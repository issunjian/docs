import{_ as s,o as n,c as a,V as l}from"./chunks/framework.c6d8cbec.js";const u=JSON.parse('{"title":"获取目录结构(纯前端)","description":"","frontmatter":{},"headers":[],"relativePath":"frontend/js/获取目录结构.md","filePath":"frontend/js/获取目录结构.md"}'),p={name:"frontend/js/获取目录结构.md"},o=l(`<h1 id="获取目录结构-纯前端" tabindex="-1">获取目录结构(纯前端) <a class="header-anchor" href="#获取目录结构-纯前端" aria-label="Permalink to &quot;获取目录结构(纯前端)&quot;">​</a></h1><div class="language-vue vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">vue</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F6F6F4;">&lt;</span><span style="color:#F286C4;">button</span><span style="color:#F6F6F4;"> @</span><span style="color:#62E884;font-style:italic;">click</span><span style="color:#F286C4;">=</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">onSelectDir</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;font-style:italic;">class</span><span style="color:#F286C4;">=</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">select-btn</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">&gt;选择文件夹&lt;/</span><span style="color:#F286C4;">button</span><span style="color:#F6F6F4;">&gt;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#22863A;">button</span><span style="color:#24292E;"> @</span><span style="color:#6F42C1;">click</span><span style="color:#24292E;">=</span><span style="color:#032F62;">&quot;</span><span style="color:#24292E;">onSelectDir</span><span style="color:#032F62;">&quot;</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">class</span><span style="color:#24292E;">=</span><span style="color:#032F62;">&quot;select-btn&quot;</span><span style="color:#24292E;">&gt;选择文件夹&lt;/</span><span style="color:#22863A;">button</span><span style="color:#24292E;">&gt;</span></span></code></pre></div><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F286C4;">const</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">onSelectDir</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">async</span><span style="color:#F6F6F4;"> () </span><span style="color:#F286C4;">=&gt;</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">  </span><span style="color:#F286C4;">const</span><span style="color:#F6F6F4;"> dirHandle </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">await</span><span style="color:#F6F6F4;"> window.</span><span style="color:#62E884;">showDirectoryPicker</span><span style="color:#F6F6F4;">()</span></span>
<span class="line"><span style="color:#F6F6F4;">  </span><span style="color:#F286C4;">await</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">getDirData</span><span style="color:#F6F6F4;">(dirHandle, directoryData)</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span>
<span class="line"><span style="color:#7B7F8B;">/*递归获取文件夹下的所有文件, 并生成树状结构 </span></span>
<span class="line"><span style="color:#7B7F8B;"> {</span></span>
<span class="line"><span style="color:#7B7F8B;">&quot;id&quot;: &quot;o6ukw45e&quot;,</span></span>
<span class="line"><span style="color:#7B7F8B;">&quot;name&quot;: &quot;core&quot;,</span></span>
<span class="line"><span style="color:#7B7F8B;">&quot;ftype&quot;: &quot;dir&quot;,</span></span>
<span class="line"><span style="color:#7B7F8B;">&quot;children&quot;: [</span></span>
<span class="line"><span style="color:#7B7F8B;">  {</span></span>
<span class="line"><span style="color:#7B7F8B;">    &quot;id&quot;: &quot;bc41wb16&quot;,</span></span>
<span class="line"><span style="color:#7B7F8B;">    &quot;name&quot;: &quot;.eslintrc.cjs&quot;,</span></span>
<span class="line"><span style="color:#7B7F8B;">    &quot;ftype&quot;: &quot;cjs&quot;</span></span>
<span class="line"><span style="color:#7B7F8B;">  },]</span></span>
<span class="line"><span style="color:#7B7F8B;">}</span></span>
<span class="line"><span style="color:#7B7F8B;">*/</span></span>
<span class="line"><span style="color:#F286C4;">let</span><span style="color:#F6F6F4;"> exclude </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> [</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">node_modules</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">, </span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">.git</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">, </span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">.vscode</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">, </span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">.prettierignore</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">, </span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">dist</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">]; </span><span style="color:#7B7F8B;">//排除的文件夹</span></span>
<span class="line"><span style="color:#F286C4;">const</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">getDirData</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">async</span><span style="color:#F6F6F4;"> (</span><span style="color:#FFB86C;font-style:italic;">dirHandle</span><span style="color:#F6F6F4;">, </span><span style="color:#FFB86C;font-style:italic;">dirData</span><span style="color:#F6F6F4;">) </span><span style="color:#F286C4;">=&gt;</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">  </span><span style="color:#F286C4;">for</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">await</span><span style="color:#F6F6F4;"> (</span><span style="color:#F286C4;">const</span><span style="color:#F6F6F4;"> entry </span><span style="color:#F286C4;">of</span><span style="color:#F6F6F4;"> dirHandle.</span><span style="color:#62E884;">values</span><span style="color:#F6F6F4;">()) {</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">let</span><span style="color:#F6F6F4;"> { name, kind } </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> entry</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#7B7F8B;">//文件大小</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">if</span><span style="color:#F6F6F4;"> (kind </span><span style="color:#F286C4;">===</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">file</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">) {</span></span>
<span class="line"><span style="color:#F6F6F4;">      </span><span style="color:#F286C4;">const</span><span style="color:#F6F6F4;"> size </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">await</span><span style="color:#F6F6F4;"> entry.</span><span style="color:#62E884;">getFile</span><span style="color:#F6F6F4;">().</span><span style="color:#62E884;">then</span><span style="color:#F6F6F4;">(</span><span style="color:#FFB86C;font-style:italic;">file</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">=&gt;</span><span style="color:#F6F6F4;"> file.size </span><span style="color:#F286C4;">||</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">0</span><span style="color:#F6F6F4;">)</span></span>
<span class="line"><span style="color:#F6F6F4;">      </span><span style="color:#F286C4;">const</span><span style="color:#F6F6F4;"> ftype </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> name.</span><span style="color:#62E884;">split</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">.</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">).length </span><span style="color:#F286C4;">&gt;</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">1</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">?</span><span style="color:#F6F6F4;"> name.</span><span style="color:#62E884;">split</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">.</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">)[</span><span style="color:#BF9EEE;">1</span><span style="color:#F6F6F4;">] </span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">unknown</span><span style="color:#DEE492;">&#39;</span></span>
<span class="line"><span style="color:#F6F6F4;">      dirData.children.</span><span style="color:#62E884;">push</span><span style="color:#F6F6F4;">({</span></span>
<span class="line"><span style="color:#F6F6F4;">        id</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">randomId</span><span style="color:#F6F6F4;">(),</span></span>
<span class="line"><span style="color:#F6F6F4;">        name,</span></span>
<span class="line"><span style="color:#F6F6F4;">        size,</span></span>
<span class="line"><span style="color:#F6F6F4;">        value</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> size,</span></span>
<span class="line"><span style="color:#F6F6F4;">        ftype</span></span>
<span class="line"><span style="color:#F6F6F4;">      })</span></span>
<span class="line"><span style="color:#F6F6F4;">    } </span><span style="color:#F286C4;">else</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">if</span><span style="color:#F6F6F4;"> (kind </span><span style="color:#F286C4;">===</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">directory</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">) {</span></span>
<span class="line"><span style="color:#F6F6F4;">      </span><span style="color:#F286C4;">if</span><span style="color:#F6F6F4;"> (exclude.</span><span style="color:#62E884;">includes</span><span style="color:#F6F6F4;">(name)) </span><span style="color:#F286C4;">continue</span><span style="color:#F6F6F4;">;</span></span>
<span class="line"><span style="color:#F6F6F4;">      </span><span style="color:#F286C4;">const</span><span style="color:#F6F6F4;"> children </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">        id</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">randomId</span><span style="color:#F6F6F4;">(),</span></span>
<span class="line"><span style="color:#F6F6F4;">        name,</span></span>
<span class="line"><span style="color:#F6F6F4;">        ftype</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">dir</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">        children</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> []</span></span>
<span class="line"><span style="color:#F6F6F4;">      }</span></span>
<span class="line"><span style="color:#F6F6F4;">      dirData.children.</span><span style="color:#62E884;">push</span><span style="color:#F6F6F4;">(children)</span></span>
<span class="line"><span style="color:#F6F6F4;">      </span><span style="color:#F286C4;">await</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">getDirData</span><span style="color:#F6F6F4;">(entry, children)</span></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span>
<span class="line"><span style="color:#F6F6F4;">  }</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">onSelectDir</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">async</span><span style="color:#24292E;"> () </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">dirHandle</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">await</span><span style="color:#24292E;"> window.</span><span style="color:#6F42C1;">showDirectoryPicker</span><span style="color:#24292E;">()</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">await</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">getDirData</span><span style="color:#24292E;">(dirHandle, directoryData)</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"><span style="color:#6A737D;">/*递归获取文件夹下的所有文件, 并生成树状结构 </span></span>
<span class="line"><span style="color:#6A737D;"> {</span></span>
<span class="line"><span style="color:#6A737D;">&quot;id&quot;: &quot;o6ukw45e&quot;,</span></span>
<span class="line"><span style="color:#6A737D;">&quot;name&quot;: &quot;core&quot;,</span></span>
<span class="line"><span style="color:#6A737D;">&quot;ftype&quot;: &quot;dir&quot;,</span></span>
<span class="line"><span style="color:#6A737D;">&quot;children&quot;: [</span></span>
<span class="line"><span style="color:#6A737D;">  {</span></span>
<span class="line"><span style="color:#6A737D;">    &quot;id&quot;: &quot;bc41wb16&quot;,</span></span>
<span class="line"><span style="color:#6A737D;">    &quot;name&quot;: &quot;.eslintrc.cjs&quot;,</span></span>
<span class="line"><span style="color:#6A737D;">    &quot;ftype&quot;: &quot;cjs&quot;</span></span>
<span class="line"><span style="color:#6A737D;">  },]</span></span>
<span class="line"><span style="color:#6A737D;">}</span></span>
<span class="line"><span style="color:#6A737D;">*/</span></span>
<span class="line"><span style="color:#D73A49;">let</span><span style="color:#24292E;"> exclude </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> [</span><span style="color:#032F62;">&quot;node_modules&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;.git&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;.vscode&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;.prettierignore&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;dist&quot;</span><span style="color:#24292E;">]; </span><span style="color:#6A737D;">//排除的文件夹</span></span>
<span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">getDirData</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">async</span><span style="color:#24292E;"> (</span><span style="color:#E36209;">dirHandle</span><span style="color:#24292E;">, </span><span style="color:#E36209;">dirData</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">for</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">await</span><span style="color:#24292E;"> (</span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">entry</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">of</span><span style="color:#24292E;"> dirHandle.</span><span style="color:#6F42C1;">values</span><span style="color:#24292E;">()) {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">let</span><span style="color:#24292E;"> { name, kind } </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> entry</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//文件大小</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (kind </span><span style="color:#D73A49;">===</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;file&#39;</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">size</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">await</span><span style="color:#24292E;"> entry.</span><span style="color:#6F42C1;">getFile</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">then</span><span style="color:#24292E;">(</span><span style="color:#E36209;">file</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> file.size </span><span style="color:#D73A49;">||</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">ftype</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> name.</span><span style="color:#6F42C1;">split</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;.&#39;</span><span style="color:#24292E;">).</span><span style="color:#005CC5;">length</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">?</span><span style="color:#24292E;"> name.</span><span style="color:#6F42C1;">split</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;.&#39;</span><span style="color:#24292E;">)[</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">] </span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;unknown&#39;</span></span>
<span class="line"><span style="color:#24292E;">      dirData.children.</span><span style="color:#6F42C1;">push</span><span style="color:#24292E;">({</span></span>
<span class="line"><span style="color:#24292E;">        id: </span><span style="color:#6F42C1;">randomId</span><span style="color:#24292E;">(),</span></span>
<span class="line"><span style="color:#24292E;">        name,</span></span>
<span class="line"><span style="color:#24292E;">        size,</span></span>
<span class="line"><span style="color:#24292E;">        value: size,</span></span>
<span class="line"><span style="color:#24292E;">        ftype</span></span>
<span class="line"><span style="color:#24292E;">      })</span></span>
<span class="line"><span style="color:#24292E;">    } </span><span style="color:#D73A49;">else</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (kind </span><span style="color:#D73A49;">===</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;directory&#39;</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (exclude.</span><span style="color:#6F42C1;">includes</span><span style="color:#24292E;">(name)) </span><span style="color:#D73A49;">continue</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">children</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">        id: </span><span style="color:#6F42C1;">randomId</span><span style="color:#24292E;">(),</span></span>
<span class="line"><span style="color:#24292E;">        name,</span></span>
<span class="line"><span style="color:#24292E;">        ftype: </span><span style="color:#032F62;">&#39;dir&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">        children: []</span></span>
<span class="line"><span style="color:#24292E;">      }</span></span>
<span class="line"><span style="color:#24292E;">      dirData.children.</span><span style="color:#6F42C1;">push</span><span style="color:#24292E;">(children)</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#D73A49;">await</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">getDirData</span><span style="color:#24292E;">(entry, children)</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">  }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div>`,3),e=[o];function t(c,r,y,F,i,E){return n(),a("div",null,e)}const D=s(p,[["render",t]]);export{u as __pageData,D as default};
