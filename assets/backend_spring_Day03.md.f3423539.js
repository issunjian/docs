import{_ as s,o as a,c as n,V as l}from"./chunks/framework.c6d8cbec.js";const d=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[],"relativePath":"backend/spring/Day03.md","filePath":"backend/spring/Day03.md"}'),p={name:"backend/spring/Day03.md"},o=l(`<h2 id="_1-aop" tabindex="-1">1. AOP <a class="header-anchor" href="#_1-aop" aria-label="Permalink to &quot;1\\. AOP&quot;">â€‹</a></h2><h3 id="_1-1-aop-ç®€ä»‹ã€ç†è§£ã€‘" tabindex="-1">1.1 AOP ç®€ä»‹ã€ç†è§£ã€‘ <a class="header-anchor" href="#_1-1-aop-ç®€ä»‹ã€ç†è§£ã€‘" aria-label="Permalink to &quot;1.1 AOP ç®€ä»‹ã€ç†è§£ã€‘&quot;">â€‹</a></h3><h4 id="_1-1-1ã€Œaop-ç®€ä»‹ã€æ ¸å¿ƒé—®é¢˜-ç­”æ¡ˆ" tabindex="-1">1.1.1ã€ŒAOP ç®€ä»‹ã€æ ¸å¿ƒé—®é¢˜&amp;ç­”æ¡ˆ <a class="header-anchor" href="#_1-1-1ã€Œaop-ç®€ä»‹ã€æ ¸å¿ƒé—®é¢˜-ç­”æ¡ˆ" aria-label="Permalink to &quot;1.1.1ã€ŒAOP ç®€ä»‹ã€æ ¸å¿ƒé—®é¢˜&amp;ç­”æ¡ˆ&quot;">â€‹</a></h4><p>AOP çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ</p><p>ç‚¹å‡»æŸ¥çœ‹ä½œç”¨</p><ul><li><p>AOP(Aspect Oriented Programming)é¢å‘åˆ‡é¢ç¼–ç¨‹ï¼Œä¸€ç§ç¼–ç¨‹èŒƒå¼ï¼ŒæŒ‡å¯¼å¼€å‘è€…å¦‚ä½•ç»„ç»‡ç¨‹åºç»“æ„</p></li><li><p>OOP(Object Oriented Programming)é¢å‘å¯¹è±¡ç¼–ç¨‹----<strong>å®šä¹‰ç±»ï¼Œå®šä¹‰æ–¹æ³•ï¼Œå¼€å‘åŠŸèƒ½</strong></p></li><li><p>ä½œç”¨ï¼šåœ¨çš„åŸºç¡€ä¸Šä¸ºå…¶è¿›è¡Œã€‚ ç®€å•çš„è¯´å°±æ˜¯åœ¨ä¸æ”¹å˜æ–¹æ³•æºä»£ç çš„åŸºç¡€ä¸Šå¯¹æ–¹æ³•è¿›è¡ŒåŠŸèƒ½å¢å¼ºã€‚</p></li><li><p>Spring ç†å¿µï¼šæ— å…¥ä¾µå¼/æ— ä¾µå…¥å¼å¢å¼º</p></li></ul><p>AOP æ ¸å¿ƒæ¦‚å¿µæœ‰å“ªäº›ï¼Ÿ</p><p>ç‚¹å‡»æŸ¥çœ‹æ ¸å¿ƒæ¦‚å¿µ</p><ul><li>è¿æ¥ç‚¹ï¼ˆJoinPointï¼‰ï¼šæ­£åœ¨æ‰§è¡Œçš„æ–¹æ³•ï¼Œä¾‹å¦‚ï¼šupdate()ã€delete()ã€select()ç­‰éƒ½æ˜¯è¿æ¥ç‚¹ã€‚</li><li>åˆ‡å…¥ç‚¹ï¼ˆPointcutï¼‰ï¼šè¿›è¡ŒåŠŸèƒ½å¢å¼ºäº†çš„æ–¹æ³•ï¼Œä¾‹å¦‚:update()ã€delete()æ–¹æ³•ï¼Œselect()æ–¹æ³•æ²¡æœ‰è¢«å¢å¼ºæ‰€ä»¥ä¸æ˜¯åˆ‡å…¥ç‚¹ï¼Œä½†æ˜¯æ˜¯è¿æ¥ç‚¹ã€‚ <ul><li>åœ¨ SpringAOP ä¸­ï¼Œä¸€ä¸ªåˆ‡å…¥ç‚¹å¯ä»¥åªæè¿°ä¸€ä¸ªå…·ä½“æ–¹æ³•ï¼Œä¹Ÿå¯ä»¥åŒ¹é…å¤šä¸ªæ–¹æ³• <ul><li><strong>ä¸€ä¸ªå…·ä½“æ–¹æ³•</strong>ï¼šcom.itheima.dao åŒ…ä¸‹çš„ BookDao æ¥å£ä¸­çš„æ— å½¢å‚æ— è¿”å›å€¼çš„ save æ–¹æ³•</li><li><strong>åŒ¹é…å¤šä¸ªæ–¹æ³•</strong>ï¼šæ‰€æœ‰çš„ save æ–¹æ³•ï¼Œæ‰€æœ‰çš„ get å¼€å¤´çš„æ–¹æ³•ï¼Œæ‰€æœ‰ä»¥ Dao ç»“å°¾çš„æ¥å£ä¸­çš„ä»»æ„æ–¹æ³•ï¼Œæ‰€æœ‰å¸¦æœ‰ä¸€ä¸ªå‚æ•°çš„æ–¹æ³•</li></ul></li></ul></li><li>é€šçŸ¥ï¼ˆAdviceï¼‰ï¼šåœ¨åˆ‡å…¥ç‚¹å‰åæ‰§è¡Œçš„æ“ä½œï¼Œä¹Ÿå°±æ˜¯å¢å¼ºçš„å…±æ€§åŠŸèƒ½ <ul><li>åœ¨ SpringAOP ä¸­ï¼ŒåŠŸèƒ½æœ€ç»ˆä»¥æ–¹æ³•çš„å½¢å¼å‘ˆç°</li></ul></li><li>é€šçŸ¥ç±»ï¼šé€šçŸ¥æ–¹æ³•æ‰€åœ¨çš„ç±»å«åšé€šçŸ¥ç±»</li><li>æè¿°é€šçŸ¥(<strong>å…±æ€§åŠŸèƒ½</strong>)ä¸åˆ‡å…¥ç‚¹ï¼ˆ<strong>éœ€è¦å¢å¼ºçš„æ–¹æ³•</strong>ï¼‰çš„å¯¹åº”å…³ç³»ï¼Œä¹Ÿå°±æ˜¯å“ªäº›é€šçŸ¥æ–¹æ³•å¯¹åº”å“ªäº›åˆ‡å…¥ç‚¹æ–¹æ³•ã€‚<img src="http://www.yangeit.cn:21010/assets/image-20210730144903209-34de9793.png" alt=""></li></ul><p>æé—®ï¼šæŸ¥çœ‹ä¸‹åˆ—å›¾ç‰‡ï¼Œå›ç­”é—®é¢˜</p><p>ç‚¹å‡»æŸ¥çœ‹å›¾ç‰‡</p><ul><li><p>ä¸‹åˆ—å“ªä¸ªæ˜¯ç›®æ ‡å¯¹è±¡ï¼Œå“ªä¸ªæ˜¯ä»£ç†å¯¹è±¡ï¼Ÿ</p><p><img src="http://www.yangeit.cn:21010/assets/image-20220513203556476-3922456c.png" alt="image-20220513203556476"></p><p>image-20220513203556476</p></li></ul><h3 id="_1-2-aop-å…¥é—¨æ¡ˆä¾‹ã€é‡ç‚¹ã€‘" tabindex="-1">1.2 AOP å…¥é—¨æ¡ˆä¾‹ã€é‡ç‚¹ã€‘ <a class="header-anchor" href="#_1-2-aop-å…¥é—¨æ¡ˆä¾‹ã€é‡ç‚¹ã€‘" aria-label="Permalink to &quot;1.2 AOP å…¥é—¨æ¡ˆä¾‹ã€é‡ç‚¹ã€‘&quot;">â€‹</a></h3><h4 id="_1-2-1-ã€Œå…¥é—¨æ¡ˆä¾‹ã€æ ¸å¿ƒé—®é¢˜-ç­”æ¡ˆ" tabindex="-1">1.2.1 ã€Œå…¥é—¨æ¡ˆä¾‹ã€æ ¸å¿ƒé—®é¢˜&amp;ç­”æ¡ˆ <a class="header-anchor" href="#_1-2-1-ã€Œå…¥é—¨æ¡ˆä¾‹ã€æ ¸å¿ƒé—®é¢˜-ç­”æ¡ˆ" aria-label="Permalink to &quot;1.2.1 ã€Œå…¥é—¨æ¡ˆä¾‹ã€æ ¸å¿ƒé—®é¢˜&amp;ç­”æ¡ˆ&quot;">â€‹</a></h4><p>é—®é¢˜</p><ol><li>åœ¨é€šçŸ¥æ–¹æ³•ä¸­å¦‚ä½•å®šä¹‰åˆ‡å…¥ç‚¹è¡¨è¾¾å¼ï¼Ÿ</li><li>å¦‚ä½•é…ç½®åˆ‡é¢ï¼Ÿ</li><li>åœ¨é…ç½®ç±»ä¸Šå¦‚ä½•å¼€å¯ AOP æ³¨è§£åŠŸèƒ½ï¼Ÿ</li></ol><h4 id="_1-2-2-aop-å…¥é—¨æ¡ˆä¾‹æ€è·¯åˆ†æ" tabindex="-1">1.2.2 AOP å…¥é—¨æ¡ˆä¾‹æ€è·¯åˆ†æ <a class="header-anchor" href="#_1-2-2-aop-å…¥é—¨æ¡ˆä¾‹æ€è·¯åˆ†æ" aria-label="Permalink to &quot;1.2.2 AOP å…¥é—¨æ¡ˆä¾‹æ€è·¯åˆ†æ&quot;">â€‹</a></h4><p>ç‚¹å‡»æŸ¥çœ‹æ€è·¯åˆ†æ</p><ul><li>æ¡ˆä¾‹è®¾å®šï¼šæµ‹å®šæ¥å£æ‰§è¡Œæ•ˆç‡</li><li>ç®€åŒ–è®¾å®šï¼šåœ¨æ¥å£æ‰§è¡Œå‰è¾“å‡ºå½“å‰ç³»ç»Ÿæ—¶é—´</li><li>å¼€å‘æ¨¡å¼ï¼šXML or <strong>æ³¨è§£</strong></li><li>æ€è·¯åˆ†æï¼š <ol><li>å¯¼å…¥åæ ‡ï¼ˆpom.xmlï¼‰</li><li>åˆ¶ä½œè¿æ¥ç‚¹æ–¹æ³•ï¼ˆåŸå§‹æ“ä½œï¼Œdao æ¥å£ä¸å®ç°ç±»ï¼‰</li><li>åˆ¶ä½œå…±æ€§åŠŸèƒ½ï¼ˆé€šçŸ¥ç±»ä¸é€šçŸ¥ï¼‰</li><li>å®šä¹‰åˆ‡å…¥ç‚¹</li><li>ç»‘å®šåˆ‡å…¥ç‚¹ä¸é€šçŸ¥å…³ç³»ï¼ˆåˆ‡é¢ï¼‰</li></ol></li></ul><h4 id="_1-2-3-aop-å…¥é—¨æ¡ˆä¾‹å®ç°" tabindex="-1">1.2.3 AOP å…¥é—¨æ¡ˆä¾‹å®ç° <a class="header-anchor" href="#_1-2-3-aop-å…¥é—¨æ¡ˆä¾‹å®ç°" aria-label="Permalink to &quot;1.2.3 AOP å…¥é—¨æ¡ˆä¾‹å®ç°&quot;">â€‹</a></h4><p>æ­¥é„¹</p><h5 id="ã€ç¬¬ä¸€æ­¥ã€‘å¯¼å…¥-aop-ç›¸å…³åæ ‡" tabindex="-1">ã€ç¬¬ä¸€æ­¥ã€‘å¯¼å…¥ Aop ç›¸å…³åæ ‡ <a class="header-anchor" href="#ã€ç¬¬ä¸€æ­¥ã€‘å¯¼å…¥-aop-ç›¸å…³åæ ‡" aria-label="Permalink to &quot;ã€ç¬¬ä¸€æ­¥ã€‘å¯¼å…¥ Aop ç›¸å…³åæ ‡&quot;">â€‹</a></h5><h5 id="ã€ç¬¬äºŒæ­¥ã€‘å®šä¹‰-dao-æ¥å£ä¸å®ç°ç±»" tabindex="-1">ã€ç¬¬äºŒæ­¥ã€‘å®šä¹‰ dao æ¥å£ä¸å®ç°ç±» <a class="header-anchor" href="#ã€ç¬¬äºŒæ­¥ã€‘å®šä¹‰-dao-æ¥å£ä¸å®ç°ç±»" aria-label="Permalink to &quot;ã€ç¬¬äºŒæ­¥ã€‘å®šä¹‰ dao æ¥å£ä¸å®ç°ç±»&quot;">â€‹</a></h5><h5 id="ã€ç¬¬ä¸‰æ­¥ã€‘å®šä¹‰é€šçŸ¥ç±»-åˆ¶ä½œé€šçŸ¥æ–¹æ³•" tabindex="-1">ã€ç¬¬ä¸‰æ­¥ã€‘å®šä¹‰é€šçŸ¥ç±»ï¼Œåˆ¶ä½œé€šçŸ¥æ–¹æ³• <a class="header-anchor" href="#ã€ç¬¬ä¸‰æ­¥ã€‘å®šä¹‰é€šçŸ¥ç±»-åˆ¶ä½œé€šçŸ¥æ–¹æ³•" aria-label="Permalink to &quot;ã€ç¬¬ä¸‰æ­¥ã€‘å®šä¹‰é€šçŸ¥ç±»ï¼Œåˆ¶ä½œé€šçŸ¥æ–¹æ³•&quot;">â€‹</a></h5><h5 id="ã€ç¬¬å››æ­¥ã€‘å®šä¹‰åˆ‡å…¥ç‚¹è¡¨è¾¾å¼ã€é…ç½®åˆ‡é¢-ç»‘å®šåˆ‡å…¥ç‚¹ä¸é€šçŸ¥å…³ç³»" tabindex="-1">ã€ç¬¬å››æ­¥ã€‘å®šä¹‰åˆ‡å…¥ç‚¹è¡¨è¾¾å¼ã€é…ç½®åˆ‡é¢(ç»‘å®šåˆ‡å…¥ç‚¹ä¸é€šçŸ¥å…³ç³») <a class="header-anchor" href="#ã€ç¬¬å››æ­¥ã€‘å®šä¹‰åˆ‡å…¥ç‚¹è¡¨è¾¾å¼ã€é…ç½®åˆ‡é¢-ç»‘å®šåˆ‡å…¥ç‚¹ä¸é€šçŸ¥å…³ç³»" aria-label="Permalink to &quot;ã€ç¬¬å››æ­¥ã€‘å®šä¹‰åˆ‡å…¥ç‚¹è¡¨è¾¾å¼ã€é…ç½®åˆ‡é¢(ç»‘å®šåˆ‡å…¥ç‚¹ä¸é€šçŸ¥å…³ç³»)&quot;">â€‹</a></h5><h5 id="ã€ç¬¬äº”æ­¥ã€‘åœ¨é…ç½®ç±»ä¸­è¿›è¡Œ-spring-æ³¨è§£åŒ…æ‰«æå’Œå¼€å¯-aop-åŠŸèƒ½" tabindex="-1">ã€ç¬¬äº”æ­¥ã€‘åœ¨é…ç½®ç±»ä¸­è¿›è¡Œ Spring æ³¨è§£åŒ…æ‰«æå’Œå¼€å¯ AOP åŠŸèƒ½ <a class="header-anchor" href="#ã€ç¬¬äº”æ­¥ã€‘åœ¨é…ç½®ç±»ä¸­è¿›è¡Œ-spring-æ³¨è§£åŒ…æ‰«æå’Œå¼€å¯-aop-åŠŸèƒ½" aria-label="Permalink to &quot;ã€ç¬¬äº”æ­¥ã€‘åœ¨é…ç½®ç±»ä¸­è¿›è¡Œ Spring æ³¨è§£åŒ…æ‰«æå’Œå¼€å¯ AOP åŠŸèƒ½&quot;">â€‹</a></h5><h5 id="ã€ç¬¬ä¸€æ­¥ã€‘å¯¼å…¥-aop-ç›¸å…³åæ ‡-1" tabindex="-1">ã€ç¬¬ä¸€æ­¥ã€‘å¯¼å…¥ Aop ç›¸å…³åæ ‡ <a class="header-anchor" href="#ã€ç¬¬ä¸€æ­¥ã€‘å¯¼å…¥-aop-ç›¸å…³åæ ‡-1" aria-label="Permalink to &quot;ã€ç¬¬ä¸€æ­¥ã€‘å¯¼å…¥ Aop ç›¸å…³åæ ‡&quot;">â€‹</a></h5><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F6F6F4;">&lt;</span><span style="color:#F286C4;">dependencies</span><span style="color:#F6F6F4;">&gt;</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#7B7F8B;">&lt;!--springæ ¸å¿ƒä¾èµ–ï¼Œä¼šå°†spring-aopä¼ é€’è¿›æ¥--&gt;</span></span>
<span class="line"><span style="color:#F6F6F4;">    &lt;</span><span style="color:#F286C4;">dependency</span><span style="color:#F6F6F4;">&gt;</span></span>
<span class="line"><span style="color:#F6F6F4;">        &lt;</span><span style="color:#F286C4;">groupId</span><span style="color:#F6F6F4;">&gt;org.springframework&lt;/</span><span style="color:#F286C4;">groupId</span><span style="color:#F6F6F4;">&gt;</span></span>
<span class="line"><span style="color:#F6F6F4;">        &lt;</span><span style="color:#F286C4;">artifactId</span><span style="color:#F6F6F4;">&gt;spring-context&lt;/</span><span style="color:#F286C4;">artifactId</span><span style="color:#F6F6F4;">&gt;</span></span>
<span class="line"><span style="color:#F6F6F4;">        &lt;</span><span style="color:#F286C4;">version</span><span style="color:#F6F6F4;">&gt;5.2.10.RELEASE&lt;/</span><span style="color:#F286C4;">version</span><span style="color:#F6F6F4;">&gt;</span></span>
<span class="line"><span style="color:#F6F6F4;">    &lt;/</span><span style="color:#F286C4;">dependency</span><span style="color:#F6F6F4;">&gt;</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#7B7F8B;">&lt;!--åˆ‡å…¥ç‚¹è¡¨è¾¾å¼ä¾èµ–ï¼Œç›®çš„æ˜¯æ‰¾åˆ°åˆ‡å…¥ç‚¹æ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯æ‰¾åˆ°è¦å¢å¼ºçš„æ–¹æ³•--&gt;</span></span>
<span class="line"><span style="color:#F6F6F4;">    &lt;</span><span style="color:#F286C4;">dependency</span><span style="color:#F6F6F4;">&gt;</span></span>
<span class="line"><span style="color:#F6F6F4;">        &lt;</span><span style="color:#F286C4;">groupId</span><span style="color:#F6F6F4;">&gt;org.aspectj&lt;/</span><span style="color:#F286C4;">groupId</span><span style="color:#F6F6F4;">&gt;</span></span>
<span class="line"><span style="color:#F6F6F4;">        &lt;</span><span style="color:#F286C4;">artifactId</span><span style="color:#F6F6F4;">&gt;aspectjweaver&lt;/</span><span style="color:#F286C4;">artifactId</span><span style="color:#F6F6F4;">&gt;</span></span>
<span class="line"><span style="color:#F6F6F4;">        &lt;</span><span style="color:#F286C4;">version</span><span style="color:#F6F6F4;">&gt;1.9.4&lt;/</span><span style="color:#F286C4;">version</span><span style="color:#F6F6F4;">&gt;</span></span>
<span class="line"><span style="color:#F6F6F4;">    &lt;/</span><span style="color:#F286C4;">dependency</span><span style="color:#F6F6F4;">&gt;</span></span>
<span class="line"><span style="color:#F6F6F4;">&lt;/</span><span style="color:#F286C4;">dependencies</span><span style="color:#F6F6F4;">&gt;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#22863A;">dependencies</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">&lt;!--springæ ¸å¿ƒä¾èµ–ï¼Œä¼šå°†spring-aopä¼ é€’è¿›æ¥--&gt;</span></span>
<span class="line"><span style="color:#24292E;">    &lt;</span><span style="color:#22863A;">dependency</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">        &lt;</span><span style="color:#22863A;">groupId</span><span style="color:#24292E;">&gt;org.springframework&lt;/</span><span style="color:#22863A;">groupId</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">        &lt;</span><span style="color:#22863A;">artifactId</span><span style="color:#24292E;">&gt;spring-context&lt;/</span><span style="color:#22863A;">artifactId</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">        &lt;</span><span style="color:#22863A;">version</span><span style="color:#24292E;">&gt;5.2.10.RELEASE&lt;/</span><span style="color:#22863A;">version</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">    &lt;/</span><span style="color:#22863A;">dependency</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">&lt;!--åˆ‡å…¥ç‚¹è¡¨è¾¾å¼ä¾èµ–ï¼Œç›®çš„æ˜¯æ‰¾åˆ°åˆ‡å…¥ç‚¹æ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯æ‰¾åˆ°è¦å¢å¼ºçš„æ–¹æ³•--&gt;</span></span>
<span class="line"><span style="color:#24292E;">    &lt;</span><span style="color:#22863A;">dependency</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">        &lt;</span><span style="color:#22863A;">groupId</span><span style="color:#24292E;">&gt;org.aspectj&lt;/</span><span style="color:#22863A;">groupId</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">        &lt;</span><span style="color:#22863A;">artifactId</span><span style="color:#24292E;">&gt;aspectjweaver&lt;/</span><span style="color:#22863A;">artifactId</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">        &lt;</span><span style="color:#22863A;">version</span><span style="color:#24292E;">&gt;1.9.4&lt;/</span><span style="color:#22863A;">version</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">    &lt;/</span><span style="color:#22863A;">dependency</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">&lt;/</span><span style="color:#22863A;">dependencies</span><span style="color:#24292E;">&gt;</span></span></code></pre></div><p><img src="http://www.yangeit.cn:21010/assets/image-20210730150138448-84fc6690.png" alt="image-20210730150138448"></p><p>image-20210730150138448</p><h5 id="ã€ç¬¬äºŒæ­¥ã€‘å®šä¹‰-dao-æ¥å£ä¸å®ç°ç±»-1" tabindex="-1">ã€ç¬¬äºŒæ­¥ã€‘å®šä¹‰ dao æ¥å£ä¸å®ç°ç±» <a class="header-anchor" href="#ã€ç¬¬äºŒæ­¥ã€‘å®šä¹‰-dao-æ¥å£ä¸å®ç°ç±»-1" aria-label="Permalink to &quot;ã€ç¬¬äºŒæ­¥ã€‘å®šä¹‰ dao æ¥å£ä¸å®ç°ç±»&quot;">â€‹</a></h5><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#7B7F8B;">// å®šä¹‰æ¥å£</span></span>
<span class="line"><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">interface</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;">BookDao</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">save</span><span style="color:#F6F6F4;">();</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">update</span><span style="color:#F6F6F4;">();</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">// å®šä¹‰æ¥å£</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">interface</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">BookDao</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">save</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">update</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#7B7F8B;">// å®šä¹‰å®ç°ç±»,æ·»åŠ æ³¨è§£@Repository(æŒä¹…å±‚)</span></span>
<span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Repository</span></span>
<span class="line"><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">class</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;">BookDaoImpl</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">implements</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">BookDao</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">save</span><span style="color:#F6F6F4;">() {</span></span>
<span class="line"><span style="color:#F6F6F4;">        System.out.</span><span style="color:#62E884;">println</span><span style="color:#F6F6F4;">(System.</span><span style="color:#62E884;">currentTimeMillis</span><span style="color:#F6F6F4;">());</span></span>
<span class="line"><span style="color:#F6F6F4;">        System.out.</span><span style="color:#62E884;">println</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">book dao save ...</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">);</span></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">update</span><span style="color:#F6F6F4;">(){</span></span>
<span class="line"><span style="color:#F6F6F4;">        System.out.</span><span style="color:#62E884;">println</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">book dao update ...</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">);</span></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">// å®šä¹‰å®ç°ç±»,æ·»åŠ æ³¨è§£@Repository(æŒä¹…å±‚)</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Repository</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">BookDaoImpl</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">implements</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">BookDao</span><span style="color:#24292E;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">save</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">        System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(System.</span><span style="color:#6F42C1;">currentTimeMillis</span><span style="color:#24292E;">());</span></span>
<span class="line"><span style="color:#24292E;">        System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;book dao save ...&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">update</span><span style="color:#24292E;">(){</span></span>
<span class="line"><span style="color:#24292E;">        System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;book dao update ...&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h5 id="ã€ç¬¬ä¸‰æ­¥ã€‘å®šä¹‰é€šçŸ¥ç±»-åˆ¶ä½œé€šçŸ¥æ–¹æ³•-1" tabindex="-1">ã€ç¬¬ä¸‰æ­¥ã€‘å®šä¹‰é€šçŸ¥ç±»ï¼Œåˆ¶ä½œé€šçŸ¥æ–¹æ³• <a class="header-anchor" href="#ã€ç¬¬ä¸‰æ­¥ã€‘å®šä¹‰é€šçŸ¥ç±»-åˆ¶ä½œé€šçŸ¥æ–¹æ³•-1" aria-label="Permalink to &quot;ã€ç¬¬ä¸‰æ­¥ã€‘å®šä¹‰é€šçŸ¥ç±»ï¼Œåˆ¶ä½œé€šçŸ¥æ–¹æ³•&quot;">â€‹</a></h5><blockquote><p>å»ºç«‹ aop åŒ…ï¼Œåœ¨åŒ…ä¸­å®šä¹‰ MyAdvice é€šçŸ¥ç±»</p></blockquote><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#7B7F8B;">//é€šçŸ¥ç±»å¿…é¡»é…ç½®æˆSpringç®¡ç†çš„bean</span></span>
<span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Component</span></span>
<span class="line"><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">class</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;">MyAdvice</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">method</span><span style="color:#F6F6F4;">(){</span></span>
<span class="line"><span style="color:#F6F6F4;">        System.out.</span><span style="color:#62E884;">println</span><span style="color:#F6F6F4;">(System.</span><span style="color:#62E884;">currentTimeMillis</span><span style="color:#F6F6F4;">());</span></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">//é€šçŸ¥ç±»å¿…é¡»é…ç½®æˆSpringç®¡ç†çš„bean</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Component</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">MyAdvice</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">method</span><span style="color:#24292E;">(){</span></span>
<span class="line"><span style="color:#24292E;">        System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(System.</span><span style="color:#6F42C1;">currentTimeMillis</span><span style="color:#24292E;">());</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h5 id="ã€ç¬¬å››æ­¥ã€‘å®šä¹‰åˆ‡å…¥ç‚¹è¡¨è¾¾å¼ã€é…ç½®åˆ‡é¢-ç»‘å®šåˆ‡å…¥ç‚¹ä¸é€šçŸ¥å…³ç³»-1" tabindex="-1">ã€ç¬¬å››æ­¥ã€‘å®šä¹‰åˆ‡å…¥ç‚¹è¡¨è¾¾å¼ã€é…ç½®åˆ‡é¢(ç»‘å®šåˆ‡å…¥ç‚¹ä¸é€šçŸ¥å…³ç³») <a class="header-anchor" href="#ã€ç¬¬å››æ­¥ã€‘å®šä¹‰åˆ‡å…¥ç‚¹è¡¨è¾¾å¼ã€é…ç½®åˆ‡é¢-ç»‘å®šåˆ‡å…¥ç‚¹ä¸é€šçŸ¥å…³ç³»-1" aria-label="Permalink to &quot;ã€ç¬¬å››æ­¥ã€‘å®šä¹‰åˆ‡å…¥ç‚¹è¡¨è¾¾å¼ã€é…ç½®åˆ‡é¢(ç»‘å®šåˆ‡å…¥ç‚¹ä¸é€šçŸ¥å…³ç³»)&quot;">â€‹</a></h5><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#7B7F8B;">//é€šçŸ¥ç±»å¿…é¡»é…ç½®æˆSpringç®¡ç†çš„bean</span></span>
<span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Component</span></span>
<span class="line"><span style="color:#7B7F8B;">//è®¾ç½®å½“å‰ç±»ä¸ºåˆ‡é¢ç±»ç±»</span></span>
<span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Aspect</span></span>
<span class="line"><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">class</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;">MyAdvice</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#7B7F8B;">//è®¾ç½®åˆ‡å…¥ç‚¹ï¼Œ@Pointcutæ³¨è§£è¦æ±‚é…ç½®åœ¨æ–¹æ³•ä¸Šæ–¹</span></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Pointcut</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">execution(void com.itheima.dao.BookDao.update())</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">)</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">private</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">pt</span><span style="color:#F6F6F4;">(){}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#7B7F8B;">//è®¾ç½®åœ¨åˆ‡å…¥ç‚¹pt()çš„å‰é¢è¿è¡Œå½“å‰æ“ä½œ(å‰ç½®é€šçŸ¥)</span></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Before</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">pt()</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">)</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">method</span><span style="color:#F6F6F4;">(){</span></span>
<span class="line"><span style="color:#F6F6F4;">        System.out.</span><span style="color:#62E884;">println</span><span style="color:#F6F6F4;">(System.</span><span style="color:#62E884;">currentTimeMillis</span><span style="color:#F6F6F4;">());</span></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">//é€šçŸ¥ç±»å¿…é¡»é…ç½®æˆSpringç®¡ç†çš„bean</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Component</span></span>
<span class="line"><span style="color:#6A737D;">//è®¾ç½®å½“å‰ç±»ä¸ºåˆ‡é¢ç±»ç±»</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Aspect</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">MyAdvice</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//è®¾ç½®åˆ‡å…¥ç‚¹ï¼Œ@Pointcutæ³¨è§£è¦æ±‚é…ç½®åœ¨æ–¹æ³•ä¸Šæ–¹</span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Pointcut</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;execution(void com.itheima.dao.BookDao.update())&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">pt</span><span style="color:#24292E;">(){}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//è®¾ç½®åœ¨åˆ‡å…¥ç‚¹pt()çš„å‰é¢è¿è¡Œå½“å‰æ“ä½œ(å‰ç½®é€šçŸ¥)</span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Before</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;pt()&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">method</span><span style="color:#24292E;">(){</span></span>
<span class="line"><span style="color:#24292E;">        System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(System.</span><span style="color:#6F42C1;">currentTimeMillis</span><span style="color:#24292E;">());</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><p><img src="http://www.yangeit.cn:21010/assets/image-20210730154740528-8f329199.png" alt="image-20210730154740528"></p><p>image-20210730154740528</p><h5 id="ã€ç¬¬äº”æ­¥ã€‘åœ¨é…ç½®ç±»ä¸­è¿›è¡Œ-spring-æ³¨è§£åŒ…æ‰«æå’Œå¼€å¯-aop-åŠŸèƒ½-1" tabindex="-1">ã€ç¬¬äº”æ­¥ã€‘åœ¨é…ç½®ç±»ä¸­è¿›è¡Œ Spring æ³¨è§£åŒ…æ‰«æå’Œå¼€å¯ AOP åŠŸèƒ½ <a class="header-anchor" href="#ã€ç¬¬äº”æ­¥ã€‘åœ¨é…ç½®ç±»ä¸­è¿›è¡Œ-spring-æ³¨è§£åŒ…æ‰«æå’Œå¼€å¯-aop-åŠŸèƒ½-1" aria-label="Permalink to &quot;ã€ç¬¬äº”æ­¥ã€‘åœ¨é…ç½®ç±»ä¸­è¿›è¡Œ Spring æ³¨è§£åŒ…æ‰«æå’Œå¼€å¯ AOP åŠŸèƒ½&quot;">â€‹</a></h5><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Configuration</span></span>
<span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">ComponentScan</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">com.itheima</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">)</span></span>
<span class="line"><span style="color:#7B7F8B;">//å¼€å¯æ³¨è§£å¼€å‘AOPåŠŸèƒ½</span></span>
<span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">EnableAspectJAutoProxy</span></span>
<span class="line"><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">class</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;">SpringConfig</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Configuration</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">ComponentScan</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;com.itheima&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#6A737D;">//å¼€å¯æ³¨è§£å¼€å‘AOPåŠŸèƒ½</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">EnableAspectJAutoProxy</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">SpringConfig</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h5 id="æµ‹è¯•ç±»å’Œè¿è¡Œç»“æœ" tabindex="-1">æµ‹è¯•ç±»å’Œè¿è¡Œç»“æœ <a class="header-anchor" href="#æµ‹è¯•ç±»å’Œè¿è¡Œç»“æœ" aria-label="Permalink to &quot;æµ‹è¯•ç±»å’Œè¿è¡Œç»“æœ&quot;">â€‹</a></h5><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">class</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;">App</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">static</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">main</span><span style="color:#F6F6F4;">(</span><span style="color:#97E1F1;font-style:italic;">String</span><span style="color:#F6F6F4;">[] </span><span style="color:#FFB86C;font-style:italic;">args</span><span style="color:#F6F6F4;">) {</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#97E1F1;font-style:italic;">ApplicationContext</span><span style="color:#F6F6F4;"> ctx </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;font-weight:bold;">new</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">AnnotationConfigApplicationContext</span><span style="color:#F6F6F4;">(SpringConfig.class);</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#97E1F1;font-style:italic;">BookDao</span><span style="color:#F6F6F4;"> bookDao </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> ctx.</span><span style="color:#62E884;">getBean</span><span style="color:#F6F6F4;">(BookDao.class);</span></span>
<span class="line"><span style="color:#F6F6F4;">        bookDao.</span><span style="color:#62E884;">update</span><span style="color:#F6F6F4;">();</span></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">App</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">static</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">main</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">String</span><span style="color:#24292E;">[] </span><span style="color:#E36209;">args</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">        ApplicationContext ctx </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">AnnotationConfigApplicationContext</span><span style="color:#24292E;">(SpringConfig.class);</span></span>
<span class="line"><span style="color:#24292E;">        BookDao bookDao </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> ctx.</span><span style="color:#6F42C1;">getBean</span><span style="color:#24292E;">(BookDao.class);</span></span>
<span class="line"><span style="color:#24292E;">        bookDao.</span><span style="color:#6F42C1;">update</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><p><img src="http://www.yangeit.cn:21010/assets/image-20210730151347354-1f84d6f3.png" alt="image-20210730151347354"></p><p>image-20210730151347354</p><h3 id="_1-3-aop-å…¥é—¨æ¡ˆä¾‹-ç»ƒä¹ -âœï¸" tabindex="-1">1.3 AOP å…¥é—¨æ¡ˆä¾‹ ç»ƒä¹  âœï¸ <a class="header-anchor" href="#_1-3-aop-å…¥é—¨æ¡ˆä¾‹-ç»ƒä¹ -âœï¸" aria-label="Permalink to &quot;1.3 AOP å…¥é—¨æ¡ˆä¾‹ ç»ƒä¹  âœï¸&quot;">â€‹</a></h3><h4 id="_1-3-0ã€Œaop-å…¥é—¨æ¡ˆä¾‹-ã€ç›®çš„" tabindex="-1">1.3.0ã€ŒAOP å…¥é—¨æ¡ˆä¾‹ ã€ç›®çš„ <a class="header-anchor" href="#_1-3-0ã€Œaop-å…¥é—¨æ¡ˆä¾‹-ã€ç›®çš„" aria-label="Permalink to &quot;1.3.0ã€ŒAOP å…¥é—¨æ¡ˆä¾‹ ã€ç›®çš„&quot;">â€‹</a></h4><blockquote><p>ç†Ÿæ‚‰æ¥å…¥ç‚¹ã€åˆ‡å…¥ç‚¹ã€åˆ‡é¢æè¿°ã€é€šçŸ¥æ–¹æ³•ã€é€šçŸ¥ç±»çš„å®šä¹‰å’Œä½¿ç”¨</p></blockquote><h4 id="_1-3-1ã€Œaop-å…¥é—¨æ¡ˆä¾‹-ã€éœ€æ±‚-æ•ˆæœ" tabindex="-1">1.3.1ã€ŒAOP å…¥é—¨æ¡ˆä¾‹ ã€éœ€æ±‚&amp;æ•ˆæœ <a class="header-anchor" href="#_1-3-1ã€Œaop-å…¥é—¨æ¡ˆä¾‹-ã€éœ€æ±‚-æ•ˆæœ" aria-label="Permalink to &quot;1.3.1ã€ŒAOP å…¥é—¨æ¡ˆä¾‹ ã€éœ€æ±‚&amp;æ•ˆæœ&quot;">â€‹</a></h4><blockquote><p>æµ‹å®šæ¥å£æ‰§è¡Œæ•ˆç‡</p></blockquote><h4 id="_1-3-2ã€Œaop-å…¥é—¨æ¡ˆä¾‹-ã€æ­¥é„¹" tabindex="-1">1.3.2ã€ŒAOP å…¥é—¨æ¡ˆä¾‹ ã€æ­¥é„¹ <a class="header-anchor" href="#_1-3-2ã€Œaop-å…¥é—¨æ¡ˆä¾‹-ã€æ­¥é„¹" aria-label="Permalink to &quot;1.3.2ã€ŒAOP å…¥é—¨æ¡ˆä¾‹ ã€æ­¥é„¹&quot;">â€‹</a></h4><ul><li>åœ¨é£ç§‹ä¸­ä¸‹è½½ spring_18_aop_quickstarttest å‹ç¼©åŒ…ï¼Œæ”¾åˆ°ä½ çš„å·¥ç¨‹ä¸­</li><li>å¯¼å…¥åˆ°é¡¹ç›®ä¸­</li><li>å®Œæˆé€šçŸ¥ç±»ä¸­çš„ä»£ç </li><li>æ³¨æ„ï¼šå¯¼å·¥ç¨‹åï¼Œä¸€å®šè¦åšçš„ä¸‰ä¸ªæ­¥é„¹ <ol><li>æ£€æŸ¥ Maven ä»“åº“</li><li>æ£€æŸ¥ jdk-1.8</li><li>æ£€æŸ¥ç¼–è¯‘å™¨ç‰ˆæœ¬-1.8</li></ol></li></ul><h3 id="_1-4-aop-å·¥ä½œæµç¨‹-ğŸ" tabindex="-1">1.4 AOP å·¥ä½œæµç¨‹ ğŸ <a class="header-anchor" href="#_1-4-aop-å·¥ä½œæµç¨‹-ğŸ" aria-label="Permalink to &quot;1.4 AOP å·¥ä½œæµç¨‹ ğŸ&quot;">â€‹</a></h3><h3 id="_1-4-1-ã€Œaop-å·¥ä½œæµç¨‹ã€æ ¸å¿ƒé—®é¢˜-ç­”æ¡ˆ" tabindex="-1">1.4.1 ã€ŒAOP å·¥ä½œæµç¨‹ã€æ ¸å¿ƒé—®é¢˜&amp;ç­”æ¡ˆ <a class="header-anchor" href="#_1-4-1-ã€Œaop-å·¥ä½œæµç¨‹ã€æ ¸å¿ƒé—®é¢˜-ç­”æ¡ˆ" aria-label="Permalink to &quot;1.4.1 ã€ŒAOP å·¥ä½œæµç¨‹ã€æ ¸å¿ƒé—®é¢˜&amp;ç­”æ¡ˆ&quot;">â€‹</a></h3><p>é—®é¢˜</p><ol><li>ä»€ä¹ˆæ˜¯ç›®æ ‡å¯¹è±¡ï¼Ÿä»€ä¹ˆæ˜¯ä»£ç†å¯¹è±¡ï¼Ÿ</li></ol><p>ç‚¹å‡»æŸ¥çœ‹</p><ul><li>ï¼šè¢«ä»£ç†çš„å¯¹è±¡ï¼Œä¹Ÿå«åŸå§‹å¯¹è±¡ï¼Œè¯¥å¯¹è±¡ä¸­çš„æ–¹æ³•æ²¡æœ‰ä»»ä½•åŠŸèƒ½å¢å¼ºã€‚</li><li>ï¼šä»£ç†åç”Ÿæˆçš„å¯¹è±¡ï¼Œç”± Spring å¸®æˆ‘ä»¬åˆ›å»ºä»£ç†å¯¹è±¡ã€‚</li></ul><h4 id="_1-4-2-aop-å·¥ä½œæµç¨‹" tabindex="-1">1.4.2 AOP å·¥ä½œæµç¨‹ <a class="header-anchor" href="#_1-4-2-aop-å·¥ä½œæµç¨‹" aria-label="Permalink to &quot;1.4.2 AOP å·¥ä½œæµç¨‹&quot;">â€‹</a></h4><p>ç‚¹å‡»æŸ¥çœ‹ä»£ç </p><ol><li>Spring å®¹å™¨å¯åŠ¨</li><li>è¯»å–æ‰€æœ‰åˆ‡é¢é…ç½®ä¸­çš„åˆ‡å…¥ç‚¹</li><li>åˆå§‹åŒ– beanï¼Œåˆ¤å®š bean å¯¹åº”çš„ç±»ä¸­çš„æ–¹æ³•æ˜¯å¦åŒ¹é…åˆ°ä»»æ„åˆ‡å…¥ç‚¹ <ul><li>åŒ¹é…å¤±è´¥ï¼Œåˆ›å»ºåŸå§‹å¯¹è±¡</li><li>åŒ¹é…æˆåŠŸï¼Œåˆ›å»ºåŸå§‹å¯¹è±¡ï¼ˆç›®æ ‡å¯¹è±¡ï¼‰çš„ä»£ç†å¯¹è±¡</li></ul></li><li>è·å– bean æ‰§è¡Œæ–¹æ³• <ul><li>è·å–çš„ bean æ˜¯åŸå§‹å¯¹è±¡æ—¶ï¼Œè°ƒç”¨æ–¹æ³•å¹¶æ‰§è¡Œï¼Œå®Œæˆæ“ä½œ</li><li>è·å–çš„ bean æ˜¯ä»£ç†å¯¹è±¡æ—¶ï¼Œæ ¹æ®ä»£ç†å¯¹è±¡çš„è¿è¡Œæ¨¡å¼è¿è¡ŒåŸå§‹æ–¹æ³•ä¸å¢å¼ºçš„å†…å®¹ï¼Œå®Œæˆæ“ä½œ</li></ul></li></ol><h4 id="_1-4-3-åœ¨æµ‹è¯•ç±»ä¸­éªŒè¯ä»£ç†å¯¹è±¡" tabindex="-1">1.4.3 åœ¨æµ‹è¯•ç±»ä¸­éªŒè¯ä»£ç†å¯¹è±¡ <a class="header-anchor" href="#_1-4-3-åœ¨æµ‹è¯•ç±»ä¸­éªŒè¯ä»£ç†å¯¹è±¡" aria-label="Permalink to &quot;1.4.3 åœ¨æµ‹è¯•ç±»ä¸­éªŒè¯ä»£ç†å¯¹è±¡&quot;">â€‹</a></h4><p>ç‚¹å‡»æŸ¥çœ‹ä»£ç </p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">class</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;">App</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">static</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">main</span><span style="color:#F6F6F4;">(</span><span style="color:#97E1F1;font-style:italic;">String</span><span style="color:#F6F6F4;">[] </span><span style="color:#FFB86C;font-style:italic;">args</span><span style="color:#F6F6F4;">) {</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#97E1F1;font-style:italic;">ApplicationContext</span><span style="color:#F6F6F4;"> ctx </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;font-weight:bold;">new</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">AnnotationConfigApplicationContext</span><span style="color:#F6F6F4;">(SpringConfig.class);</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#97E1F1;font-style:italic;">BookDao</span><span style="color:#F6F6F4;"> bookDao </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> ctx.</span><span style="color:#62E884;">getBean</span><span style="color:#F6F6F4;">(BookDao.class);</span></span>
<span class="line"><span style="color:#F6F6F4;">        bookDao.</span><span style="color:#62E884;">update</span><span style="color:#F6F6F4;">();</span></span>
<span class="line"><span style="color:#F6F6F4;">		</span><span style="color:#7B7F8B;">//æ‰“å°å¯¹è±¡çš„ç±»å</span></span>
<span class="line"><span style="color:#F6F6F4;">        System.out.</span><span style="color:#62E884;">println</span><span style="color:#F6F6F4;">(bookDao.</span><span style="color:#62E884;">getClass</span><span style="color:#F6F6F4;">());</span></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">App</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">static</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">main</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">String</span><span style="color:#24292E;">[] </span><span style="color:#E36209;">args</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">        ApplicationContext ctx </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">AnnotationConfigApplicationContext</span><span style="color:#24292E;">(SpringConfig.class);</span></span>
<span class="line"><span style="color:#24292E;">        BookDao bookDao </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> ctx.</span><span style="color:#6F42C1;">getBean</span><span style="color:#24292E;">(BookDao.class);</span></span>
<span class="line"><span style="color:#24292E;">        bookDao.</span><span style="color:#6F42C1;">update</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">		</span><span style="color:#6A737D;">//æ‰“å°å¯¹è±¡çš„ç±»å</span></span>
<span class="line"><span style="color:#24292E;">        System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(bookDao.</span><span style="color:#6F42C1;">getClass</span><span style="color:#24292E;">());</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><p><img src="http://www.yangeit.cn:21010/assets/image-20210730152631741-6c63a193.png" alt="image-20210730152631741"></p><p>image-20210730152631741</p><p>æé—®ï¼šæŸ¥çœ‹ä¸‹åˆ—å›¾ç‰‡ï¼ŒåŠ æ·±ä»£ç†å¯¹è±¡å’Œç›®æ ‡å¯¹è±¡çš„ç†è§£</p><p>ç‚¹å‡»æŸ¥çœ‹å›¾ç‰‡</p><p><img src="http://www.yangeit.cn:21010/assets/image-20220513210229992-21e89357.png" alt="image-20220513210229992"></p><p>image-20220513210229992</p><h3 id="_1-5-aop-åˆ‡å…¥ç‚¹è¡¨è¾¾å¼-ğŸ" tabindex="-1">1.5 AOP åˆ‡å…¥ç‚¹è¡¨è¾¾å¼ ğŸ <a class="header-anchor" href="#_1-5-aop-åˆ‡å…¥ç‚¹è¡¨è¾¾å¼-ğŸ" aria-label="Permalink to &quot;1.5 AOP åˆ‡å…¥ç‚¹è¡¨è¾¾å¼ ğŸ&quot;">â€‹</a></h3><h3 id="_1-5-1-ã€Œaop-åˆ‡å…¥ç‚¹è¡¨è¾¾å¼ã€æ ¸å¿ƒé—®é¢˜-ç­”æ¡ˆ" tabindex="-1">1.5.1 ã€ŒAOP åˆ‡å…¥ç‚¹è¡¨è¾¾å¼ã€æ ¸å¿ƒé—®é¢˜&amp;ç­”æ¡ˆ <a class="header-anchor" href="#_1-5-1-ã€Œaop-åˆ‡å…¥ç‚¹è¡¨è¾¾å¼ã€æ ¸å¿ƒé—®é¢˜-ç­”æ¡ˆ" aria-label="Permalink to &quot;1.5.1 ã€ŒAOP åˆ‡å…¥ç‚¹è¡¨è¾¾å¼ã€æ ¸å¿ƒé—®é¢˜&amp;ç­”æ¡ˆ&quot;">â€‹</a></h3><p>é—®é¢˜</p><ol><li>åœ¨åˆ‡å…¥ç‚¹è¡¨è¾¾å¼ä¸­å¦‚ä½•ç®€åŒ–åŒ…åå’Œå‚æ•°ç±»å‹ä¹¦å†™ï¼Ÿ</li></ol><p>ç‚¹å‡»æŸ¥çœ‹ä»£ç </p><ul><li>ä½¿ç”¨é€šé…ç¬¦</li></ul><h4 id="_1-5-2-è¯­æ³•æ ¼å¼" tabindex="-1">1.5.2 è¯­æ³•æ ¼å¼ <a class="header-anchor" href="#_1-5-2-è¯­æ³•æ ¼å¼" aria-label="Permalink to &quot;1.5.2 è¯­æ³•æ ¼å¼&quot;">â€‹</a></h4><ul><li><p>åˆ‡å…¥ç‚¹ï¼šè¦è¿›è¡Œå¢å¼ºçš„æ–¹æ³•</p></li><li><p>åˆ‡å…¥ç‚¹è¡¨è¾¾å¼ï¼šè¦è¿›è¡Œå¢å¼ºçš„æ–¹æ³•çš„æè¿°æ–¹å¼</p></li></ul><p>ç‚¹å‡»æŸ¥çœ‹æè¿°æ–¹å¼</p><ul><li>æè¿°æ–¹å¼ä¸€ï¼šæ‰§è¡Œ com.itheima.dao åŒ…ä¸‹çš„ BookDao æ¥å£ä¸­çš„æ— å‚æ•° update æ–¹æ³•</li></ul><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#62E884;">execution</span><span style="color:#F6F6F4;">(</span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> com.itheima.dao.BookDao.</span><span style="color:#62E884;">update</span><span style="color:#F6F6F4;">())</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">execution</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> com.itheima.dao.BookDao.</span><span style="color:#6F42C1;">update</span><span style="color:#24292E;">())</span></span></code></pre></div><ul><li>æè¿°æ–¹å¼äºŒï¼šæ‰§è¡Œ com.itheima.dao.impl åŒ…ä¸‹çš„ BookDaoImpl ç±»ä¸­çš„æ— å‚æ•° update æ–¹æ³•</li></ul><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#62E884;">execution</span><span style="color:#F6F6F4;">(</span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> com.itheima.dao.impl.BookDaoImpl.</span><span style="color:#62E884;">update</span><span style="color:#F6F6F4;">())</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">execution</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> com.itheima.dao.impl.BookDaoImpl.</span><span style="color:#6F42C1;">update</span><span style="color:#24292E;">())</span></span></code></pre></div><ul><li>åˆ‡å…¥ç‚¹è¡¨è¾¾å¼æ ‡å‡†æ ¼å¼ï¼šåŠ¨ä½œå…³é”®å­—(è®¿é—®ä¿®é¥°ç¬¦ è¿”å›å€¼ åŒ…å.ç±»/æ¥å£å.æ–¹æ³•å(å‚æ•°) å¼‚å¸¸åï¼‰</li></ul><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#62E884;">execution</span><span style="color:#F6F6F4;">(</span><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">User</span><span style="color:#F6F6F4;"> com.itheima.service.UserService.</span><span style="color:#62E884;">findById</span><span style="color:#F6F6F4;">(</span><span style="color:#97E1F1;font-style:italic;">int</span><span style="color:#F6F6F4;">))</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">execution</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> User com.itheima.service.UserService.</span><span style="color:#6F42C1;">findById</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">int</span><span style="color:#24292E;">))</span></span></code></pre></div><ul><li>åŠ¨ä½œå…³é”®å­—ï¼šæè¿°åˆ‡å…¥ç‚¹çš„è¡Œä¸ºåŠ¨ä½œï¼Œä¾‹å¦‚ execution è¡¨ç¤ºæ‰§è¡Œåˆ°æŒ‡å®šåˆ‡å…¥ç‚¹</li><li>è®¿é—®ä¿®é¥°ç¬¦ï¼špublicï¼Œprivate ç­‰ï¼Œå¯ä»¥çœç•¥</li><li>è¿”å›å€¼ï¼šå†™è¿”å›å€¼ç±»å‹</li><li>åŒ…åï¼šå¤šçº§åŒ…ä½¿ç”¨ç‚¹è¿æ¥</li><li>ç±»/æ¥å£åï¼š</li><li>æ–¹æ³•åï¼š</li><li>å‚æ•°ï¼šç›´æ¥å†™å‚æ•°çš„ç±»å‹ï¼Œå¤šä¸ªç±»å‹ç”¨é€—å·éš”å¼€</li><li>å¼‚å¸¸åï¼šæ–¹æ³•å®šä¹‰ä¸­æŠ›å‡ºæŒ‡å®šå¼‚å¸¸ï¼Œå¯ä»¥çœç•¥</li></ul><h4 id="_1-5-3-é€šé…ç¬¦" tabindex="-1">1.5.3 é€šé…ç¬¦ <a class="header-anchor" href="#_1-5-3-é€šé…ç¬¦" aria-label="Permalink to &quot;1.5.3 é€šé…ç¬¦&quot;">â€‹</a></h4><blockquote><p>ç›®çš„ï¼šå¯ä»¥ä½¿ç”¨é€šé…ç¬¦æè¿°åˆ‡å…¥ç‚¹ï¼Œå¿«é€Ÿæè¿°ã€‚</p></blockquote><p>ç‚¹å‡»æŸ¥çœ‹æè¿°æ–¹å¼</p><ul><li>*å•ä¸ªç‹¬ç«‹çš„ä»»æ„ç¬¦å·ï¼Œå¯ä»¥ç‹¬ç«‹å‡ºç°ï¼Œä¹Ÿå¯ä»¥ä½œä¸ºå‰ç¼€æˆ–è€…åç¼€çš„åŒ¹é…ç¬¦å‡ºç°</li></ul><blockquote><p>åŒ¹é… com.itheima åŒ…ä¸‹çš„ä»»æ„åŒ…ä¸­çš„ UserService ç±»æˆ–æ¥å£ä¸­æ‰€æœ‰ find å¼€å¤´çš„å¸¦æœ‰ä¸€ä¸ªå‚æ•°çš„æ–¹æ³•</p></blockquote><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F6F6F4;">executionï¼ˆ</span><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">*</span><span style="color:#F6F6F4;"> com.itheima.</span><span style="color:#F286C4;">*</span><span style="color:#F6F6F4;">.UserService.find</span><span style="color:#F286C4;">*</span><span style="color:#F6F6F4;">(</span><span style="color:#F286C4;">*</span><span style="color:#F6F6F4;">))</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">executionï¼ˆ</span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">*</span><span style="color:#24292E;"> com.itheima.</span><span style="color:#D73A49;">*</span><span style="color:#24292E;">.UserService.find</span><span style="color:#D73A49;">*</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">*</span><span style="color:#24292E;">))</span></span></code></pre></div><ul><li>.. ï¼šå¤šä¸ªè¿ç»­çš„ä»»æ„ç¬¦å·ï¼Œå¯ä»¥ç‹¬ç«‹å‡ºç°ï¼Œå¸¸ç”¨äºç®€åŒ–åŒ…åä¸å‚æ•°çš„ä¹¦å†™</li></ul><blockquote><p>åŒ¹é… com åŒ…ä¸‹çš„ä»»æ„åŒ…ä¸­çš„ UserService ç±»æˆ–æ¥å£ä¸­æ‰€æœ‰åç§°ä¸º findById çš„æ–¹æ³•</p></blockquote><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F6F6F4;">executionï¼ˆ</span><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">User</span><span style="color:#F6F6F4;"> com..UserService.</span><span style="color:#62E884;">findById</span><span style="color:#F6F6F4;">(..))</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">executionï¼ˆ</span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> User com..UserService.</span><span style="color:#6F42C1;">findById</span><span style="color:#24292E;">(..))</span></span></code></pre></div><ul><li>+ï¼šä¸“ç”¨äºåŒ¹é…å­ç±»ç±»å‹</li></ul><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#62E884;">execution</span><span style="color:#F6F6F4;">(</span><span style="color:#F286C4;">*</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">*</span><span style="color:#F6F6F4;">..</span><span style="color:#F286C4;">*</span><span style="color:#F6F6F4;">Service</span><span style="color:#F286C4;">+</span><span style="color:#F6F6F4;">.</span><span style="color:#F286C4;">*</span><span style="color:#F6F6F4;">(..))</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">execution</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">*</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">*</span><span style="color:#24292E;">..</span><span style="color:#D73A49;">*</span><span style="color:#24292E;">Service</span><span style="color:#D73A49;">+</span><span style="color:#24292E;">.</span><span style="color:#D73A49;">*</span><span style="color:#24292E;">(..))</span></span></code></pre></div><h4 id="_1-5-4-ä¹¦å†™æŠ€å·§" tabindex="-1">1.5.4 ä¹¦å†™æŠ€å·§ <a class="header-anchor" href="#_1-5-4-ä¹¦å†™æŠ€å·§" aria-label="Permalink to &quot;1.5.4 ä¹¦å†™æŠ€å·§&quot;">â€‹</a></h4><p>ç‚¹å‡»æŸ¥çœ‹ä¹¦å†™æŠ€å·§</p><p><img src="http://www.yangeit.cn:21010/assets/image-20220415225440393-b23e3e7f.png" alt=""></p><p><strong>ä¸è¦æ­»è®°ï¼Œä¸è¦æ­»è®°ï¼Œæ…¢æ…¢ä½“ä¼šï¼Œæ…¢æ…¢ä½“ä¼š</strong></p><ul><li><p>æŠ€å·§è¯´æ˜ï¼š</p></li><li><p>ä»æ–¹æ³•åˆ°è¿”å›å€¼ <img src="http://www.yangeit.cn:21010/assets/image-20220416113412950-14df490e.png" alt="image-20220416113412950"></p></li><li><p>ä»¥ååœ¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œå‘½åä¸€å®šè¦è§„èŒƒï¼Œæ–¹ä¾¿å†™åˆ‡å…¥ç‚¹è¡¨è¾¾å¼å­</p><ol><li>å¦‚æŸ¥è¯¢ï¼šä»¥ find å¼€å¤´æˆ–è€… query å¼€å¤´ ï¼Œå¦‚ queryxxx()</li><li>å¦‚è·å¾—å•ä¸ªï¼Œgetxxx</li><li>å¦‚ä¿å­˜ï¼šsaveXXX</li><li>å¦‚æ›´æ–°ï¼šupdateXXX</li><li>å¦‚åˆ é™¤ï¼šdeleteXXX</li></ol></li></ul><p>æé—®ï¼šæŸ¥çœ‹ä¸‹åˆ—å›¾ç‰‡ï¼Œå›ç­”é—®é¢˜</p><p>ç‚¹å‡»æŸ¥çœ‹å›¾ç‰‡</p><p><img src="http://www.yangeit.cn:21010/assets/image-20220415230440122-1c3e129a.png" alt="image-20220415230440122"></p><p>image-20220415230440122</p><h3 id="_1-6-aop-é€šçŸ¥ç±»å‹" tabindex="-1">1.6 AOP é€šçŸ¥ç±»å‹ <a class="header-anchor" href="#_1-6-aop-é€šçŸ¥ç±»å‹" aria-label="Permalink to &quot;1.6 AOP é€šçŸ¥ç±»å‹&quot;">â€‹</a></h3><h4 id="_1-6-1-ã€Œé€šçŸ¥ç±»å‹ã€æ ¸å¿ƒé—®é¢˜-ç­”æ¡ˆ" tabindex="-1">1.6.1 ã€Œé€šçŸ¥ç±»å‹ã€æ ¸å¿ƒé—®é¢˜&amp;ç­”æ¡ˆ <a class="header-anchor" href="#_1-6-1-ã€Œé€šçŸ¥ç±»å‹ã€æ ¸å¿ƒé—®é¢˜-ç­”æ¡ˆ" aria-label="Permalink to &quot;1.6.1 ã€Œé€šçŸ¥ç±»å‹ã€æ ¸å¿ƒé—®é¢˜&amp;ç­”æ¡ˆ&quot;">â€‹</a></h4><p>é—®é¢˜</p><ol><li>é€šçŸ¥ç±»å‹ä¸­å“ªç§é€šçŸ¥æœ€é‡è¦,èƒ½å®ç°å…¶ä»–ç±»å‹çš„é€šçŸ¥</li></ol><p>ç‚¹å‡»æŸ¥çœ‹</p><ul><li><strong>ç¯ç»•é€šçŸ¥(é‡ç‚¹)ï¼š</strong> æ‰‹åŠ¨è°ƒç”¨åˆ‡å…¥ç‚¹æ–¹æ³•å¹¶å¯¹å…¶è¿›è¡Œå¢å¼ºçš„é€šçŸ¥æ–¹å¼ã€‚</li></ul><h4 id="_1-6-2-aop-é€šçŸ¥åˆ†ç±»" tabindex="-1">1.6.2 AOP é€šçŸ¥åˆ†ç±» <a class="header-anchor" href="#_1-6-2-aop-é€šçŸ¥åˆ†ç±»" aria-label="Permalink to &quot;1.6.2 AOP é€šçŸ¥åˆ†ç±»&quot;">â€‹</a></h4><p>ç‚¹å‡»æŸ¥çœ‹é€šçŸ¥åˆ†ç±»</p><ul><li>AOP é€šçŸ¥æè¿°äº†æŠ½å–çš„å…±æ€§åŠŸèƒ½ï¼Œæ ¹æ®å…±æ€§åŠŸèƒ½æŠ½å–çš„ä½ç½®ä¸åŒï¼Œæœ€ç»ˆè¿è¡Œä»£ç æ—¶è¦å°†å…¶åŠ å…¥åˆ°åˆç†çš„ä½ç½®</li><li>AOP é€šçŸ¥å…±åˆ†ä¸º 5 ç§ç±»å‹ <ul><li>å‰ç½®é€šçŸ¥ï¼šåœ¨åˆ‡å…¥ç‚¹æ–¹æ³•æ‰§è¡Œä¹‹å‰æ‰§è¡Œ</li><li>åç½®é€šçŸ¥ï¼šåœ¨åˆ‡å…¥ç‚¹æ–¹æ³•æ‰§è¡Œä¹‹åæ‰§è¡Œï¼Œæ— è®ºåˆ‡å…¥ç‚¹æ–¹æ³•å†…éƒ¨æ˜¯å¦å‡ºç°å¼‚å¸¸ï¼Œåç½®é€šçŸ¥éƒ½ä¼šæ‰§è¡Œã€‚</li><li>**ç¯ç»•é€šçŸ¥(é‡ç‚¹)ï¼š**æ‰‹åŠ¨è°ƒç”¨åˆ‡å…¥ç‚¹æ–¹æ³•å¹¶å¯¹å…¶è¿›è¡Œå¢å¼ºçš„é€šçŸ¥æ–¹å¼ã€‚ ğŸ‘ˆ</li><li>è¿”å›åé€šçŸ¥(äº†è§£)ï¼šåœ¨åˆ‡å…¥ç‚¹æ–¹æ³•æ‰§è¡Œä¹‹åæ‰§è¡Œï¼Œå¦‚æœåˆ‡å…¥ç‚¹æ–¹æ³•å†…éƒ¨å‡ºç°å¼‚å¸¸å°†ä¸ä¼šæ‰§è¡Œã€‚</li><li>æŠ›å‡ºå¼‚å¸¸åé€šçŸ¥(äº†è§£)ï¼šåœ¨åˆ‡å…¥ç‚¹æ–¹æ³•æ‰§è¡Œä¹‹åæ‰§è¡Œï¼Œåªæœ‰å½“åˆ‡å…¥ç‚¹æ–¹æ³•å†…éƒ¨å‡ºç°å¼‚å¸¸ä¹‹åæ‰æ‰§è¡Œã€‚</li></ul></li></ul><h4 id="_1-6-3-aop-é€šçŸ¥è¯¦è§£" tabindex="-1">1.6.3 AOP é€šçŸ¥è¯¦è§£ <a class="header-anchor" href="#_1-6-3-aop-é€šçŸ¥è¯¦è§£" aria-label="Permalink to &quot;1.6.3 AOP é€šçŸ¥è¯¦è§£&quot;">â€‹</a></h4><h5 id="_1ï¸âƒ£-å‰ç½®é€šçŸ¥-ğŸš€" tabindex="-1">1ï¸âƒ£ å‰ç½®é€šçŸ¥ ğŸš€ <a class="header-anchor" href="#_1ï¸âƒ£-å‰ç½®é€šçŸ¥-ğŸš€" aria-label="Permalink to &quot;1ï¸âƒ£ å‰ç½®é€šçŸ¥ ğŸš€&quot;">â€‹</a></h5><ul><li>åç§°ï¼š@Before ï¼ˆäº†è§£ï¼‰</li><li>ç±»å‹ï¼š<strong>æ–¹æ³•æ³¨è§£</strong></li><li>ä½ç½®ï¼šé€šçŸ¥æ–¹æ³•å®šä¹‰ä¸Šæ–¹</li><li>ä½œç”¨ï¼šè®¾ç½®å½“å‰é€šçŸ¥æ–¹æ³•ä¸åˆ‡å…¥ç‚¹ä¹‹é—´çš„ç»‘å®šå…³ç³»ï¼Œå½“å‰é€šçŸ¥æ–¹æ³•åœ¨åŸå§‹åˆ‡å…¥ç‚¹æ–¹æ³•å‰è¿è¡Œ</li><li>èŒƒä¾‹ï¼š</li></ul><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Before</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">pt()</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">)</span></span>
<span class="line"><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">before</span><span style="color:#F6F6F4;">() {</span></span>
<span class="line"><span style="color:#F6F6F4;">    System.out.</span><span style="color:#62E884;">println</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">before advice ...</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">);</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Before</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;pt()&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">before</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">    System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;before advice ...&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h5 id="_2ï¸âƒ£-åç½®é€šçŸ¥-ğŸš€" tabindex="-1">2ï¸âƒ£ åç½®é€šçŸ¥ ğŸš€ <a class="header-anchor" href="#_2ï¸âƒ£-åç½®é€šçŸ¥-ğŸš€" aria-label="Permalink to &quot;2ï¸âƒ£ åç½®é€šçŸ¥ ğŸš€&quot;">â€‹</a></h5><ul><li>åç§°ï¼š@After ï¼ˆäº†è§£ï¼‰</li><li>ç±»å‹ï¼šæ–¹æ³•æ³¨è§£</li><li>ä½ç½®ï¼šé€šçŸ¥æ–¹æ³•å®šä¹‰ä¸Šæ–¹</li><li>ä½œç”¨ï¼šè®¾ç½®å½“å‰é€šçŸ¥æ–¹æ³•ä¸åˆ‡å…¥ç‚¹ä¹‹é—´çš„ç»‘å®šå…³ç³»ï¼Œå½“å‰é€šçŸ¥æ–¹æ³•åœ¨åŸå§‹åˆ‡å…¥ç‚¹æ–¹æ³•åè¿è¡Œ</li><li>èŒƒä¾‹ï¼š</li></ul><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">After</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">pt()</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">)</span></span>
<span class="line"><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">after</span><span style="color:#F6F6F4;">() {</span></span>
<span class="line"><span style="color:#F6F6F4;">    System.out.</span><span style="color:#62E884;">println</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">after advice ...</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">);</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">After</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;pt()&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">after</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">    System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;after advice ...&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h5 id="_3ï¸âƒ£-è¿”å›åé€šçŸ¥-ğŸš€" tabindex="-1">3ï¸âƒ£ è¿”å›åé€šçŸ¥ ğŸš€ <a class="header-anchor" href="#_3ï¸âƒ£-è¿”å›åé€šçŸ¥-ğŸš€" aria-label="Permalink to &quot;3ï¸âƒ£ è¿”å›åé€šçŸ¥ ğŸš€&quot;">â€‹</a></h5><ul><li>åç§°ï¼š@AfterReturningï¼ˆäº†è§£ï¼‰</li><li>ç±»å‹ï¼š<strong>æ–¹æ³•æ³¨è§£</strong></li><li>ä½ç½®ï¼šé€šçŸ¥æ–¹æ³•å®šä¹‰ä¸Šæ–¹</li><li>ä½œç”¨ï¼šè®¾ç½®å½“å‰é€šçŸ¥æ–¹æ³•ä¸åˆ‡å…¥ç‚¹ä¹‹é—´çš„ç»‘å®šå…³ç³»ï¼Œå½“å‰é€šçŸ¥æ–¹æ³•åœ¨åŸå§‹åˆ‡å…¥ç‚¹æ–¹æ³•æ­£å¸¸æ‰§è¡Œå®Œæ¯•åè¿è¡Œ</li><li>èŒƒä¾‹ï¼š</li></ul><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">AfterReturning</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">pt()</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">)</span></span>
<span class="line"><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">afterReturning</span><span style="color:#F6F6F4;">() {</span></span>
<span class="line"><span style="color:#F6F6F4;">    System.out.</span><span style="color:#62E884;">println</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">afterReturning advice ...</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">);</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">AfterReturning</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;pt()&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">afterReturning</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">    System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;afterReturning advice ...&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h5 id="_4ï¸âƒ£-æŠ›å‡ºå¼‚å¸¸åé€šçŸ¥-ğŸš€" tabindex="-1">4ï¸âƒ£ æŠ›å‡ºå¼‚å¸¸åé€šçŸ¥ ğŸš€ <a class="header-anchor" href="#_4ï¸âƒ£-æŠ›å‡ºå¼‚å¸¸åé€šçŸ¥-ğŸš€" aria-label="Permalink to &quot;4ï¸âƒ£ æŠ›å‡ºå¼‚å¸¸åé€šçŸ¥ ğŸš€&quot;">â€‹</a></h5><ul><li>åç§°ï¼š@AfterThrowingï¼ˆäº†è§£ï¼‰</li><li>ç±»å‹ï¼š<strong>æ–¹æ³•æ³¨è§£</strong></li><li>ä½ç½®ï¼šé€šçŸ¥æ–¹æ³•å®šä¹‰ä¸Šæ–¹</li><li>ä½œç”¨ï¼šè®¾ç½®å½“å‰é€šçŸ¥æ–¹æ³•ä¸åˆ‡å…¥ç‚¹ä¹‹é—´çš„ç»‘å®šå…³ç³»ï¼Œå½“å‰é€šçŸ¥æ–¹æ³•åœ¨åŸå§‹åˆ‡å…¥ç‚¹æ–¹æ³•è¿è¡ŒæŠ›å‡ºå¼‚å¸¸åæ‰§è¡Œ</li><li>èŒƒä¾‹ï¼š</li></ul><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">AfterThrowing</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">pt()</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">)</span></span>
<span class="line"><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">afterThrowing</span><span style="color:#F6F6F4;">() {</span></span>
<span class="line"><span style="color:#F6F6F4;">    System.out.</span><span style="color:#62E884;">println</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">afterThrowing advice ...</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">);</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">AfterThrowing</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;pt()&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">afterThrowing</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">    System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;afterThrowing advice ...&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h5 id="_5ï¸âƒ£-ç¯ç»•é€šçŸ¥ã€é‡ç‚¹ã€‘-â¤ï¸-ğŸ‘ˆ" tabindex="-1">5ï¸âƒ£ ç¯ç»•é€šçŸ¥ã€é‡ç‚¹ã€‘ â¤ï¸ ğŸ‘ˆ <a class="header-anchor" href="#_5ï¸âƒ£-ç¯ç»•é€šçŸ¥ã€é‡ç‚¹ã€‘-â¤ï¸-ğŸ‘ˆ" aria-label="Permalink to &quot;5ï¸âƒ£ ç¯ç»•é€šçŸ¥ã€é‡ç‚¹ã€‘ â¤ï¸ ğŸ‘ˆ&quot;">â€‹</a></h5><ul><li>åç§°ï¼š@Aroundï¼ˆé‡ç‚¹ï¼Œå¸¸ç”¨ï¼‰</li><li>ç±»å‹ï¼š<strong>æ–¹æ³•æ³¨è§£</strong></li><li>ä½ç½®ï¼šé€šçŸ¥æ–¹æ³•å®šä¹‰ä¸Šæ–¹</li><li>ä½œç”¨ï¼šè®¾ç½®å½“å‰é€šçŸ¥æ–¹æ³•ä¸åˆ‡å…¥ç‚¹ä¹‹é—´çš„ç»‘å®šå…³ç³»ï¼Œå½“å‰é€šçŸ¥æ–¹æ³•åœ¨åŸå§‹åˆ‡å…¥ç‚¹æ–¹æ³•å‰åè¿è¡Œ</li><li>èŒƒä¾‹ï¼šï¼š</li></ul><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Around</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">pt()</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">)</span></span>
<span class="line"><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">Object</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">around</span><span style="color:#F6F6F4;">(</span><span style="color:#97E1F1;font-style:italic;">ProceedingJoinPoint</span><span style="color:#F6F6F4;"> pjp) throws Throwable {</span></span>
<span class="line"><span style="color:#F6F6F4;">    System.out.</span><span style="color:#62E884;">println</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">around before advice ...</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">);</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#97E1F1;font-style:italic;">Object</span><span style="color:#F6F6F4;"> ret </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> pjp.</span><span style="color:#62E884;">proceed</span><span style="color:#F6F6F4;">();</span></span>
<span class="line"><span style="color:#F6F6F4;">    System.out.</span><span style="color:#62E884;">println</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">around after advice ...</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">);</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">return</span><span style="color:#F6F6F4;"> ret;</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Around</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;pt()&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> Object </span><span style="color:#6F42C1;">around</span><span style="color:#24292E;">(ProceedingJoinPoint pjp) throws Throwable {</span></span>
<span class="line"><span style="color:#24292E;">    System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;around before advice ...&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    Object ret </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> pjp.</span><span style="color:#6F42C1;">proceed</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">    System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;around after advice ...&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> ret;</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><p><strong>ç¯ç»•é€šçŸ¥æ³¨æ„äº‹é¡¹</strong></p><ol><li>ç¯ç»•é€šçŸ¥æ–¹æ³•å½¢å‚å¿…é¡»æ˜¯ ProceedingJoinPointï¼Œè¡¨ç¤ºæ­£åœ¨æ‰§è¡Œçš„è¿æ¥ç‚¹ï¼Œä½¿ç”¨è¯¥å¯¹è±¡çš„ proceed()æ–¹æ³•è¡¨ç¤ºå¯¹åŸå§‹å¯¹è±¡æ–¹æ³•è¿›è¡Œè°ƒç”¨ï¼Œè¿”å›å€¼ä¸ºåŸå§‹å¯¹è±¡æ–¹æ³•çš„è¿”å›å€¼ã€‚ ğŸ‘ˆ</li><li>ç¯ç»•é€šçŸ¥æ–¹æ³•çš„è¿”å›å€¼å»ºè®®å†™æˆ Object ç±»å‹ï¼Œç”¨äºå°†åŸå§‹å¯¹è±¡æ–¹æ³•çš„è¿”å›å€¼è¿›è¡Œè¿”å›ï¼Œå“ªé‡Œä½¿ç”¨ä»£ç†å¯¹è±¡å°±è¿”å›åˆ°å“ªé‡Œã€‚</li></ol><h2 id="_2-aop-æ¡ˆä¾‹" tabindex="-1">2. AOP æ¡ˆä¾‹ <a class="header-anchor" href="#_2-aop-æ¡ˆä¾‹" aria-label="Permalink to &quot;2\\. AOP æ¡ˆä¾‹&quot;">â€‹</a></h2><h3 id="_2-1-æ¡ˆä¾‹-æµ‹é‡ä¸šåŠ¡å±‚æ¥å£ä¸‡æ¬¡æ‰§è¡Œæ•ˆç‡" tabindex="-1">2.1 æ¡ˆä¾‹-æµ‹é‡ä¸šåŠ¡å±‚æ¥å£ä¸‡æ¬¡æ‰§è¡Œæ•ˆç‡ <a class="header-anchor" href="#_2-1-æ¡ˆä¾‹-æµ‹é‡ä¸šåŠ¡å±‚æ¥å£ä¸‡æ¬¡æ‰§è¡Œæ•ˆç‡" aria-label="Permalink to &quot;2.1 æ¡ˆä¾‹-æµ‹é‡ä¸šåŠ¡å±‚æ¥å£ä¸‡æ¬¡æ‰§è¡Œæ•ˆç‡&quot;">â€‹</a></h3><h4 id="_2-1-1-éœ€æ±‚å’Œåˆ†æ" tabindex="-1">2.1.1 éœ€æ±‚å’Œåˆ†æ <a class="header-anchor" href="#_2-1-1-éœ€æ±‚å’Œåˆ†æ" aria-label="Permalink to &quot;2.1.1 éœ€æ±‚å’Œåˆ†æ&quot;">â€‹</a></h4><p>æç¤º</p><ul><li><p>éœ€æ±‚ï¼šä»»æ„ä¸šåŠ¡å±‚æ¥å£æ‰§è¡Œå‡å¯æ˜¾ç¤ºå…¶æ‰§è¡Œæ•ˆç‡ï¼ˆæ‰§è¡Œæ—¶é•¿ï¼‰</p></li><li><p>åˆ†æï¼š</p><p>1ï¸âƒ£ ä¸šåŠ¡åŠŸèƒ½ï¼šä¸šåŠ¡å±‚æ¥å£æ‰§è¡Œå‰ååˆ†åˆ«è®°å½•æ—¶é—´ï¼Œæ±‚å·®å€¼å¾—åˆ°æ‰§è¡Œæ•ˆç‡ ğŸ‘ˆ</p><p>2ï¸âƒ£ é€šçŸ¥ç±»å‹é€‰æ‹©å‰åå‡å¯ä»¥å¢å¼ºçš„ç±»å‹â€”â€”ç¯ç»•é€šçŸ¥ ğŸ‘ˆ</p></li></ul><p><a href="https://mermaid-js.github.io/mermaid-live-editor/edit#pako:eNqrVkrOT0lVslJKL0osyFAIcYnJUwACx-Tk_NK8kuDUorLM5FRdXTuF4sQyEO2YX2D1smHW8_lLgZxnnQ1PN857Nrn3yd452s837o5_Nm3ns81T45_saH-2ZuGzzuUvFvY8m77t5fQt2ExVABmbkpqTWkILg9My81Icc3J0aWS0U6VnCmVGx-Qp6SjlphblJmamAMO_GiymVJKRmpsao2QFZKYkFmXHKMXk1QLVJZaW5AdX5iUrWZUUlabqKJUWpCSWpLpkJgKjLVfJKi0xpxgoWpCYF5WfnwtRVAsAQ2zfFQ" target="_blank" rel="noreferrer"><img src="https://mermaid.ink/img/pako:eNqrVkrOT0lVslJKL0osyFAIcYnJUwACx-Tk_NK8kuDUorLM5FRdXTuF4sQyEO2YX2D1smHW8_lLgZxnnQ1PN857Nrn3yd452s837o5_Nm3ns81T45_saH-2ZuGzzuUvFvY8m77t5fQt2ExVABmbkpqTWkILg9My81Icc3J0aWS0U6VnCmVGx-Qp6SjlphblJmamAMO_GiymVJKRmpsao2QFZKYkFmXHKMXk1QLVJZaW5AdX5iUrWZUUlabqKJUWpCSWpLpkJgKjLVfJKi0xpxgoWpCYF5WfnwtRVAsAQ2zfFQ?type=png" alt="">open in new window</a></p><h4 id="_2-1-2-ä»£ç å®ç°" tabindex="-1">2.1.2 ä»£ç å®ç° <a class="header-anchor" href="#_2-1-2-ä»£ç å®ç°" aria-label="Permalink to &quot;2.1.2 ä»£ç å®ç°&quot;">â€‹</a></h4><p>ç›¸å…³ä¿¡æ¯</p><h5 id="ã€å‰ç½®å·¥ä½œã€‘ç¯å¢ƒå‡†å¤‡" tabindex="-1">ã€å‰ç½®å·¥ä½œã€‘ç¯å¢ƒå‡†å¤‡ <a class="header-anchor" href="#ã€å‰ç½®å·¥ä½œã€‘ç¯å¢ƒå‡†å¤‡" aria-label="Permalink to &quot;ã€å‰ç½®å·¥ä½œã€‘ç¯å¢ƒå‡†å¤‡&quot;">â€‹</a></h5><h5 id="ã€ç¬¬ä¸€æ­¥ã€‘ç¼–å†™é€šçŸ¥ç±»" tabindex="-1">ã€ç¬¬ä¸€æ­¥ã€‘ç¼–å†™é€šçŸ¥ç±» <a class="header-anchor" href="#ã€ç¬¬ä¸€æ­¥ã€‘ç¼–å†™é€šçŸ¥ç±»" aria-label="Permalink to &quot;ã€ç¬¬ä¸€æ­¥ã€‘ç¼–å†™é€šçŸ¥ç±»&quot;">â€‹</a></h5><h5 id="ã€ç¬¬äºŒæ­¥ã€‘åœ¨-springconfig-é…ç½®ç±»ä¸Šå¼€å¯-aop-æ³¨è§£åŠŸèƒ½" tabindex="-1">ã€ç¬¬äºŒæ­¥ã€‘åœ¨ SpringConfig é…ç½®ç±»ä¸Šå¼€å¯ AOP æ³¨è§£åŠŸèƒ½ <a class="header-anchor" href="#ã€ç¬¬äºŒæ­¥ã€‘åœ¨-springconfig-é…ç½®ç±»ä¸Šå¼€å¯-aop-æ³¨è§£åŠŸèƒ½" aria-label="Permalink to &quot;ã€ç¬¬äºŒæ­¥ã€‘åœ¨ SpringConfig é…ç½®ç±»ä¸Šå¼€å¯ AOP æ³¨è§£åŠŸèƒ½&quot;">â€‹</a></h5><h5 id="ã€ç¬¬ä¸‰æ­¥ã€‘è¿è¡Œæµ‹è¯•ç±»-æŸ¥çœ‹ç»“æœ" tabindex="-1">ã€ç¬¬ä¸‰æ­¥ã€‘è¿è¡Œæµ‹è¯•ç±»ï¼ŒæŸ¥çœ‹ç»“æœ <a class="header-anchor" href="#ã€ç¬¬ä¸‰æ­¥ã€‘è¿è¡Œæµ‹è¯•ç±»-æŸ¥çœ‹ç»“æœ" aria-label="Permalink to &quot;ã€ç¬¬ä¸‰æ­¥ã€‘è¿è¡Œæµ‹è¯•ç±»ï¼ŒæŸ¥çœ‹ç»“æœ&quot;">â€‹</a></h5><h5 id="ã€å‰ç½®å·¥ä½œã€‘ç¯å¢ƒå‡†å¤‡-1" tabindex="-1">ã€å‰ç½®å·¥ä½œã€‘ç¯å¢ƒå‡†å¤‡ <a class="header-anchor" href="#ã€å‰ç½®å·¥ä½œã€‘ç¯å¢ƒå‡†å¤‡-1" aria-label="Permalink to &quot;ã€å‰ç½®å·¥ä½œã€‘ç¯å¢ƒå‡†å¤‡&quot;">â€‹</a></h5><ol><li>Spring æ•´åˆ mybatis å¯¹ spring_db æ•°æ®åº“ä¸­çš„ Account è¿›è¡Œ CRUD æ“ä½œ</li><li>Spring æ•´åˆ Junit æµ‹è¯• CRUD æ˜¯å¦ OKã€‚</li></ol><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">RunWith</span><span style="color:#F6F6F4;">(SpringJUnit4ClassRunner.class)</span></span>
<span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">ContextConfiguration</span><span style="color:#F6F6F4;">(</span><span style="color:#BF9EEE;">classes</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> SpringConfig.class)</span></span>
<span class="line"><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">class</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;">AccountServiceTestCase</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Autowired</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">private</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">AccountService</span><span style="color:#F6F6F4;"> accountService;</span></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Test</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">testFindById</span><span style="color:#F6F6F4;">(){</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#97E1F1;font-style:italic;">Account</span><span style="color:#F6F6F4;"> ac </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> accountService.</span><span style="color:#62E884;">findById</span><span style="color:#F6F6F4;">(</span><span style="color:#BF9EEE;">2</span><span style="color:#F6F6F4;">);</span></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Test</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">testFindAll</span><span style="color:#F6F6F4;">(){</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#97E1F1;font-style:italic;">List</span><span style="color:#F6F6F4;">&lt;Account&gt; all </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> accountService.</span><span style="color:#62E884;">findAll</span><span style="color:#F6F6F4;">();</span></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">RunWith</span><span style="color:#24292E;">(SpringJUnit4ClassRunner.class)</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">ContextConfiguration</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">classes</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> SpringConfig.class)</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">AccountServiceTestCase</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Autowired</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> AccountService accountService;</span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Test</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">testFindById</span><span style="color:#24292E;">(){</span></span>
<span class="line"><span style="color:#24292E;">        Account ac </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> accountService.</span><span style="color:#6F42C1;">findById</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">2</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Test</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">testFindAll</span><span style="color:#24292E;">(){</span></span>
<span class="line"><span style="color:#24292E;">        List&lt;</span><span style="color:#D73A49;">Account</span><span style="color:#24292E;">&gt; all </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> accountService.</span><span style="color:#6F42C1;">findAll</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><ol start="3"><li>åœ¨ pom.xml ä¸­æ·»åŠ  aspectjweaver åˆ‡å…¥ç‚¹è¡¨è¾¾å¼ä¾èµ–ã€ä¸å¯é‡å¤å¯¼å…¥ã€‘</li></ol><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#7B7F8B;">&lt;!--åˆ‡å…¥ç‚¹è¡¨è¾¾å¼ä¾èµ–ï¼Œç›®çš„æ˜¯æ‰¾åˆ°åˆ‡å…¥ç‚¹æ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯æ‰¾åˆ°è¦å¢å¼ºçš„æ–¹æ³•--&gt;</span></span>
<span class="line"><span style="color:#F6F6F4;">&lt;</span><span style="color:#F286C4;">dependency</span><span style="color:#F6F6F4;">&gt;</span></span>
<span class="line"><span style="color:#F6F6F4;">    &lt;</span><span style="color:#F286C4;">groupId</span><span style="color:#F6F6F4;">&gt;org.aspectj&lt;/</span><span style="color:#F286C4;">groupId</span><span style="color:#F6F6F4;">&gt;</span></span>
<span class="line"><span style="color:#F6F6F4;">    &lt;</span><span style="color:#F286C4;">artifactId</span><span style="color:#F6F6F4;">&gt;aspectjweaver&lt;/</span><span style="color:#F286C4;">artifactId</span><span style="color:#F6F6F4;">&gt;</span></span>
<span class="line"><span style="color:#F6F6F4;">    &lt;</span><span style="color:#F286C4;">version</span><span style="color:#F6F6F4;">&gt;1.9.4&lt;/</span><span style="color:#F286C4;">version</span><span style="color:#F6F6F4;">&gt;</span></span>
<span class="line"><span style="color:#F6F6F4;">&lt;/</span><span style="color:#F286C4;">dependency</span><span style="color:#F6F6F4;">&gt;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">&lt;!--åˆ‡å…¥ç‚¹è¡¨è¾¾å¼ä¾èµ–ï¼Œç›®çš„æ˜¯æ‰¾åˆ°åˆ‡å…¥ç‚¹æ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯æ‰¾åˆ°è¦å¢å¼ºçš„æ–¹æ³•--&gt;</span></span>
<span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#22863A;">dependency</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">    &lt;</span><span style="color:#22863A;">groupId</span><span style="color:#24292E;">&gt;org.aspectj&lt;/</span><span style="color:#22863A;">groupId</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">    &lt;</span><span style="color:#22863A;">artifactId</span><span style="color:#24292E;">&gt;aspectjweaver&lt;/</span><span style="color:#22863A;">artifactId</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">    &lt;</span><span style="color:#22863A;">version</span><span style="color:#24292E;">&gt;1.9.4&lt;/</span><span style="color:#22863A;">version</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">&lt;/</span><span style="color:#22863A;">dependency</span><span style="color:#24292E;">&gt;</span></span></code></pre></div><h5 id="ã€ç¬¬ä¸€æ­¥ã€‘ç¼–å†™é€šçŸ¥ç±»-1" tabindex="-1">ã€ç¬¬ä¸€æ­¥ã€‘ç¼–å†™é€šçŸ¥ç±» <a class="header-anchor" href="#ã€ç¬¬ä¸€æ­¥ã€‘ç¼–å†™é€šçŸ¥ç±»-1" aria-label="Permalink to &quot;ã€ç¬¬ä¸€æ­¥ã€‘ç¼–å†™é€šçŸ¥ç±»&quot;">â€‹</a></h5><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#7B7F8B;">//é€šçŸ¥ç±»å¿…é¡»é…ç½®æˆSpringç®¡ç†çš„bean</span></span>
<span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Component</span></span>
<span class="line"><span style="color:#7B7F8B;">//è®¾ç½®å½“å‰ç±»ä¸ºåˆ‡é¢ç±»ç±»</span></span>
<span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Aspect</span></span>
<span class="line"><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">class</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;">ProjectAdvice</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#7B7F8B;">//åŒ¹é…ä¸šåŠ¡å±‚çš„æ‰€æœ‰æ–¹æ³•</span></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Pointcut</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">execution(* com.itheima.service.*Service.*(..))</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">)</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">private</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">servicePt</span><span style="color:#F6F6F4;">(){}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#7B7F8B;">//è®¾ç½®ç¯ç»•é€šçŸ¥ï¼Œåœ¨åŸå§‹æ“ä½œçš„è¿è¡Œå‰åè®°å½•æ‰§è¡Œæ—¶é—´</span></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Around</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">ProjectAdvice.servicePt()</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">) </span><span style="color:#7B7F8B;">//æœ¬ç±»ç±»åå¯ä»¥çœç•¥ä¸å†™</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">runSpeed</span><span style="color:#F6F6F4;">(</span><span style="color:#97E1F1;font-style:italic;">ProceedingJoinPoint</span><span style="color:#F6F6F4;"> </span><span style="color:#FFB86C;font-style:italic;">pjp</span><span style="color:#F6F6F4;">) </span><span style="color:#F286C4;">throws</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">Throwable</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#7B7F8B;">//è·å–æ‰§è¡Œçš„ç­¾åå¯¹è±¡</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#97E1F1;font-style:italic;">Signature</span><span style="color:#F6F6F4;"> signature </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> pjp.</span><span style="color:#62E884;">getSignature</span><span style="color:#F6F6F4;">();</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#7B7F8B;">//è·å–æ¥å£/ç±»å…¨é™å®šå</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#97E1F1;font-style:italic;">String</span><span style="color:#F6F6F4;"> className </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> signature.</span><span style="color:#62E884;">getDeclaringTypeName</span><span style="color:#F6F6F4;">();</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#7B7F8B;">//è·å–æ–¹æ³•å</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#97E1F1;font-style:italic;">String</span><span style="color:#F6F6F4;"> methodName </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> signature.</span><span style="color:#62E884;">getName</span><span style="color:#F6F6F4;">();</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#7B7F8B;">//è®°å½•å¼€å§‹æ—¶é—´</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#97E1F1;font-style:italic;">long</span><span style="color:#F6F6F4;"> start </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> System.</span><span style="color:#62E884;">currentTimeMillis</span><span style="color:#F6F6F4;">();</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#7B7F8B;">//æ‰§è¡Œä¸‡æ¬¡æ“ä½œ</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#F286C4;">for</span><span style="color:#F6F6F4;"> (</span><span style="color:#97E1F1;font-style:italic;">int</span><span style="color:#F6F6F4;"> i </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">0</span><span style="color:#F6F6F4;">; i </span><span style="color:#F286C4;">&lt;</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">10000</span><span style="color:#F6F6F4;">; i</span><span style="color:#F286C4;">++</span><span style="color:#F6F6F4;">) {</span></span>
<span class="line"><span style="color:#F6F6F4;">           pjp.</span><span style="color:#62E884;">proceed</span><span style="color:#F6F6F4;">();</span></span>
<span class="line"><span style="color:#F6F6F4;">        }</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#7B7F8B;">//è®°å½•ç»“æŸæ—¶é—´</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#97E1F1;font-style:italic;">long</span><span style="color:#F6F6F4;"> end </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> System.</span><span style="color:#62E884;">currentTimeMillis</span><span style="color:#F6F6F4;">();</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#7B7F8B;">//æ‰“å°æ‰§è¡Œç»“æœ</span></span>
<span class="line"><span style="color:#F6F6F4;">        System.out.</span><span style="color:#62E884;">println</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">ä¸‡æ¬¡æ‰§è¡Œï¼š</span><span style="color:#DEE492;">&quot;</span><span style="color:#F286C4;">+</span><span style="color:#F6F6F4;"> className</span><span style="color:#F286C4;">+</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">.</span><span style="color:#DEE492;">&quot;</span><span style="color:#F286C4;">+</span><span style="color:#F6F6F4;">methodName</span><span style="color:#F286C4;">+</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">----&gt;</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">+</span><span style="color:#F6F6F4;">(end</span><span style="color:#F286C4;">-</span><span style="color:#F6F6F4;">start) </span><span style="color:#F286C4;">+</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">ms</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">);</span></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">//é€šçŸ¥ç±»å¿…é¡»é…ç½®æˆSpringç®¡ç†çš„bean</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Component</span></span>
<span class="line"><span style="color:#6A737D;">//è®¾ç½®å½“å‰ç±»ä¸ºåˆ‡é¢ç±»ç±»</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Aspect</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">ProjectAdvice</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//åŒ¹é…ä¸šåŠ¡å±‚çš„æ‰€æœ‰æ–¹æ³•</span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Pointcut</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;execution(* com.itheima.service.*Service.*(..))&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">servicePt</span><span style="color:#24292E;">(){}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//è®¾ç½®ç¯ç»•é€šçŸ¥ï¼Œåœ¨åŸå§‹æ“ä½œçš„è¿è¡Œå‰åè®°å½•æ‰§è¡Œæ—¶é—´</span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Around</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;ProjectAdvice.servicePt()&quot;</span><span style="color:#24292E;">) </span><span style="color:#6A737D;">//æœ¬ç±»ç±»åå¯ä»¥çœç•¥ä¸å†™</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">runSpeed</span><span style="color:#24292E;">(ProceedingJoinPoint </span><span style="color:#E36209;">pjp</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">throws</span><span style="color:#24292E;"> Throwable {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">//è·å–æ‰§è¡Œçš„ç­¾åå¯¹è±¡</span></span>
<span class="line"><span style="color:#24292E;">        Signature signature </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> pjp.</span><span style="color:#6F42C1;">getSignature</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">//è·å–æ¥å£/ç±»å…¨é™å®šå</span></span>
<span class="line"><span style="color:#24292E;">        String className </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> signature.</span><span style="color:#6F42C1;">getDeclaringTypeName</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">//è·å–æ–¹æ³•å</span></span>
<span class="line"><span style="color:#24292E;">        String methodName </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> signature.</span><span style="color:#6F42C1;">getName</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">//è®°å½•å¼€å§‹æ—¶é—´</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">long</span><span style="color:#24292E;"> start </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> System.</span><span style="color:#6F42C1;">currentTimeMillis</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">//æ‰§è¡Œä¸‡æ¬¡æ“ä½œ</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">for</span><span style="color:#24292E;"> (</span><span style="color:#D73A49;">int</span><span style="color:#24292E;"> i </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">; i </span><span style="color:#D73A49;">&lt;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">10000</span><span style="color:#24292E;">; i</span><span style="color:#D73A49;">++</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">           pjp.</span><span style="color:#6F42C1;">proceed</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">//è®°å½•ç»“æŸæ—¶é—´</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">long</span><span style="color:#24292E;"> end </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> System.</span><span style="color:#6F42C1;">currentTimeMillis</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">//æ‰“å°æ‰§è¡Œç»“æœ</span></span>
<span class="line"><span style="color:#24292E;">        System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;ä¸‡æ¬¡æ‰§è¡Œï¼š&quot;</span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> className</span><span style="color:#D73A49;">+</span><span style="color:#032F62;">&quot;.&quot;</span><span style="color:#D73A49;">+</span><span style="color:#24292E;">methodName</span><span style="color:#D73A49;">+</span><span style="color:#032F62;">&quot;----&gt;&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;">(end</span><span style="color:#D73A49;">-</span><span style="color:#24292E;">start) </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;ms&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h5 id="ã€ç¬¬äºŒæ­¥ã€‘åœ¨-springconfig-é…ç½®ç±»ä¸Šå¼€å¯-aop-æ³¨è§£åŠŸèƒ½-1" tabindex="-1">ã€ç¬¬äºŒæ­¥ã€‘åœ¨ SpringConfig é…ç½®ç±»ä¸Šå¼€å¯ AOP æ³¨è§£åŠŸèƒ½ <a class="header-anchor" href="#ã€ç¬¬äºŒæ­¥ã€‘åœ¨-springconfig-é…ç½®ç±»ä¸Šå¼€å¯-aop-æ³¨è§£åŠŸèƒ½-1" aria-label="Permalink to &quot;ã€ç¬¬äºŒæ­¥ã€‘åœ¨ SpringConfig é…ç½®ç±»ä¸Šå¼€å¯ AOP æ³¨è§£åŠŸèƒ½&quot;">â€‹</a></h5><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Configuration</span></span>
<span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">ComponentScan</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">com.itheima</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">)</span></span>
<span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">PropertySource</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">classpath:jdbc.properties</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">)</span></span>
<span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Import</span><span style="color:#F6F6F4;">({JdbcConfig.class,MybatisConfig.class})</span></span>
<span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">EnableAspectJAutoProxy</span><span style="color:#F6F6F4;"> </span><span style="color:#7B7F8B;">//å¼€å¯AOPæ³¨è§£åŠŸèƒ½</span></span>
<span class="line"><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">class</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;">SpringConfig</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Configuration</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">ComponentScan</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;com.itheima&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">PropertySource</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;classpath:jdbc.properties&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Import</span><span style="color:#24292E;">({JdbcConfig.class,MybatisConfig.class})</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">EnableAspectJAutoProxy</span><span style="color:#24292E;"> </span><span style="color:#6A737D;">//å¼€å¯AOPæ³¨è§£åŠŸèƒ½</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">SpringConfig</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h5 id="ã€ç¬¬ä¸‰æ­¥ã€‘è¿è¡Œæµ‹è¯•ç±»-æŸ¥çœ‹ç»“æœ-1" tabindex="-1">ã€ç¬¬ä¸‰æ­¥ã€‘è¿è¡Œæµ‹è¯•ç±»ï¼ŒæŸ¥çœ‹ç»“æœ <a class="header-anchor" href="#ã€ç¬¬ä¸‰æ­¥ã€‘è¿è¡Œæµ‹è¯•ç±»-æŸ¥çœ‹ç»“æœ-1" aria-label="Permalink to &quot;ã€ç¬¬ä¸‰æ­¥ã€‘è¿è¡Œæµ‹è¯•ç±»ï¼ŒæŸ¥çœ‹ç»“æœ&quot;">â€‹</a></h5><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">RunWith</span><span style="color:#F6F6F4;">(SpringJUnit4ClassRunner.class)</span></span>
<span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">ContextConfiguration</span><span style="color:#F6F6F4;">(</span><span style="color:#BF9EEE;">classes</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> SpringConfig.class)</span></span>
<span class="line"><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">class</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;">AccountServiceTestCase</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Autowired</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">private</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">AccountService</span><span style="color:#F6F6F4;"> accountService;</span></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Test</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">testFindById</span><span style="color:#F6F6F4;">(){</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#97E1F1;font-style:italic;">Account</span><span style="color:#F6F6F4;"> account </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> accountService.</span><span style="color:#62E884;">findById</span><span style="color:#F6F6F4;">(</span><span style="color:#BF9EEE;">2</span><span style="color:#F6F6F4;">);</span></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Test</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">testFindAll</span><span style="color:#F6F6F4;">(){</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#97E1F1;font-style:italic;">List</span><span style="color:#F6F6F4;">&lt;Account&gt; list </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> accountService.</span><span style="color:#62E884;">findAll</span><span style="color:#F6F6F4;">();</span></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">RunWith</span><span style="color:#24292E;">(SpringJUnit4ClassRunner.class)</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">ContextConfiguration</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">classes</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> SpringConfig.class)</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">AccountServiceTestCase</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Autowired</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> AccountService accountService;</span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Test</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">testFindById</span><span style="color:#24292E;">(){</span></span>
<span class="line"><span style="color:#24292E;">        Account account </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> accountService.</span><span style="color:#6F42C1;">findById</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">2</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Test</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">testFindAll</span><span style="color:#24292E;">(){</span></span>
<span class="line"><span style="color:#24292E;">        List&lt;</span><span style="color:#D73A49;">Account</span><span style="color:#24292E;">&gt; list </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> accountService.</span><span style="color:#6F42C1;">findAll</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><p><img src="http://www.yangeit.cn:21010/assets/image-20210730164219555-40dea680.png" alt="image-20210730164219555"></p><p>image-20210730164219555</p><h3 id="_2-2-æµ‹é‡ä¸šåŠ¡å±‚æ¥å£ä¸‡æ¬¡æ‰§è¡Œæ•ˆç‡-âœï¸" tabindex="-1">2.2 æµ‹é‡ä¸šåŠ¡å±‚æ¥å£ä¸‡æ¬¡æ‰§è¡Œæ•ˆç‡ âœï¸ <a class="header-anchor" href="#_2-2-æµ‹é‡ä¸šåŠ¡å±‚æ¥å£ä¸‡æ¬¡æ‰§è¡Œæ•ˆç‡-âœï¸" aria-label="Permalink to &quot;2.2 æµ‹é‡ä¸šåŠ¡å±‚æ¥å£ä¸‡æ¬¡æ‰§è¡Œæ•ˆç‡ âœï¸&quot;">â€‹</a></h3><h4 id="_2-2-0ã€Œæµ‹é‡ä¸šåŠ¡å±‚æ¥å£ä¸‡æ¬¡æ‰§è¡Œæ•ˆç‡-ã€ç›®çš„" tabindex="-1">2.2.0ã€Œæµ‹é‡ä¸šåŠ¡å±‚æ¥å£ä¸‡æ¬¡æ‰§è¡Œæ•ˆç‡ ã€ç›®çš„ <a class="header-anchor" href="#_2-2-0ã€Œæµ‹é‡ä¸šåŠ¡å±‚æ¥å£ä¸‡æ¬¡æ‰§è¡Œæ•ˆç‡-ã€ç›®çš„" aria-label="Permalink to &quot;2.2.0ã€Œæµ‹é‡ä¸šåŠ¡å±‚æ¥å£ä¸‡æ¬¡æ‰§è¡Œæ•ˆç‡ ã€ç›®çš„&quot;">â€‹</a></h4><blockquote><p>ç†Ÿæ‚‰ç¯ç»•é€šçŸ¥</p></blockquote><h4 id="_2-2-1ã€Œæµ‹é‡ä¸šåŠ¡å±‚æ¥å£ä¸‡æ¬¡æ‰§è¡Œæ•ˆç‡ã€éœ€æ±‚-æ•ˆæœ" tabindex="-1">2.2.1ã€Œæµ‹é‡ä¸šåŠ¡å±‚æ¥å£ä¸‡æ¬¡æ‰§è¡Œæ•ˆç‡ã€éœ€æ±‚&amp;æ•ˆæœ <a class="header-anchor" href="#_2-2-1ã€Œæµ‹é‡ä¸šåŠ¡å±‚æ¥å£ä¸‡æ¬¡æ‰§è¡Œæ•ˆç‡ã€éœ€æ±‚-æ•ˆæœ" aria-label="Permalink to &quot;2.2.1ã€Œæµ‹é‡ä¸šåŠ¡å±‚æ¥å£ä¸‡æ¬¡æ‰§è¡Œæ•ˆç‡ã€éœ€æ±‚&amp;æ•ˆæœ&quot;">â€‹</a></h4><p><img src="http://www.yangeit.cn:21010/assets/image-20210730164219555-40dea680.png" alt="image-20210730164219555"></p><p>image-20210730164219555</p><h4 id="_2-2-2ã€Œæµ‹é‡ä¸šåŠ¡å±‚æ¥å£ä¸‡æ¬¡æ‰§è¡Œæ•ˆç‡ã€æ­¥é„¹" tabindex="-1">2.2.2ã€Œæµ‹é‡ä¸šåŠ¡å±‚æ¥å£ä¸‡æ¬¡æ‰§è¡Œæ•ˆç‡ã€æ­¥é„¹ <a class="header-anchor" href="#_2-2-2ã€Œæµ‹é‡ä¸šåŠ¡å±‚æ¥å£ä¸‡æ¬¡æ‰§è¡Œæ•ˆç‡ã€æ­¥é„¹" aria-label="Permalink to &quot;2.2.2ã€Œæµ‹é‡ä¸šåŠ¡å±‚æ¥å£ä¸‡æ¬¡æ‰§è¡Œæ•ˆç‡ã€æ­¥é„¹&quot;">â€‹</a></h4><p>è¯´æ˜</p><ul><li>åœ¨é£ç§‹ä¸­ä¸‹è½½ spring_21_case_interface_run_speedtest å‹ç¼©åŒ…ï¼Œæ”¾åˆ°ä½ çš„å·¥ç¨‹ä¸­</li><li>å¯¼å…¥åˆ°é¡¹ç›®ä¸­</li><li>å®Œæˆé€šçŸ¥ç±»ä¸­çš„ä»£ç </li><li>å¯åŠ¨ç±»ä¸º AccountServiceTestCaseï¼Œç±»ä¸­æœ‰è¯¦ç»†è¯´æ˜</li><li>æ³¨æ„ï¼šå¯¼å·¥ç¨‹åï¼Œä¸€å®šè¦åšçš„ä¸‰ä¸ªæ­¥é„¹ <ol><li>æ£€æŸ¥ Maven ä»“åº“</li><li>æ£€æŸ¥ jdk-1.8</li><li>æ£€æŸ¥ç¼–è¯‘å™¨ç‰ˆæœ¬-1.8</li></ol></li></ul><p>ç‚¹å‡»æŸ¥çœ‹ç»ƒä¹ æ­¥é„¹è¯´æ˜</p><ul><li><p>éœ€æ±‚ 1ï¼šä»»æ„ä¸šåŠ¡å±‚æ¥å£æ‰§è¡Œå‡å¯æ˜¾ç¤ºå…¶æ‰§è¡Œæ•ˆç‡ï¼ˆæ‰§è¡Œæ—¶é•¿ï¼‰</p></li><li><p>ç»ƒä¹ ç›®æ ‡ï¼šä¸»è¦ç»ƒä¹ ç¯ç»•é€šçŸ¥å½¢å‚è°ƒç”¨ï¼ˆpjp.proceed()) ä»¥åŠæ‹¦æˆªçš„ç±»å’Œæ–¹æ³•åçš„è·å–</p><ol><li>æ‰§è¡Œ testFindById æ–¹æ³•ï¼Œæµ‹è¯•æ‰§è¡Œ 1 æ¬¡è€—æ—¶å¤šå°‘</li><li>æ‰§è¡Œ testFindAll æ–¹æ³•ï¼Œæµ‹è¯•æ‰§è¡Œ 10000 æ¬¡è€—æ—¶å¤šå°‘</li></ol></li><li><p>æ­¥é„¹ï¼š</p><ol><li><p>å¯¼å…¥é¡¹ç›®ï¼Œæ£€æŸ¥ pom ä¾èµ–å’Œ maven ä»“åº“</p></li><li><p>ä¿®æ”¹æ•°æ®åº“å¯†ç å’Œæ•°æ®åº“åå­—</p></li><li><p>æ£€æŸ¥æ•°æ®åº“ä¸­æ˜¯å¦æœ‰å¯¹åº”çš„è¡¨æ ¼å’Œæ•°æ®é‡</p></li><li><p>é…ç½®ç±» SpringConfig ä¸­æ£€æŸ¥æ˜¯å¦æœ‰å¼€å¯ AOP æ³¨è§£å¼€å‘ @EnableAspectJAutoProxy</p></li><li><p>åœ¨ AOP ç±»ä¸­ ProjectAdvice ä¸­æ£€æŸ¥ é€šçŸ¥æ–¹æ³•å’Œç¯ç»•é€šçŸ¥æ³¨è§£ @Around</p></li><li><p>æ£€æŸ¥åˆ‡å…¥ç‚¹è¡¨è¾¾å¼æ˜¯å¦åŒ¹é… æµ‹è¯•ç±»ä¸­æ‰§è¡Œçš„æ–¹æ³•</p><ul><li>execution(* com.itheima.service.*Service.*(..)</li></ul></li></ol></li><li><p>éœ€æ±‚ 2ï¼šåœ¨ä¸Šä¸€ä¸ªéœ€æ±‚ä¸Šï¼Œå®Œæˆæ‰“å°è¾“å…¥å‚æ•°</p><ul><li>å¦‚ï¼šaccountService.findById(2);è¿™é‡ŒæŸ¥è¯¢äº† id ä¸º 2 çš„å‚æ•°ï¼Œåœ¨å¢å¼ºçš„æ–¹æ³•ä¸­ï¼Œè¾“å…¥å‚æ•° 2</li><li>æ ¼å¼ï¼šæ‰§è¡Œï¼šcom.itheima.service.AccountService.findById å‚æ•°ï¼š[2]----&gt;465ms</li></ul></li><li><p>ç»ƒä¹ ç›®æ ‡ï¼šä¸»è¦ç»ƒä¹ ç¯ç»•é€šçŸ¥å½¢å‚è°ƒç”¨,è·å¾—åŸæœ‰æ–¹æ³•è¾“å…¥çš„å‚æ•°</p><ul><li>Object[] args = pjp.getArgs();</li></ul></li><li><p>å¦‚æœä½ å®Œæˆäº†ä¸Šè¿°ç¬¬ä¸€ä¸ªéœ€æ±‚ï¼Œæ­å–œä½ ï¼Œä½ æŒæ¡äº†é‡ç‚¹å†…å®¹ï¼ˆ3 åˆ†ä¹‹ä¸€ï¼‰ç¯ç»•é€šçŸ¥</p></li><li><p>å¦‚æœä½ å®Œæˆäº†ä¸Šè¿°çš„ç¬¬äºŒä¸ªéœ€æ±‚ï¼Œæ­å–œä½ ï¼Œä½ å‡†å¤‡æŒæ¡äº†é‡ç‚¹å†…å®¹ï¼ˆ3 åˆ†ä¹‹ä¸€ï¼‰ç¯ç»•é€šçŸ¥è·å¾—å‚æ•°</p></li></ul><h3 id="_2-3-aop-åˆ‡å…¥ç‚¹æ•°æ®è·å–" tabindex="-1">2.3 AOP åˆ‡å…¥ç‚¹æ•°æ®è·å– <a class="header-anchor" href="#_2-3-aop-åˆ‡å…¥ç‚¹æ•°æ®è·å–" aria-label="Permalink to &quot;2.3 AOP åˆ‡å…¥ç‚¹æ•°æ®è·å–&quot;">â€‹</a></h3><h3 id="_2-3-1-ã€Œåˆ‡å…¥ç‚¹æ•°æ®è·å–ã€æ ¸å¿ƒé—®é¢˜-ç­”æ¡ˆ" tabindex="-1">2.3.1 ã€Œåˆ‡å…¥ç‚¹æ•°æ®è·å–ã€æ ¸å¿ƒé—®é¢˜&amp;ç­”æ¡ˆ <a class="header-anchor" href="#_2-3-1-ã€Œåˆ‡å…¥ç‚¹æ•°æ®è·å–ã€æ ¸å¿ƒé—®é¢˜-ç­”æ¡ˆ" aria-label="Permalink to &quot;2.3.1 ã€Œåˆ‡å…¥ç‚¹æ•°æ®è·å–ã€æ ¸å¿ƒé—®é¢˜&amp;ç­”æ¡ˆ&quot;">â€‹</a></h3><p>é—®é¢˜</p><ol><li>åœ¨ç¯ç»•é€šçŸ¥ä¸­å¯ä»¥è·å–åˆ°å“ªäº›æ•°æ®ï¼Ÿ</li></ol><p>ç‚¹å‡»æŸ¥çœ‹ä»£ç </p><ul><li>è·å–å‚æ•°</li><li>è·å–è¿”å›å€¼</li><li>è·å–å¼‚å¸¸</li></ul><h4 id="_2-1-è·å–å‚æ•°" tabindex="-1">2.1 è·å–å‚æ•° <a class="header-anchor" href="#_2-1-è·å–å‚æ•°" aria-label="Permalink to &quot;2.1 è·å–å‚æ•°&quot;">â€‹</a></h4><blockquote><p>è¯´æ˜ï¼šåœ¨å‰ç½®é€šçŸ¥å’Œç¯ç»•é€šçŸ¥ä¸­éƒ½å¯ä»¥è·å–åˆ°è¿æ¥ç‚¹æ–¹æ³•çš„å‚æ•°ä»¬</p></blockquote><ul><li>JoinPoint å¯¹è±¡æè¿°äº†è¿æ¥ç‚¹æ–¹æ³•çš„è¿è¡ŒçŠ¶æ€ï¼Œå¯ä»¥è·å–åˆ°åŸå§‹æ–¹æ³•çš„è°ƒç”¨å‚æ•°</li></ul><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Before</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">pt()</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">)</span></span>
<span class="line"><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">before</span><span style="color:#F6F6F4;">(</span><span style="color:#97E1F1;font-style:italic;">JoinPoint</span><span style="color:#F6F6F4;"> jp) {</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#97E1F1;font-style:italic;">Object</span><span style="color:#F6F6F4;">[] args </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> jp.</span><span style="color:#62E884;">getArgs</span><span style="color:#F6F6F4;">(); </span><span style="color:#7B7F8B;">//è·å–è¿æ¥ç‚¹æ–¹æ³•çš„å‚æ•°ä»¬</span></span>
<span class="line"><span style="color:#F6F6F4;">    System.out.</span><span style="color:#62E884;">println</span><span style="color:#F6F6F4;">(Arrays.</span><span style="color:#62E884;">toString</span><span style="color:#F6F6F4;">(args));</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Before</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;pt()&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">before</span><span style="color:#24292E;">(JoinPoint jp) {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">Object</span><span style="color:#24292E;">[] args </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> jp.</span><span style="color:#6F42C1;">getArgs</span><span style="color:#24292E;">(); </span><span style="color:#6A737D;">//è·å–è¿æ¥ç‚¹æ–¹æ³•çš„å‚æ•°ä»¬</span></span>
<span class="line"><span style="color:#24292E;">    System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(Arrays.</span><span style="color:#6F42C1;">toString</span><span style="color:#24292E;">(args));</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><ul><li>ProccedJointPoint æ˜¯ JoinPoint çš„å­ç±» ğŸ‘ˆ</li></ul><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Around</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">pt()</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">)</span></span>
<span class="line"><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">Object</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">around</span><span style="color:#F6F6F4;">(</span><span style="color:#97E1F1;font-style:italic;">ProceedingJoinPoint</span><span style="color:#F6F6F4;"> pjp) throws Throwable {</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#97E1F1;font-style:italic;">Object</span><span style="color:#F6F6F4;">[] args </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> pjp.</span><span style="color:#62E884;">getArgs</span><span style="color:#F6F6F4;">(); </span><span style="color:#7B7F8B;">//è·å–è¿æ¥ç‚¹æ–¹æ³•çš„å‚æ•°ä»¬</span></span>
<span class="line"><span style="color:#F6F6F4;">    System.out.</span><span style="color:#62E884;">println</span><span style="color:#F6F6F4;">(Arrays.</span><span style="color:#62E884;">toString</span><span style="color:#F6F6F4;">(args));</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#97E1F1;font-style:italic;">Object</span><span style="color:#F6F6F4;"> ret </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> pjp.</span><span style="color:#62E884;">proceed</span><span style="color:#F6F6F4;">();</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">return</span><span style="color:#F6F6F4;"> ret;</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Around</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;pt()&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> Object </span><span style="color:#6F42C1;">around</span><span style="color:#24292E;">(ProceedingJoinPoint pjp) throws Throwable {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">Object</span><span style="color:#24292E;">[] args </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> pjp.</span><span style="color:#6F42C1;">getArgs</span><span style="color:#24292E;">(); </span><span style="color:#6A737D;">//è·å–è¿æ¥ç‚¹æ–¹æ³•çš„å‚æ•°ä»¬</span></span>
<span class="line"><span style="color:#24292E;">    System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(Arrays.</span><span style="color:#6F42C1;">toString</span><span style="color:#24292E;">(args));</span></span>
<span class="line"><span style="color:#24292E;">    Object ret </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> pjp.</span><span style="color:#6F42C1;">proceed</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> ret;</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h4 id="_2-2-è·å–è¿”å›å€¼-â¤ï¸" tabindex="-1">2.2 è·å–è¿”å›å€¼ â¤ï¸ <a class="header-anchor" href="#_2-2-è·å–è¿”å›å€¼-â¤ï¸" aria-label="Permalink to &quot;2.2 è·å–è¿”å›å€¼ â¤ï¸&quot;">â€‹</a></h4><blockquote><p>è¯´æ˜ï¼šåœ¨è¿”å›åé€šçŸ¥å’Œç¯ç»•é€šçŸ¥ä¸­éƒ½å¯ä»¥è·å–åˆ°è¿æ¥ç‚¹æ–¹æ³•çš„è¿”å›å€¼</p></blockquote><ul><li>æŠ›å‡ºå¼‚å¸¸åé€šçŸ¥å¯ä»¥è·å–åˆ‡å…¥ç‚¹æ–¹æ³•ä¸­å‡ºç°çš„å¼‚å¸¸ä¿¡æ¯ï¼Œä½¿ç”¨å½¢å‚å¯ä»¥æ¥æ”¶å¯¹åº”çš„å¼‚å¸¸å¯¹è±¡</li></ul><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">AfterReturning</span><span style="color:#F6F6F4;">(</span><span style="color:#BF9EEE;">value</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">pt()</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">,</span><span style="color:#BF9EEE;">returning</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">ret</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">)</span></span>
<span class="line"><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">afterReturning</span><span style="color:#F6F6F4;">(</span><span style="color:#97E1F1;font-style:italic;">String</span><span style="color:#F6F6F4;"> ret) { </span><span style="color:#7B7F8B;">//å˜é‡åè¦å’Œreturning=&quot;ret&quot;çš„å±æ€§å€¼ä¸€è‡´</span></span>
<span class="line"><span style="color:#F6F6F4;">    System.out.</span><span style="color:#62E884;">println</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">afterReturning advice ...</span><span style="color:#DEE492;">&quot;</span><span style="color:#F286C4;">+</span><span style="color:#F6F6F4;">ret);</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">AfterReturning</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">value</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;pt()&quot;</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">returning</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;ret&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">afterReturning</span><span style="color:#24292E;">(String ret) { </span><span style="color:#6A737D;">//å˜é‡åè¦å’Œreturning=&quot;ret&quot;çš„å±æ€§å€¼ä¸€è‡´</span></span>
<span class="line"><span style="color:#24292E;">    System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;afterReturning advice ...&quot;</span><span style="color:#D73A49;">+</span><span style="color:#24292E;">ret);</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><ul><li>ç¯ç»•é€šçŸ¥ä¸­å¯ä»¥æ‰‹å·¥ä¹¦å†™å¯¹åŸå§‹æ–¹æ³•çš„è°ƒç”¨ï¼Œå¾—åˆ°çš„ç»“æœå³ä¸ºåŸå§‹æ–¹æ³•çš„è¿”å›å€¼ ğŸ‘ˆ</li></ul><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Around</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">pt()</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">)</span></span>
<span class="line"><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">Object</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">around</span><span style="color:#F6F6F4;">(</span><span style="color:#97E1F1;font-style:italic;">ProceedingJoinPoint</span><span style="color:#F6F6F4;"> pjp) throws Throwable {</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#7B7F8B;">// æ‰‹åŠ¨è°ƒç”¨è¿æ¥ç‚¹æ–¹æ³•ï¼Œè¿”å›å€¼å°±æ˜¯è¿æ¥ç‚¹æ–¹æ³•çš„è¿”å›å€¼</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#97E1F1;font-style:italic;">Object</span><span style="color:#F6F6F4;"> ret </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> pjp.</span><span style="color:#62E884;">proceed</span><span style="color:#F6F6F4;">();</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">return</span><span style="color:#F6F6F4;"> ret;</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Around</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;pt()&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> Object </span><span style="color:#6F42C1;">around</span><span style="color:#24292E;">(ProceedingJoinPoint pjp) throws Throwable {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// æ‰‹åŠ¨è°ƒç”¨è¿æ¥ç‚¹æ–¹æ³•ï¼Œè¿”å›å€¼å°±æ˜¯è¿æ¥ç‚¹æ–¹æ³•çš„è¿”å›å€¼</span></span>
<span class="line"><span style="color:#24292E;">    Object ret </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> pjp.</span><span style="color:#6F42C1;">proceed</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> ret;</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h4 id="_2-3-è·å–å¼‚å¸¸-ğŸš€" tabindex="-1">2.3 è·å–å¼‚å¸¸ ğŸš€ <a class="header-anchor" href="#_2-3-è·å–å¼‚å¸¸-ğŸš€" aria-label="Permalink to &quot;2.3 è·å–å¼‚å¸¸ ğŸš€&quot;">â€‹</a></h4><blockquote><p>è¯´æ˜ï¼šåœ¨æŠ›å‡ºå¼‚å¸¸åé€šçŸ¥å’Œç¯ç»•é€šçŸ¥ä¸­éƒ½å¯ä»¥è·å–åˆ°è¿æ¥ç‚¹æ–¹æ³•ä¸­å‡ºç°çš„å¼‚å¸¸</p></blockquote><ul><li>æŠ›å‡ºå¼‚å¸¸åé€šçŸ¥å¯ä»¥è·å–åˆ‡å…¥ç‚¹æ–¹æ³•ä¸­å‡ºç°çš„å¼‚å¸¸ä¿¡æ¯ï¼Œä½¿ç”¨å½¢å‚å¯ä»¥æ¥æ”¶å¯¹åº”çš„å¼‚å¸¸å¯¹è±¡</li></ul><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">AfterThrowing</span><span style="color:#F6F6F4;">(</span><span style="color:#BF9EEE;">value</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">pt()</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">,</span><span style="color:#BF9EEE;">throwing</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">t</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">)</span></span>
<span class="line"><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">afterThrowing</span><span style="color:#F6F6F4;">(</span><span style="color:#97E1F1;font-style:italic;">Throwable</span><span style="color:#F6F6F4;"> t) {</span><span style="color:#7B7F8B;">//å˜é‡åè¦å’Œthrowing = &quot;t&quot;çš„å±æ€§å€¼ä¸€è‡´</span></span>
<span class="line"><span style="color:#F6F6F4;">    System.out.</span><span style="color:#62E884;">println</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">afterThrowing advice ...</span><span style="color:#DEE492;">&quot;</span><span style="color:#F286C4;">+</span><span style="color:#F6F6F4;"> t);</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">AfterThrowing</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">value</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;pt()&quot;</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">throwing</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;t&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">afterThrowing</span><span style="color:#24292E;">(Throwable t) {</span><span style="color:#6A737D;">//å˜é‡åè¦å’Œthrowing = &quot;t&quot;çš„å±æ€§å€¼ä¸€è‡´</span></span>
<span class="line"><span style="color:#24292E;">    System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;afterThrowing advice ...&quot;</span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> t);</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><ul><li>æŠ›å‡ºå¼‚å¸¸åé€šçŸ¥å¯ä»¥è·å–åˆ‡å…¥ç‚¹æ–¹æ³•è¿è¡Œçš„å¼‚å¸¸ä¿¡æ¯ï¼Œä½¿ç”¨å½¢å‚å¯ä»¥æ¥æ”¶è¿è¡Œæ—¶æŠ›å‡ºçš„å¼‚å¸¸å¯¹è±¡</li></ul><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Around</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">pt()</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">)</span></span>
<span class="line"><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">Object</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">around</span><span style="color:#F6F6F4;">(</span><span style="color:#97E1F1;font-style:italic;">ProceedingJoinPoint</span><span style="color:#F6F6F4;"> pjp)  {</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#97E1F1;font-style:italic;">Object</span><span style="color:#F6F6F4;"> ret </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">null</span><span style="color:#F6F6F4;">;</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#7B7F8B;">//æ­¤å¤„éœ€è¦try...catchå¤„ç†ï¼Œcatchä¸­æ•è·åˆ°çš„å¼‚å¸¸å°±æ˜¯è¿æ¥ç‚¹æ–¹æ³•ä¸­æŠ›å‡ºçš„å¼‚å¸¸</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">try</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">        ret </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> pjp.</span><span style="color:#62E884;">proceed</span><span style="color:#F6F6F4;">();</span></span>
<span class="line"><span style="color:#F6F6F4;">    } </span><span style="color:#F286C4;">catch</span><span style="color:#F6F6F4;"> (</span><span style="color:#97E1F1;font-style:italic;">Throwable</span><span style="color:#F6F6F4;"> </span><span style="color:#FFB86C;font-style:italic;">t</span><span style="color:#F6F6F4;">) {</span></span>
<span class="line"><span style="color:#F6F6F4;">        t.</span><span style="color:#62E884;">printStackTrace</span><span style="color:#F6F6F4;">();</span></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">return</span><span style="color:#F6F6F4;"> ret;</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Around</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;pt()&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> Object </span><span style="color:#6F42C1;">around</span><span style="color:#24292E;">(ProceedingJoinPoint pjp)  {</span></span>
<span class="line"><span style="color:#24292E;">    Object ret </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">null</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//æ­¤å¤„éœ€è¦try...catchå¤„ç†ï¼Œcatchä¸­æ•è·åˆ°çš„å¼‚å¸¸å°±æ˜¯è¿æ¥ç‚¹æ–¹æ³•ä¸­æŠ›å‡ºçš„å¼‚å¸¸</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">try</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">        ret </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> pjp.</span><span style="color:#6F42C1;">proceed</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">    } </span><span style="color:#D73A49;">catch</span><span style="color:#24292E;"> (Throwable </span><span style="color:#E36209;">t</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">        t.</span><span style="color:#6F42C1;">printStackTrace</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> ret;</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h3 id="_2-4-æ¡ˆä¾‹-ç™¾åº¦ç½‘ç›˜å¯†ç æ•°æ®å…¼å®¹å¤„ç†" tabindex="-1">2.4 æ¡ˆä¾‹-ç™¾åº¦ç½‘ç›˜å¯†ç æ•°æ®å…¼å®¹å¤„ç† <a class="header-anchor" href="#_2-4-æ¡ˆä¾‹-ç™¾åº¦ç½‘ç›˜å¯†ç æ•°æ®å…¼å®¹å¤„ç†" aria-label="Permalink to &quot;2.4 æ¡ˆä¾‹-ç™¾åº¦ç½‘ç›˜å¯†ç æ•°æ®å…¼å®¹å¤„ç†&quot;">â€‹</a></h3><h4 id="_2-4-1-éœ€æ±‚å’Œåˆ†æ" tabindex="-1">2.4.1 éœ€æ±‚å’Œåˆ†æ <a class="header-anchor" href="#_2-4-1-éœ€æ±‚å’Œåˆ†æ" aria-label="Permalink to &quot;2.4.1 éœ€æ±‚å’Œåˆ†æ&quot;">â€‹</a></h4><p>éœ€æ±‚å’Œåˆ†æ</p><ul><li>éœ€æ±‚ï¼šå¯¹ç™¾åº¦ç½‘ç›˜åˆ†äº«é“¾æ¥è¾“å…¥å¯†ç æ—¶å°¾éƒ¨å¤šè¾“å…¥çš„ç©ºæ ¼åšå…¼å®¹å¤„ç†</li></ul><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F6F6F4;">é“¾æ¥ï¼šhttps</span><span style="color:#F286C4;">:</span><span style="color:#7B7F8B;">//pan.baidu.com/s/12tMJaOlabADUXhu8VgwMzw?pwd=hztj</span></span>
<span class="line"><span style="color:#F6F6F4;">æå–ç ï¼šhztj</span></span>
<span class="line"><span style="color:#F6F6F4;">å¤åˆ¶è¿™æ®µå†…å®¹åæ‰“å¼€ç™¾åº¦ç½‘ç›˜æ‰‹æœº Appï¼Œæ“ä½œæ›´æ–¹ä¾¿å“¦</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">é“¾æ¥ï¼šhttps</span><span style="color:#D73A49;">:</span><span style="color:#6A737D;">//pan.baidu.com/s/12tMJaOlabADUXhu8VgwMzw?pwd=hztj</span></span>
<span class="line"><span style="color:#24292E;">æå–ç ï¼šhztj</span></span>
<span class="line"><span style="color:#24292E;">å¤åˆ¶è¿™æ®µå†…å®¹åæ‰“å¼€ç™¾åº¦ç½‘ç›˜æ‰‹æœº Appï¼Œæ“ä½œæ›´æ–¹ä¾¿å“¦</span></span></code></pre></div><ul><li>åˆ†æï¼š</li></ul><p><a href="https://mermaid-js.github.io/mermaid-live-editor/edit#pako:eNqrVkrOT0lVslJKL0osyFAIcYnJUwCCZ_0TnvZPe76g0SqjqiRLQVf3ad_uZ32dz1fuerZgj66uHUg0Jk9JRyk3tSg3MTMFaEA1SGeMUklGam5qjJIVkJmSWJQdoxSTVwtUl1hakh9cmZesZFVSVJqqo1RakJJYkuqSmQi0N1fJKi0xpzi1FgCLTTYb" target="_blank" rel="noreferrer"><img src="https://mermaid.ink/img/pako:eNqrVkrOT0lVslJKL0osyFAIcYnJUwCCZ_0TnvZPe76g0SqjqiRLQVf3ad_uZ32dz1fuerZgj66uHUg0Jk9JRyk3tSg3MTMFaEA1SGeMUklGam5qjJIVkJmSWJQdoxSTVwtUl1hakh9cmZesZFVSVJqqo1RakJJYkuqSmQi0N1fJKi0xpzi1FgCLTTYb?type=png" alt="">open in new window</a></p><p>â‘ ï¼šåœ¨ä¸šåŠ¡æ–¹æ³•æ‰§è¡Œä¹‹å‰å¯¹æ‰€æœ‰çš„è¾“å…¥å‚æ•°è¿›è¡Œæ ¼å¼å¤„ç†â€”â€”trim()</p><p>â‘¡ï¼šä½¿ç”¨å¤„ç†åçš„å‚æ•°è°ƒç”¨åŸå§‹æ–¹æ³•â€”â€”ç¯ç»•é€šçŸ¥ä¸­å­˜åœ¨å¯¹åŸå§‹æ–¹æ³•çš„è°ƒç”¨</p><p><a href="https://mermaid-js.github.io/mermaid-live-editor/edit#pako:eNqrVkrOT0lVslJKL0osyFAIcYnJUwACx4ICBQVd3Rcbmp9PWWHzdMLq5yt3PVuw5_mslqfr254vaLTT1bULSi3OLy1KTi0OTi0qy0xO1csvSM0LDfKxget7sqOXgFaXxHy9otTEFLiAru7TtdOfr1n2ZMemp-t3Pls_Bag6tbA0Maf42bSdzzZPhQjG5CnpKOWmFuUmZqYA3V4NcnSMUklGam5qjJIVkJmSWJQdoxSTVwtUl1hakh9cmZesZFVSVJqqo1RakJJYkuqSmQj0cq6SVRrQ7NRaAIDzdnA" target="_blank" rel="noreferrer"><img src="https://mermaid.ink/img/pako:eNqrVkrOT0lVslJKL0osyFAIcYnJUwACx4ICBQVd3Rcbmp9PWWHzdMLq5yt3PVuw5_mslqfr254vaLTT1bULSi3OLy1KTi0OTi0qy0xO1csvSM0LDfKxget7sqOXgFaXxHy9otTEFLiAru7TtdOfr1n2ZMemp-t3Pls_Bag6tbA0Maf42bSdzzZPhQjG5CnpKOWmFuUmZqYA3V4NcnSMUklGam5qjJIVkJmSWJQdoxSTVwtUl1hakh9cmZesZFVSVJqqo1RakJJYkuqSmQj0cq6SVRrQ7NRaAIDzdnA?type=png" alt="">open in new window</a></p><h4 id="_2-4-2-ä»£ç å®ç°" tabindex="-1">2.4.2 ä»£ç å®ç° <a class="header-anchor" href="#_2-4-2-ä»£ç å®ç°" aria-label="Permalink to &quot;2.4.2 ä»£ç å®ç°&quot;">â€‹</a></h4><h5 id="ã€å‰ç½®å·¥ä½œã€‘ç¯å¢ƒå‡†å¤‡-2" tabindex="-1">ã€å‰ç½®å·¥ä½œã€‘ç¯å¢ƒå‡†å¤‡ <a class="header-anchor" href="#ã€å‰ç½®å·¥ä½œã€‘ç¯å¢ƒå‡†å¤‡-2" aria-label="Permalink to &quot;ã€å‰ç½®å·¥ä½œã€‘ç¯å¢ƒå‡†å¤‡&quot;">â€‹</a></h5><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#7B7F8B;">//-------------serviceå±‚ä»£ç -----------------------</span></span>
<span class="line"><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">interface</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;">ResourcesService</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">boolean</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">openURL</span><span style="color:#F6F6F4;">(</span><span style="color:#97E1F1;font-style:italic;">String</span><span style="color:#F6F6F4;"> </span><span style="color:#FFB86C;font-style:italic;">url</span><span style="color:#F6F6F4;"> ,</span><span style="color:#97E1F1;font-style:italic;">String</span><span style="color:#F6F6F4;"> </span><span style="color:#FFB86C;font-style:italic;">password</span><span style="color:#F6F6F4;">);</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span>
<span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Service</span></span>
<span class="line"><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">class</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;">ResourcesServiceImpl</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">implements</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">ResourcesService</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Autowired</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">private</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">ResourcesDao</span><span style="color:#F6F6F4;"> resourcesDao;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">boolean</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">openURL</span><span style="color:#F6F6F4;">(</span><span style="color:#97E1F1;font-style:italic;">String</span><span style="color:#F6F6F4;"> </span><span style="color:#FFB86C;font-style:italic;">url</span><span style="color:#F6F6F4;">, </span><span style="color:#97E1F1;font-style:italic;">String</span><span style="color:#F6F6F4;"> </span><span style="color:#FFB86C;font-style:italic;">password</span><span style="color:#F6F6F4;">) {</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#F286C4;">return</span><span style="color:#F6F6F4;"> resourcesDao.</span><span style="color:#62E884;">readResources</span><span style="color:#F6F6F4;">(url,password);</span></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">//-------------serviceå±‚ä»£ç -----------------------</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">interface</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">ResourcesService</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">boolean</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">openURL</span><span style="color:#24292E;">(String </span><span style="color:#E36209;">url</span><span style="color:#24292E;"> ,String </span><span style="color:#E36209;">password</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Service</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">ResourcesServiceImpl</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">implements</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">ResourcesService</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Autowired</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> ResourcesDao resourcesDao;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">boolean</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">openURL</span><span style="color:#24292E;">(String </span><span style="color:#E36209;">url</span><span style="color:#24292E;">, String </span><span style="color:#E36209;">password</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> resourcesDao.</span><span style="color:#6F42C1;">readResources</span><span style="color:#24292E;">(url,password);</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#7B7F8B;">//-------------daoå±‚ä»£ç -----------------------</span></span>
<span class="line"><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">interface</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;">ResourcesDao</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#97E1F1;font-style:italic;">boolean</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">readResources</span><span style="color:#F6F6F4;">(</span><span style="color:#97E1F1;font-style:italic;">String</span><span style="color:#F6F6F4;"> </span><span style="color:#FFB86C;font-style:italic;">url</span><span style="color:#F6F6F4;">, </span><span style="color:#97E1F1;font-style:italic;">String</span><span style="color:#F6F6F4;"> </span><span style="color:#FFB86C;font-style:italic;">password</span><span style="color:#F6F6F4;">);</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span>
<span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Repository</span></span>
<span class="line"><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">class</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;">ResourcesDaoImpl</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">implements</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">ResourcesDao</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">boolean</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">readResources</span><span style="color:#F6F6F4;">(</span><span style="color:#97E1F1;font-style:italic;">String</span><span style="color:#F6F6F4;"> </span><span style="color:#FFB86C;font-style:italic;">url</span><span style="color:#F6F6F4;">, </span><span style="color:#97E1F1;font-style:italic;">String</span><span style="color:#F6F6F4;"> </span><span style="color:#FFB86C;font-style:italic;">password</span><span style="color:#F6F6F4;">) {</span></span>
<span class="line"><span style="color:#F6F6F4;">        System.out.</span><span style="color:#62E884;">println</span><span style="color:#F6F6F4;">(password.</span><span style="color:#62E884;">length</span><span style="color:#F6F6F4;">());</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#7B7F8B;">//æ¨¡æ‹Ÿæ ¡éªŒ</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#F286C4;">return</span><span style="color:#F6F6F4;"> password.</span><span style="color:#62E884;">equals</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">root</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">);</span></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">//-------------daoå±‚ä»£ç -----------------------</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">interface</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">ResourcesDao</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">boolean</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">readResources</span><span style="color:#24292E;">(String </span><span style="color:#E36209;">url</span><span style="color:#24292E;">, String </span><span style="color:#E36209;">password</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Repository</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">ResourcesDaoImpl</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">implements</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">ResourcesDao</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">boolean</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">readResources</span><span style="color:#24292E;">(String </span><span style="color:#E36209;">url</span><span style="color:#24292E;">, String </span><span style="color:#E36209;">password</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">        System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(password.</span><span style="color:#6F42C1;">length</span><span style="color:#24292E;">());</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">//æ¨¡æ‹Ÿæ ¡éªŒ</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> password.</span><span style="color:#6F42C1;">equals</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;root&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h5 id="ã€ç¬¬ä¸€æ­¥ã€‘ç¼–å†™é€šçŸ¥ç±»-2" tabindex="-1">ã€ç¬¬ä¸€æ­¥ã€‘ç¼–å†™é€šçŸ¥ç±» <a class="header-anchor" href="#ã€ç¬¬ä¸€æ­¥ã€‘ç¼–å†™é€šçŸ¥ç±»-2" aria-label="Permalink to &quot;ã€ç¬¬ä¸€æ­¥ã€‘ç¼–å†™é€šçŸ¥ç±»&quot;">â€‹</a></h5><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Component</span></span>
<span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Aspect</span></span>
<span class="line"><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">class</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;">DataAdvice</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Pointcut</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">execution(boolean com.itheima.service.*Service.*(*,*))</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">)</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">private</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">servicePt</span><span style="color:#F6F6F4;">(){}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Around</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">DataAdvice.servicePt()</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">)</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">Object</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">trimStr</span><span style="color:#F6F6F4;">(</span><span style="color:#97E1F1;font-style:italic;">ProceedingJoinPoint</span><span style="color:#F6F6F4;"> </span><span style="color:#FFB86C;font-style:italic;">pjp</span><span style="color:#F6F6F4;">) </span><span style="color:#F286C4;">throws</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">Throwable</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#97E1F1;font-style:italic;">Object</span><span style="color:#F6F6F4;">[] args </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> pjp.</span><span style="color:#62E884;">getArgs</span><span style="color:#F6F6F4;">();</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#F286C4;">for</span><span style="color:#F6F6F4;"> (</span><span style="color:#97E1F1;font-style:italic;">int</span><span style="color:#F6F6F4;"> i </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">0</span><span style="color:#F6F6F4;">; i </span><span style="color:#F286C4;">&lt;</span><span style="color:#F6F6F4;"> args.length; i</span><span style="color:#F286C4;">++</span><span style="color:#F6F6F4;">) {</span></span>
<span class="line"><span style="color:#F6F6F4;">            </span><span style="color:#7B7F8B;">//åˆ¤æ–­å‚æ•°æ˜¯ä¸æ˜¯å­—ç¬¦ä¸²</span></span>
<span class="line"><span style="color:#F6F6F4;">            </span><span style="color:#F286C4;">if</span><span style="color:#F6F6F4;">(args[i].</span><span style="color:#62E884;">getClass</span><span style="color:#F6F6F4;">().</span><span style="color:#62E884;">equals</span><span style="color:#F6F6F4;">(String.class)){</span></span>
<span class="line"><span style="color:#F6F6F4;">                args[i] </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> args[i].</span><span style="color:#62E884;">toString</span><span style="color:#F6F6F4;">().</span><span style="color:#62E884;">trim</span><span style="color:#F6F6F4;">();</span></span>
<span class="line"><span style="color:#F6F6F4;">            }</span></span>
<span class="line"><span style="color:#F6F6F4;">        }</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#97E1F1;font-style:italic;">Object</span><span style="color:#F6F6F4;"> ret </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> pjp.</span><span style="color:#62E884;">proceed</span><span style="color:#F6F6F4;">(args);</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#F286C4;">return</span><span style="color:#F6F6F4;"> ret;</span></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Component</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Aspect</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">DataAdvice</span><span style="color:#24292E;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Pointcut</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;execution(boolean com.itheima.service.*Service.*(*,*))&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">servicePt</span><span style="color:#24292E;">(){}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Around</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;DataAdvice.servicePt()&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> Object </span><span style="color:#6F42C1;">trimStr</span><span style="color:#24292E;">(ProceedingJoinPoint </span><span style="color:#E36209;">pjp</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">throws</span><span style="color:#24292E;"> Throwable {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">Object</span><span style="color:#24292E;">[] args </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> pjp.</span><span style="color:#6F42C1;">getArgs</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">for</span><span style="color:#24292E;"> (</span><span style="color:#D73A49;">int</span><span style="color:#24292E;"> i </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">; i </span><span style="color:#D73A49;">&lt;</span><span style="color:#24292E;"> args.length; i</span><span style="color:#D73A49;">++</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6A737D;">//åˆ¤æ–­å‚æ•°æ˜¯ä¸æ˜¯å­—ç¬¦ä¸²</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">if</span><span style="color:#24292E;">(args[i].</span><span style="color:#6F42C1;">getClass</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">equals</span><span style="color:#24292E;">(String.class)){</span></span>
<span class="line"><span style="color:#24292E;">                args[i] </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> args[i].</span><span style="color:#6F42C1;">toString</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">trim</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">            }</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"><span style="color:#24292E;">        Object ret </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> pjp.</span><span style="color:#6F42C1;">proceed</span><span style="color:#24292E;">(args);</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> ret;</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h5 id="ã€ç¬¬äºŒæ­¥ã€‘åœ¨-springconfig-é…ç½®ç±»ä¸Šå¼€å¯-aop-æ³¨è§£åŠŸèƒ½-2" tabindex="-1">ã€ç¬¬äºŒæ­¥ã€‘åœ¨ SpringConfig é…ç½®ç±»ä¸Šå¼€å¯ AOP æ³¨è§£åŠŸèƒ½ <a class="header-anchor" href="#ã€ç¬¬äºŒæ­¥ã€‘åœ¨-springconfig-é…ç½®ç±»ä¸Šå¼€å¯-aop-æ³¨è§£åŠŸèƒ½-2" aria-label="Permalink to &quot;ã€ç¬¬äºŒæ­¥ã€‘åœ¨ SpringConfig é…ç½®ç±»ä¸Šå¼€å¯ AOP æ³¨è§£åŠŸèƒ½&quot;">â€‹</a></h5><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Configuration</span></span>
<span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">ComponentScan</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">com.itheima</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">)</span></span>
<span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">EnableAspectJAutoProxy</span></span>
<span class="line"><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">class</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;">SpringConfig</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Configuration</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">ComponentScan</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;com.itheima&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">EnableAspectJAutoProxy</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">SpringConfig</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h5 id="ã€ç¬¬ä¸‰æ­¥ã€‘è¿è¡Œæµ‹è¯•ç±»-æŸ¥çœ‹ç»“æœ-2" tabindex="-1">ã€ç¬¬ä¸‰æ­¥ã€‘è¿è¡Œæµ‹è¯•ç±»ï¼ŒæŸ¥çœ‹ç»“æœ <a class="header-anchor" href="#ã€ç¬¬ä¸‰æ­¥ã€‘è¿è¡Œæµ‹è¯•ç±»-æŸ¥çœ‹ç»“æœ-2" aria-label="Permalink to &quot;ã€ç¬¬ä¸‰æ­¥ã€‘è¿è¡Œæµ‹è¯•ç±»ï¼ŒæŸ¥çœ‹ç»“æœ&quot;">â€‹</a></h5><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">class</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;">App</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">static</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">main</span><span style="color:#F6F6F4;">(</span><span style="color:#97E1F1;font-style:italic;">String</span><span style="color:#F6F6F4;">[] </span><span style="color:#FFB86C;font-style:italic;">args</span><span style="color:#F6F6F4;">) {</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#97E1F1;font-style:italic;">ApplicationContext</span><span style="color:#F6F6F4;"> ctx </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;font-weight:bold;">new</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">AnnotationConfigApplicationContext</span><span style="color:#F6F6F4;">(SpringConfig.class);</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#97E1F1;font-style:italic;">ResourcesService</span><span style="color:#F6F6F4;"> resourcesService </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> ctx.</span><span style="color:#62E884;">getBean</span><span style="color:#F6F6F4;">(ResourcesService.class);</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#97E1F1;font-style:italic;">boolean</span><span style="color:#F6F6F4;"> flag </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> resourcesService.</span><span style="color:#62E884;">openURL</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">http://pan.baidu.com/haha</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">, </span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">root </span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">);</span></span>
<span class="line"><span style="color:#F6F6F4;">        System.out.</span><span style="color:#62E884;">println</span><span style="color:#F6F6F4;">(flag);</span></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">App</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">static</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">main</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">String</span><span style="color:#24292E;">[] </span><span style="color:#E36209;">args</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">        ApplicationContext ctx </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">AnnotationConfigApplicationContext</span><span style="color:#24292E;">(SpringConfig.class);</span></span>
<span class="line"><span style="color:#24292E;">        ResourcesService resourcesService </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> ctx.</span><span style="color:#6F42C1;">getBean</span><span style="color:#24292E;">(ResourcesService.class);</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">boolean</span><span style="color:#24292E;"> flag </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> resourcesService.</span><span style="color:#6F42C1;">openURL</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;http://pan.baidu.com/haha&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;root &quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">        System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(flag);</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h3 id="_2-5-aop-å¼€å‘æ€»ç»“" tabindex="-1">2.5 AOP å¼€å‘æ€»ç»“ <a class="header-anchor" href="#_2-5-aop-å¼€å‘æ€»ç»“" aria-label="Permalink to &quot;2.5 AOP å¼€å‘æ€»ç»“&quot;">â€‹</a></h3><h4 id="_2-5-1-aop-çš„æ ¸å¿ƒæ¦‚å¿µ-ğŸ" tabindex="-1">2.5.1 AOP çš„æ ¸å¿ƒæ¦‚å¿µ ğŸ <a class="header-anchor" href="#_2-5-1-aop-çš„æ ¸å¿ƒæ¦‚å¿µ-ğŸ" aria-label="Permalink to &quot;2.5.1 AOP çš„æ ¸å¿ƒæ¦‚å¿µ ğŸ&quot;">â€‹</a></h4><p>æç¤º</p><ul><li>æ¦‚å¿µï¼šAOP(Aspect Oriented Programming)é¢å‘åˆ‡é¢ç¼–ç¨‹ï¼Œä¸€ç§ç¼–ç¨‹èŒƒå¼</li><li>ä½œç”¨ï¼šåœ¨ä¸æƒŠåŠ¨åŸå§‹è®¾è®¡çš„åŸºç¡€ä¸Šä¸ºæ–¹æ³•è¿›è¡ŒåŠŸèƒ½å¢å¼º</li><li>æ ¸å¿ƒæ¦‚å¿µ <ul><li>ä»£ç†ï¼ˆProxyï¼‰ï¼šSpringAOP çš„æ ¸å¿ƒæœ¬è´¨æ˜¯é‡‡ç”¨ä»£ç†æ¨¡å¼å®ç°çš„ â¤ï¸</li><li>è¿æ¥ç‚¹ï¼ˆJoinPointï¼‰ï¼š åœ¨ SpringAOP ä¸­ï¼Œç†è§£ä¸ºä»»æ„æ–¹æ³•çš„æ‰§è¡Œ</li><li>åˆ‡å…¥ç‚¹ï¼ˆPointcutï¼‰ï¼šåŒ¹é…è¿æ¥ç‚¹çš„å¼å­ï¼Œä¹Ÿæ˜¯å…·æœ‰å…±æ€§åŠŸèƒ½çš„æ–¹æ³•æè¿°</li><li>é€šçŸ¥ï¼ˆAdviceï¼‰ï¼šè‹¥å¹²ä¸ªæ–¹æ³•çš„å…±æ€§åŠŸèƒ½ï¼Œåœ¨åˆ‡å…¥ç‚¹å¤„æ‰§è¡Œï¼Œæœ€ç»ˆä½“ç°ä¸ºä¸€ä¸ªæ–¹æ³•</li><li>åˆ‡é¢ï¼ˆAspectï¼‰ï¼šæè¿°é€šçŸ¥ä¸åˆ‡å…¥ç‚¹çš„å¯¹åº”å…³ç³» â¤ï¸</li><li>ç›®æ ‡å¯¹è±¡ï¼ˆTargetï¼‰ï¼šè¢«ä»£ç†çš„åŸå§‹å¯¹è±¡æˆä¸ºç›®æ ‡å¯¹è±¡ â¤ï¸</li></ul></li></ul><h4 id="_2-5-2-åˆ‡å…¥ç‚¹è¡¨è¾¾å¼è¯­æ³•" tabindex="-1">2.5.2 åˆ‡å…¥ç‚¹è¡¨è¾¾å¼è¯­æ³• <a class="header-anchor" href="#_2-5-2-åˆ‡å…¥ç‚¹è¡¨è¾¾å¼è¯­æ³•" aria-label="Permalink to &quot;2.5.2 åˆ‡å…¥ç‚¹è¡¨è¾¾å¼è¯­æ³•&quot;">â€‹</a></h4><p>ç‚¹å‡»æŸ¥çœ‹åˆ‡å…¥ç‚¹è¡¨è¾¾å¼è¯­æ³•</p><ul><li><p>åˆ‡å…¥ç‚¹è¡¨è¾¾å¼æ ‡å‡†æ ¼å¼ï¼šåŠ¨ä½œå…³é”®å­—(è®¿é—®ä¿®é¥°ç¬¦ è¿”å›å€¼ åŒ…å.ç±»/æ¥å£å.æ–¹æ³•åï¼ˆå‚æ•°ï¼‰å¼‚å¸¸å)</p><ul><li>execution(* com.itheima.service.*Service.*(..))</li></ul></li><li><p>åˆ‡å…¥ç‚¹è¡¨è¾¾å¼æè¿°é€šé…ç¬¦ï¼š</p><ul><li>ä½œç”¨ï¼šç”¨äºå¿«é€Ÿæè¿°ï¼ŒèŒƒå›´æè¿°</li><li>*ï¼šåŒ¹é…ä»»æ„ç¬¦å·ï¼ˆå¸¸ç”¨ï¼‰</li><li>.. ï¼šåŒ¹é…å¤šä¸ªè¿ç»­çš„ä»»æ„ç¬¦å·ï¼ˆå¸¸ç”¨ï¼‰</li><li>+ï¼šåŒ¹é…å­ç±»ç±»å‹</li></ul></li><li><p>åˆ‡å…¥ç‚¹è¡¨è¾¾å¼ä¹¦å†™æŠ€å·§</p><ol><li>æŒ‰æ ‡å‡†è§„èŒƒå¼€å‘</li><li>æŸ¥è¯¢æ“ä½œçš„è¿”å›å€¼å»ºè®®ä½¿ç”¨*åŒ¹é…</li><li>å‡å°‘ä½¿ç”¨..çš„å½¢å¼æè¿°åŒ…</li><li>å¯¹æ¥å£è¿›è¡Œæè¿°ï¼Œä½¿ç”¨*è¡¨ç¤ºæ¨¡å—åï¼Œä¾‹å¦‚ UserService çš„åŒ¹é…æè¿°ä¸º*Service</li><li>æ–¹æ³•åä¹¦å†™ä¿ç•™åŠ¨è¯ï¼Œä¾‹å¦‚ getï¼Œä½¿ç”¨*è¡¨ç¤ºåè¯ï¼Œä¾‹å¦‚ getById åŒ¹é…æè¿°ä¸º getBy*</li><li>å‚æ•°æ ¹æ®å®é™…æƒ…å†µçµæ´»è°ƒæ•´</li></ol></li></ul><blockquote><p>1.è¡¨è¾¾å¼ï¼šè¯»çš„æ–¹å¼ä»åå¾€å‰è¯»å–ï¼Œåœ¨è·¯å¾„ä¸Šä¸è¦ä½¿ç”¨.. â¤ï¸</p></blockquote><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Pointcut</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">execution(* com.itheima.dao.BookDao.findName(..))</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">)</span></span>
<span class="line"><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">private</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">pt</span><span style="color:#F6F6F4;">(){}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Around</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">pt()</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">)</span></span>
<span class="line"><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">Object</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">around</span><span style="color:#F6F6F4;">(</span><span style="color:#97E1F1;font-style:italic;">ProceedingJoinPoint</span><span style="color:#F6F6F4;"> pjp) {</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#97E1F1;font-style:italic;">Object</span><span style="color:#F6F6F4;">[] args </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> pjp.</span><span style="color:#62E884;">getArgs</span><span style="color:#F6F6F4;">();</span></span>
<span class="line"><span style="color:#F6F6F4;">    System.out.</span><span style="color:#62E884;">println</span><span style="color:#F6F6F4;">(Arrays.</span><span style="color:#62E884;">toString</span><span style="color:#F6F6F4;">(args));</span></span>
<span class="line"><span style="color:#F6F6F4;">    args[</span><span style="color:#BF9EEE;">0</span><span style="color:#F6F6F4;">] </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">666</span><span style="color:#F6F6F4;">;</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#97E1F1;font-style:italic;">Object</span><span style="color:#F6F6F4;"> ret </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">null</span><span style="color:#F6F6F4;">;</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">try</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">        ret </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> pjp.</span><span style="color:#62E884;">proceed</span><span style="color:#F6F6F4;">(args);</span></span>
<span class="line"><span style="color:#F6F6F4;">    } </span><span style="color:#F286C4;">catch</span><span style="color:#F6F6F4;"> (</span><span style="color:#97E1F1;font-style:italic;">Throwable</span><span style="color:#F6F6F4;"> </span><span style="color:#FFB86C;font-style:italic;">t</span><span style="color:#F6F6F4;">) {</span></span>
<span class="line"><span style="color:#F6F6F4;">        t.</span><span style="color:#62E884;">printStackTrace</span><span style="color:#F6F6F4;">();</span></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">return</span><span style="color:#F6F6F4;"> ret;</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Pointcut</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;execution(* com.itheima.dao.BookDao.findName(..))&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;"> </span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">pt</span><span style="color:#24292E;">(){}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Around</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;pt()&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> Object </span><span style="color:#6F42C1;">around</span><span style="color:#24292E;">(ProceedingJoinPoint pjp) {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">Object</span><span style="color:#24292E;">[] args </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> pjp.</span><span style="color:#6F42C1;">getArgs</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">    System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(Arrays.</span><span style="color:#6F42C1;">toString</span><span style="color:#24292E;">(args));</span></span>
<span class="line"><span style="color:#24292E;">    args[</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">] </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">666</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">    Object ret </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">null</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">try</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">        ret </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> pjp.</span><span style="color:#6F42C1;">proceed</span><span style="color:#24292E;">(args);</span></span>
<span class="line"><span style="color:#24292E;">    } </span><span style="color:#D73A49;">catch</span><span style="color:#24292E;"> (Throwable </span><span style="color:#E36209;">t</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">        t.</span><span style="color:#6F42C1;">printStackTrace</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> ret;</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h4 id="_4-3-äº”ç§é€šçŸ¥ç±»å‹" tabindex="-1">4.3 äº”ç§é€šçŸ¥ç±»å‹ <a class="header-anchor" href="#_4-3-äº”ç§é€šçŸ¥ç±»å‹" aria-label="Permalink to &quot;4.3 äº”ç§é€šçŸ¥ç±»å‹&quot;">â€‹</a></h4><p>ç‚¹å‡»æŸ¥çœ‹äº”ç§é€šçŸ¥ç±»å‹</p><ul><li>å‰ç½®é€šçŸ¥</li><li>åç½®é€šçŸ¥</li><li>ç¯ç»•é€šçŸ¥ ğŸ‘ˆ â¤ï¸ <ul><li>ç¯ç»•é€šçŸ¥ä¾èµ–å½¢å‚ ProceedingJoinPoint æ‰èƒ½å®ç°å¯¹åŸå§‹æ–¹æ³•çš„è°ƒç”¨</li><li>ç¯ç»•é€šçŸ¥å¯ä»¥éš”ç¦»åŸå§‹æ–¹æ³•çš„è°ƒç”¨æ‰§è¡Œ</li><li>ç¯ç»•é€šçŸ¥è¿”å›å€¼è®¾ç½®ä¸º Object ç±»å‹</li><li>ç¯ç»•é€šçŸ¥ä¸­å¯ä»¥å¯¹åŸå§‹æ–¹æ³•è°ƒç”¨è¿‡ç¨‹ä¸­å‡ºç°çš„å¼‚å¸¸è¿›è¡Œå¤„ç†</li></ul></li><li>è¿”å›åé€šçŸ¥</li><li>æŠ›å‡ºå¼‚å¸¸åé€šçŸ¥</li></ul><p>æ³¨æ„</p><p>Aop å»ºè®®åœ¨å²—ä½çº§åˆ«æ¯”è¾ƒé«˜çš„æ—¶å€™ä½¿ç”¨ï¼Œå¦‚æœåªæ˜¯å…¬å¸çš„å°å·¥ç¨‹å¸ˆï¼Œå»ºè®®å…ˆå’¨è¯¢ä¸»ç®¡ã€‚</p><h2 id="_3-spring-äº‹åŠ¡ç®¡ç†" tabindex="-1">3.Spring äº‹åŠ¡ç®¡ç† <a class="header-anchor" href="#_3-spring-äº‹åŠ¡ç®¡ç†" aria-label="Permalink to &quot;3.Spring äº‹åŠ¡ç®¡ç†&quot;">â€‹</a></h2><h3 id="_3-1-spring-äº‹åŠ¡ç®€ä»‹ã€é‡ç‚¹ã€‘" tabindex="-1">3.1 Spring äº‹åŠ¡ç®€ä»‹ã€é‡ç‚¹ã€‘ <a class="header-anchor" href="#_3-1-spring-äº‹åŠ¡ç®€ä»‹ã€é‡ç‚¹ã€‘" aria-label="Permalink to &quot;3.1 Spring äº‹åŠ¡ç®€ä»‹ã€é‡ç‚¹ã€‘&quot;">â€‹</a></h3><h4 id="_3-1-1-ã€Œ-spring-äº‹åŠ¡ç®€ä»‹ã€æ ¸å¿ƒé—®é¢˜-ç­”æ¡ˆ" tabindex="-1">3.1.1 ã€Œ Spring äº‹åŠ¡ç®€ä»‹ã€æ ¸å¿ƒé—®é¢˜&amp;ç­”æ¡ˆ <a class="header-anchor" href="#_3-1-1-ã€Œ-spring-äº‹åŠ¡ç®€ä»‹ã€æ ¸å¿ƒé—®é¢˜-ç­”æ¡ˆ" aria-label="Permalink to &quot;3.1.1 ã€Œ Spring äº‹åŠ¡ç®€ä»‹ã€æ ¸å¿ƒé—®é¢˜&amp;ç­”æ¡ˆ&quot;">â€‹</a></h4><p>é—®é¢˜</p><ol><li>Spring æä¾›çš„äº‹åŠ¡ç®¡ç†æ˜¯æ•°æ®å±‚çš„äº‹åŠ¡è¿˜æ˜¯ä¸šåŠ¡å±‚çš„äº‹åŠ¡?</li></ol><p>ç‚¹å‡»æŸ¥çœ‹</p><ul><li>äº‹åŠ¡ä½œç”¨ï¼šåœ¨æ•°æ®å±‚ä¿éšœä¸€ç³»åˆ—çš„æ•°æ®åº“æ“ä½œåŒæˆåŠŸåŒå¤±è´¥</li><li>Spring äº‹åŠ¡ä½œç”¨ï¼šåœ¨æ•°æ®å±‚æˆ–****ä¿éšœä¸€ç³»åˆ—çš„æ•°æ®åº“æ“ä½œåŒæˆåŠŸåŒå¤±è´¥ <img src="http://www.yangeit.cn:21010/assets/image-20210801190820853-d0c9a90e.png" alt="image-20210801190820853"></li></ul><h4 id="_3-1-2-éœ€æ±‚å’Œåˆ†æ" tabindex="-1">3.1.2 éœ€æ±‚å’Œåˆ†æ <a class="header-anchor" href="#_3-1-2-éœ€æ±‚å’Œåˆ†æ" aria-label="Permalink to &quot;3.1.2 éœ€æ±‚å’Œåˆ†æ&quot;">â€‹</a></h4><p>æç¤º</p><ul><li><p>éœ€æ±‚ï¼šå®ç°ä»»æ„ä¸¤ä¸ªè´¦æˆ·é—´è½¬è´¦æ“ä½œ</p></li><li><p>éœ€æ±‚å¾®ç¼©ï¼šA è´¦æˆ·å‡é’±ï¼ŒB è´¦æˆ·åŠ é’±</p></li><li><p>åˆ†æï¼š</p><p>â‘ ï¼šæ•°æ®å±‚æä¾›åŸºç¡€æ“ä½œï¼ŒæŒ‡å®šè´¦æˆ·å‡é’±ï¼ˆoutMoneyï¼‰ï¼ŒæŒ‡å®šè´¦æˆ·åŠ é’±ï¼ˆinMoneyï¼‰</p><p>â‘¡ï¼šä¸šåŠ¡å±‚æä¾›è½¬è´¦æ“ä½œï¼ˆtransferï¼‰ï¼Œè°ƒç”¨å‡é’±ä¸åŠ é’±çš„æ“ä½œ</p><p>â‘¢ï¼šæä¾› 2 ä¸ªè´¦å·å’Œæ“ä½œé‡‘é¢æ‰§è¡Œè½¬è´¦æ“ä½œ</p><p>â‘£ï¼šåŸºäº Spring æ•´åˆ MyBatis ç¯å¢ƒæ­å»ºä¸Šè¿°æ“ä½œ</p></li><li><p>ç»“æœåˆ†æï¼š</p><p>â‘ ï¼šç¨‹åºæ­£å¸¸æ‰§è¡Œæ—¶ï¼Œè´¦æˆ·é‡‘é¢ A å‡ B åŠ ï¼Œæ²¡æœ‰é—®é¢˜</p><p>â‘¡ï¼šç¨‹åºå‡ºç°å¼‚å¸¸åï¼Œè½¬è´¦å¤±è´¥ï¼Œä½†æ˜¯å¼‚å¸¸ä¹‹å‰æ“ä½œæˆåŠŸï¼Œå¼‚å¸¸ä¹‹åæ“ä½œå¤±è´¥ï¼Œæ•´ä½“ä¸šåŠ¡å¤±è´¥</p></li></ul><h4 id="_3-1-3-ä»£ç å®ç°" tabindex="-1">3.1.3 ä»£ç å®ç° <a class="header-anchor" href="#_3-1-3-ä»£ç å®ç°" aria-label="Permalink to &quot;3.1.3 ä»£ç å®ç°&quot;">â€‹</a></h4><h5 id="ã€å‰ç½®å·¥ä½œã€‘ç¯å¢ƒå‡†å¤‡-3" tabindex="-1">ã€å‰ç½®å·¥ä½œã€‘ç¯å¢ƒå‡†å¤‡ <a class="header-anchor" href="#ã€å‰ç½®å·¥ä½œã€‘ç¯å¢ƒå‡†å¤‡-3" aria-label="Permalink to &quot;ã€å‰ç½®å·¥ä½œã€‘ç¯å¢ƒå‡†å¤‡&quot;">â€‹</a></h5><blockquote><p>Spring æ•´åˆ Mybatis ç›¸å…³ä»£ç (ä¾èµ–ã€JdbcConfigã€MybatisConfigã€SpringConfig)çœç•¥ã€‚</p></blockquote><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">interface</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;">AccountDao</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Update</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">update tbl_account set money = money + #{money} where name = #{name}</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">)</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">inMoney</span><span style="color:#F6F6F4;">(@</span><span style="color:#97E1F1;font-style:italic;">Param</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">name</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">) </span><span style="color:#97E1F1;font-style:italic;">String</span><span style="color:#F6F6F4;"> </span><span style="color:#FFB86C;font-style:italic;">name</span><span style="color:#F6F6F4;">, @</span><span style="color:#97E1F1;font-style:italic;">Param</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">money</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">) </span><span style="color:#97E1F1;font-style:italic;">Double</span><span style="color:#F6F6F4;"> </span><span style="color:#FFB86C;font-style:italic;">money</span><span style="color:#F6F6F4;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Update</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">update tbl_account set money = money - #{money} where name = #{name}</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">)</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">outMoney</span><span style="color:#F6F6F4;">(@</span><span style="color:#97E1F1;font-style:italic;">Param</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">name</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">) </span><span style="color:#97E1F1;font-style:italic;">String</span><span style="color:#F6F6F4;"> </span><span style="color:#FFB86C;font-style:italic;">name</span><span style="color:#F6F6F4;">, @</span><span style="color:#97E1F1;font-style:italic;">Param</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">money</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">) </span><span style="color:#97E1F1;font-style:italic;">Double</span><span style="color:#F6F6F4;"> </span><span style="color:#FFB86C;font-style:italic;">money</span><span style="color:#F6F6F4;">);</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">interface</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">AccountDao</span><span style="color:#24292E;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Update</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;update tbl_account set money = money + #{money} where name = #{name}&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">inMoney</span><span style="color:#24292E;">(@</span><span style="color:#D73A49;">Param</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;name&quot;</span><span style="color:#24292E;">) String </span><span style="color:#E36209;">name</span><span style="color:#24292E;">, @</span><span style="color:#D73A49;">Param</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;money&quot;</span><span style="color:#24292E;">) Double </span><span style="color:#E36209;">money</span><span style="color:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Update</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;update tbl_account set money = money - #{money} where name = #{name}&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">outMoney</span><span style="color:#24292E;">(@</span><span style="color:#D73A49;">Param</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;name&quot;</span><span style="color:#24292E;">) String </span><span style="color:#E36209;">name</span><span style="color:#24292E;">, @</span><span style="color:#D73A49;">Param</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;money&quot;</span><span style="color:#24292E;">) Double </span><span style="color:#E36209;">money</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">interface</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;">AccountService</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#7B7F8B;">    /**</span></span>
<span class="line"><span style="color:#7B7F8B;">     * è½¬è´¦æ“ä½œ</span></span>
<span class="line"><span style="color:#7B7F8B;">     * </span><span style="color:#F286C4;">@param</span><span style="color:#7B7F8B;"> </span><span style="color:#FFB86C;font-style:italic;">out</span><span style="color:#7B7F8B;"> ä¼ å‡ºæ–¹</span></span>
<span class="line"><span style="color:#7B7F8B;">     * </span><span style="color:#F286C4;">@param</span><span style="color:#7B7F8B;"> </span><span style="color:#FFB86C;font-style:italic;">in</span><span style="color:#7B7F8B;"> è½¬å…¥æ–¹</span></span>
<span class="line"><span style="color:#7B7F8B;">     * </span><span style="color:#F286C4;">@param</span><span style="color:#7B7F8B;"> </span><span style="color:#FFB86C;font-style:italic;">money</span><span style="color:#7B7F8B;"> é‡‘é¢</span></span>
<span class="line"><span style="color:#7B7F8B;">     */</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">transfer</span><span style="color:#F6F6F4;">(</span><span style="color:#97E1F1;font-style:italic;">String</span><span style="color:#F6F6F4;"> </span><span style="color:#FFB86C;font-style:italic;">out</span><span style="color:#F6F6F4;">,</span><span style="color:#97E1F1;font-style:italic;">String</span><span style="color:#F6F6F4;"> </span><span style="color:#FFB86C;font-style:italic;">in</span><span style="color:#F6F6F4;"> ,</span><span style="color:#97E1F1;font-style:italic;">Double</span><span style="color:#F6F6F4;"> </span><span style="color:#FFB86C;font-style:italic;">money</span><span style="color:#F6F6F4;">) ;</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">interface</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">AccountService</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#6A737D;">    /**</span></span>
<span class="line"><span style="color:#6A737D;">     * è½¬è´¦æ“ä½œ</span></span>
<span class="line"><span style="color:#6A737D;">     * </span><span style="color:#D73A49;">@param</span><span style="color:#6A737D;"> </span><span style="color:#E36209;">out</span><span style="color:#6A737D;"> ä¼ å‡ºæ–¹</span></span>
<span class="line"><span style="color:#6A737D;">     * </span><span style="color:#D73A49;">@param</span><span style="color:#6A737D;"> </span><span style="color:#E36209;">in</span><span style="color:#6A737D;"> è½¬å…¥æ–¹</span></span>
<span class="line"><span style="color:#6A737D;">     * </span><span style="color:#D73A49;">@param</span><span style="color:#6A737D;"> </span><span style="color:#E36209;">money</span><span style="color:#6A737D;"> é‡‘é¢</span></span>
<span class="line"><span style="color:#6A737D;">     */</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">transfer</span><span style="color:#24292E;">(String </span><span style="color:#E36209;">out</span><span style="color:#24292E;">,String </span><span style="color:#E36209;">in</span><span style="color:#24292E;"> ,Double </span><span style="color:#E36209;">money</span><span style="color:#24292E;">) ;</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Service</span></span>
<span class="line"><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">class</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;">AccountServiceImpl</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">implements</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">AccountService</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Autowired</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">private</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">AccountDao</span><span style="color:#F6F6F4;"> accountDao;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">transfer</span><span style="color:#F6F6F4;">(</span><span style="color:#97E1F1;font-style:italic;">String</span><span style="color:#F6F6F4;"> </span><span style="color:#FFB86C;font-style:italic;">out</span><span style="color:#F6F6F4;">,</span><span style="color:#97E1F1;font-style:italic;">String</span><span style="color:#F6F6F4;"> </span><span style="color:#FFB86C;font-style:italic;">in</span><span style="color:#F6F6F4;"> ,</span><span style="color:#97E1F1;font-style:italic;">Double</span><span style="color:#F6F6F4;"> </span><span style="color:#FFB86C;font-style:italic;">money</span><span style="color:#F6F6F4;">) {</span></span>
<span class="line"><span style="color:#F6F6F4;">        accountDao.</span><span style="color:#62E884;">outMoney</span><span style="color:#F6F6F4;">(out,money);</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#97E1F1;font-style:italic;">int</span><span style="color:#F6F6F4;"> i </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">1</span><span style="color:#F286C4;">/</span><span style="color:#BF9EEE;">0</span><span style="color:#F6F6F4;">;</span></span>
<span class="line"><span style="color:#F6F6F4;">        accountDao.</span><span style="color:#62E884;">inMoney</span><span style="color:#F6F6F4;">(in,money);</span></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Service</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">AccountServiceImpl</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">implements</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">AccountService</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Autowired</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> AccountDao accountDao;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">transfer</span><span style="color:#24292E;">(String </span><span style="color:#E36209;">out</span><span style="color:#24292E;">,String </span><span style="color:#E36209;">in</span><span style="color:#24292E;"> ,Double </span><span style="color:#E36209;">money</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">        accountDao.</span><span style="color:#6F42C1;">outMoney</span><span style="color:#24292E;">(out,money);</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">int</span><span style="color:#24292E;"> i </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#D73A49;">/</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">        accountDao.</span><span style="color:#6F42C1;">inMoney</span><span style="color:#24292E;">(in,money);</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h5 id="ã€ç¬¬ä¸€æ­¥ã€‘åœ¨ä¸šåŠ¡å±‚æ¥å£ä¸Šæ·»åŠ -spring-äº‹åŠ¡ç®¡ç†" tabindex="-1">ã€ç¬¬ä¸€æ­¥ã€‘åœ¨ä¸šåŠ¡å±‚æ¥å£ä¸Šæ·»åŠ  Spring äº‹åŠ¡ç®¡ç† <a class="header-anchor" href="#ã€ç¬¬ä¸€æ­¥ã€‘åœ¨ä¸šåŠ¡å±‚æ¥å£ä¸Šæ·»åŠ -spring-äº‹åŠ¡ç®¡ç†" aria-label="Permalink to &quot;ã€ç¬¬ä¸€æ­¥ã€‘åœ¨ä¸šåŠ¡å±‚æ¥å£ä¸Šæ·»åŠ  Spring äº‹åŠ¡ç®¡ç†&quot;">â€‹</a></h5><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">interface</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;">AccountService</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#7B7F8B;">//é…ç½®å½“å‰æ¥å£æ–¹æ³•å…·æœ‰äº‹åŠ¡</span></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Transactional</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">transfer</span><span style="color:#F6F6F4;">(</span><span style="color:#97E1F1;font-style:italic;">String</span><span style="color:#F6F6F4;"> </span><span style="color:#FFB86C;font-style:italic;">out</span><span style="color:#F6F6F4;">,</span><span style="color:#97E1F1;font-style:italic;">String</span><span style="color:#F6F6F4;"> </span><span style="color:#FFB86C;font-style:italic;">in</span><span style="color:#F6F6F4;"> ,</span><span style="color:#97E1F1;font-style:italic;">Double</span><span style="color:#F6F6F4;"> </span><span style="color:#FFB86C;font-style:italic;">money</span><span style="color:#F6F6F4;">) ;</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">interface</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">AccountService</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//é…ç½®å½“å‰æ¥å£æ–¹æ³•å…·æœ‰äº‹åŠ¡</span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Transactional</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">transfer</span><span style="color:#24292E;">(String </span><span style="color:#E36209;">out</span><span style="color:#24292E;">,String </span><span style="color:#E36209;">in</span><span style="color:#24292E;"> ,Double </span><span style="color:#E36209;">money</span><span style="color:#24292E;">) ;</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><ul><li><p>æ³¨æ„äº‹é¡¹</p><ol><li>Spring æ³¨è§£å¼äº‹åŠ¡é€šå¸¸æ·»åŠ åœ¨ä¸šåŠ¡å±‚æ¥å£ä¸­è€Œä¸ä¼šæ·»åŠ åˆ°ä¸šåŠ¡å±‚å®ç°ç±»ä¸­ï¼Œé™ä½è€¦åˆ</li><li>æ³¨è§£å¼äº‹åŠ¡å¯ä»¥æ·»åŠ åˆ°ä¸šåŠ¡æ–¹æ³•ä¸Šè¡¨ç¤ºå½“å‰æ–¹æ³•å¼€å¯äº‹åŠ¡ï¼Œä¹Ÿå¯ä»¥æ·»åŠ åˆ°æ¥å£ä¸Šè¡¨ç¤ºå½“å‰æ¥å£æ‰€æœ‰æ–¹æ³•å¼€å¯äº‹åŠ¡</li></ol></li></ul><h5 id="ã€ç¬¬äºŒæ­¥ã€‘è®¾ç½®äº‹åŠ¡ç®¡ç†å™¨-å°†äº‹åŠ¡ç®¡ç†å™¨æ·»åŠ åˆ°-ioc-å®¹å™¨ä¸­" tabindex="-1">ã€ç¬¬äºŒæ­¥ã€‘è®¾ç½®äº‹åŠ¡ç®¡ç†å™¨(å°†äº‹åŠ¡ç®¡ç†å™¨æ·»åŠ åˆ° IOC å®¹å™¨ä¸­) <a class="header-anchor" href="#ã€ç¬¬äºŒæ­¥ã€‘è®¾ç½®äº‹åŠ¡ç®¡ç†å™¨-å°†äº‹åŠ¡ç®¡ç†å™¨æ·»åŠ åˆ°-ioc-å®¹å™¨ä¸­" aria-label="Permalink to &quot;ã€ç¬¬äºŒæ­¥ã€‘è®¾ç½®äº‹åŠ¡ç®¡ç†å™¨(å°†äº‹åŠ¡ç®¡ç†å™¨æ·»åŠ åˆ° IOC å®¹å™¨ä¸­)&quot;">â€‹</a></h5><blockquote><p>è¯´æ˜ï¼šå¯ä»¥åœ¨ JdbcConfig ä¸­é…ç½®äº‹åŠ¡ç®¡ç†å™¨</p></blockquote><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#7B7F8B;">//é…ç½®äº‹åŠ¡ç®¡ç†å™¨ï¼Œmybatisä½¿ç”¨çš„æ˜¯jdbcäº‹åŠ¡</span></span>
<span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Bean</span></span>
<span class="line"><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">PlatformTransactionManager</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">transactionManager</span><span style="color:#F6F6F4;">(</span><span style="color:#97E1F1;font-style:italic;">DataSource</span><span style="color:#F6F6F4;"> dataSource){</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#97E1F1;font-style:italic;">DataSourceTransactionManager</span><span style="color:#F6F6F4;"> dtm </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;font-weight:bold;">new</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">DataSourceTransactionManager</span><span style="color:#F6F6F4;">();</span></span>
<span class="line"><span style="color:#F6F6F4;">    transactionManager.</span><span style="color:#62E884;">setDataSource</span><span style="color:#F6F6F4;">(dataSource);</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">return</span><span style="color:#F6F6F4;"> transactionManager;</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">//é…ç½®äº‹åŠ¡ç®¡ç†å™¨ï¼Œmybatisä½¿ç”¨çš„æ˜¯jdbcäº‹åŠ¡</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Bean</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> PlatformTransactionManager </span><span style="color:#6F42C1;">transactionManager</span><span style="color:#24292E;">(DataSource dataSource){</span></span>
<span class="line"><span style="color:#24292E;">    DataSourceTransactionManager dtm </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">DataSourceTransactionManager</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">    transactionManager.</span><span style="color:#6F42C1;">setDataSource</span><span style="color:#24292E;">(dataSource);</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> transactionManager;</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><ul><li><p>æ³¨æ„äº‹é¡¹</p><ol><li>äº‹åŠ¡ç®¡ç†å™¨è¦æ ¹æ®å®ç°æŠ€æœ¯è¿›è¡Œé€‰æ‹©</li><li>MyBatis æ¡†æ¶ä½¿ç”¨çš„æ˜¯ JDBC äº‹åŠ¡ â¤ï¸</li></ol></li></ul><h5 id="ã€ç¬¬ä¸‰æ­¥ã€‘å¼€å¯æ³¨è§£å¼äº‹åŠ¡é©±åŠ¨" tabindex="-1">ã€ç¬¬ä¸‰æ­¥ã€‘å¼€å¯æ³¨è§£å¼äº‹åŠ¡é©±åŠ¨ <a class="header-anchor" href="#ã€ç¬¬ä¸‰æ­¥ã€‘å¼€å¯æ³¨è§£å¼äº‹åŠ¡é©±åŠ¨" aria-label="Permalink to &quot;ã€ç¬¬ä¸‰æ­¥ã€‘å¼€å¯æ³¨è§£å¼äº‹åŠ¡é©±åŠ¨&quot;">â€‹</a></h5><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Configuration</span></span>
<span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">ComponentScan</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">com.itheima</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">)</span></span>
<span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">PropertySource</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">classpath:jdbc.properties</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">)</span></span>
<span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Import</span><span style="color:#F6F6F4;">({JdbcConfig.class,MybatisConfig.class})</span></span>
<span class="line"><span style="color:#7B7F8B;">//å¼€å¯æ³¨è§£å¼äº‹åŠ¡é©±åŠ¨</span></span>
<span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">EnableTransactionManagement</span></span>
<span class="line"><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">class</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;">SpringConfig</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Configuration</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">ComponentScan</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;com.itheima&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">PropertySource</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;classpath:jdbc.properties&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Import</span><span style="color:#24292E;">({JdbcConfig.class,MybatisConfig.class})</span></span>
<span class="line"><span style="color:#6A737D;">//å¼€å¯æ³¨è§£å¼äº‹åŠ¡é©±åŠ¨</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">EnableTransactionManagement</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">SpringConfig</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h5 id="ã€ç¬¬å››æ­¥ã€‘è¿è¡Œæµ‹è¯•ç±»-æŸ¥çœ‹ç»“æœ" tabindex="-1">ã€ç¬¬å››æ­¥ã€‘è¿è¡Œæµ‹è¯•ç±»ï¼ŒæŸ¥çœ‹ç»“æœ <a class="header-anchor" href="#ã€ç¬¬å››æ­¥ã€‘è¿è¡Œæµ‹è¯•ç±»-æŸ¥çœ‹ç»“æœ" aria-label="Permalink to &quot;ã€ç¬¬å››æ­¥ã€‘è¿è¡Œæµ‹è¯•ç±»ï¼ŒæŸ¥çœ‹ç»“æœ&quot;">â€‹</a></h5><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">RunWith</span><span style="color:#F6F6F4;">(SpringJUnit4ClassRunner.class)</span></span>
<span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">ContextConfiguration</span><span style="color:#F6F6F4;">(</span><span style="color:#BF9EEE;">classes</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> SpringConfig.class)</span></span>
<span class="line"><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">class</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;">AccountServiceTest</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Autowired</span></span>
<span class="line"><span style="color:#F286C4;">private</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">AccountService</span><span style="color:#F6F6F4;"> accountService;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Test</span></span>
<span class="line"><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">testTransfer</span><span style="color:#F6F6F4;">() </span><span style="color:#F286C4;">throws</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">IOException</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">    accountService.</span><span style="color:#62E884;">transfer</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">Tom</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">,</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">Jerry</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">,</span><span style="color:#BF9EEE;">100D</span><span style="color:#F6F6F4;">);</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">RunWith</span><span style="color:#24292E;">(SpringJUnit4ClassRunner.class)</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">ContextConfiguration</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">classes</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> SpringConfig.class)</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">AccountServiceTest</span><span style="color:#24292E;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Autowired</span></span>
<span class="line"><span style="color:#D73A49;">private</span><span style="color:#24292E;"> AccountService accountService;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Test</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">testTransfer</span><span style="color:#24292E;">() </span><span style="color:#D73A49;">throws</span><span style="color:#24292E;"> IOException {</span></span>
<span class="line"><span style="color:#24292E;">    accountService.</span><span style="color:#6F42C1;">transfer</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;Tom&quot;</span><span style="color:#24292E;">,</span><span style="color:#032F62;">&quot;Jerry&quot;</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">100D</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h3 id="_3-2-spring-äº‹åŠ¡è§’è‰²ã€ç†è§£ã€‘" tabindex="-1">3.2 Spring äº‹åŠ¡è§’è‰²ã€ç†è§£ã€‘ <a class="header-anchor" href="#_3-2-spring-äº‹åŠ¡è§’è‰²ã€ç†è§£ã€‘" aria-label="Permalink to &quot;3.2 Spring äº‹åŠ¡è§’è‰²ã€ç†è§£ã€‘&quot;">â€‹</a></h3><h4 id="_3-2-1-ã€Œspring-äº‹åŠ¡è§’è‰²ã€æ ¸å¿ƒé—®é¢˜-ç­”æ¡ˆ" tabindex="-1">3.2.1 ã€ŒSpring äº‹åŠ¡è§’è‰²ã€æ ¸å¿ƒé—®é¢˜&amp;ç­”æ¡ˆ <a class="header-anchor" href="#_3-2-1-ã€Œspring-äº‹åŠ¡è§’è‰²ã€æ ¸å¿ƒé—®é¢˜-ç­”æ¡ˆ" aria-label="Permalink to &quot;3.2.1 ã€ŒSpring äº‹åŠ¡è§’è‰²ã€æ ¸å¿ƒé—®é¢˜&amp;ç­”æ¡ˆ&quot;">â€‹</a></h4><p>é—®é¢˜</p><ol><li>ä»€ä¹ˆæ˜¯äº‹åŠ¡ç®¡ç†å‘˜ï¼Œä»€ä¹ˆæ˜¯äº‹åŠ¡åè°ƒå‘˜ï¼Ÿ</li></ol><p>ç‚¹å‡»æŸ¥çœ‹</p><ul><li>äº‹åŠ¡ç®¡ç†å‘˜ï¼šå‘èµ·äº‹åŠ¡æ–¹ï¼Œåœ¨ Spring ä¸­é€šå¸¸æŒ‡ä»£ä¸šåŠ¡å±‚å¼€å¯äº‹åŠ¡çš„æ–¹æ³•</li><li>äº‹åŠ¡åè°ƒå‘˜ï¼šåŠ å…¥äº‹åŠ¡æ–¹ï¼Œåœ¨ Spring ä¸­é€šå¸¸æŒ‡ä»£æ•°æ®å±‚æ–¹æ³•ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸šåŠ¡å±‚æ–¹æ³• <img src="http://www.yangeit.cn:21010/assets/image-20210801192453227-d0d5a8eb.png" alt="image-20210801192453227"></li></ul><h3 id="_3-3-spring-äº‹åŠ¡ç›¸å…³é…ç½®" tabindex="-1">3.3 Spring äº‹åŠ¡ç›¸å…³é…ç½® <a class="header-anchor" href="#_3-3-spring-äº‹åŠ¡ç›¸å…³é…ç½®" aria-label="Permalink to &quot;3.3 Spring äº‹åŠ¡ç›¸å…³é…ç½®&quot;">â€‹</a></h3><h4 id="_3-3-1-ã€Œspring-äº‹åŠ¡ç›¸å…³é…ç½®ã€æ ¸å¿ƒé—®é¢˜-ç­”æ¡ˆ" tabindex="-1">3.3.1 ã€ŒSpring äº‹åŠ¡ç›¸å…³é…ç½®ã€æ ¸å¿ƒé—®é¢˜&amp;ç­”æ¡ˆ <a class="header-anchor" href="#_3-3-1-ã€Œspring-äº‹åŠ¡ç›¸å…³é…ç½®ã€æ ¸å¿ƒé—®é¢˜-ç­”æ¡ˆ" aria-label="Permalink to &quot;3.3.1 ã€ŒSpring äº‹åŠ¡ç›¸å…³é…ç½®ã€æ ¸å¿ƒé—®é¢˜&amp;ç­”æ¡ˆ&quot;">â€‹</a></h4><p>é—®é¢˜</p><ol><li>ä»€ä¹ˆæ ·çš„å¼‚å¸¸ï¼ŒSpring äº‹åŠ¡é»˜è®¤æ˜¯ä¸è¿›è¡Œå›æ»šçš„ï¼Ÿ</li></ol><p>ç‚¹å‡»æŸ¥çœ‹</p><blockquote><p>è¯´æ˜ï¼šå¯¹äº RuntimeException ç±»å‹å¼‚å¸¸æˆ–è€… Error é”™è¯¯ï¼ŒSpring äº‹åŠ¡èƒ½å¤Ÿè¿›è¡Œå›æ»šæ“ä½œã€‚ä½†æ˜¯å¯¹äºï¼Œæ‰€ä»¥éœ€è¦ä½¿ç”¨ rollbackFor æ¥è®¾ç½®è¦å›æ»šçš„å¼‚å¸¸ã€‚ç›¸å½“äºæ‰“ä¸ªè¡¥ä¸ï¼Œä¸å½±å“åŸæœ‰å¼‚å¸¸çš„å›æ»šæ“ä½œ.</p></blockquote><p><img src="http://www.yangeit.cn:21010/assets/image-20210802151553053-ea06f348.png" alt="image-20210802151553053"></p><p>image-20210802151553053</p><h4 id="_3-3-1-æ¡ˆä¾‹-è½¬è´¦ä¸šåŠ¡è¿½åŠ æ—¥å¿—" tabindex="-1">3.3.1 æ¡ˆä¾‹ï¼šè½¬è´¦ä¸šåŠ¡è¿½åŠ æ—¥å¿— <a class="header-anchor" href="#_3-3-1-æ¡ˆä¾‹-è½¬è´¦ä¸šåŠ¡è¿½åŠ æ—¥å¿—" aria-label="Permalink to &quot;3.3.1 æ¡ˆä¾‹ï¼šè½¬è´¦ä¸šåŠ¡è¿½åŠ æ—¥å¿—&quot;">â€‹</a></h4><p>ç‚¹å‡»æŸ¥çœ‹å›¾ç¤º</p><p><img src="http://www.yangeit.cn:21010/assets/image-20220416003934031-7bebaeb3.png" alt="image-20220416003934031"></p><p>image-20220416003934031</p><h5 id="éœ€æ±‚å’Œåˆ†æ" tabindex="-1">éœ€æ±‚å’Œåˆ†æ <a class="header-anchor" href="#éœ€æ±‚å’Œåˆ†æ" aria-label="Permalink to &quot;éœ€æ±‚å’Œåˆ†æ&quot;">â€‹</a></h5><p>ç‚¹å‡»æŸ¥çœ‹</p><ul><li><p>éœ€æ±‚ï¼šå®ç°ä»»æ„ä¸¤ä¸ªè´¦æˆ·é—´è½¬è´¦æ“ä½œï¼Œå¹¶å¯¹æ¯æ¬¡è½¬è´¦æ“ä½œåœ¨æ•°æ®åº“è¿›è¡Œç•™ç—•</p></li><li><p>éœ€æ±‚å¾®ç¼©ï¼šA è´¦æˆ·å‡é’±ï¼ŒB è´¦æˆ·åŠ é’±ï¼Œæ•°æ®åº“è®°å½•æ—¥å¿—</p></li><li><p>åˆ†æï¼š</p><p>â‘ ï¼šåŸºäºè½¬è´¦æ“ä½œæ¡ˆä¾‹æ·»åŠ æ—¥å¿—æ¨¡å—ï¼Œå®ç°æ•°æ®åº“ä¸­è®°å½•æ—¥å¿—</p><p>â‘¡ï¼šä¸šåŠ¡å±‚è½¬è´¦æ“ä½œï¼ˆtransferï¼‰ï¼Œè°ƒç”¨å‡é’±ã€åŠ é’±ä¸è®°å½•æ—¥å¿—åŠŸèƒ½</p></li><li><p>å®ç°æ•ˆæœé¢„æœŸï¼š æ— è®ºè½¬è´¦æ“ä½œæ˜¯å¦æˆåŠŸï¼Œå‡è¿›è¡Œè½¬è´¦æ“ä½œçš„æ—¥å¿—ç•™ç—•</p></li><li><p>å­˜åœ¨çš„é—®é¢˜ï¼š æ—¥å¿—çš„è®°å½•ä¸è½¬è´¦æ“ä½œéš¶å±åŒä¸€ä¸ªäº‹åŠ¡ï¼ŒåŒæˆåŠŸåŒå¤±è´¥</p></li><li><p>å®ç°æ•ˆæœé¢„æœŸæ”¹è¿›ï¼š æ— è®ºè½¬è´¦æ“ä½œæ˜¯å¦æˆåŠŸï¼Œæ—¥å¿—å¿…é¡»ä¿ç•™</p></li><li><p>äº‹åŠ¡ä¼ æ’­è¡Œä¸ºï¼šäº‹åŠ¡åè°ƒå‘˜å¯¹äº‹åŠ¡ç®¡ç†å‘˜æ‰€æºå¸¦äº‹åŠ¡çš„å¤„ç†æ€åº¦</p></li></ul><p><img src="http://www.yangeit.cn:21010/assets/image-20210802153216460-3453977b.png" alt="image-20210802153216460"></p><p>image-20210802153216460</p><h5 id="ä»£ç å®ç°" tabindex="-1">ä»£ç å®ç° <a class="header-anchor" href="#ä»£ç å®ç°" aria-label="Permalink to &quot;ä»£ç å®ç°&quot;">â€‹</a></h5><p>æ­¥é„¹</p><ul><li>ã€å‡†å¤‡å·¥ä½œã€‘ç¯å¢ƒæ•´å¤‡</li><li>ã€ç¬¬ä¸€æ­¥ã€‘åœ¨ AccountServiceImpl ä¸­è°ƒç”¨ logService ä¸­æ·»åŠ æ—¥å¿—çš„æ–¹æ³•</li><li>ã€ç¬¬äºŒæ­¥ã€‘åœ¨ LogService çš„ log()æ–¹æ³•ä¸Šè®¾ç½®äº‹åŠ¡çš„ä¼ æ’­è¡Œä¸º</li><li>ã€ç¬¬ä¸‰æ­¥ã€‘è¿è¡Œæµ‹è¯•ç±»ï¼ŒæŸ¥çœ‹ç»“æœ</li></ul><h5 id="ã€å‡†å¤‡å·¥ä½œã€‘ç¯å¢ƒæ•´å¤‡" tabindex="-1">ã€å‡†å¤‡å·¥ä½œã€‘ç¯å¢ƒæ•´å¤‡ <a class="header-anchor" href="#ã€å‡†å¤‡å·¥ä½œã€‘ç¯å¢ƒæ•´å¤‡" aria-label="Permalink to &quot;ã€å‡†å¤‡å·¥ä½œã€‘ç¯å¢ƒæ•´å¤‡&quot;">â€‹</a></h5><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F286C4;">USE</span><span style="color:#F6F6F4;"> spring_db;</span></span>
<span class="line"><span style="color:#F286C4;">CREATE</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">TABLE</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">tbl_log</span><span style="color:#F6F6F4;">(</span></span>
<span class="line"><span style="color:#F6F6F4;">	id </span><span style="color:#F286C4;">INT</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">PRIMARY KEY</span><span style="color:#F6F6F4;"> AUTO_INCREMENT,</span></span>
<span class="line"><span style="color:#F6F6F4;">	info </span><span style="color:#F286C4;">VARCHAR</span><span style="color:#F6F6F4;">(</span><span style="color:#BF9EEE;">255</span><span style="color:#F6F6F4;">),</span></span>
<span class="line"><span style="color:#F6F6F4;">	createDate </span><span style="color:#F286C4;">DATE</span></span>
<span class="line"><span style="color:#F6F6F4;">);</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">USE</span><span style="color:#24292E;"> spring_db;</span></span>
<span class="line"><span style="color:#D73A49;">CREATE</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">TABLE</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">tbl_log</span><span style="color:#24292E;">(</span></span>
<span class="line"><span style="color:#24292E;">	id </span><span style="color:#D73A49;">INT</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">PRIMARY KEY</span><span style="color:#24292E;"> AUTO_INCREMENT,</span></span>
<span class="line"><span style="color:#24292E;">	info </span><span style="color:#D73A49;">VARCHAR</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">255</span><span style="color:#24292E;">),</span></span>
<span class="line"><span style="color:#24292E;">	createDate </span><span style="color:#D73A49;">DATE</span></span>
<span class="line"><span style="color:#24292E;">);</span></span></code></pre></div><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">interface</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;">LogService</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#7B7F8B;">//propagationè®¾ç½®äº‹åŠ¡å±æ€§ï¼šä¼ æ’­è¡Œä¸ºè®¾ç½®ä¸ºå½“å‰æ“ä½œéœ€è¦æ–°äº‹åŠ¡</span></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Transactional</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">log</span><span style="color:#F6F6F4;">(</span><span style="color:#97E1F1;font-style:italic;">String</span><span style="color:#F6F6F4;"> </span><span style="color:#FFB86C;font-style:italic;">out</span><span style="color:#F6F6F4;">, </span><span style="color:#97E1F1;font-style:italic;">String</span><span style="color:#F6F6F4;"> </span><span style="color:#FFB86C;font-style:italic;">in</span><span style="color:#F6F6F4;">, </span><span style="color:#97E1F1;font-style:italic;">Double</span><span style="color:#F6F6F4;"> </span><span style="color:#FFB86C;font-style:italic;">money</span><span style="color:#F6F6F4;">);</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">interface</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">LogService</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//propagationè®¾ç½®äº‹åŠ¡å±æ€§ï¼šä¼ æ’­è¡Œä¸ºè®¾ç½®ä¸ºå½“å‰æ“ä½œéœ€è¦æ–°äº‹åŠ¡</span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Transactional</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">log</span><span style="color:#24292E;">(String </span><span style="color:#E36209;">out</span><span style="color:#24292E;">, String </span><span style="color:#E36209;">in</span><span style="color:#24292E;">, Double </span><span style="color:#E36209;">money</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Service</span></span>
<span class="line"><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">class</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;">LogServiceImpl</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">implements</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">LogService</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Autowired</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">private</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">LogDao</span><span style="color:#F6F6F4;"> logDao;</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">log</span><span style="color:#F6F6F4;">(</span><span style="color:#97E1F1;font-style:italic;">String</span><span style="color:#F6F6F4;"> </span><span style="color:#FFB86C;font-style:italic;">out</span><span style="color:#F6F6F4;">,</span><span style="color:#97E1F1;font-style:italic;">String</span><span style="color:#F6F6F4;"> </span><span style="color:#FFB86C;font-style:italic;">in</span><span style="color:#F6F6F4;">,</span><span style="color:#97E1F1;font-style:italic;">Double</span><span style="color:#F6F6F4;"> </span><span style="color:#FFB86C;font-style:italic;">money</span><span style="color:#F6F6F4;"> ) {</span></span>
<span class="line"><span style="color:#F6F6F4;">        logDao.</span><span style="color:#62E884;">log</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">è½¬è´¦æ“ä½œç”±</span><span style="color:#DEE492;">&quot;</span><span style="color:#F286C4;">+</span><span style="color:#F6F6F4;">out</span><span style="color:#F286C4;">+</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">åˆ°</span><span style="color:#DEE492;">&quot;</span><span style="color:#F286C4;">+</span><span style="color:#F6F6F4;">in</span><span style="color:#F286C4;">+</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">,é‡‘é¢ï¼š</span><span style="color:#DEE492;">&quot;</span><span style="color:#F286C4;">+</span><span style="color:#F6F6F4;">money);</span></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Service</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">LogServiceImpl</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">implements</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">LogService</span><span style="color:#24292E;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Autowired</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> LogDao logDao;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">log</span><span style="color:#24292E;">(String </span><span style="color:#E36209;">out</span><span style="color:#24292E;">,String </span><span style="color:#E36209;">in</span><span style="color:#24292E;">,Double </span><span style="color:#E36209;">money</span><span style="color:#24292E;"> ) {</span></span>
<span class="line"><span style="color:#24292E;">        logDao.</span><span style="color:#6F42C1;">log</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;è½¬è´¦æ“ä½œç”±&quot;</span><span style="color:#D73A49;">+</span><span style="color:#24292E;">out</span><span style="color:#D73A49;">+</span><span style="color:#032F62;">&quot;åˆ°&quot;</span><span style="color:#D73A49;">+</span><span style="color:#24292E;">in</span><span style="color:#D73A49;">+</span><span style="color:#032F62;">&quot;,é‡‘é¢ï¼š&quot;</span><span style="color:#D73A49;">+</span><span style="color:#24292E;">money);</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">interface</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;">LogDao</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Insert</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">insert into tbl_log (info,createDate) values(#{info},now())</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">)</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">log</span><span style="color:#F6F6F4;">(</span><span style="color:#97E1F1;font-style:italic;">String</span><span style="color:#F6F6F4;"> </span><span style="color:#FFB86C;font-style:italic;">info</span><span style="color:#F6F6F4;">);</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">interface</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">LogDao</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Insert</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;insert into tbl_log (info,createDate) values(#{info},now())&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">log</span><span style="color:#24292E;">(String </span><span style="color:#E36209;">info</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h5 id="ã€ç¬¬ä¸€æ­¥ã€‘åœ¨-accountserviceimpl-ä¸­è°ƒç”¨-logservice-ä¸­æ·»åŠ æ—¥å¿—çš„æ–¹æ³•" tabindex="-1">ã€ç¬¬ä¸€æ­¥ã€‘åœ¨ AccountServiceImpl ä¸­è°ƒç”¨ logService ä¸­æ·»åŠ æ—¥å¿—çš„æ–¹æ³• <a class="header-anchor" href="#ã€ç¬¬ä¸€æ­¥ã€‘åœ¨-accountserviceimpl-ä¸­è°ƒç”¨-logservice-ä¸­æ·»åŠ æ—¥å¿—çš„æ–¹æ³•" aria-label="Permalink to &quot;ã€ç¬¬ä¸€æ­¥ã€‘åœ¨ AccountServiceImpl ä¸­è°ƒç”¨ logService ä¸­æ·»åŠ æ—¥å¿—çš„æ–¹æ³•&quot;">â€‹</a></h5><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Service</span></span>
<span class="line"><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">class</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;">AccountServiceImpl</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">implements</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">AccountService</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Autowired</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">private</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">AccountDao</span><span style="color:#F6F6F4;"> accountDao;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Autowired</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">private</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">LogService</span><span style="color:#F6F6F4;"> logService;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">transfer</span><span style="color:#F6F6F4;">(</span><span style="color:#97E1F1;font-style:italic;">String</span><span style="color:#F6F6F4;"> </span><span style="color:#FFB86C;font-style:italic;">out</span><span style="color:#F6F6F4;">,</span><span style="color:#97E1F1;font-style:italic;">String</span><span style="color:#F6F6F4;"> </span><span style="color:#FFB86C;font-style:italic;">in</span><span style="color:#F6F6F4;"> ,</span><span style="color:#97E1F1;font-style:italic;">Double</span><span style="color:#F6F6F4;"> </span><span style="color:#FFB86C;font-style:italic;">money</span><span style="color:#F6F6F4;">) {</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#F286C4;">try</span><span style="color:#F6F6F4;">{</span></span>
<span class="line"><span style="color:#F6F6F4;">            accountDao.</span><span style="color:#62E884;">outMoney</span><span style="color:#F6F6F4;">(out,money);</span></span>
<span class="line"><span style="color:#F6F6F4;">            </span><span style="color:#97E1F1;font-style:italic;">int</span><span style="color:#F6F6F4;"> i </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">1</span><span style="color:#F286C4;">/</span><span style="color:#BF9EEE;">0</span><span style="color:#F6F6F4;">;</span></span>
<span class="line"><span style="color:#F6F6F4;">            accountDao.</span><span style="color:#62E884;">inMoney</span><span style="color:#F6F6F4;">(in,money);</span></span>
<span class="line"><span style="color:#F6F6F4;">        }</span><span style="color:#F286C4;">finally</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">            logService.</span><span style="color:#62E884;">log</span><span style="color:#F6F6F4;">(out,in,money);</span></span>
<span class="line"><span style="color:#F6F6F4;">        }</span></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Service</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">AccountServiceImpl</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">implements</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">AccountService</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Autowired</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> AccountDao accountDao;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Autowired</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> LogService logService;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">transfer</span><span style="color:#24292E;">(String </span><span style="color:#E36209;">out</span><span style="color:#24292E;">,String </span><span style="color:#E36209;">in</span><span style="color:#24292E;"> ,Double </span><span style="color:#E36209;">money</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">try</span><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">            accountDao.</span><span style="color:#6F42C1;">outMoney</span><span style="color:#24292E;">(out,money);</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">int</span><span style="color:#24292E;"> i </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#D73A49;">/</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">            accountDao.</span><span style="color:#6F42C1;">inMoney</span><span style="color:#24292E;">(in,money);</span></span>
<span class="line"><span style="color:#24292E;">        }</span><span style="color:#D73A49;">finally</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">            logService.</span><span style="color:#6F42C1;">log</span><span style="color:#24292E;">(out,in,money);</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h5 id="ã€ç¬¬äºŒæ­¥ã€‘åœ¨-logservice-çš„-log-æ–¹æ³•ä¸Šè®¾ç½®äº‹åŠ¡çš„ä¼ æ’­è¡Œä¸º" tabindex="-1">ã€ç¬¬äºŒæ­¥ã€‘åœ¨ LogService çš„ log()æ–¹æ³•ä¸Šè®¾ç½®äº‹åŠ¡çš„ä¼ æ’­è¡Œä¸º <a class="header-anchor" href="#ã€ç¬¬äºŒæ­¥ã€‘åœ¨-logservice-çš„-log-æ–¹æ³•ä¸Šè®¾ç½®äº‹åŠ¡çš„ä¼ æ’­è¡Œä¸º" aria-label="Permalink to &quot;ã€ç¬¬äºŒæ­¥ã€‘åœ¨ LogService çš„ log()æ–¹æ³•ä¸Šè®¾ç½®äº‹åŠ¡çš„ä¼ æ’­è¡Œä¸º&quot;">â€‹</a></h5><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">interface</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;">LogService</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#7B7F8B;">//propagationè®¾ç½®äº‹åŠ¡å±æ€§ï¼šä¼ æ’­è¡Œä¸ºè®¾ç½®ä¸ºå½“å‰æ“ä½œéœ€è¦æ–°äº‹åŠ¡</span></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Transactional</span><span style="color:#F6F6F4;">(</span><span style="color:#BF9EEE;">propagation</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> Propagation.REQUIRES_NEW)</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">log</span><span style="color:#F6F6F4;">(</span><span style="color:#97E1F1;font-style:italic;">String</span><span style="color:#F6F6F4;"> </span><span style="color:#FFB86C;font-style:italic;">out</span><span style="color:#F6F6F4;">, </span><span style="color:#97E1F1;font-style:italic;">String</span><span style="color:#F6F6F4;"> </span><span style="color:#FFB86C;font-style:italic;">in</span><span style="color:#F6F6F4;">, </span><span style="color:#97E1F1;font-style:italic;">Double</span><span style="color:#F6F6F4;"> </span><span style="color:#FFB86C;font-style:italic;">money</span><span style="color:#F6F6F4;">);</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">interface</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">LogService</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//propagationè®¾ç½®äº‹åŠ¡å±æ€§ï¼šä¼ æ’­è¡Œä¸ºè®¾ç½®ä¸ºå½“å‰æ“ä½œéœ€è¦æ–°äº‹åŠ¡</span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Transactional</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">propagation</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> Propagation.REQUIRES_NEW)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">log</span><span style="color:#24292E;">(String </span><span style="color:#E36209;">out</span><span style="color:#24292E;">, String </span><span style="color:#E36209;">in</span><span style="color:#24292E;">, Double </span><span style="color:#E36209;">money</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h5 id="ã€ç¬¬ä¸‰æ­¥ã€‘è¿è¡Œæµ‹è¯•ç±»-æŸ¥çœ‹ç»“æœ-3" tabindex="-1">ã€ç¬¬ä¸‰æ­¥ã€‘è¿è¡Œæµ‹è¯•ç±»ï¼ŒæŸ¥çœ‹ç»“æœ <a class="header-anchor" href="#ã€ç¬¬ä¸‰æ­¥ã€‘è¿è¡Œæµ‹è¯•ç±»-æŸ¥çœ‹ç»“æœ-3" aria-label="Permalink to &quot;ã€ç¬¬ä¸‰æ­¥ã€‘è¿è¡Œæµ‹è¯•ç±»ï¼ŒæŸ¥çœ‹ç»“æœ&quot;">â€‹</a></h5><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">RunWith</span><span style="color:#F6F6F4;">(SpringJUnit4ClassRunner.class)</span></span>
<span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">ContextConfiguration</span><span style="color:#F6F6F4;">(</span><span style="color:#BF9EEE;">classes</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> SpringConfig.class)</span></span>
<span class="line"><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">class</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;">AccountServiceTest</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Autowired</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">private</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">AccountService</span><span style="color:#F6F6F4;"> accountService;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Test</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">testTransfer</span><span style="color:#F6F6F4;">() </span><span style="color:#F286C4;">throws</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">IOException</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">        accountService.</span><span style="color:#62E884;">transfer</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">Tom</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">,</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">Jerry</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">,</span><span style="color:#BF9EEE;">50D</span><span style="color:#F6F6F4;">);</span></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">RunWith</span><span style="color:#24292E;">(SpringJUnit4ClassRunner.class)</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">ContextConfiguration</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">classes</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> SpringConfig.class)</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">AccountServiceTest</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Autowired</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> AccountService accountService;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Test</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">testTransfer</span><span style="color:#24292E;">() </span><span style="color:#D73A49;">throws</span><span style="color:#24292E;"> IOException {</span></span>
<span class="line"><span style="color:#24292E;">        accountService.</span><span style="color:#6F42C1;">transfer</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;Tom&quot;</span><span style="color:#24292E;">,</span><span style="color:#032F62;">&quot;Jerry&quot;</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">50D</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h4 id="_3-3-2-äº‹åŠ¡ä¼ æ’­è¡Œä¸º" tabindex="-1">3.3.2 äº‹åŠ¡ä¼ æ’­è¡Œä¸º <a class="header-anchor" href="#_3-3-2-äº‹åŠ¡ä¼ æ’­è¡Œä¸º" aria-label="Permalink to &quot;3.3.2 äº‹åŠ¡ä¼ æ’­è¡Œä¸º&quot;">â€‹</a></h4><blockquote><p>äº‹åŠ¡ä¼ æ’­è¡Œä¸ºï¼šäº‹åŠ¡åè°ƒå‘˜å¯¹äº‹åŠ¡ç®¡ç†å‘˜æ‰€æºå¸¦äº‹åŠ¡çš„å¤„ç†æ€åº¦</p></blockquote><p>ç‚¹å‡»æŸ¥çœ‹</p><p><img src="http://www.yangeit.cn:21010/assets/image-20210802153014296-2f7367e3.png" alt="image-20210802153014296"></p><p>image-20210802153014296</p><h3 id="_3-4-äº‹åŠ¡ä¼ æ’­è¡Œä¸ºç»ƒä¹ -âœï¸" tabindex="-1">3.4 äº‹åŠ¡ä¼ æ’­è¡Œä¸ºç»ƒä¹  âœï¸ <a class="header-anchor" href="#_3-4-äº‹åŠ¡ä¼ æ’­è¡Œä¸ºç»ƒä¹ -âœï¸" aria-label="Permalink to &quot;3.4 äº‹åŠ¡ä¼ æ’­è¡Œä¸ºç»ƒä¹  âœï¸&quot;">â€‹</a></h3><h4 id="_3-4-0ã€Œäº‹åŠ¡ä¼ æ’­è¡Œä¸º-ã€ç›®çš„" tabindex="-1">3.4.0ã€Œäº‹åŠ¡ä¼ æ’­è¡Œä¸º ã€ç›®çš„ <a class="header-anchor" href="#_3-4-0ã€Œäº‹åŠ¡ä¼ æ’­è¡Œä¸º-ã€ç›®çš„" aria-label="Permalink to &quot;3.4.0ã€Œäº‹åŠ¡ä¼ æ’­è¡Œä¸º ã€ç›®çš„&quot;">â€‹</a></h4><blockquote><p>äº‹åŠ¡ä¼ æ’­è¡Œä¸ºä¸­çš„ REQUIRES_NEW å¼€å¯ä¸€ä¸ªæ–°çš„äº‹ç‰©</p></blockquote><h4 id="_3-4-1ã€Œäº‹åŠ¡ä¼ æ’­è¡Œä¸ºã€éœ€æ±‚-æ•ˆæœ" tabindex="-1">3.4.1ã€Œäº‹åŠ¡ä¼ æ’­è¡Œä¸ºã€éœ€æ±‚&amp;æ•ˆæœ <a class="header-anchor" href="#_3-4-1ã€Œäº‹åŠ¡ä¼ æ’­è¡Œä¸ºã€éœ€æ±‚-æ•ˆæœ" aria-label="Permalink to &quot;3.4.1ã€Œäº‹åŠ¡ä¼ æ’­è¡Œä¸ºã€éœ€æ±‚&amp;æ•ˆæœ&quot;">â€‹</a></h4><blockquote><p>è½¬è´¦è¿‡ç¨‹ä¸­å‡ºç°äº†å¼‚å¸¸ï¼Œæ—¥å¿—ä¹Ÿè¿›è¡Œäº†è®°å½•</p></blockquote><h4 id="_3-4-2ã€Œäº‹åŠ¡ä¼ æ’­è¡Œä¸ºã€æ­¥é„¹" tabindex="-1">3.4.2ã€Œäº‹åŠ¡ä¼ æ’­è¡Œä¸ºã€æ­¥é„¹ <a class="header-anchor" href="#_3-4-2ã€Œäº‹åŠ¡ä¼ æ’­è¡Œä¸ºã€æ­¥é„¹" aria-label="Permalink to &quot;3.4.2ã€Œäº‹åŠ¡ä¼ æ’­è¡Œä¸ºã€æ­¥é„¹&quot;">â€‹</a></h4><ul><li>åœ¨é£ç§‹ä¸­ä¸‹è½½ spring_25_case_transfer_logtest å‹ç¼©åŒ…ï¼Œæ”¾åˆ°ä½ çš„å·¥ç¨‹ä¸­</li><li>å¯¼å…¥åˆ°é¡¹ç›®ä¸­</li><li>å¯åŠ¨ç±»ä¸º AccountServiceTestï¼Œç±»ä¸­æœ‰è¯¦ç»†è¯´æ˜</li><li>æ€è€ƒ AccountService å’Œ LogService æ·»åŠ ä»€ä¹ˆæ³¨è§£é…ç½®äº‹ç‰©ï¼Œå¹¶ä¸”æ€è€ƒè¦é…ç½®ä½•ç§ä¼ æ’­å±æ€§</li><li>æ³¨æ„ï¼šå¯¼å·¥ç¨‹åï¼Œä¸€å®šè¦åšçš„ä¸‰ä¸ªæ­¥é„¹ <ol><li>æ£€æŸ¥ Maven ä»“åº“</li><li>æ£€æŸ¥ jdk-1.8</li><li>æ£€æŸ¥ç¼–è¯‘å™¨ç‰ˆæœ¬-1.8</li></ol></li></ul><p>è®°å¿†å°æŠ€å·§</p><ul><li><p>Spring å®¹å™¨å’Œ bean çš„æ³¨è§£ ï¼šccip abs</p></li><li><p>aop çš„æ³¨è§£ï¼šCAPA E</p></li></ul><h2 id="â˜†-å­¦ä¹ æ–¹æ³•åŸ¹å…»" tabindex="-1">â˜† å­¦ä¹ æ–¹æ³•åŸ¹å…» <a class="header-anchor" href="#â˜†-å­¦ä¹ æ–¹æ³•åŸ¹å…»" aria-label="Permalink to &quot;â˜† å­¦ä¹ æ–¹æ³•åŸ¹å…»&quot;">â€‹</a></h2><ol><li><p>æ™šè‡ªä¹ ç¬¬ä¸€èŠ‚è¯¾ï¼Œè€å¸ˆæ€»ç»“å®Œæ¯•ä¹‹åï¼Œæ¯ä¸ªåŒå­¦å…ˆå¿…é¡»æ¢³ç†ä»Šæ—¥çŸ¥è¯†ç‚¹ (md ç¬”è®°ä¹Ÿè¡Œ)ï¼›æ•´ç†å¥½çš„ç¬”è®°å¯ä»¥å‘ç»™ç»„é•¿ï¼Œç»„é•¿äº¤ç»™ä½ ç­é•¿ï¼Œæ„åœ¨åŸ¹å…»å¤§å®¶æ€»ç»“çš„èƒ½åŠ›ï¼‰</p></li><li><p>æ™šè‡ªä¹ ç¬¬äºŒèŠ‚è¯¾å¼€å§‹ç»ƒä¹ ï¼ˆ**è®°ä½ï¼š**ç¨‹åºå‘˜æ˜¯ä»£ç å †èµ·æ¥çš„ï¼‰ï¼š</p><ol><li>å…ˆè¦æŠŠä»Šå¤©çš„æ‰€æœ‰æ¡ˆä¾‹ï¼ŒæŒ‰ç…§ä¹¦å†™é¡ºåºå†™ä¸€é</li><li>ç‹¬ç«‹ä¹¦å†™ä»Šæ—¥ä½œä¸š<a href="http://www.yangeit.cn:21010/lessontask/springtask/day03.html" target="_blank" rel="noreferrer">ç‚¹å‡»æŸ¥çœ‹ä½œä¸š</a> ğŸ‘ˆ ğŸ‘ˆ ğŸ‘ˆ</li></ol></li><li><p>ç¦»ä¸‹æ™šè‡ªä¹ è¿˜æœ‰ 20 åˆ†é’Ÿæ—¶å€™ï¼šé¢„ä¹ ç¬¬äºŒå¤©çš„çŸ¥è¯†ï¼Œé¢„ä¹ çš„æ—¶å€™ä¸€å®šè¦æ³¨æ„ï¼š</p><ol><li>é¢„ä¹ ä¸æ˜¯å­¦ä¹ ï¼Œä¸è¦çœ‹ç¬¬äºŒå¤©çš„è§†é¢‘ï¼Œåˆ‡è®°<strong>ä¸è¦çœ‹</strong>ç¬¬äºŒå¤©è§†é¢‘</li><li>é¢„ä¹ <strong>çœ‹</strong>ç¬¬äºŒå¤©çš„ç¬”è®°ï¼ŒæŠŠç¬¬äºŒå¤©ç¬”è®°å…¨éƒ¨è¿‡ä¸€éï¼ˆæ²¡çœ‹æ‡‚çš„è·³è¿‡ï¼‰ï¼Œ<strong>é‡ç‚¹æ³¨æ„</strong>è‡ªå·±æ²¡çœ‹æ‡‚çš„çŸ¥è¯†ç‚¹ï¼Œæ‰“ä¸Šæ ‡è®°ï¼Œç¬¬äºŒå¤©ç€é‡å¬è¿™ä¸€å—</li><li>é¢„ä¹ å¯ä»¥é€šè¿‡ä¸‹åˆ—é¢˜ç›®æ¥æ£€æµ‹é¢„ä¹ æ•ˆæœ<a href="https://www.wenjuan.ltd/s/UZBZJvPfeq1" target="_blank" rel="noreferrer">springé¢„ä¹ æ•ˆæœæ£€æµ‹open in new window</a></li></ol></li></ol><h2 id="è¯¾åä½œä¸š" tabindex="-1">è¯¾åä½œä¸š <a class="header-anchor" href="#è¯¾åä½œä¸š" aria-label="Permalink to &quot;è¯¾åä½œä¸š&quot;">â€‹</a></h2><p>è¯¾åä½œä¸šåœ¨é£ç§‹å…±äº«æ–‡ä»¶å¤¹ä¸­ä¸Šï¼Œåšå®Œè®°å¾—å‘ç»™ç»„é•¿</p>`,310),e=[o];function t(c,r,y,i,F,E){return a(),n("div",null,e)}const g=s(p,[["render",t]]);export{d as __pageData,g as default};
