import{_ as s,o as a,c as n,V as l}from"./chunks/framework.c6d8cbec.js";const p="/docs/assets/hashcode-1.467caccb.png",o="data:image/png;base64,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",u=JSON.parse('{"title":"Java hashCode方法解析：C++实现的高效本地方法","description":"hashCode是Java 所有类都有的方法，它会返回一个整数哈希码，表示对象在内存中的近似位置。相等的对象应具有相同哈希码，因此自定义类时需同时重写hashCode()和equals()方法。","frontmatter":{"title":"Java hashCode方法解析：C++实现的高效本地方法","shortTitle":"Java hashCode方法解析","category":["Java核心"],"tag":["Java重要知识点"],"description":"hashCode是Java 所有类都有的方法，它会返回一个整数哈希码，表示对象在内存中的近似位置。相等的对象应具有相同哈希码，因此自定义类时需同时重写hashCode()和equals()方法。","author":"沉默王二","head":[["meta",{"name":"keywords","content":"java,hashcode,equals"}]]},"headers":[],"relativePath":"backend/tobetter/basic-extra-meal/hashcode.md","filePath":"backend/tobetter/basic-extra-meal/hashcode.md"}'),e={name:"backend/tobetter/basic-extra-meal/hashcode.md"},t=l('<h1 id="_13-5-java-hashcode方法解析" tabindex="-1">13.5 Java hashCode方法解析 <a class="header-anchor" href="#_13-5-java-hashcode方法解析" aria-label="Permalink to &quot;13.5 Java hashCode方法解析&quot;">​</a></h1><p>今天我们来谈谈 Java 中的 <code>hashCode()</code> 方法。众所周知，Java 是一门面向对象的编程语言，所有的类都会默认继承自 Object 类，而 Object 的中文意思就是“对象”。</p><p>Object 类中就包含了 <code>hashCode()</code> 方法：</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">native</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">int</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">hashCode</span><span style="color:#F6F6F4;">();</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">native</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">int</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">hashCode</span><span style="color:#24292E;">();</span></span></code></pre></div><p>意味着所有的类都会有一个 <code>hashCode()</code> 方法，该方法会返回一个 int 类型的值。由于 <code>hashCode()</code> 方法是一个<a href="https://tobebetterjavaer.com/oo/native-method.html" target="_blank" rel="noreferrer">本地方法</a>（<code>native</code> 关键字修饰的方法，用 <code>C/C++</code> 语言实现，由 Java 调用），意味着 Object 类中并没有给出具体的实现。</p><p>具体的实现可以参考 <code>jdk/src/hotspot/share/runtime/synchronizer.cpp</code>（源码可以到 <a href="https://github.com/openjdk/jdk/blob/master/src/hotspot/share/runtime/synchronizer.cpp" target="_blank" rel="noreferrer">GitHub 上 OpenJDK 的仓库中下载</a>）。<code>get_next_hash()</code> 方法会根据 hashCode 的取值来决定采用哪一种哈希值的生成策略。</p><img src="'+p+`"><p>Java 9 之后，<code>hashCode()</code> 方法会被 <code>@HotSpotIntrinsicCandidate</code> 注解修饰，表明它在 HotSpot 虚拟机中有一套高效的实现，基于 CPU 指令。</p><p>那大家有没有想过这样一个问题：<strong>为什么 Object 类需要一个 <code>hashCode()</code> 方法呢</strong>？</p><p>在 Java 中，<code>hashCode()</code> 方法的主要作用就是为了配合<a href="https://tobebetterjavaer.com/collection/hashmap.html" target="_blank" rel="noreferrer">哈希表</a>使用的。</p><p>哈希表（Hash Table），也叫散列表，是一种可以通过关键码值（key-value）直接访问的数据结构，它最大的特点就是可以快速实现查找、插入和删除。其中用到的算法叫做哈希，就是把任意长度的输入，变换成固定长度的输出，该输出就是哈希值。像 MD5、SHA1 都用的是哈希算法。</p><p>像 Java 中的 HashSet、Hashtable（注意是小写的 t）、HashMap 都是基于哈希表的具体实现。其中的 <a href="https://tobebetterjavaer.com/collection/hashmap.html" target="_blank" rel="noreferrer">HashMap</a> 就是最典型的代表，不仅面试官经常问，工作中的使用频率也非常的高。</p><p>大家想一下，如果没有哈希表，但又需要这样一个数据结构，它里面存放的数据是不允许重复的，该怎么办呢？</p><p>要不使用 <code>equals()</code> 方法进行逐个比较？这种方案当然是可行的。但如果数据量特别特别大，采用 <code>equals()</code> 方法进行逐个对比的效率肯定很低很低，最好的解决方案就是哈希表。</p><p>拿 HashMap 来说吧。当我们要在它里面添加对象时，先调用这个对象的 <code>hashCode()</code> 方法，得到对应的哈希值，然后将哈希值和对象一起放到 HashMap 中。当我们要再添加一个新的对象时：</p><ul><li>获取对象的哈希值；</li><li>和之前已经存在的哈希值进行比较，如果不相等，直接存进去；</li><li>如果有相等的，再调用 <code>equals()</code> 方法进行对象之间的比较，如果相等，不存了；</li><li>如果不等，说明哈希冲突了，增加一个链表，存放新的对象；</li><li>如果链表的长度大于 8，转为红黑树来处理。</li></ul><p>就这么一套下来，调用 <code>equals()</code> 方法的频率就大大降低了。也就是说，只要哈希算法足够的高效，把发生哈希冲突的频率降到最低，哈希表的效率就特别的高。</p><p>来看一下 HashMap 的哈希算法：</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F286C4;">static</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">final</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">int</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">hash</span><span style="color:#F6F6F4;">(</span><span style="color:#97E1F1;font-style:italic;">Object</span><span style="color:#F6F6F4;"> key) {</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#97E1F1;font-style:italic;">int</span><span style="color:#F6F6F4;"> h;</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">return</span><span style="color:#F6F6F4;"> (key </span><span style="color:#F286C4;">==</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">null</span><span style="color:#F6F6F4;">) </span><span style="color:#F286C4;">?</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">0</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> (h </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> key.</span><span style="color:#62E884;">hashCode</span><span style="color:#F6F6F4;">()) </span><span style="color:#F286C4;">^</span><span style="color:#F6F6F4;"> (h </span><span style="color:#F286C4;">&gt;&gt;&gt;</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">16</span><span style="color:#F6F6F4;">);</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">static</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">final</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">int</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">hash</span><span style="color:#24292E;">(Object key) {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">int</span><span style="color:#24292E;"> h;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> (key </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">null</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">?</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> (h </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> key.</span><span style="color:#6F42C1;">hashCode</span><span style="color:#24292E;">()) </span><span style="color:#D73A49;">^</span><span style="color:#24292E;"> (h </span><span style="color:#D73A49;">&gt;&gt;&gt;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">16</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><p>先调用对象的 <code>hashCode()</code> 方法，然后对该值进行右移运算，然后再进行异或运算。</p><p>通常来说，String 会用来作为 HashMap 的键进行哈希运算，因此我们再来看一下 String 的 <code>hashCode()</code> 方法：</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">int</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">hashCode</span><span style="color:#F6F6F4;">() {</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#97E1F1;font-style:italic;">int</span><span style="color:#F6F6F4;"> h </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> hash;</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">if</span><span style="color:#F6F6F4;"> (h </span><span style="color:#F286C4;">==</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">0</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">&amp;&amp;</span><span style="color:#F6F6F4;"> value.length </span><span style="color:#F286C4;">&gt;</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">0</span><span style="color:#F6F6F4;">) {</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#97E1F1;font-style:italic;">char</span><span style="color:#F6F6F4;"> val[] </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> value;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#F286C4;">for</span><span style="color:#F6F6F4;"> (</span><span style="color:#97E1F1;font-style:italic;">int</span><span style="color:#F6F6F4;"> i </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">0</span><span style="color:#F6F6F4;">; i </span><span style="color:#F286C4;">&lt;</span><span style="color:#F6F6F4;"> value.length; i</span><span style="color:#F286C4;">++</span><span style="color:#F6F6F4;">) {</span></span>
<span class="line"><span style="color:#F6F6F4;">            h </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">31</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">*</span><span style="color:#F6F6F4;"> h </span><span style="color:#F286C4;">+</span><span style="color:#F6F6F4;"> val[i];</span></span>
<span class="line"><span style="color:#F6F6F4;">        }</span></span>
<span class="line"><span style="color:#F6F6F4;">        hash </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> h;</span></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">return</span><span style="color:#F6F6F4;"> h;</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">int</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">hashCode</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">int</span><span style="color:#24292E;"> h </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> hash;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (h </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&amp;&amp;</span><span style="color:#24292E;"> value.length </span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">char</span><span style="color:#24292E;"> val[] </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> value;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">for</span><span style="color:#24292E;"> (</span><span style="color:#D73A49;">int</span><span style="color:#24292E;"> i </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">; i </span><span style="color:#D73A49;">&lt;</span><span style="color:#24292E;"> value.length; i</span><span style="color:#D73A49;">++</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">            h </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">31</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">*</span><span style="color:#24292E;"> h </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> val[i];</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"><span style="color:#24292E;">        hash </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> h;</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> h;</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><p>可想而知，经过这么一系列复杂的运算，再加上 JDK 作者这种大师级别的设计，哈希冲突的概率我相信已经降到了最低（我们在 HashMap 中深入探讨过）。</p><p>当然了，从理论上来说，对于两个不同对象，它们通过 <code>hashCode()</code> 方法计算后的值可能相同。因此，不能使用 <code>hashCode()</code> 方法来判断两个对象是否相等，必须得通过 <code>equals()</code> 方法。</p><p>也就是说：</p><ul><li>如果两个对象调用 <code>equals()</code> 方法得到的结果为 true，调用 <code>hashCode()</code> 方法得到的结果必定相等；</li><li>如果两个对象调用 <code>hashCode()</code> 方法得到的结果不相等，调用 <code>equals()</code> 方法得到的结果必定为 false；</li></ul><p>反之：</p><ul><li>如果两个对象调用 <code>equals()</code> 方法得到的结果为 false，调用 <code>hashCode()</code> 方法得到的结果不一定不相等；</li><li>如果两个对象调用 <code>hashCode()</code> 方法得到的结果相等，调用 <code>equals()</code> 方法得到的结果不一定为 true；</li></ul><p>来看下面这段代码。</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">class</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;">Test</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">static</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">main</span><span style="color:#F6F6F4;">(</span><span style="color:#97E1F1;font-style:italic;">String</span><span style="color:#F6F6F4;">[] </span><span style="color:#FFB86C;font-style:italic;">args</span><span style="color:#F6F6F4;">) {</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#97E1F1;font-style:italic;">Student</span><span style="color:#F6F6F4;"> s1 </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;font-weight:bold;">new</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">Student</span><span style="color:#F6F6F4;">(</span><span style="color:#BF9EEE;">18</span><span style="color:#F6F6F4;">, </span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">张三</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">);</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#97E1F1;font-style:italic;">Map</span><span style="color:#F6F6F4;">&lt;Student, Integer&gt; scores </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;font-weight:bold;">new</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">HashMap</span><span style="color:#F6F6F4;">&lt;&gt;();</span></span>
<span class="line"><span style="color:#F6F6F4;">        scores.</span><span style="color:#62E884;">put</span><span style="color:#F6F6F4;">(s1, </span><span style="color:#BF9EEE;">98</span><span style="color:#F6F6F4;">);</span></span>
<span class="line"><span style="color:#F6F6F4;">        System.out.</span><span style="color:#62E884;">println</span><span style="color:#F6F6F4;">(scores.</span><span style="color:#62E884;">get</span><span style="color:#F6F6F4;">(</span><span style="color:#F286C4;font-weight:bold;">new</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">Student</span><span style="color:#F6F6F4;">(</span><span style="color:#BF9EEE;">18</span><span style="color:#F6F6F4;">, </span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">张三</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">)));</span></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span>
<span class="line"><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">class</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;">Student</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">private</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">int</span><span style="color:#F6F6F4;"> age;</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">private</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">String</span><span style="color:#F6F6F4;"> name;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">     </span><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">Student</span><span style="color:#F6F6F4;">(</span><span style="color:#97E1F1;font-style:italic;">int</span><span style="color:#F6F6F4;"> </span><span style="color:#FFB86C;font-style:italic;">age</span><span style="color:#F6F6F4;">, </span><span style="color:#97E1F1;font-style:italic;">String</span><span style="color:#F6F6F4;"> </span><span style="color:#FFB86C;font-style:italic;">name</span><span style="color:#F6F6F4;">) {</span></span>
<span class="line"><span style="color:#F6F6F4;">         </span><span style="color:#BF9EEE;font-style:italic;">this</span><span style="color:#F6F6F4;">.age </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> age;</span></span>
<span class="line"><span style="color:#F6F6F4;">         </span><span style="color:#BF9EEE;font-style:italic;">this</span><span style="color:#F6F6F4;">.name </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> name;</span></span>
<span class="line"><span style="color:#F6F6F4;">     }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">     @</span><span style="color:#97E1F1;font-style:italic;">Override</span></span>
<span class="line"><span style="color:#F6F6F4;">     </span><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">boolean</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">equals</span><span style="color:#F6F6F4;">(</span><span style="color:#97E1F1;font-style:italic;">Object</span><span style="color:#F6F6F4;"> </span><span style="color:#FFB86C;font-style:italic;">o</span><span style="color:#F6F6F4;">) {</span></span>
<span class="line"><span style="color:#F6F6F4;">         </span><span style="color:#97E1F1;font-style:italic;">Student</span><span style="color:#F6F6F4;"> student </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> (Student) o;</span></span>
<span class="line"><span style="color:#F6F6F4;">         </span><span style="color:#F286C4;">return</span><span style="color:#F6F6F4;"> age </span><span style="color:#F286C4;">==</span><span style="color:#F6F6F4;"> student.age </span><span style="color:#F286C4;">&amp;&amp;</span></span>
<span class="line"><span style="color:#F6F6F4;">                 Objects.</span><span style="color:#62E884;">equals</span><span style="color:#F6F6F4;">(name, student.name);</span></span>
<span class="line"><span style="color:#F6F6F4;">     }</span></span>
<span class="line"><span style="color:#F6F6F4;"> }</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Test</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">static</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">main</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">String</span><span style="color:#24292E;">[] </span><span style="color:#E36209;">args</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">        Student s1 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Student</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">18</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;张三&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">        Map&lt;</span><span style="color:#D73A49;">Student</span><span style="color:#24292E;">, </span><span style="color:#D73A49;">Integer</span><span style="color:#24292E;">&gt; scores </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> HashMap&lt;&gt;();</span></span>
<span class="line"><span style="color:#24292E;">        scores.</span><span style="color:#6F42C1;">put</span><span style="color:#24292E;">(s1, </span><span style="color:#005CC5;">98</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">        System.out.</span><span style="color:#6F42C1;">println</span><span style="color:#24292E;">(scores.</span><span style="color:#6F42C1;">get</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Student</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">18</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;张三&quot;</span><span style="color:#24292E;">)));</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Student</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">int</span><span style="color:#24292E;"> age;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> String name;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">     </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Student</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">int</span><span style="color:#24292E;"> </span><span style="color:#E36209;">age</span><span style="color:#24292E;">, String </span><span style="color:#E36209;">name</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">         </span><span style="color:#005CC5;">this</span><span style="color:#24292E;">.age </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> age;</span></span>
<span class="line"><span style="color:#24292E;">         </span><span style="color:#005CC5;">this</span><span style="color:#24292E;">.name </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> name;</span></span>
<span class="line"><span style="color:#24292E;">     }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">     @</span><span style="color:#D73A49;">Override</span></span>
<span class="line"><span style="color:#24292E;">     </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">boolean</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">equals</span><span style="color:#24292E;">(Object </span><span style="color:#E36209;">o</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">         Student student </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> (Student) o;</span></span>
<span class="line"><span style="color:#24292E;">         </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> age </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> student.age </span><span style="color:#D73A49;">&amp;&amp;</span></span>
<span class="line"><span style="color:#24292E;">                 Objects.</span><span style="color:#6F42C1;">equals</span><span style="color:#24292E;">(name, student.name);</span></span>
<span class="line"><span style="color:#24292E;">     }</span></span>
<span class="line"><span style="color:#24292E;"> }</span></span></code></pre></div><p>我们重写了 Student 类的 <code>equals()</code> 方法，如果两个学生的年纪和姓名相同，我们就认为是同一个学生，虽然很离谱，但我们就是这么草率。</p><p>在 <code>main()</code> 方法中，18 岁的张三考试得了 98 分，很不错的成绩，我们把张三和成绩放到了 HashMap 中，然后准备输出张三的成绩：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#f6f6f4;">null</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">null</span></span></code></pre></div><p>很不巧，结果为 null，而不是预期当中的 98。这是为什么呢？</p><p>原因就在于重写 <code>equals()</code> 方法的时候没有重写 <code>hashCode()</code> 方法。默认情况下，<code>hashCode()</code> 方法是一个本地方法，会返回对象的存储地址，显然 <code>put()</code> 中的 s1 和 <code>get()</code> 中的 <code>new Student(18, &quot;张三&quot;)</code> 是两个对象，它们的存储地址肯定是不同的。</p><p>HashMap 的 <code>get()</code> 方法会调用 <code>hash(key.hashCode())</code> 计算对象的哈希值，虽然两个不同的 <code>hashCode()</code> 结果经过 <code>hash()</code> 方法计算后有可能得到相同的结果，但这种概率微乎其微，所以就导致 <code>scores.get(new Student(18, &quot;张三&quot;))</code> 无法得到预期的值 18。</p><p>怎么解决这个问题呢？很简单，重写 <code>hashCode()</code> 方法。</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Override</span></span>
<span class="line"><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">int</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">hashCode</span><span style="color:#F6F6F4;">() {</span></span>
<span class="line"><span style="color:#F6F6F4;">     </span><span style="color:#F286C4;">return</span><span style="color:#F6F6F4;"> Objects.</span><span style="color:#62E884;">hash</span><span style="color:#F6F6F4;">(age, name);</span></span>
<span class="line"><span style="color:#F6F6F4;"> }</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Override</span></span>
<span class="line"><span style="color:#24292E;"> </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">int</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">hashCode</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">     </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> Objects.</span><span style="color:#6F42C1;">hash</span><span style="color:#24292E;">(age, name);</span></span>
<span class="line"><span style="color:#24292E;"> }</span></span></code></pre></div><p><a href="https://tobebetterjavaer.com/common-tool/Objects.html" target="_blank" rel="noreferrer">Objects 类</a>的 <code>hash()</code> 方法可以针对不同数量的参数生成新的 <code>hashCode()</code> 值。</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">static</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">int</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">hashCode</span><span style="color:#F6F6F4;">(</span><span style="color:#97E1F1;font-style:italic;">Object</span><span style="color:#F6F6F4;"> a[]) {</span></span>
<span class="line"><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">if</span><span style="color:#F6F6F4;"> (a </span><span style="color:#F286C4;">==</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">null</span><span style="color:#F6F6F4;">)</span></span>
<span class="line"><span style="color:#F6F6F4;">     </span><span style="color:#F286C4;">return</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">0</span><span style="color:#F6F6F4;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">int</span><span style="color:#F6F6F4;"> result </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">1</span><span style="color:#F6F6F4;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">for</span><span style="color:#F6F6F4;"> (</span><span style="color:#97E1F1;font-style:italic;">Object</span><span style="color:#F6F6F4;"> element </span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> a)</span></span>
<span class="line"><span style="color:#F6F6F4;">     result </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">31</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">*</span><span style="color:#F6F6F4;"> result </span><span style="color:#F286C4;">+</span><span style="color:#F6F6F4;"> (element </span><span style="color:#F286C4;">==</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">null</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">?</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">0</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> element.</span><span style="color:#62E884;">hashCode</span><span style="color:#F6F6F4;">());</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">return</span><span style="color:#F6F6F4;"> result;</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">static</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">int</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">hashCode</span><span style="color:#24292E;">(Object a[]) {</span></span>
<span class="line"><span style="color:#24292E;"> </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (a </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">null</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">     </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;"> </span><span style="color:#D73A49;">int</span><span style="color:#24292E;"> result </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;"> </span><span style="color:#D73A49;">for</span><span style="color:#24292E;"> (Object element </span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> a)</span></span>
<span class="line"><span style="color:#24292E;">     result </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">31</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">*</span><span style="color:#24292E;"> result </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> (element </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">null</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">?</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> element.</span><span style="color:#6F42C1;">hashCode</span><span style="color:#24292E;">());</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;"> </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> result;</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><p>代码似乎很简单，归纳出的数学公式如下所示（n 为字符串长度）。</p><img src="`+o+`"><p>注意：31 是个奇质数，不大不小，一般质数都非常适合哈希计算，偶数相当于移位运算，容易溢出，造成数据信息丢失。</p><p>这就意味着年纪和姓名相同的情况下，会得到相同的哈希值。<code>scores.get(new Student(18, &quot;张三&quot;))</code> 就会返回 98 的预期值了。</p><p>《Java 编程思想》这本圣经中有一段话，对 <code>hashCode()</code> 方法进行了一段描述。</p><blockquote><p>设计 <code>hashCode()</code> 时最重要的因素就是：无论何时，对同一个对象调用 <code>hashCode()</code> 都应该生成同样的值。如果在将一个对象用 <code>put()</code> 方法添加进 HashMap 时产生一个 <code>hashCode()</code> 值，而用 <code>get()</code> 方法取出时却产生了另外一个 <code>hashCode()</code> 值，那么就无法重新取得该对象了。所以，如果你的 <code>hashCode()</code> 方法依赖于对象中易变的数据，用户就要当心了，因为此数据发生变化时，<code>hashCode()</code> 就会生成一个不同的哈希值，相当于产生了一个不同的键。</p></blockquote><p>也就是说，如果在重写 <code>hashCode()</code> 和 <code>equals()</code> 方法时，对象中某个字段容易发生改变，那么最好舍弃这些字段，以免产生不可预期的结果。</p><p>好。有了上面这些内容作为基础后，我们回头再来看看本地方法 <code>hashCode()</code> 的 C++ 源码。</p><div class="language-cpp vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F286C4;">static</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">inline</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">intptr_t</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">get_next_hash</span><span style="color:#F6F6F4;">(</span><span style="color:#97E1F1;font-style:italic;">Thread</span><span style="color:#F286C4;">*</span><span style="color:#F6F6F4;"> </span><span style="color:#FFB86C;font-style:italic;">current</span><span style="color:#F6F6F4;">, </span><span style="color:#97E1F1;font-style:italic;">oop</span><span style="color:#F6F6F4;"> </span><span style="color:#FFB86C;font-style:italic;">obj</span><span style="color:#F6F6F4;">) {</span></span>
<span class="line"><span style="color:#F6F6F4;">  </span><span style="color:#F286C4;">intptr_t</span><span style="color:#F6F6F4;"> value </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">0</span><span style="color:#F6F6F4;">;</span></span>
<span class="line"><span style="color:#F6F6F4;">  </span><span style="color:#F286C4;">if</span><span style="color:#F6F6F4;"> (hashCode </span><span style="color:#F286C4;">==</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">0</span><span style="color:#F6F6F4;">) {</span></span>
<span class="line"><span style="color:#7B7F8B;">    // 这种形式使用全局的 Park-Miller 随机数生成器。</span></span>
<span class="line"><span style="color:#7B7F8B;">    // 在 MP 系统上，我们将对全局变量进行大量的读写访问，因此该机制会引发大量的一致性通信。</span></span>
<span class="line"><span style="color:#F6F6F4;">    value </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> os</span><span style="color:#F286C4;">::</span><span style="color:#62E884;">random</span><span style="color:#F6F6F4;">();</span></span>
<span class="line"><span style="color:#F6F6F4;">  } </span><span style="color:#F286C4;">else</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">if</span><span style="color:#F6F6F4;"> (hashCode </span><span style="color:#F286C4;">==</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">1</span><span style="color:#F6F6F4;">) {</span></span>
<span class="line"><span style="color:#7B7F8B;">    // 这种变体在 STW（Stop The World）操作之间具有稳定（幂等）的特性。</span></span>
<span class="line"><span style="color:#7B7F8B;">    // 在一些 1-0 同步方案中，这可能很有用。</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">intptr_t</span><span style="color:#F6F6F4;"> addr_bits </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">cast_from_oop</span><span style="color:#F6F6F4;">&lt;</span><span style="color:#F286C4;">intptr_t</span><span style="color:#F6F6F4;">&gt;(obj) </span><span style="color:#F286C4;">&gt;&gt;</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">3</span><span style="color:#F6F6F4;">;</span></span>
<span class="line"><span style="color:#F6F6F4;">    value </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> addr_bits </span><span style="color:#F286C4;">^</span><span style="color:#F6F6F4;"> (addr_bits </span><span style="color:#F286C4;">&gt;&gt;</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">5</span><span style="color:#F6F6F4;">) </span><span style="color:#F286C4;">^</span><span style="color:#F6F6F4;"> GVars.stw_random;</span></span>
<span class="line"><span style="color:#F6F6F4;">  } </span><span style="color:#F286C4;">else</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">if</span><span style="color:#F6F6F4;"> (hashCode </span><span style="color:#F286C4;">==</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">2</span><span style="color:#F6F6F4;">) {</span></span>
<span class="line"><span style="color:#F6F6F4;">    value </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">1</span><span style="color:#F6F6F4;">;</span><span style="color:#7B7F8B;">            // 用于敏感性测试</span></span>
<span class="line"><span style="color:#F6F6F4;">  } </span><span style="color:#F286C4;">else</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">if</span><span style="color:#F6F6F4;"> (hashCode </span><span style="color:#F286C4;">==</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">3</span><span style="color:#F6F6F4;">) {</span></span>
<span class="line"><span style="color:#F6F6F4;">    value </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">++</span><span style="color:#F6F6F4;">GVars.hc_sequence;</span></span>
<span class="line"><span style="color:#F6F6F4;">  } </span><span style="color:#F286C4;">else</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">if</span><span style="color:#F6F6F4;"> (hashCode </span><span style="color:#F286C4;">==</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">4</span><span style="color:#F6F6F4;">) {</span></span>
<span class="line"><span style="color:#F6F6F4;">    value </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">cast_from_oop</span><span style="color:#F6F6F4;">&lt;</span><span style="color:#F286C4;">intptr_t</span><span style="color:#F6F6F4;">&gt;(obj);</span></span>
<span class="line"><span style="color:#F6F6F4;">  } </span><span style="color:#F286C4;">else</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#7B7F8B;">    // Marsaglia 的异或移位方案，具有线程特定的状态</span></span>
<span class="line"><span style="color:#7B7F8B;">    // 这可能是最好的整体实现 -- 我们可能会在未来的版本中将其设为默认实现。</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">unsigned</span><span style="color:#F6F6F4;"> t </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> current</span><span style="color:#F286C4;">-&gt;</span><span style="color:#F6F6F4;">_hashStateX;</span></span>
<span class="line"><span style="color:#F6F6F4;">    t </span><span style="color:#F286C4;">^=</span><span style="color:#F6F6F4;"> (t </span><span style="color:#F286C4;">&lt;&lt;</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">11</span><span style="color:#F6F6F4;">);</span></span>
<span class="line"><span style="color:#F6F6F4;">    current</span><span style="color:#F286C4;">-&gt;</span><span style="color:#F6F6F4;">_hashStateX </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> current</span><span style="color:#F286C4;">-&gt;</span><span style="color:#F6F6F4;">_hashStateY;</span></span>
<span class="line"><span style="color:#F6F6F4;">    current</span><span style="color:#F286C4;">-&gt;</span><span style="color:#F6F6F4;">_hashStateY </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> current</span><span style="color:#F286C4;">-&gt;</span><span style="color:#F6F6F4;">_hashStateZ;</span></span>
<span class="line"><span style="color:#F6F6F4;">    current</span><span style="color:#F286C4;">-&gt;</span><span style="color:#F6F6F4;">_hashStateZ </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> current</span><span style="color:#F286C4;">-&gt;</span><span style="color:#F6F6F4;">_hashStateW;</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">unsigned</span><span style="color:#F6F6F4;"> v </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> current</span><span style="color:#F286C4;">-&gt;</span><span style="color:#F6F6F4;">_hashStateW;</span></span>
<span class="line"><span style="color:#F6F6F4;">    v </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> (v </span><span style="color:#F286C4;">^</span><span style="color:#F6F6F4;"> (v </span><span style="color:#F286C4;">&gt;&gt;</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">19</span><span style="color:#F6F6F4;">)) </span><span style="color:#F286C4;">^</span><span style="color:#F6F6F4;"> (t </span><span style="color:#F286C4;">^</span><span style="color:#F6F6F4;"> (t </span><span style="color:#F286C4;">&gt;&gt;</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">8</span><span style="color:#F6F6F4;">));</span></span>
<span class="line"><span style="color:#F6F6F4;">    current</span><span style="color:#F286C4;">-&gt;</span><span style="color:#F6F6F4;">_hashStateW </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> v;</span></span>
<span class="line"><span style="color:#F6F6F4;">    value </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> v;</span></span>
<span class="line"><span style="color:#F6F6F4;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">  value </span><span style="color:#F286C4;">&amp;=</span><span style="color:#F6F6F4;"> markWord</span><span style="color:#F286C4;">::</span><span style="color:#F6F6F4;">hash_mask;</span></span>
<span class="line"><span style="color:#F6F6F4;">  </span><span style="color:#F286C4;">if</span><span style="color:#F6F6F4;"> (value </span><span style="color:#F286C4;">==</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">0</span><span style="color:#F6F6F4;">) value </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">0x</span><span style="color:#BF9EEE;">BAD</span><span style="color:#F6F6F4;">;</span></span>
<span class="line"><span style="color:#F6F6F4;">  </span><span style="color:#62E884;">assert</span><span style="color:#F6F6F4;">(value </span><span style="color:#F286C4;">!=</span><span style="color:#F6F6F4;"> markWord</span><span style="color:#F286C4;">::</span><span style="color:#F6F6F4;">no_hash, </span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">invariant</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">);</span></span>
<span class="line"><span style="color:#F6F6F4;">  </span><span style="color:#F286C4;">return</span><span style="color:#F6F6F4;"> value;</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">static</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">inline</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">intptr_t</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">get_next_hash</span><span style="color:#24292E;">(</span><span style="color:#6F42C1;">Thread</span><span style="color:#D73A49;">*</span><span style="color:#24292E;"> </span><span style="color:#E36209;">current</span><span style="color:#24292E;">, </span><span style="color:#6F42C1;">oop</span><span style="color:#24292E;"> </span><span style="color:#E36209;">obj</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">intptr_t</span><span style="color:#24292E;"> value </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (hashCode </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#6A737D;">    // 这种形式使用全局的 Park-Miller 随机数生成器。</span></span>
<span class="line"><span style="color:#6A737D;">    // 在 MP 系统上，我们将对全局变量进行大量的读写访问，因此该机制会引发大量的一致性通信。</span></span>
<span class="line"><span style="color:#24292E;">    value </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">os</span><span style="color:#24292E;">::</span><span style="color:#6F42C1;">random</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">  } </span><span style="color:#D73A49;">else</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (hashCode </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#6A737D;">    // 这种变体在 STW（Stop The World）操作之间具有稳定（幂等）的特性。</span></span>
<span class="line"><span style="color:#6A737D;">    // 在一些 1-0 同步方案中，这可能很有用。</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">intptr_t</span><span style="color:#24292E;"> addr_bits </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">cast_from_oop</span><span style="color:#24292E;">&lt;</span><span style="color:#D73A49;">intptr_t</span><span style="color:#24292E;">&gt;(obj) </span><span style="color:#D73A49;">&gt;&gt;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">3</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">    value </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> addr_bits </span><span style="color:#D73A49;">^</span><span style="color:#24292E;"> (addr_bits </span><span style="color:#D73A49;">&gt;&gt;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">5</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">^</span><span style="color:#24292E;"> GVars.stw_random;</span></span>
<span class="line"><span style="color:#24292E;">  } </span><span style="color:#D73A49;">else</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (hashCode </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">2</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">    value </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">;</span><span style="color:#6A737D;">            // 用于敏感性测试</span></span>
<span class="line"><span style="color:#24292E;">  } </span><span style="color:#D73A49;">else</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (hashCode </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">3</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">    value </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">++</span><span style="color:#24292E;">GVars.hc_sequence;</span></span>
<span class="line"><span style="color:#24292E;">  } </span><span style="color:#D73A49;">else</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (hashCode </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">    value </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">cast_from_oop</span><span style="color:#24292E;">&lt;</span><span style="color:#D73A49;">intptr_t</span><span style="color:#24292E;">&gt;(obj);</span></span>
<span class="line"><span style="color:#24292E;">  } </span><span style="color:#D73A49;">else</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#6A737D;">    // Marsaglia 的异或移位方案，具有线程特定的状态</span></span>
<span class="line"><span style="color:#6A737D;">    // 这可能是最好的整体实现 -- 我们可能会在未来的版本中将其设为默认实现。</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">unsigned</span><span style="color:#24292E;"> t </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> current-&gt;_hashStateX;</span></span>
<span class="line"><span style="color:#24292E;">    t </span><span style="color:#D73A49;">^=</span><span style="color:#24292E;"> (t </span><span style="color:#D73A49;">&lt;&lt;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">11</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    current-&gt;_hashStateX </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> current-&gt;_hashStateY;</span></span>
<span class="line"><span style="color:#24292E;">    current-&gt;_hashStateY </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> current-&gt;_hashStateZ;</span></span>
<span class="line"><span style="color:#24292E;">    current-&gt;_hashStateZ </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> current-&gt;_hashStateW;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">unsigned</span><span style="color:#24292E;"> v </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> current-&gt;_hashStateW;</span></span>
<span class="line"><span style="color:#24292E;">    v </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> (v </span><span style="color:#D73A49;">^</span><span style="color:#24292E;"> (v </span><span style="color:#D73A49;">&gt;&gt;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">19</span><span style="color:#24292E;">)) </span><span style="color:#D73A49;">^</span><span style="color:#24292E;"> (t </span><span style="color:#D73A49;">^</span><span style="color:#24292E;"> (t </span><span style="color:#D73A49;">&gt;&gt;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">8</span><span style="color:#24292E;">));</span></span>
<span class="line"><span style="color:#24292E;">    current-&gt;_hashStateW </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> v;</span></span>
<span class="line"><span style="color:#24292E;">    value </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> v;</span></span>
<span class="line"><span style="color:#24292E;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">  value </span><span style="color:#D73A49;">&amp;=</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">markWord</span><span style="color:#24292E;">::hash_mask;</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (value </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">) value </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">0x</span><span style="color:#005CC5;">BAD</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">assert</span><span style="color:#24292E;">(value </span><span style="color:#D73A49;">!=</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">markWord</span><span style="color:#24292E;">::no_hash, </span><span style="color:#032F62;">&quot;invariant&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> value;</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><p>如果没有 C++ 基础的话，不用细致去看每一行代码，我们只通过表面去了解一下 <code>get_next_hash()</code> 这个方法就行。其中的 <code>hashCode</code> 变量是 JVM 启动时的一个全局参数，可以通过它来切换哈希值的生成策略。</p><ul><li><code>hashCode==0</code>，调用操作系统 OS 的 <code>random()</code> 方法返回随机数。</li><li><code>hashCode == 1</code>，在 STW（stop-the-world）操作中，这种策略通常用于同步方案中。利用对象地址进行计算，使用不经常更新的随机数（<code>GVars.stw_random</code>）参与其中。</li><li><code>hashCode == 2</code>，使用返回 1，用于某些情况下的测试。</li><li><code>hashCode == 3</code>，从 0 开始计算哈希值，不是线程安全的，多个线程可能会得到相同的哈希值。</li><li><code>hashCode == 4</code>，与创建对象的内存位置有关，原样输出。</li><li><code>hashCode == 5</code>，默认值，支持多线程，使用了 Marsaglia 的 xor-shift 算法产生伪随机数。所谓的 xor-shift 算法，简单来说，看起来就是一个移位寄存器，每次移入的位由寄存器中若干位取异或生成。所谓的伪随机数，不是完全随机的，但是真随机生成比较困难，所以只要能通过一定的随机数统计检测，就可以当作真随机数来使用。</li></ul><p>这里简单总结下。</p><p>在 Java 中，<code>hashCode()</code>方法是定义在 <code>java.lang.Object</code> 类中的一个方法，该类是所有 Java 所有类的父类。因此，每个 Java 对象都可以调用 <code>hashCode()</code>方法。<code>hashCode()</code>方法主要用于支持哈希表（如 java.util.HashMap），这些数据结构使用哈希算法能实现快速查找、插入和删除操作。</p><p><code>hashCode()</code>方法的主要目的是返回一个整数，这个整数称为哈希码，它代表了对象在内存中的一种近似表示。哈希码用于将对象映射到哈希表中的一个特定的位置。两个相等的对象（根据 <a href="https://tobebetterjavaer.com/string/equals.html" target="_blank" rel="noreferrer"><code>equals()</code>方法比较</a>）应该具有相同的哈希码。然而，具有相同哈希码的两个对象并不一定相等。</p><p>当你创建一个自定义类并覆盖 <code>equals()</code>方法时，通常也需要覆盖 <code>hashCode()</code>方法，以确保相等的对象具有相同的哈希码。这有助于提高哈希表在使用自定义类的对象作为键时的准确性。</p><hr><p>最近整理了一份牛逼的学习资料，包括但不限于 Java 基础部分（JVM、Java 集合框架、多线程），还囊括了 <strong>数据库、计算机网络、算法与数据结构、设计模式、框架类 Spring、Netty、微服务（Dubbo，消息队列） 网关</strong> 等等等等……详情戳：<a href="https://tobebetterjavaer.com/pdf/programmer-111.html" target="_blank" rel="noreferrer">可以说是 2022 年全网最全的学习和找工作的 PDF 资源了</a></p>`,57),c=[t];function r(F,y,i,E,d,h){return a(),n("div",null,c)}const A=s(e,[["render",r]]);export{u as __pageData,A as default};
