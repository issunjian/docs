import{_ as s,o as n,c as a,V as l}from"./chunks/framework.c6d8cbec.js";const g=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[],"relativePath":"backend/spring-boot/äº‹åŠ¡AOP.md","filePath":"backend/spring-boot/äº‹åŠ¡AOP.md"}'),p={name:"backend/spring-boot/äº‹åŠ¡AOP.md"},o=l(`<h2 id="äº‹åŠ¡-aop" tabindex="-1">äº‹åŠ¡&amp;AOP <a class="header-anchor" href="#äº‹åŠ¡-aop" aria-label="Permalink to &quot;äº‹åŠ¡&amp;AOP&quot;">â€‹</a></h2><h2 id="ä»Šæ—¥ç›®æ ‡" tabindex="-1">ä»Šæ—¥ç›®æ ‡ <a class="header-anchor" href="#ä»Šæ—¥ç›®æ ‡" aria-label="Permalink to &quot;ä»Šæ—¥ç›®æ ‡&quot;">â€‹</a></h2><p>ç›®æ ‡</p><ul><li>èƒ½å¤ŸæŒæ¡ Spring äº‹åŠ¡é…ç½® â¤ï¸ ğŸ</li><li>èƒ½å¤Ÿç†è§£ AOP çš„ä½œç”¨ ğŸ â¤ï¸</li><li>èƒ½å¤Ÿå®Œæˆ AOP çš„å…¥é—¨æ¡ˆä¾‹ âœï¸</li><li>èƒ½å¤Ÿç†è§£ AOP çš„å·¥ä½œæµç¨‹ ğŸ</li><li>èƒ½å¤Ÿè¯´å‡º AOP çš„äº”ç§é€šçŸ¥ç±»å‹ ğŸ</li></ul><h2 id="_1-äº‹åŠ¡ç®¡ç†" tabindex="-1">1. äº‹åŠ¡ç®¡ç† <a class="header-anchor" href="#_1-äº‹åŠ¡ç®¡ç†" aria-label="Permalink to &quot;1\\. äº‹åŠ¡ç®¡ç†&quot;">â€‹</a></h2><h3 id="_1-1-äº‹åŠ¡å›é¡¾" tabindex="-1">1.1 äº‹åŠ¡å›é¡¾ <a class="header-anchor" href="#_1-1-äº‹åŠ¡å›é¡¾" aria-label="Permalink to &quot;1.1 äº‹åŠ¡å›é¡¾&quot;">â€‹</a></h3><p>äº‹åŠ¡</p><p><strong>äº‹åŠ¡</strong>æ˜¯ä¸€ç»„æ“ä½œçš„é›†åˆï¼Œå®ƒæ˜¯ä¸€ä¸ªä¸å¯åˆ†å‰²çš„å·¥ä½œå•ä½ã€‚äº‹åŠ¡ä¼šæŠŠæ‰€æœ‰çš„æ“ä½œä½œä¸ºä¸€ä¸ªæ•´ä½“ï¼Œä¸€èµ·å‘æ•°æ®åº“æäº¤æˆ–è€…æ˜¯æ’¤é”€æ“ä½œè¯·æ±‚ã€‚æ‰€ä»¥è¿™ç»„æ“ä½œ<strong>è¦ä¹ˆåŒæ—¶æˆåŠŸï¼Œè¦ä¹ˆåŒæ—¶å¤±è´¥</strong>ã€‚</p><p><strong>äº‹åŠ¡çš„æ“ä½œä¸»è¦æœ‰ä¸‰æ­¥ï¼š</strong></p><ol><li>å¼€å¯äº‹åŠ¡ï¼ˆä¸€ç»„æ“ä½œå¼€å§‹å‰ï¼Œå¼€å¯äº‹åŠ¡ï¼‰ï¼šstart transaction / begin ;</li><li>æäº¤äº‹åŠ¡ï¼ˆè¿™ç»„æ“ä½œå…¨éƒ¨æˆåŠŸåï¼Œæäº¤äº‹åŠ¡ï¼‰ï¼šcommit ;</li><li>å›æ»šäº‹åŠ¡ï¼ˆä¸­é—´ä»»ä½•ä¸€ä¸ªæ“ä½œå‡ºç°å¼‚å¸¸ï¼Œå›æ»šäº‹åŠ¡ï¼‰ï¼šrollback ;</li></ol><h3 id="_1-2-springäº‹åŠ¡ç®¡ç†-ğŸ-â¤ï¸" tabindex="-1">1.2 Springäº‹åŠ¡ç®¡ç† ğŸ â¤ï¸ <a class="header-anchor" href="#_1-2-springäº‹åŠ¡ç®¡ç†-ğŸ-â¤ï¸" aria-label="Permalink to &quot;1.2 Springäº‹åŠ¡ç®¡ç† ğŸ â¤ï¸&quot;">â€‹</a></h3><p>ç›®æ ‡ğŸ¯ ï¼š<strong>Springä¸‹è¿›è¡Œäº‹åŠ¡ç®¡ç†</strong></p><p>é—®é¢˜</p><ol><li><strong>@Transactional</strong>æ³¨è§£çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿå¯ä»¥å†™åœ¨ä»€ä¹ˆä½ç½®ï¼Ÿ</li></ol><p>ç‚¹å‡»æŸ¥çœ‹</p><p><strong>@Transactionalä½œç”¨</strong>ï¼šå°±æ˜¯åœ¨<strong>å½“å‰è¿™ä¸ªæ–¹æ³•</strong>æ‰§è¡Œå¼€å§‹ä¹‹å‰æ¥å¼€å¯äº‹åŠ¡ï¼Œ<strong>æ–¹æ³•æ‰§è¡Œå®Œæ¯•ä¹‹åæäº¤äº‹åŠ¡</strong>ã€‚å¦‚æœåœ¨è¿™ä¸ªæ–¹æ³•æ‰§è¡Œçš„è¿‡ç¨‹å½“ä¸­å‡ºç°äº†<strong>å¼‚å¸¸</strong>ï¼Œå°±ä¼šè¿›è¡Œäº‹åŠ¡çš„<strong>å›æ»šæ“ä½œ</strong>ã€‚</p><p><strong>@Transactionalæ³¨è§£</strong>ï¼šæˆ‘ä»¬ä¸€èˆ¬ä¼šåœ¨<strong>ä¸šåŠ¡å±‚(serviceåŒ…)<strong>å½“ä¸­æ¥æ§åˆ¶äº‹åŠ¡ï¼Œå› ä¸ºåœ¨ä¸šåŠ¡å±‚å½“ä¸­ï¼Œä¸€ä¸ªä¸šåŠ¡åŠŸèƒ½å¯èƒ½ä¼šåŒ…å«</strong>å¤šä¸ªæ•°æ®è®¿é—®çš„æ“ä½œ(å¤šæ¡sqlè¯­å¥)</strong>ã€‚åœ¨ä¸šåŠ¡å±‚æ¥æ§åˆ¶äº‹åŠ¡ï¼Œæˆ‘ä»¬å°±å¯ä»¥å°†å¤šä¸ªæ•°æ®è®¿é—®æ“ä½œæ§åˆ¶åœ¨ä¸€ä¸ªäº‹åŠ¡èŒƒå›´å†…ã€‚</p><p><strong>@Transactionalæ³¨è§£ä¹¦å†™ä½ç½®ï¼š</strong></p><ul><li>æ–¹æ³• <ul><li><strong>å½“å‰æ–¹æ³•</strong>äº¤ç»™springè¿›è¡Œäº‹åŠ¡ç®¡ç†</li></ul></li><li>ç±» <ul><li><strong>å½“å‰ç±»ä¸­æ‰€æœ‰çš„æ–¹æ³•</strong>éƒ½äº¤ç”±springè¿›è¡Œäº‹åŠ¡ç®¡ç†</li></ul></li><li>æ¥å£ <ul><li>æ¥å£ä¸‹<strong>æ‰€æœ‰çš„å®ç°ç±»</strong>å½“ä¸­æ‰€æœ‰çš„æ–¹æ³•éƒ½äº¤ç»™spring è¿›è¡Œäº‹åŠ¡ç®¡ç†</li></ul></li></ul><h4 id="_1-2-1-äº‹ç‰©æ¡ˆä¾‹-å‡†å¤‡ä»£ç " tabindex="-1">1.2.1 äº‹ç‰©æ¡ˆä¾‹_å‡†å¤‡ä»£ç  <a class="header-anchor" href="#_1-2-1-äº‹ç‰©æ¡ˆä¾‹-å‡†å¤‡ä»£ç " aria-label="Permalink to &quot;1.2.1 äº‹ç‰©æ¡ˆä¾‹\\_å‡†å¤‡ä»£ç &quot;">â€‹</a></h4><p>ç›®æ ‡ğŸ¯ ï¼š<strong>äº‹åŠ¡ç®¡ç†æ¡ˆä¾‹ï¼šè§£æ•£éƒ¨é—¨ ï¼ˆè§£æ•£éƒ¨é—¨å°±æ˜¯åˆ é™¤éƒ¨é—¨ï¼‰</strong></p><p>éœ€æ±‚</p><p><strong>éœ€æ±‚</strong>ï¼šå½“éƒ¨é—¨è§£æ•£äº†ä¸ä»…éœ€è¦æŠŠéƒ¨é—¨ä¿¡æ¯åˆ é™¤äº†ï¼Œè¿˜éœ€è¦æŠŠè¯¥éƒ¨é—¨ä¸‹çš„å‘˜å·¥æ•°æ®ä¹Ÿåˆ é™¤äº†ã€‚</p><p><strong>æ­¥éª¤ï¼š</strong></p><ul><li>æ ¹æ®IDåˆ é™¤éƒ¨é—¨æ•°æ®</li><li>æ ¹æ®éƒ¨é—¨IDåˆ é™¤è¯¥éƒ¨é—¨ä¸‹çš„å‘˜å·¥</li></ul><p><strong>ä»£ç å®ç°ï¼š</strong> ğŸ‘‡ ğŸ‘‡</p><ol><li>DeptServiceImpl</li></ol><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Slf4j</span></span>
<span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Service</span></span>
<span class="line"><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">class</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;">DeptServiceImpl</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">implements</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">DeptService</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Autowired</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">private</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">DeptMapper</span><span style="color:#F6F6F4;"> deptMapper;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Autowired</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">private</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">EmpMapper</span><span style="color:#F6F6F4;"> empMapper;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#7B7F8B;">//æ ¹æ®éƒ¨é—¨idï¼Œåˆ é™¤éƒ¨é—¨ä¿¡æ¯åŠéƒ¨é—¨ä¸‹çš„æ‰€æœ‰å‘˜å·¥</span></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Override</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">delete</span><span style="color:#F6F6F4;">(</span><span style="color:#97E1F1;font-style:italic;">Integer</span><span style="color:#F6F6F4;"> </span><span style="color:#FFB86C;font-style:italic;">id</span><span style="color:#F6F6F4;">){</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#7B7F8B;">//æ ¹æ®éƒ¨é—¨idåˆ é™¤éƒ¨é—¨ä¿¡æ¯</span></span>
<span class="line"><span style="color:#F6F6F4;">        deptMapper.</span><span style="color:#62E884;">deleteById</span><span style="color:#F6F6F4;">(id);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#7B7F8B;">//åˆ é™¤éƒ¨é—¨ä¸‹çš„æ‰€æœ‰å‘˜å·¥ä¿¡æ¯</span></span>
<span class="line"><span style="color:#F6F6F4;">        empMapper.</span><span style="color:#62E884;">deleteByDeptId</span><span style="color:#F6F6F4;">(id);   </span></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Slf4j</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Service</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">DeptServiceImpl</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">implements</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">DeptService</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Autowired</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> DeptMapper deptMapper;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Autowired</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> EmpMapper empMapper;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//æ ¹æ®éƒ¨é—¨idï¼Œåˆ é™¤éƒ¨é—¨ä¿¡æ¯åŠéƒ¨é—¨ä¸‹çš„æ‰€æœ‰å‘˜å·¥</span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Override</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">delete</span><span style="color:#24292E;">(Integer </span><span style="color:#E36209;">id</span><span style="color:#24292E;">){</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">//æ ¹æ®éƒ¨é—¨idåˆ é™¤éƒ¨é—¨ä¿¡æ¯</span></span>
<span class="line"><span style="color:#24292E;">        deptMapper.</span><span style="color:#6F42C1;">deleteById</span><span style="color:#24292E;">(id);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">//åˆ é™¤éƒ¨é—¨ä¸‹çš„æ‰€æœ‰å‘˜å·¥ä¿¡æ¯</span></span>
<span class="line"><span style="color:#24292E;">        empMapper.</span><span style="color:#6F42C1;">deleteByDeptId</span><span style="color:#24292E;">(id);   </span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><ol start="2"><li>DeptMapper</li></ol><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Mapper</span></span>
<span class="line"><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">interface</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;">DeptMapper</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#7B7F8B;">    /**</span></span>
<span class="line"><span style="color:#7B7F8B;">     * æ ¹æ®idåˆ é™¤éƒ¨é—¨ä¿¡æ¯</span></span>
<span class="line"><span style="color:#7B7F8B;">     * </span><span style="color:#F286C4;">@param</span><span style="color:#7B7F8B;"> </span><span style="color:#FFB86C;font-style:italic;">id</span><span style="color:#7B7F8B;">   éƒ¨é—¨id</span></span>
<span class="line"><span style="color:#7B7F8B;">     */</span></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Delete</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">delete from dept where id = #{id}</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">)</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">deleteById</span><span style="color:#F6F6F4;">(</span><span style="color:#97E1F1;font-style:italic;">Integer</span><span style="color:#F6F6F4;"> </span><span style="color:#FFB86C;font-style:italic;">id</span><span style="color:#F6F6F4;">);</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Mapper</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">interface</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">DeptMapper</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#6A737D;">    /**</span></span>
<span class="line"><span style="color:#6A737D;">     * æ ¹æ®idåˆ é™¤éƒ¨é—¨ä¿¡æ¯</span></span>
<span class="line"><span style="color:#6A737D;">     * </span><span style="color:#D73A49;">@param</span><span style="color:#6A737D;"> </span><span style="color:#E36209;">id</span><span style="color:#6A737D;">   éƒ¨é—¨id</span></span>
<span class="line"><span style="color:#6A737D;">     */</span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Delete</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;delete from dept where id = #{id}&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">deleteById</span><span style="color:#24292E;">(Integer </span><span style="color:#E36209;">id</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><ol start="3"><li>EmpMapper</li></ol><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Mapper</span></span>
<span class="line"><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">interface</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;">EmpMapper</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#7B7F8B;">//æ ¹æ®éƒ¨é—¨idåˆ é™¤éƒ¨é—¨ä¸‹æ‰€æœ‰å‘˜å·¥</span></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Delete</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">delete from emp where dept_id=#{deptId}</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">)</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">int</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">deleteByDeptId</span><span style="color:#F6F6F4;">(</span><span style="color:#97E1F1;font-style:italic;">Integer</span><span style="color:#F6F6F4;"> </span><span style="color:#FFB86C;font-style:italic;">deptId</span><span style="color:#F6F6F4;">);</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Mapper</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">interface</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">EmpMapper</span><span style="color:#24292E;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//æ ¹æ®éƒ¨é—¨idåˆ é™¤éƒ¨é—¨ä¸‹æ‰€æœ‰å‘˜å·¥</span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Delete</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;delete from emp where dept_id=#{deptId}&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">int</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">deleteByDeptId</span><span style="color:#24292E;">(Integer </span><span style="color:#E36209;">deptId</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><p>é‡å¯SpringBootæœåŠ¡ï¼Œä½¿ç”¨postmanæµ‹è¯•éƒ¨é—¨åˆ é™¤ï¼š</p><p><img src="http://www.yangeit.cn:21010/assets/image-20230107140057729-0e6e055a.png" alt="image-20230107140057729"></p><p>image-20230107140057729</p><p>ä»£ç æ­£å¸¸æƒ…å†µä¸‹ï¼Œdeptè¡¨å’ŒEmè¡¨ä¸­çš„æ•°æ®å·²åˆ é™¤</p><p><img src="http://www.yangeit.cn:21010/assets/image-20230107140130199-59a8e8d6.png" alt="image-20230107140130199"></p><p>image-20230107140130199</p><p><img src="http://www.yangeit.cn:21010/assets/image-20230107140221425-eeeb1ee9.png" alt="image-20230107140221425"></p><p>image-20230107140221425</p><p><strong>ä¿®æ”¹DeptServiceImplç±»ä¸­ä»£ç ï¼Œæ·»åŠ å¯èƒ½å‡ºç°å¼‚å¸¸çš„ä»£ç ï¼š</strong> âš ï¸</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Slf4j</span></span>
<span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Service</span></span>
<span class="line"><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">class</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;">DeptServiceImpl</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">implements</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">DeptService</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Autowired</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">private</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">DeptMapper</span><span style="color:#F6F6F4;"> deptMapper;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Autowired</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">private</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">EmpMapper</span><span style="color:#F6F6F4;"> empMapper;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#7B7F8B;">//æ ¹æ®éƒ¨é—¨idï¼Œåˆ é™¤éƒ¨é—¨ä¿¡æ¯åŠéƒ¨é—¨ä¸‹çš„æ‰€æœ‰å‘˜å·¥</span></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Override</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">delete</span><span style="color:#F6F6F4;">(</span><span style="color:#97E1F1;font-style:italic;">Integer</span><span style="color:#F6F6F4;"> </span><span style="color:#FFB86C;font-style:italic;">id</span><span style="color:#F6F6F4;">){</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#7B7F8B;">//æ ¹æ®éƒ¨é—¨idåˆ é™¤éƒ¨é—¨ä¿¡æ¯</span></span>
<span class="line"><span style="color:#F6F6F4;">        deptMapper.</span><span style="color:#62E884;">deleteById</span><span style="color:#F6F6F4;">(id);</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#7B7F8B;">//æ¨¡æ‹Ÿï¼šå¼‚å¸¸å‘ç”Ÿ</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#97E1F1;font-style:italic;">int</span><span style="color:#F6F6F4;"> i </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">1</span><span style="color:#F286C4;">/</span><span style="color:#BF9EEE;">0</span><span style="color:#F6F6F4;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#7B7F8B;">//åˆ é™¤éƒ¨é—¨ä¸‹çš„æ‰€æœ‰å‘˜å·¥ä¿¡æ¯</span></span>
<span class="line"><span style="color:#F6F6F4;">        empMapper.</span><span style="color:#62E884;">deleteByDeptId</span><span style="color:#F6F6F4;">(id);   </span></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Slf4j</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Service</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">DeptServiceImpl</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">implements</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">DeptService</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Autowired</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> DeptMapper deptMapper;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Autowired</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> EmpMapper empMapper;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//æ ¹æ®éƒ¨é—¨idï¼Œåˆ é™¤éƒ¨é—¨ä¿¡æ¯åŠéƒ¨é—¨ä¸‹çš„æ‰€æœ‰å‘˜å·¥</span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Override</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">delete</span><span style="color:#24292E;">(Integer </span><span style="color:#E36209;">id</span><span style="color:#24292E;">){</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">//æ ¹æ®éƒ¨é—¨idåˆ é™¤éƒ¨é—¨ä¿¡æ¯</span></span>
<span class="line"><span style="color:#24292E;">        deptMapper.</span><span style="color:#6F42C1;">deleteById</span><span style="color:#24292E;">(id);</span></span>
<span class="line"><span style="color:#24292E;">        </span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">//æ¨¡æ‹Ÿï¼šå¼‚å¸¸å‘ç”Ÿ</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">int</span><span style="color:#24292E;"> i </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#D73A49;">/</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">//åˆ é™¤éƒ¨é—¨ä¸‹çš„æ‰€æœ‰å‘˜å·¥ä¿¡æ¯</span></span>
<span class="line"><span style="color:#24292E;">        empMapper.</span><span style="color:#6F42C1;">deleteByDeptId</span><span style="color:#24292E;">(id);   </span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><p>é‡å¯SpringBootæœåŠ¡ï¼Œä½¿ç”¨postmanæµ‹è¯•éƒ¨é—¨åˆ é™¤ï¼š</p><p><img src="http://www.yangeit.cn:21010/assets/image-20230107140618199-ac6eca64.png" alt="image-20230107140618199"></p><p>image-20230107140618199</p><p><img src="http://www.yangeit.cn:21010/assets/image-20230107140706301-74661d2d.png" alt="image-20230107140706301"></p><p>image-20230107140706301</p><p>æŸ¥çœ‹æ•°æ®åº“è¡¨ï¼š</p><ul><li>åˆ é™¤äº†2å·éƒ¨é—¨</li></ul><p><img src="http://www.yangeit.cn:21010/assets/image-20230107140726701-71c796a0.png" alt="image-20230107140726701"></p><p>image-20230107140726701</p><ul><li>2å·éƒ¨é—¨ä¸‹çš„å‘˜å·¥æ•°æ®æ²¡æœ‰åˆ é™¤</li></ul><p><img src="http://www.yangeit.cn:21010/assets/image-20230107140221425-eeeb1ee9.png" alt="image-20230107140221425"></p><p>image-20230107140221425</p><p><strong>ä»¥ä¸Šç¨‹åºå‡ºç°çš„é—®é¢˜ï¼šå³ä½¿ç¨‹åºè¿è¡ŒæŠ›å‡ºäº†å¼‚å¸¸ï¼Œéƒ¨é—¨ä¾ç„¶åˆ é™¤äº†ï¼Œä½†æ˜¯éƒ¨é—¨ä¸‹çš„å‘˜å·¥å´æ²¡æœ‰åˆ é™¤ï¼Œé€ æˆäº†æ•°æ®çš„ä¸ä¸€è‡´ã€‚</strong></p><p>ç‚¹å‡»æŸ¥çœ‹åŸå› åˆ†æ</p><h4 id="_1-2-2-åŸå› åˆ†æ" tabindex="-1">1.2.2 åŸå› åˆ†æ <a class="header-anchor" href="#_1-2-2-åŸå› åˆ†æ" aria-label="Permalink to &quot;1.2.2 åŸå› åˆ†æ&quot;">â€‹</a></h4><p>åŸå› ï¼š</p><ul><li>å…ˆæ‰§è¡Œæ ¹æ®idåˆ é™¤éƒ¨é—¨çš„æ“ä½œï¼Œè¿™æ­¥æ‰§è¡Œå®Œæ¯•ï¼Œæ•°æ®åº“è¡¨ dept ä¸­çš„æ•°æ®å°±å·²ç»åˆ é™¤äº†ã€‚</li><li>æ‰§è¡Œ 1/0 æ“ä½œï¼ŒæŠ›å‡ºå¼‚å¸¸</li><li>æŠ›å‡ºå¼‚å¸¸ä¹‹å‰ï¼Œä¸‹é¢æ‰€æœ‰çš„ä»£ç éƒ½ä¸ä¼šæ‰§è¡Œäº†ï¼Œæ ¹æ®éƒ¨é—¨IDåˆ é™¤è¯¥éƒ¨é—¨ä¸‹çš„å‘˜å·¥ï¼Œè¿™ä¸ªæ“ä½œä¹Ÿä¸ä¼šæ‰§è¡Œ ã€‚</li></ul><p>æ­¤æ—¶å°±å‡ºç°é—®é¢˜äº†ï¼Œéƒ¨é—¨åˆ é™¤äº†ï¼Œéƒ¨é—¨ä¸‹çš„å‘˜å·¥è¿˜åœ¨ï¼Œä¸šåŠ¡æ“ä½œå‰åæ•°æ®ä¸ä¸€è‡´ã€‚</p><p>è€Œè¦æƒ³ä¿è¯æ“ä½œå‰åï¼Œæ•°æ®çš„ä¸€è‡´æ€§ï¼Œå°±éœ€è¦è®©è§£æ•£éƒ¨é—¨ä¸­æ¶‰åŠåˆ°çš„ä¸¤ä¸ªä¸šåŠ¡æ“ä½œï¼Œè¦ä¹ˆå…¨éƒ¨æˆåŠŸï¼Œè¦ä¹ˆå…¨éƒ¨å¤±è´¥ ã€‚ é‚£æˆ‘ä»¬å¦‚ä½•ï¼Œè®©è¿™ä¸¤ä¸ªæ“ä½œè¦ä¹ˆå…¨éƒ¨æˆåŠŸï¼Œè¦ä¹ˆå…¨éƒ¨å¤±è´¥å‘¢ ï¼Ÿ</p><p>é‚£å°±å¯ä»¥é€šè¿‡äº‹åŠ¡æ¥å®ç°ï¼Œå› ä¸ºä¸€ä¸ªäº‹åŠ¡ä¸­çš„å¤šä¸ªä¸šåŠ¡æ“ä½œï¼Œè¦ä¹ˆå…¨éƒ¨æˆåŠŸï¼Œè¦ä¹ˆå…¨éƒ¨å¤±è´¥ã€‚</p><p>æ­¤æ—¶ï¼Œæˆ‘ä»¬å°±éœ€è¦åœ¨deleteåˆ é™¤ä¸šåŠ¡åŠŸèƒ½ä¸­æ·»åŠ äº‹åŠ¡ã€‚</p><p><img src="http://www.yangeit.cn:21010/assets/image-20230107141652636-400a7207.png" alt="image-20230107141652636"></p><p>image-20230107141652636</p><p>åœ¨æ–¹æ³•è¿è¡Œä¹‹å‰ï¼Œå¼€å¯äº‹åŠ¡ï¼Œå¦‚æœæ–¹æ³•æˆåŠŸæ‰§è¡Œï¼Œå°±æäº¤äº‹åŠ¡ï¼Œå¦‚æœæ–¹æ³•æ‰§è¡Œçš„è¿‡ç¨‹å½“ä¸­å‡ºç°å¼‚å¸¸äº†ï¼Œå°±å›æ»šäº‹åŠ¡ã€‚</p><p>Springä¸­å¼€å¯äº‹ç‰©ç®¡ç†</p><p><strong>@Transactionalä½œç”¨</strong>ï¼šå°±æ˜¯åœ¨å½“å‰è¿™ä¸ªæ–¹æ³•æ‰§è¡Œå¼€å§‹ä¹‹å‰æ¥å¼€å¯äº‹åŠ¡ï¼Œæ–¹æ³•æ‰§è¡Œå®Œæ¯•ä¹‹åæäº¤äº‹åŠ¡ã€‚<strong>å¦‚æœåœ¨è¿™ä¸ªæ–¹æ³•æ‰§è¡Œçš„è¿‡ç¨‹å½“ä¸­å‡ºç°äº†å¼‚å¸¸ï¼Œå°±ä¼šè¿›è¡Œäº‹åŠ¡çš„å›æ»šæ“ä½œã€‚</strong></p><p><strong>@Transactionalæ³¨è§£</strong>ï¼šæˆ‘ä»¬ä¸€èˆ¬ä¼šåœ¨ä¸šåŠ¡å±‚å½“ä¸­æ¥æ§åˆ¶äº‹åŠ¡ ï¼Œå› ä¸ºåœ¨ä¸šåŠ¡å±‚å½“ä¸­ï¼Œä¸€ä¸ªä¸šåŠ¡åŠŸèƒ½å¯èƒ½ä¼šåŒ…å«å¤šä¸ªæ•°æ®è®¿é—®çš„æ“ä½œ ã€‚åœ¨ä¸šåŠ¡å±‚æ¥æ§åˆ¶äº‹åŠ¡ï¼Œæˆ‘ä»¬å°±å¯ä»¥å°†å¤šä¸ªæ•°æ®è®¿é—®æ“ä½œæ§åˆ¶åœ¨ä¸€ä¸ªäº‹åŠ¡èŒƒå›´å†…ã€‚</p><p><strong>@Transactionalæ³¨è§£ä¹¦å†™ä½ç½®:</strong> ğŸ‘‡ ğŸ‘‡</p><ul><li><strong>æ–¹æ³•</strong><ul><li><strong>å½“å‰æ–¹æ³•</strong>äº¤ç»™springè¿›è¡Œäº‹åŠ¡ç®¡ç†</li></ul></li><li><strong>ç±»</strong><ul><li>å½“å‰ç±»ä¸­<strong>æ‰€æœ‰çš„æ–¹æ³•éƒ½äº¤ç”±springè¿›è¡Œäº‹åŠ¡ç®¡ç†</strong></li></ul></li><li><strong>æ¥å£</strong><ul><li>æ¥å£ä¸‹<strong>æ‰€æœ‰çš„å®ç°ç±»å½“ä¸­æ‰€æœ‰çš„æ–¹æ³•éƒ½</strong>äº¤ç»™spring è¿›è¡Œäº‹åŠ¡ç®¡ç†</li></ul></li></ul><p>ç‚¹å‡»æŸ¥çœ‹å¼€å¯äº‹ç‰©çš„ä»£ç </p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨ä¸šåŠ¡æ–¹æ³•deleteä¸ŠåŠ ä¸Š <strong>@Transactional</strong> æ¥æ§åˆ¶äº‹åŠ¡ ã€‚</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Slf4j</span></span>
<span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Service</span></span>
<span class="line"><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">class</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;">DeptServiceImpl</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">implements</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">DeptService</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Autowired</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">private</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">DeptMapper</span><span style="color:#F6F6F4;"> deptMapper;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Autowired</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">private</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">EmpMapper</span><span style="color:#F6F6F4;"> empMapper;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">    </span></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Override</span></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Transactional</span><span style="color:#F6F6F4;">  </span><span style="color:#7B7F8B;">//å½“å‰æ–¹æ³•æ·»åŠ äº†äº‹åŠ¡ç®¡ç†</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">delete</span><span style="color:#F6F6F4;">(</span><span style="color:#97E1F1;font-style:italic;">Integer</span><span style="color:#F6F6F4;"> </span><span style="color:#FFB86C;font-style:italic;">id</span><span style="color:#F6F6F4;">){</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#7B7F8B;">//æ ¹æ®éƒ¨é—¨idåˆ é™¤éƒ¨é—¨ä¿¡æ¯</span></span>
<span class="line"><span style="color:#F6F6F4;">        deptMapper.</span><span style="color:#62E884;">deleteById</span><span style="color:#F6F6F4;">(id);</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#7B7F8B;">//æ¨¡æ‹Ÿï¼šå¼‚å¸¸å‘ç”Ÿ</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#97E1F1;font-style:italic;">int</span><span style="color:#F6F6F4;"> i </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">1</span><span style="color:#F286C4;">/</span><span style="color:#BF9EEE;">0</span><span style="color:#F6F6F4;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#7B7F8B;">//åˆ é™¤éƒ¨é—¨ä¸‹çš„æ‰€æœ‰å‘˜å·¥ä¿¡æ¯</span></span>
<span class="line"><span style="color:#F6F6F4;">        empMapper.</span><span style="color:#62E884;">deleteByDeptId</span><span style="color:#F6F6F4;">(id);   </span></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Slf4j</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Service</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">DeptServiceImpl</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">implements</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">DeptService</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Autowired</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> DeptMapper deptMapper;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Autowired</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> EmpMapper empMapper;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Override</span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Transactional</span><span style="color:#24292E;">  </span><span style="color:#6A737D;">//å½“å‰æ–¹æ³•æ·»åŠ äº†äº‹åŠ¡ç®¡ç†</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">delete</span><span style="color:#24292E;">(Integer </span><span style="color:#E36209;">id</span><span style="color:#24292E;">){</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">//æ ¹æ®éƒ¨é—¨idåˆ é™¤éƒ¨é—¨ä¿¡æ¯</span></span>
<span class="line"><span style="color:#24292E;">        deptMapper.</span><span style="color:#6F42C1;">deleteById</span><span style="color:#24292E;">(id);</span></span>
<span class="line"><span style="color:#24292E;">        </span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">//æ¨¡æ‹Ÿï¼šå¼‚å¸¸å‘ç”Ÿ</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">int</span><span style="color:#24292E;"> i </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#D73A49;">/</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">//åˆ é™¤éƒ¨é—¨ä¸‹çš„æ‰€æœ‰å‘˜å·¥ä¿¡æ¯</span></span>
<span class="line"><span style="color:#24292E;">        empMapper.</span><span style="color:#6F42C1;">deleteByDeptId</span><span style="color:#24292E;">(id);   </span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><p>åœ¨ä¸šåŠ¡åŠŸèƒ½ä¸Šæ·»åŠ @Transactionalæ³¨è§£è¿›è¡Œäº‹åŠ¡ç®¡ç†åï¼Œæˆ‘ä»¬é‡å¯SpringBootæœåŠ¡ï¼Œä½¿ç”¨postmanæµ‹è¯•ï¼š</p><p><img src="http://www.yangeit.cn:21010/assets/image-20230107143339917-2eec7fff.png" alt="image-20230107143339917"></p><p>image-20230107143339917</p><p>æ·»åŠ Springäº‹åŠ¡ç®¡ç†åï¼Œç”±äºæœåŠ¡ç«¯ç¨‹åºå¼•å‘äº†å¼‚å¸¸ï¼Œæ‰€ä»¥äº‹åŠ¡è¿›è¡Œå›æ»šã€‚</p><p><img src="http://www.yangeit.cn:21010/assets/image-20230107144312892-1bced2d7.png" alt="image-20230107144312892"></p><p>image-20230107144312892</p><p><img src="http://www.yangeit.cn:21010/assets/image-20230107143720961-8ffe0709.png" alt="image-20230107143720961"></p><p>image-20230107143720961</p><p>æŠ€å·§</p><ol><li>åœ¨springæ¡†æ¶å½“ä¸­å·²ç»æŠŠäº‹åŠ¡æ§åˆ¶çš„ä»£ç å·²ç»å°è£…å¥½äº†ï¼Œå¹¶ä¸éœ€è¦å¼€å‘è€…æ‰‹åŠ¨å®ç°ã€‚</li><li>ä½¿ç”¨springæ¡†æ¶ï¼Œåªéœ€è¦é€šè¿‡ä¸€ä¸ªç®€å•çš„æ³¨è§£ <strong>@Transactional</strong> å°±æå®šäº†ã€‚</li><li>å¯ä»¥åœ¨application.ymlé…ç½®æ–‡ä»¶ä¸­å¼€å¯äº‹åŠ¡ç®¡ç†æ—¥å¿—ï¼Œè¿™æ ·å°±å¯ä»¥åœ¨æ§åˆ¶çœ‹åˆ°å’Œ<strong>äº‹åŠ¡ç›¸å…³çš„æ—¥å¿—ä¿¡æ¯</strong>äº†</li></ol><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#7B7F8B;">#springäº‹åŠ¡ç®¡ç†æ—¥å¿—</span></span>
<span class="line"><span style="color:#97E1F1;">logging</span><span style="color:#F286C4;">:</span></span>
<span class="line"><span style="color:#F6F6F4;">  </span><span style="color:#97E1F1;">level</span><span style="color:#F286C4;">:</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#97E1F1;">org.springframework.jdbc.support.JdbcTransactionManager</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#E7EE98;">debug</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">#springäº‹åŠ¡ç®¡ç†æ—¥å¿—</span></span>
<span class="line"><span style="color:#22863A;">logging</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">level</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">org.springframework.jdbc.support.JdbcTransactionManager</span><span style="color:#24292E;">: </span><span style="color:#032F62;">debug</span></span></code></pre></div><h3 id="_1-3-äº‹åŠ¡è¿›é˜¶-ğŸ-ğŸš€" tabindex="-1">1.3 äº‹åŠ¡è¿›é˜¶ ğŸ ğŸš€ <a class="header-anchor" href="#_1-3-äº‹åŠ¡è¿›é˜¶-ğŸ-ğŸš€" aria-label="Permalink to &quot;1.3 äº‹åŠ¡è¿›é˜¶ ğŸ ğŸš€&quot;">â€‹</a></h3><p>ç›®æ ‡ğŸ¯ ï¼š<strong>@Transactionaläº‹åŠ¡ç®¡ç†æ³¨è§£çš„ä½¿ç”¨ç»†èŠ‚</strong></p><p>@Transactionalæ³¨è§£ å½“ä¸­çš„ä¸¤ä¸ªå¸¸è§çš„å±æ€§ï¼š</p><ol><li>å¼‚å¸¸å›æ»šçš„å±æ€§ï¼šrollbackFor</li><li>äº‹åŠ¡ä¼ æ’­è¡Œä¸ºï¼špropagation</li></ol><h4 id="å¼‚å¸¸å›æ»šçš„å±æ€§-rollbackfor-ğŸ‘‡" tabindex="-1">å¼‚å¸¸å›æ»šçš„å±æ€§ï¼šrollbackFor ğŸ‘‡ <a class="header-anchor" href="#å¼‚å¸¸å›æ»šçš„å±æ€§-rollbackfor-ğŸ‘‡" aria-label="Permalink to &quot;å¼‚å¸¸å›æ»šçš„å±æ€§ï¼šrollbackFor ğŸ‘‡&quot;">â€‹</a></h4><p>æ‰€æœ‰å¼‚å¸¸éƒ½ä¼šè§¦å‘å›æ»šå—ï¼ŸrollbackForå±æ€§çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ</p><ul><li>åœ¨Springçš„äº‹åŠ¡ç®¡ç†ä¸­ï¼Œ<strong>é»˜è®¤åªæœ‰è¿è¡Œæ—¶å¼‚å¸¸ RuntimeException</strong>æ‰ä¼šå›æ»šã€‚</li><li>å¦‚æœ<strong>è¿˜éœ€è¦å›æ»šæŒ‡å®šç±»å‹çš„å¼‚å¸¸</strong>ï¼Œå¯ä»¥é€šè¿‡rollbackForå±æ€§æ¥æŒ‡å®šã€‚</li></ul><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Transactional</span><span style="color:#F6F6F4;">(</span><span style="color:#BF9EEE;">rollbackFor</span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;">Exception.class)</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">delete</span><span style="color:#F6F6F4;">(</span><span style="color:#97E1F1;font-style:italic;">Integer</span><span style="color:#F6F6F4;"> id){</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#7B7F8B;">// çœç•¥ä»£ç </span></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Transactional</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">rollbackFor</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">Exception.class)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">delete</span><span style="color:#24292E;">(Integer id){</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">// çœç•¥ä»£ç </span></span>
<span class="line"><span style="color:#24292E;">    }</span></span></code></pre></div><p>ç‚¹å‡»æŸ¥çœ‹rollbackForå±æ€§æµ‹è¯•ä»£ç </p><p>ä¸‹é¢æˆ‘ä»¬åœ¨åšä¸€ä¸ªæµ‹è¯•ï¼Œæˆ‘ä»¬ä¿®æ”¹ä¸šåŠ¡åŠŸèƒ½ä»£ç ï¼Œ<strong>åœ¨æ¨¡æ‹Ÿå¼‚å¸¸çš„ä½ç½®ä¸Šç›´æ¥æŠ›å‡ºExceptionå¼‚å¸¸ï¼ˆç¼–è¯‘æ—¶å¼‚å¸¸ï¼‰</strong></p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Transactional</span></span>
<span class="line"><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">delete</span><span style="color:#F6F6F4;">(</span><span style="color:#97E1F1;font-style:italic;">Integer</span><span style="color:#F6F6F4;"> id) throws Exception {</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#7B7F8B;">//æ ¹æ®éƒ¨é—¨idåˆ é™¤éƒ¨é—¨ä¿¡æ¯</span></span>
<span class="line"><span style="color:#F6F6F4;">        deptMapper.</span><span style="color:#62E884;">deleteById</span><span style="color:#F6F6F4;">(id);</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#7B7F8B;">//æ¨¡æ‹Ÿï¼šå¼‚å¸¸å‘ç”Ÿ</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#F286C4;">if</span><span style="color:#F6F6F4;">(</span><span style="color:#BF9EEE;">true</span><span style="color:#F6F6F4;">){</span></span>
<span class="line"><span style="color:#F6F6F4;">            </span><span style="color:#F286C4;">throw</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;font-weight:bold;">new</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">Exception</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">å‡ºç°å¼‚å¸¸äº†\`\`\`</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">);</span></span>
<span class="line"><span style="color:#F6F6F4;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#7B7F8B;">//åˆ é™¤éƒ¨é—¨ä¸‹çš„æ‰€æœ‰å‘˜å·¥ä¿¡æ¯</span></span>
<span class="line"><span style="color:#F6F6F4;">        empMapper.</span><span style="color:#62E884;">deleteByDeptId</span><span style="color:#F6F6F4;">(id);   </span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Transactional</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">delete</span><span style="color:#24292E;">(Integer id) throws Exception {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">//æ ¹æ®éƒ¨é—¨idåˆ é™¤éƒ¨é—¨ä¿¡æ¯</span></span>
<span class="line"><span style="color:#24292E;">        deptMapper.</span><span style="color:#6F42C1;">deleteById</span><span style="color:#24292E;">(id);</span></span>
<span class="line"><span style="color:#24292E;">        </span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">//æ¨¡æ‹Ÿï¼šå¼‚å¸¸å‘ç”Ÿ</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">if</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">true</span><span style="color:#24292E;">){</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">throw</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Exception</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;å‡ºç°å¼‚å¸¸äº†\`\`\`&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">//åˆ é™¤éƒ¨é—¨ä¸‹çš„æ‰€æœ‰å‘˜å·¥ä¿¡æ¯</span></span>
<span class="line"><span style="color:#24292E;">        empMapper.</span><span style="color:#6F42C1;">deleteByDeptId</span><span style="color:#24292E;">(id);   </span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><p><strong>é‡æ–°å¯åŠ¨æœåŠ¡åæµ‹è¯•ï¼š</strong> æŠ›å‡ºå¼‚å¸¸ä¹‹åäº‹åŠ¡ä¼šä¸ä¼šå›æ»š???</p><blockquote><p>ç°æœ‰è¡¨ä¸­æ•°æ®ï¼š</p><p><img src="http://www.yangeit.cn:21010/assets/image-20230107140726701-71c796a0.png" alt="image-20230107140726701"></p><p>image-20230107140726701</p></blockquote><p>ä½¿ç”¨postmanæµ‹è¯•ï¼Œåˆ é™¤5å·éƒ¨é—¨</p><p><img src="http://www.yangeit.cn:21010/assets/image-20230108142359592-14d2dcd2.png" alt="image-20230108142359592"></p><p>image-20230108142359592</p><p>å‘ç”Ÿäº†Exceptionå¼‚å¸¸ï¼Œä½†äº‹åŠ¡ä¾ç„¶æäº¤äº†</p><p><img src="http://www.yangeit.cn:21010/assets/image-20230108142555310-86ab5ff5.png" alt="image-20230108142555310"></p><p>image-20230108142555310</p><blockquote><p>deptè¡¨ä¸­æ•°æ®ï¼š</p><p><img src="http://www.yangeit.cn:21010/assets/image-20230108142707351-932ffc9b.png" alt="image-20230108142707351"></p><p>image-20230108142707351</p></blockquote><p>é€šè¿‡ä»¥ä¸Šæµ‹è¯•å¯ä»¥å¾—å‡ºä¸€ä¸ªç»“è®ºï¼šğŸ‘‡ ğŸ‘‡</p><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œåªæœ‰å‡ºç°RuntimeException(è¿è¡Œæ—¶å¼‚å¸¸)æ‰ä¼šå›æ»šäº‹åŠ¡ã€‚ ğŸ‘ˆ ğŸ</p><p>å‡å¦‚æˆ‘ä»¬æƒ³è®©æ‰€æœ‰çš„å¼‚å¸¸éƒ½å›æ»šï¼Œéœ€è¦æ¥é…ç½®@Transactionalæ³¨è§£å½“ä¸­çš„rollbackForå±æ€§ï¼Œé€šè¿‡rollbackForè¿™ä¸ªå±æ€§å¯ä»¥æŒ‡å®šå‡ºç°ä½•ç§å¼‚å¸¸ç±»å‹å›æ»šäº‹åŠ¡ã€‚</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Slf4j</span></span>
<span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Service</span></span>
<span class="line"><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">class</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;">DeptServiceImpl</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">implements</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">DeptService</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Autowired</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">private</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">DeptMapper</span><span style="color:#F6F6F4;"> deptMapper;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Autowired</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">private</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">EmpMapper</span><span style="color:#F6F6F4;"> empMapper;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">    </span></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Override</span></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Transactional</span><span style="color:#F6F6F4;">(</span><span style="color:#BF9EEE;">rollbackFor</span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;">Exception.class)</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">delete</span><span style="color:#F6F6F4;">(</span><span style="color:#97E1F1;font-style:italic;">Integer</span><span style="color:#F6F6F4;"> </span><span style="color:#FFB86C;font-style:italic;">id</span><span style="color:#F6F6F4;">){</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#7B7F8B;">//æ ¹æ®éƒ¨é—¨idåˆ é™¤éƒ¨é—¨ä¿¡æ¯</span></span>
<span class="line"><span style="color:#F6F6F4;">        deptMapper.</span><span style="color:#62E884;">deleteById</span><span style="color:#F6F6F4;">(id);</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#7B7F8B;">//æ¨¡æ‹Ÿï¼šå¼‚å¸¸å‘ç”Ÿ</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#97E1F1;font-style:italic;">int</span><span style="color:#F6F6F4;"> num </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> id</span><span style="color:#F286C4;">/</span><span style="color:#BF9EEE;">0</span><span style="color:#F6F6F4;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#7B7F8B;">//åˆ é™¤éƒ¨é—¨ä¸‹çš„æ‰€æœ‰å‘˜å·¥ä¿¡æ¯</span></span>
<span class="line"><span style="color:#F6F6F4;">        empMapper.</span><span style="color:#62E884;">deleteByDeptId</span><span style="color:#F6F6F4;">(id);   </span></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Slf4j</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Service</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">DeptServiceImpl</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">implements</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">DeptService</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Autowired</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> DeptMapper deptMapper;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Autowired</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> EmpMapper empMapper;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Override</span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Transactional</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">rollbackFor</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">Exception.class)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">delete</span><span style="color:#24292E;">(Integer </span><span style="color:#E36209;">id</span><span style="color:#24292E;">){</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">//æ ¹æ®éƒ¨é—¨idåˆ é™¤éƒ¨é—¨ä¿¡æ¯</span></span>
<span class="line"><span style="color:#24292E;">        deptMapper.</span><span style="color:#6F42C1;">deleteById</span><span style="color:#24292E;">(id);</span></span>
<span class="line"><span style="color:#24292E;">        </span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">//æ¨¡æ‹Ÿï¼šå¼‚å¸¸å‘ç”Ÿ</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">int</span><span style="color:#24292E;"> num </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> id</span><span style="color:#D73A49;">/</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">//åˆ é™¤éƒ¨é—¨ä¸‹çš„æ‰€æœ‰å‘˜å·¥ä¿¡æ¯</span></span>
<span class="line"><span style="color:#24292E;">        empMapper.</span><span style="color:#6F42C1;">deleteByDeptId</span><span style="color:#24292E;">(id);   </span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><p>æ¥ä¸‹æ¥æˆ‘ä»¬é‡æ–°å¯åŠ¨æœåŠ¡ï¼Œæµ‹è¯•åˆ é™¤éƒ¨é—¨çš„æ“ä½œï¼š</p><p><img src="http://www.yangeit.cn:21010/assets/image-20230108184912155-4cb952f2.png" alt="image-20230108184912155"></p><p>image-20230108184912155</p><p>æ§åˆ¶å°æ—¥å¿—ï¼šæ‰§è¡Œäº†åˆ é™¤3å·éƒ¨é—¨çš„æ“ä½œï¼Œ å› ä¸ºå¼‚å¸¸åˆè¿›è¡Œäº†äº‹åŠ¡å›æ»š</p><p><img src="http://www.yangeit.cn:21010/assets/image-20230108185432083-167774ec.png" alt="image-20230108185432083"></p><p>image-20230108185432083</p><p>æ•°æ®è¡¨ï¼š3å·éƒ¨é—¨æ²¡æœ‰åˆ é™¤</p><p><img src="http://www.yangeit.cn:21010/assets/image-20230107143720961-8ffe0709.png" alt="image-20230107143720961"></p><p>image-20230107143720961</p><h4 id="propagation" tabindex="-1">propagation <a class="header-anchor" href="#propagation" aria-label="Permalink to &quot;propagation&quot;">â€‹</a></h4><p>é—®é¢˜</p><ol><li>ä»€ä¹ˆæ˜¯äº‹åŠ¡çš„ä¼ æ’­è¡Œä¸ºå‘¢ï¼Ÿ</li><li>propagationå±æ€§çš„ä½œç”¨æ˜¯ä»€ä¹ˆ</li></ol><p>ç‚¹å‡»æŸ¥çœ‹</p><p><strong>äº‹åŠ¡çš„ä¼ æ’­è¡Œä¸º</strong>å°±æ˜¯<strong>Aäº‹åŠ¡</strong>æ–¹æ³•è¢«<strong>Bäº‹åŠ¡</strong>æ–¹æ³•è°ƒç”¨æ—¶ï¼Œ<strong>Aäº‹åŠ¡</strong>æ–¹æ³•åº”è¯¥å¦‚ä½•è¿›è¡Œäº‹åŠ¡æ§åˆ¶ã€‚</p><p><strong>å±æ€§propagation</strong>: ç”¨æ¥é…ç½®äº‹åŠ¡çš„ä¼ æ’­è¡Œä¸ºçš„(å¸¸è§çš„ä¼ æ’­è¡Œä¸º)</p><ul><li><strong>REQUIRED</strong>å¸¸ç”¨ ã€é»˜è®¤å€¼ã€‘éœ€è¦äº‹åŠ¡ï¼Œæœ‰åˆ™åŠ å…¥ï¼Œæ— åˆ™åˆ›å»ºæ–°äº‹åŠ¡</li><li><strong>REQUIRES_NEW</strong> å¸¸ç”¨ éœ€è¦æ–°äº‹åŠ¡ï¼Œæ— è®ºæœ‰æ— ï¼Œæ€»æ˜¯åˆ›å»ºæ–°äº‹åŠ¡</li></ul><h5 id="ä»‹ç»" tabindex="-1">ä»‹ç» <a class="header-anchor" href="#ä»‹ç»" aria-label="Permalink to &quot;ä»‹ç»&quot;">â€‹</a></h5><p>ä¾‹å¦‚ï¼šä¸¤ä¸ªäº‹åŠ¡æ–¹æ³•ï¼Œä¸€ä¸ªAæ–¹æ³•ï¼Œä¸€ä¸ªBæ–¹æ³•ã€‚åœ¨è¿™ä¸¤ä¸ªæ–¹æ³•ä¸Šéƒ½æ·»åŠ äº†@Transactionalæ³¨è§£ï¼Œå°±ä»£è¡¨è¿™ä¸¤ä¸ªæ–¹æ³•éƒ½å…·æœ‰äº‹åŠ¡ï¼Œè€Œåœ¨Aæ–¹æ³•å½“ä¸­åˆå»è°ƒç”¨äº†Bæ–¹æ³•ã€‚</p><p><img src="http://www.yangeit.cn:21010/assets/image-20230112152543953-fe8983b2.png" alt="image-20230112152543953"></p><p>image-20230112152543953</p><p>äº‹åŠ¡çš„ä¼ æ’­è¡Œä¸º</p><p><strong>æ‰€è°“äº‹åŠ¡çš„ä¼ æ’­è¡Œä¸º</strong>ï¼ŒæŒ‡çš„å°±æ˜¯åœ¨Aæ–¹æ³•è¿è¡Œçš„æ—¶å€™ï¼Œé¦–å…ˆä¼šå¼€å¯ä¸€ä¸ªäº‹åŠ¡ï¼Œåœ¨Aæ–¹æ³•å½“ä¸­åˆè°ƒç”¨äº†Bæ–¹æ³•ï¼Œ Bæ–¹æ³•è‡ªèº«ä¹Ÿå…·æœ‰äº‹åŠ¡ï¼Œé‚£ä¹ˆBæ–¹æ³•åœ¨è¿è¡Œçš„æ—¶å€™ï¼Œåˆ°åº•æ˜¯åŠ å…¥åˆ°Aæ–¹æ³•çš„äº‹åŠ¡å½“ä¸­æ¥ï¼Œè¿˜æ˜¯Bæ–¹æ³•åœ¨è¿è¡Œçš„æ—¶å€™æ–°å»ºä¸€ä¸ªäº‹åŠ¡ï¼Ÿè¿™ä¸ªå°±æ¶‰åŠåˆ°äº†<strong>äº‹åŠ¡çš„ä¼ æ’­è¡Œä¸º</strong>ã€‚ğŸ‘‡</p><p><strong>å¸¸è§çš„äº‹åŠ¡ä¼ æ’­è¡Œä¸º:</strong></p><table><thead><tr><th><strong>å±æ€§å€¼</strong></th><th><strong>å«ä¹‰</strong></th></tr></thead><tbody><tr><td><strong>REQUIRED</strong>å¸¸ç”¨</td><td>ã€é»˜è®¤å€¼ã€‘éœ€è¦äº‹åŠ¡ï¼Œæœ‰åˆ™åŠ å…¥ï¼Œæ— åˆ™åˆ›å»ºæ–°äº‹åŠ¡</td></tr><tr><td><strong>REQUIRES_NEW</strong> å¸¸ç”¨</td><td>éœ€è¦æ–°äº‹åŠ¡ï¼Œæ— è®ºæœ‰æ— ï¼Œæ€»æ˜¯åˆ›å»ºæ–°äº‹åŠ¡</td></tr><tr><td>SUPPORTS</td><td>æ”¯æŒäº‹åŠ¡ï¼Œæœ‰åˆ™åŠ å…¥ï¼Œæ— åˆ™åœ¨æ— äº‹åŠ¡çŠ¶æ€ä¸­è¿è¡Œ</td></tr><tr><td>NOT_SUPPORTED</td><td>ä¸æ”¯æŒäº‹åŠ¡ï¼Œåœ¨æ— äº‹åŠ¡çŠ¶æ€ä¸‹è¿è¡Œ,å¦‚æœå½“å‰å­˜åœ¨å·²æœ‰äº‹åŠ¡,åˆ™æŒ‚èµ·å½“å‰äº‹åŠ¡</td></tr><tr><td>MANDATORY</td><td>å¿…é¡»æœ‰äº‹åŠ¡ï¼Œå¦åˆ™æŠ›å¼‚å¸¸</td></tr><tr><td>NEVER</td><td>å¿…é¡»æ²¡äº‹åŠ¡ï¼Œå¦åˆ™æŠ›å¼‚å¸¸</td></tr><tr><td>â€¦</td><td></td></tr></tbody></table><p><strong>äº‹ç‰©ä¼ æ’­è¡Œä¸ºæ¡ˆä¾‹</strong> ğŸ‘‡ğŸ‘‡ âœï¸</p><p>ç›®æ ‡ğŸ¯ ï¼š<strong>é€šè¿‡ä»£ç æ¼”ç¤ºäº‹åŠ¡ä¼ æ’­è¡Œä¸º</strong></p><p>éœ€æ±‚å’Œæ­¥éª¤</p><p><strong>éœ€æ±‚</strong>ï¼šè§£æ•£éƒ¨é—¨æ—¶éœ€è¦è®°å½•æ“ä½œæ—¥å¿—</p><p>ç”±äºè§£æ•£éƒ¨é—¨æ˜¯ä¸€ä¸ªéå¸¸é‡è¦è€Œä¸”éå¸¸å±é™©çš„æ“ä½œï¼Œæ‰€ä»¥åœ¨ä¸šåŠ¡å½“ä¸­è¦æ±‚æ¯ä¸€æ¬¡æ‰§è¡Œè§£æ•£éƒ¨é—¨çš„æ“ä½œéƒ½éœ€è¦ç•™ä¸‹ç—•è¿¹ï¼Œå°±æ˜¯è¦è®°å½•æ“ä½œæ—¥å¿—ã€‚è€Œä¸”è¿˜è¦æ±‚æ— è®ºæ˜¯æ‰§è¡ŒæˆåŠŸäº†è¿˜æ˜¯æ‰§è¡Œå¤±è´¥äº†ï¼Œéƒ½éœ€è¦ç•™ä¸‹ç—•è¿¹ã€‚</p><p><strong>æ­¥éª¤ï¼š</strong></p><ol><li>æ‰§è¡Œè§£æ•£éƒ¨é—¨çš„ä¸šåŠ¡ï¼šå…ˆåˆ é™¤éƒ¨é—¨ï¼Œå†åˆ é™¤éƒ¨é—¨ä¸‹çš„å‘˜å·¥ï¼ˆå‰é¢å·²å®ç°ï¼‰</li><li>è®°å½•è§£æ•£éƒ¨é—¨çš„æ—¥å¿—ï¼Œåˆ°æ—¥å¿—è¡¨ï¼ˆæœªå®ç°ï¼‰</li></ol><p><strong>å‡†å¤‡å·¥ä½œï¼š</strong></p><ol><li>åˆ›å»ºæ•°æ®åº“è¡¨ dept_log æ—¥å¿—è¡¨ï¼š</li></ol><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F286C4;">create</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">table</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">dept_log</span><span style="color:#F6F6F4;">(</span></span>
<span class="line"><span style="color:#F6F6F4;">   	id </span><span style="color:#F286C4;">int</span><span style="color:#F6F6F4;"> auto_increment comment </span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">ä¸»é”®ID</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">primary key</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">    create_time </span><span style="color:#F286C4;">datetime</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">null</span><span style="color:#F6F6F4;"> comment </span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">æ“ä½œæ—¶é—´</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">description</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">varchar</span><span style="color:#F6F6F4;">(</span><span style="color:#BF9EEE;">300</span><span style="color:#F6F6F4;">) </span><span style="color:#F286C4;">null</span><span style="color:#F6F6F4;"> comment </span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">æ“ä½œæè¿°</span><span style="color:#DEE492;">&#39;</span></span>
<span class="line"><span style="color:#F6F6F4;">)comment </span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">éƒ¨é—¨æ“ä½œæ—¥å¿—è¡¨</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">create</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">table</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">dept_log</span><span style="color:#24292E;">(</span></span>
<span class="line"><span style="color:#24292E;">   	id </span><span style="color:#D73A49;">int</span><span style="color:#24292E;"> auto_increment comment </span><span style="color:#032F62;">&#39;ä¸»é”®ID&#39;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">primary key</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    create_time </span><span style="color:#D73A49;">datetime</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">null</span><span style="color:#24292E;"> comment </span><span style="color:#032F62;">&#39;æ“ä½œæ—¶é—´&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">description</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">varchar</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">300</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">null</span><span style="color:#24292E;"> comment </span><span style="color:#032F62;">&#39;æ“ä½œæè¿°&#39;</span></span>
<span class="line"><span style="color:#24292E;">)comment </span><span style="color:#032F62;">&#39;éƒ¨é—¨æ“ä½œæ—¥å¿—è¡¨&#39;</span><span style="color:#24292E;">;</span></span></code></pre></div><ol start="2"><li>å¼•å…¥èµ„æ–™ä¸­æä¾›çš„å®ä½“ç±»ï¼šDeptLog</li></ol><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Data</span></span>
<span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">NoArgsConstructor</span></span>
<span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">AllArgsConstructor</span></span>
<span class="line"><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">class</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;">DeptLog</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">private</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">Integer</span><span style="color:#F6F6F4;"> id;</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">private</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">LocalDateTime</span><span style="color:#F6F6F4;"> createTime;</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">private</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">String</span><span style="color:#F6F6F4;"> description;</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Data</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">NoArgsConstructor</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">AllArgsConstructor</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">DeptLog</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> Integer id;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> LocalDateTime createTime;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> String description;</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><ol start="3"><li>å¼•å…¥èµ„æ–™ä¸­æä¾›çš„Mapperæ¥å£ï¼šDeptLogMapper</li></ol><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Mapper</span></span>
<span class="line"><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">interface</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;">DeptLogMapper</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Insert</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">insert into dept_log(create_time,description) values(#{createTime},#{description})</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">)</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">insert</span><span style="color:#F6F6F4;">(</span><span style="color:#97E1F1;font-style:italic;">DeptLog</span><span style="color:#F6F6F4;"> </span><span style="color:#FFB86C;font-style:italic;">log</span><span style="color:#F6F6F4;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Mapper</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">interface</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">DeptLogMapper</span><span style="color:#24292E;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Insert</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;insert into dept_log(create_time,description) values(#{createTime},#{description})&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">insert</span><span style="color:#24292E;">(DeptLog </span><span style="color:#E36209;">log</span><span style="color:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><ol start="4"><li>å¼•å…¥èµ„æ–™ä¸­æä¾›çš„ä¸šåŠ¡æ¥å£ï¼šDeptLogService</li></ol><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">interface</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;">DeptLogService</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">insert</span><span style="color:#F6F6F4;">(</span><span style="color:#97E1F1;font-style:italic;">DeptLog</span><span style="color:#F6F6F4;"> </span><span style="color:#FFB86C;font-style:italic;">deptLog</span><span style="color:#F6F6F4;">);</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">interface</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">DeptLogService</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">insert</span><span style="color:#24292E;">(DeptLog </span><span style="color:#E36209;">deptLog</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><ol start="5"><li>å¼•å…¥èµ„æ–™ä¸­æä¾›çš„ä¸šåŠ¡å®ç°ç±»ï¼šDeptLogServiceImpl</li></ol><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Service</span></span>
<span class="line"><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">class</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;">DeptLogServiceImpl</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">implements</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">DeptLogService</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Autowired</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">private</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">DeptLogMapper</span><span style="color:#F6F6F4;"> deptLogMapper;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Transactional</span><span style="color:#F6F6F4;"> </span><span style="color:#7B7F8B;">//äº‹åŠ¡ä¼ æ’­è¡Œä¸ºï¼šæœ‰äº‹åŠ¡å°±åŠ å…¥ã€æ²¡æœ‰äº‹åŠ¡å°±æ–°å»ºäº‹åŠ¡</span></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Override</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">insert</span><span style="color:#F6F6F4;">(</span><span style="color:#97E1F1;font-style:italic;">DeptLog</span><span style="color:#F6F6F4;"> </span><span style="color:#FFB86C;font-style:italic;">deptLog</span><span style="color:#F6F6F4;">) {</span></span>
<span class="line"><span style="color:#F6F6F4;">        deptLogMapper.</span><span style="color:#62E884;">insert</span><span style="color:#F6F6F4;">(deptLog);</span></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Service</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">DeptLogServiceImpl</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">implements</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">DeptLogService</span><span style="color:#24292E;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Autowired</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> DeptLogMapper deptLogMapper;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Transactional</span><span style="color:#24292E;"> </span><span style="color:#6A737D;">//äº‹åŠ¡ä¼ æ’­è¡Œä¸ºï¼šæœ‰äº‹åŠ¡å°±åŠ å…¥ã€æ²¡æœ‰äº‹åŠ¡å°±æ–°å»ºäº‹åŠ¡</span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Override</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">insert</span><span style="color:#24292E;">(DeptLog </span><span style="color:#E36209;">deptLog</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">        deptLogMapper.</span><span style="color:#6F42C1;">insert</span><span style="color:#24292E;">(deptLog);</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><p><strong>ä»£ç å®ç°:</strong></p><p>ä¸šåŠ¡å®ç°ç±»ï¼šDeptServiceImpl</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Slf4j</span></span>
<span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Service</span></span>
<span class="line"><span style="color:#7B7F8B;">//@Transactional //å½“å‰ä¸šåŠ¡å®ç°ç±»ä¸­çš„æ‰€æœ‰çš„æ–¹æ³•ï¼Œéƒ½æ·»åŠ äº†springäº‹åŠ¡ç®¡ç†æœºåˆ¶</span></span>
<span class="line"><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">class</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;">DeptServiceImpl</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">implements</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">DeptService</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Autowired</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">private</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">DeptMapper</span><span style="color:#F6F6F4;"> deptMapper;</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Autowired</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">private</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">EmpMapper</span><span style="color:#F6F6F4;"> empMapper;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Autowired</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">private</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">DeptLogService</span><span style="color:#F6F6F4;"> deptLogService;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#7B7F8B;">//æ ¹æ®éƒ¨é—¨idï¼Œåˆ é™¤éƒ¨é—¨ä¿¡æ¯åŠéƒ¨é—¨ä¸‹çš„æ‰€æœ‰å‘˜å·¥</span></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Override</span></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Log</span></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Transactional</span><span style="color:#F6F6F4;">(</span><span style="color:#BF9EEE;">rollbackFor</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> Exception.class) </span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">delete</span><span style="color:#F6F6F4;">(</span><span style="color:#97E1F1;font-style:italic;">Integer</span><span style="color:#F6F6F4;"> </span><span style="color:#FFB86C;font-style:italic;">id</span><span style="color:#F6F6F4;">) </span><span style="color:#F286C4;">throws</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">Exception</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#F286C4;">try</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">            </span><span style="color:#7B7F8B;">//æ ¹æ®éƒ¨é—¨idåˆ é™¤éƒ¨é—¨ä¿¡æ¯</span></span>
<span class="line"><span style="color:#F6F6F4;">            deptMapper.</span><span style="color:#62E884;">deleteById</span><span style="color:#F6F6F4;">(id);</span></span>
<span class="line"><span style="color:#F6F6F4;">            </span><span style="color:#7B7F8B;">//æ¨¡æ‹Ÿï¼šå¼‚å¸¸</span></span>
<span class="line"><span style="color:#F6F6F4;">            </span><span style="color:#F286C4;">if</span><span style="color:#F6F6F4;">(</span><span style="color:#BF9EEE;">true</span><span style="color:#F6F6F4;">){</span></span>
<span class="line"><span style="color:#F6F6F4;">                </span><span style="color:#F286C4;">throw</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;font-weight:bold;">new</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">Exception</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">å‡ºç°å¼‚å¸¸äº†\`\`\`</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">);</span></span>
<span class="line"><span style="color:#F6F6F4;">            }</span></span>
<span class="line"><span style="color:#F6F6F4;">            </span><span style="color:#7B7F8B;">//åˆ é™¤éƒ¨é—¨ä¸‹çš„æ‰€æœ‰å‘˜å·¥ä¿¡æ¯</span></span>
<span class="line"><span style="color:#F6F6F4;">            empMapper.</span><span style="color:#62E884;">deleteByDeptId</span><span style="color:#F6F6F4;">(id);</span></span>
<span class="line"><span style="color:#F6F6F4;">        }</span><span style="color:#F286C4;">finally</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">            </span><span style="color:#7B7F8B;">//ä¸è®ºæ˜¯å¦æœ‰å¼‚å¸¸ï¼Œæœ€ç»ˆéƒ½è¦æ‰§è¡Œçš„ä»£ç ï¼šè®°å½•æ—¥å¿—</span></span>
<span class="line"><span style="color:#F6F6F4;">            </span><span style="color:#97E1F1;font-style:italic;">DeptLog</span><span style="color:#F6F6F4;"> deptLog </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;font-weight:bold;">new</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">DeptLog</span><span style="color:#F6F6F4;">();</span></span>
<span class="line"><span style="color:#F6F6F4;">            deptLog.</span><span style="color:#62E884;">setCreateTime</span><span style="color:#F6F6F4;">(LocalDateTime.</span><span style="color:#62E884;">now</span><span style="color:#F6F6F4;">());</span></span>
<span class="line"><span style="color:#F6F6F4;">            deptLog.</span><span style="color:#62E884;">setDescription</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">æ‰§è¡Œäº†è§£æ•£éƒ¨é—¨çš„æ“ä½œï¼Œæ­¤æ—¶è§£æ•£çš„æ˜¯</span><span style="color:#DEE492;">&quot;</span><span style="color:#F286C4;">+</span><span style="color:#F6F6F4;">id</span><span style="color:#F286C4;">+</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">å·éƒ¨é—¨</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">);</span></span>
<span class="line"><span style="color:#F6F6F4;">            </span><span style="color:#7B7F8B;">//è°ƒç”¨å…¶ä»–ä¸šåŠ¡ç±»ä¸­çš„æ–¹æ³•</span></span>
<span class="line"><span style="color:#F6F6F4;">            deptLogService.</span><span style="color:#62E884;">insert</span><span style="color:#F6F6F4;">(deptLog);</span></span>
<span class="line"><span style="color:#F6F6F4;">        }</span></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#7B7F8B;">//çœç•¥å…¶ä»–ä»£ç ...</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Slf4j</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Service</span></span>
<span class="line"><span style="color:#6A737D;">//@Transactional //å½“å‰ä¸šåŠ¡å®ç°ç±»ä¸­çš„æ‰€æœ‰çš„æ–¹æ³•ï¼Œéƒ½æ·»åŠ äº†springäº‹åŠ¡ç®¡ç†æœºåˆ¶</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">DeptServiceImpl</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">implements</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">DeptService</span><span style="color:#24292E;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Autowired</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> DeptMapper deptMapper;</span></span>
<span class="line"><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Autowired</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> EmpMapper empMapper;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Autowired</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> DeptLogService deptLogService;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//æ ¹æ®éƒ¨é—¨idï¼Œåˆ é™¤éƒ¨é—¨ä¿¡æ¯åŠéƒ¨é—¨ä¸‹çš„æ‰€æœ‰å‘˜å·¥</span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Override</span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Log</span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Transactional</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">rollbackFor</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> Exception.class) </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">delete</span><span style="color:#24292E;">(Integer </span><span style="color:#E36209;">id</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">throws</span><span style="color:#24292E;"> Exception {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">try</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6A737D;">//æ ¹æ®éƒ¨é—¨idåˆ é™¤éƒ¨é—¨ä¿¡æ¯</span></span>
<span class="line"><span style="color:#24292E;">            deptMapper.</span><span style="color:#6F42C1;">deleteById</span><span style="color:#24292E;">(id);</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6A737D;">//æ¨¡æ‹Ÿï¼šå¼‚å¸¸</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">if</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">true</span><span style="color:#24292E;">){</span></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#D73A49;">throw</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Exception</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;å‡ºç°å¼‚å¸¸äº†\`\`\`&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">            }</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6A737D;">//åˆ é™¤éƒ¨é—¨ä¸‹çš„æ‰€æœ‰å‘˜å·¥ä¿¡æ¯</span></span>
<span class="line"><span style="color:#24292E;">            empMapper.</span><span style="color:#6F42C1;">deleteByDeptId</span><span style="color:#24292E;">(id);</span></span>
<span class="line"><span style="color:#24292E;">        }</span><span style="color:#D73A49;">finally</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6A737D;">//ä¸è®ºæ˜¯å¦æœ‰å¼‚å¸¸ï¼Œæœ€ç»ˆéƒ½è¦æ‰§è¡Œçš„ä»£ç ï¼šè®°å½•æ—¥å¿—</span></span>
<span class="line"><span style="color:#24292E;">            DeptLog deptLog </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">DeptLog</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">            deptLog.</span><span style="color:#6F42C1;">setCreateTime</span><span style="color:#24292E;">(LocalDateTime.</span><span style="color:#6F42C1;">now</span><span style="color:#24292E;">());</span></span>
<span class="line"><span style="color:#24292E;">            deptLog.</span><span style="color:#6F42C1;">setDescription</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;æ‰§è¡Œäº†è§£æ•£éƒ¨é—¨çš„æ“ä½œï¼Œæ­¤æ—¶è§£æ•£çš„æ˜¯&quot;</span><span style="color:#D73A49;">+</span><span style="color:#24292E;">id</span><span style="color:#D73A49;">+</span><span style="color:#032F62;">&quot;å·éƒ¨é—¨&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6A737D;">//è°ƒç”¨å…¶ä»–ä¸šåŠ¡ç±»ä¸­çš„æ–¹æ³•</span></span>
<span class="line"><span style="color:#24292E;">            deptLogService.</span><span style="color:#6F42C1;">insert</span><span style="color:#24292E;">(deptLog);</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//çœç•¥å…¶ä»–ä»£ç ...</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><p><strong>æµ‹è¯•:</strong></p><p>é‡æ–°å¯åŠ¨SpringBootæœåŠ¡ï¼Œæµ‹è¯•åˆ é™¤3å·éƒ¨é—¨åä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ</p><ul><li>æ‰§è¡Œäº†åˆ é™¤3å·éƒ¨é—¨æ“ä½œ</li><li>æ‰§è¡Œäº†æ’å…¥éƒ¨é—¨æ—¥å¿—æ“ä½œ</li><li>ç¨‹åºå‘ç”ŸExceptionå¼‚å¸¸</li><li>æ‰§è¡Œäº‹åŠ¡å›æ»šï¼ˆåˆ é™¤ã€æ’å…¥æ“ä½œå› ä¸ºåœ¨ä¸€ä¸ªäº‹åŠ¡èŒƒå›´å†…ï¼Œä¸¤ä¸ªæ“ä½œéƒ½ä¼šè¢«å›æ»šï¼‰</li></ul><p><img src="http://www.yangeit.cn:21010/assets/image-20230109154025262-1460de71.png" alt="image-20230109154025262"></p><p>image-20230109154025262</p><p>ç„¶ååœ¨dept_logè¡¨ä¸­æ²¡æœ‰è®°å½•æ—¥å¿—æ•°æ®</p><p><img src="http://www.yangeit.cn:21010/assets/image-20230109154344393-300b6a96.png" alt="image-20230109154344393"></p><p>image-20230109154344393</p><p><strong>åŸå› åˆ†æ:</strong></p><p>æ¥ä¸‹æ¥æˆ‘ä»¬å°±éœ€è¦æ¥åˆ†æä¸€ä¸‹å…·ä½“æ˜¯ä»€ä¹ˆåŸå› å¯¼è‡´çš„æ—¥å¿—æ²¡æœ‰æˆåŠŸçš„è®°å½•ã€‚</p><ul><li><p>åœ¨æ‰§è¡Œdeleteæ“ä½œæ—¶å¼€å¯äº†ä¸€ä¸ªäº‹åŠ¡</p></li><li><p>å½“æ‰§è¡Œinsertæ“ä½œæ—¶ï¼Œinsertè®¾ç½®çš„äº‹åŠ¡ä¼ æ’­è¡Œæ˜¯é»˜è®¤å€¼REQUIREDï¼Œè¡¨ç¤ºæœ‰äº‹åŠ¡å°±åŠ å…¥ï¼Œæ²¡æœ‰åˆ™æ–°å»ºäº‹åŠ¡</p></li><li><p>æ­¤æ—¶ï¼šdeleteå’Œinsertæ“ä½œä½¿ç”¨äº†åŒä¸€ä¸ªäº‹åŠ¡ï¼ŒåŒä¸€ä¸ªäº‹åŠ¡ä¸­çš„å¤šä¸ªæ“ä½œï¼Œè¦ä¹ˆåŒæ—¶æˆåŠŸï¼Œè¦ä¹ˆåŒæ—¶å¤±è´¥ï¼Œæ‰€ä»¥å½“å¼‚å¸¸å‘ç”Ÿæ—¶è¿›è¡Œäº‹åŠ¡å›æ»šï¼Œå°±ä¼šå›æ»šdeleteå’Œinsertæ“ä½œ</p></li></ul><p><img src="http://www.yangeit.cn:21010/assets/image-20230109162420479-e1a0911d.png" alt="image-20230109162420479"></p><p>image-20230109162420479</p><p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong> ğŸ‘‡ ğŸ‘‡</p><p>åœ¨DeptLogServiceImplç±»ä¸­insertæ–¹æ³•ä¸Šï¼Œæ·»åŠ @Transactional(propagation = Propagation.REQUIRES_NEW)</p><blockquote><p>Propagation.REQUIRES_NEW ï¼šä¸è®ºæ˜¯å¦æœ‰äº‹åŠ¡ï¼Œéƒ½åˆ›å»ºæ–°äº‹åŠ¡ ï¼Œè¿è¡Œåœ¨ä¸€ä¸ªç‹¬ç«‹çš„äº‹åŠ¡ä¸­ã€‚</p></blockquote><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Service</span></span>
<span class="line"><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">class</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;">DeptLogServiceImpl</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">implements</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">DeptLogService</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Autowired</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">private</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">DeptLogMapper</span><span style="color:#F6F6F4;"> deptLogMapper;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Transactional</span><span style="color:#F6F6F4;">(</span><span style="color:#BF9EEE;">propagation</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> Propagation.REQUIRES_NEW)</span><span style="color:#7B7F8B;">//äº‹åŠ¡ä¼ æ’­è¡Œä¸ºï¼šä¸è®ºæ˜¯å¦æœ‰äº‹åŠ¡ï¼Œéƒ½æ–°å»ºäº‹åŠ¡</span></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Override</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">insert</span><span style="color:#F6F6F4;">(</span><span style="color:#97E1F1;font-style:italic;">DeptLog</span><span style="color:#F6F6F4;"> </span><span style="color:#FFB86C;font-style:italic;">deptLog</span><span style="color:#F6F6F4;">) {</span></span>
<span class="line"><span style="color:#F6F6F4;">        deptLogMapper.</span><span style="color:#62E884;">insert</span><span style="color:#F6F6F4;">(deptLog);</span></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Service</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">DeptLogServiceImpl</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">implements</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">DeptLogService</span><span style="color:#24292E;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Autowired</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> DeptLogMapper deptLogMapper;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Transactional</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">propagation</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> Propagation.REQUIRES_NEW)</span><span style="color:#6A737D;">//äº‹åŠ¡ä¼ æ’­è¡Œä¸ºï¼šä¸è®ºæ˜¯å¦æœ‰äº‹åŠ¡ï¼Œéƒ½æ–°å»ºäº‹åŠ¡</span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Override</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">insert</span><span style="color:#24292E;">(DeptLog </span><span style="color:#E36209;">deptLog</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">        deptLogMapper.</span><span style="color:#6F42C1;">insert</span><span style="color:#24292E;">(deptLog);</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><p>é‡å¯SpringBootæœåŠ¡ï¼Œå†æ¬¡æµ‹è¯•åˆ é™¤3å·éƒ¨é—¨ï¼š</p><p><img src="http://www.yangeit.cn:21010/assets/image-20230109170002879-52f6cedb.png" alt="image-20230109170002879"></p><p>image-20230109170002879</p><ol><li>æ­¤æ—¶ï¼ŒDeptServiceImplä¸­çš„deleteæ–¹æ³•è¿è¡Œæ—¶ï¼Œä¼šå¼€å¯ä¸€ä¸ªäº‹åŠ¡ã€‚</li><li>å½“è°ƒç”¨ deptLogService.insert(deptLog) æ—¶ï¼Œä¹Ÿä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„äº‹åŠ¡ï¼Œé‚£æ­¤æ—¶ï¼Œå½“insertæ–¹æ³•è¿è¡Œå®Œæ¯•ä¹‹åï¼Œäº‹åŠ¡å°±å·²ç»æäº¤äº†ã€‚</li><li>å³ä½¿å¤–éƒ¨çš„äº‹åŠ¡å‡ºç°å¼‚å¸¸ï¼Œå†…éƒ¨å·²ç»æäº¤çš„äº‹åŠ¡ï¼Œä¹Ÿä¸ä¼šå›æ»šäº†ï¼Œ<strong>å› ä¸ºæ˜¯ä¸¤ä¸ªç‹¬ç«‹çš„äº‹åŠ¡</strong>ã€‚</li></ol><p>äº‹åŠ¡çš„ä¼ æ’­è¡Œä¸º</p><ul><li><p>REQUIRED ï¼šå¤§éƒ¨åˆ†æƒ…å†µä¸‹éƒ½æ˜¯ç”¨è¯¥ä¼ æ’­è¡Œä¸ºå³å¯ã€‚</p></li><li><p>REQUIRES_NEW å®ç”¨ ï¼šå½“æˆ‘ä»¬ä¸å¸Œæœ›äº‹åŠ¡ä¹‹é—´ç›¸äº’å½±å“æ—¶ï¼Œå¯ä»¥ä½¿ç”¨è¯¥ä¼ æ’­è¡Œä¸ºã€‚æ¯”å¦‚ï¼šä¸‹è®¢å•å‰éœ€è¦è®°å½•æ—¥å¿—ï¼Œä¸è®ºè®¢å•ä¿å­˜æˆåŠŸä¸å¦ï¼Œéƒ½éœ€è¦ä¿è¯æ—¥å¿—è®°å½•èƒ½å¤Ÿè®°å½•æˆåŠŸã€‚</p></li></ul><p>ä½œä¸š</p><ol><li>ğŸš© èƒ½å¤Ÿæµç•…çš„è¯´å‡ºäº‹åŠ¡å›æ»šçš„æ³¨æ„äº‹é¡¹ä»¥åŠå¸¸ç”¨çš„äº‹åŠ¡ä¼ æ’­è¡Œä¸ºçš„ç‰¹ç‚¹ï¼Œ</li><li>ğŸš© èƒ½å¤Ÿå†™å‡ºæ—¥å¿—æ¡ˆä¾‹çš„æ€è·¯æµç¨‹å¹¶å®Œæˆ<code>è§£æ•£éƒ¨é—¨æ—¶éœ€è¦è®°å½•æ“ä½œæ—¥å¿—æ¡ˆä¾‹</code>ã€‚</li></ol><h2 id="_2-aopåŸºç¡€" tabindex="-1">2. AOPåŸºç¡€ <a class="header-anchor" href="#_2-aopåŸºç¡€" aria-label="Permalink to &quot;2\\. AOPåŸºç¡€&quot;">â€‹</a></h2><p>ç›®æ ‡ğŸ¯ ï¼š<strong>å­¦ä¹ AOPçš„åŸºç¡€ï¼Œç†è§£Aopçš„ä½œç”¨å’Œä¼˜åŠ¿ä»¥åŠAOPå¿«é€Ÿå…¥é—¨</strong></p><h3 id="_2-1-aopæ¦‚è¿°å’Œå¿«é€Ÿå…¥é—¨" tabindex="-1">2.1 AOPæ¦‚è¿°å’Œå¿«é€Ÿå…¥é—¨ <a class="header-anchor" href="#_2-1-aopæ¦‚è¿°å’Œå¿«é€Ÿå…¥é—¨" aria-label="Permalink to &quot;2.1 AOPæ¦‚è¿°å’Œå¿«é€Ÿå…¥é—¨&quot;">â€‹</a></h3><p>AOPçš„å®šä¹‰</p><ul><li>AOPè‹±æ–‡å…¨ç§°ï¼šAspect Oriented Programmingï¼ˆ<strong>é¢å‘åˆ‡é¢ç¼–ç¨‹ã€é¢å‘æ–¹é¢ç¼–ç¨‹</strong>ï¼‰ï¼Œå…¶å®è¯´ç™½äº†ï¼Œ<strong>é¢å‘åˆ‡é¢ç¼–ç¨‹å°±æ˜¯é¢å‘ç‰¹å®šæ–¹æ³•ç¼–ç¨‹</strong>ã€‚</li></ul><p>é‚£ä»€ä¹ˆåˆæ˜¯é¢å‘æ–¹æ³•ç¼–ç¨‹å‘¢ï¼Œ ä¸ºä»€ä¹ˆåˆéœ€è¦é¢å‘æ–¹æ³•ç¼–ç¨‹å‘¢ï¼Ÿ æ¥æˆ‘ä»¬ä¸¾ä¸ªä¾‹å­åšä¸€ä¸ªè¯´æ˜.</p><p>ç‚¹å‡»æŸ¥çœ‹ä¾‹å­ç†è§£ä¾‹å­çš„åœºæ™¯å’ŒAOPçš„ä¼˜åŠ¿</p><p>æ¯”å¦‚ï¼Œæˆ‘ä»¬è¿™é‡Œæœ‰ä¸€ä¸ªé¡¹ç›®ï¼Œé¡¹ç›®ä¸­å¼€å‘äº†å¾ˆå¤šçš„ä¸šåŠ¡åŠŸèƒ½ã€‚</p><p><img src="http://www.yangeit.cn:21010/assets/image-20230112154547523-e04fa344.png" alt="image-20230112154547523"></p><p>image-20230112154547523</p><p>ç„¶è€Œæœ‰ä¸€äº›ä¸šåŠ¡åŠŸèƒ½æ‰§è¡Œæ•ˆç‡æ¯”è¾ƒä½ï¼Œæ‰§è¡Œè€—æ—¶è¾ƒé•¿ï¼Œæˆ‘ä»¬éœ€è¦é’ˆå¯¹äºè¿™äº›ä¸šåŠ¡æ–¹æ³•è¿›è¡Œä¼˜åŒ–ã€‚ é‚£é¦–å…ˆç¬¬ä¸€æ­¥å°±éœ€è¦å®šä½å‡ºæ‰§è¡Œè€—æ—¶æ¯”è¾ƒé•¿çš„ä¸šåŠ¡æ–¹æ³•ï¼Œå†é’ˆå¯¹äºä¸šåŠ¡æ–¹æ³•å†æ¥è¿›è¡Œä¼˜åŒ–ã€‚</p><p>æ­¤æ—¶æˆ‘ä»¬å°±éœ€è¦ç»Ÿè®¡å½“å‰è¿™ä¸ªé¡¹ç›®å½“ä¸­æ¯ä¸€ä¸ªä¸šåŠ¡æ–¹æ³•çš„æ‰§è¡Œè€—æ—¶ã€‚é‚£ä¹ˆç»Ÿè®¡æ¯ä¸€ä¸ªä¸šåŠ¡æ–¹æ³•çš„æ‰§è¡Œè€—æ—¶è¯¥æ€ä¹ˆå®ç°ï¼Ÿ</p><p>å¯èƒ½å¤šæ•°äººé¦–å…ˆæƒ³åˆ°çš„å°±æ˜¯åœ¨æ¯ä¸€ä¸ªä¸šåŠ¡æ–¹æ³•è¿è¡Œä¹‹å‰ï¼Œè®°å½•è¿™ä¸ªæ–¹æ³•è¿è¡Œçš„å¼€å§‹æ—¶é—´ã€‚åœ¨è¿™ä¸ªæ–¹æ³•è¿è¡Œå®Œæ¯•ä¹‹åï¼Œå†æ¥è®°å½•è¿™ä¸ªæ–¹æ³•è¿è¡Œçš„ç»“æŸæ—¶é—´ã€‚æ‹¿ç»“æŸæ—¶é—´å‡å»å¼€å§‹æ—¶é—´ï¼Œä¸å°±æ˜¯è¿™ä¸ªæ–¹æ³•çš„æ‰§è¡Œè€—æ—¶å—ï¼Ÿ</p><p><img src="http://www.yangeit.cn:21010/assets/image-20230112154605206-a1ac8e55.png" alt="image-20230112154605206"></p><p>ä»¥ä¸Šåˆ†æçš„å®ç°æ–¹å¼æ˜¯å¯ä»¥è§£å†³éœ€æ±‚é—®é¢˜çš„ã€‚ä½†æ˜¯å¯¹äºä¸€ä¸ªé¡¹ç›®æ¥è®²ï¼Œé‡Œé¢ä¼šåŒ…å«å¾ˆå¤šçš„ä¸šåŠ¡æ¨¡å—ï¼Œæ¯ä¸ªä¸šåŠ¡æ¨¡å—åˆåŒ…å«å¾ˆå¤šå¢åˆ æ”¹æŸ¥çš„æ–¹æ³•ï¼Œå¦‚æœæˆ‘ä»¬è¦åœ¨æ¯ä¸€ä¸ªæ¨¡å—ä¸‹çš„ä¸šåŠ¡æ–¹æ³•ä¸­ï¼Œæ·»åŠ è®°å½•å¼€å§‹æ—¶é—´ã€ç»“æŸæ—¶é—´ã€è®¡ç®—æ‰§è¡Œè€—æ—¶çš„ä»£ç ï¼Œå°±ä¼šè®©ç¨‹åºå‘˜çš„å·¥ä½œå˜å¾—éå¸¸ç¹çã€‚</p><p><img src="http://www.yangeit.cn:21010/assets/image-20230112154627546-3ab4acd7.png" alt="image-20230112154627546"></p><p>è€ŒAOPé¢å‘æ–¹æ³•ç¼–ç¨‹ï¼Œå°±å¯ä»¥åšåˆ°åœ¨ä¸æ”¹åŠ¨è¿™äº›åŸå§‹æ–¹æ³•çš„åŸºç¡€ä¸Šï¼Œé’ˆå¯¹ç‰¹å®šçš„æ–¹æ³•è¿›è¡ŒåŠŸèƒ½çš„å¢å¼ºã€‚</p><blockquote><p>AOPçš„ä½œç”¨ï¼šåœ¨ç¨‹åºè¿è¡ŒæœŸé—´åœ¨ä¸ä¿®æ”¹æºä»£ç çš„åŸºç¡€ä¸Šå¯¹å·²æœ‰æ–¹æ³•è¿›è¡Œå¢å¼ºï¼ˆæ— ä¾µå…¥æ€§: è§£è€¦ï¼‰</p></blockquote><p>æˆ‘ä»¬è¦æƒ³å®Œæˆç»Ÿè®¡å„ä¸ªä¸šåŠ¡æ–¹æ³•æ‰§è¡Œè€—æ—¶çš„éœ€æ±‚ï¼Œæˆ‘ä»¬åªéœ€è¦å®šä¹‰ä¸€ä¸ªæ¨¡æ¿æ–¹æ³•ï¼Œå°†è®°å½•æ–¹æ³•æ‰§è¡Œè€—æ—¶è¿™ä¸€éƒ¨åˆ†å…¬å…±çš„é€»è¾‘ä»£ç ï¼Œå®šä¹‰åœ¨æ¨¡æ¿æ–¹æ³•å½“ä¸­ï¼Œåœ¨è¿™ä¸ªæ–¹æ³•å¼€å§‹è¿è¡Œä¹‹å‰ï¼Œæ¥è®°å½•è¿™ä¸ªæ–¹æ³•è¿è¡Œçš„å¼€å§‹æ—¶é—´ï¼Œåœ¨æ–¹æ³•ç»“æŸè¿è¡Œçš„æ—¶å€™ï¼Œå†æ¥è®°å½•æ–¹æ³•è¿è¡Œçš„ç»“æŸæ—¶é—´ï¼Œä¸­é—´å°±æ¥è¿è¡ŒåŸå§‹çš„ä¸šåŠ¡æ–¹æ³•ã€‚</p><p><img src="http://www.yangeit.cn:21010/assets/image-20230112154530101-9a9e93ef.png" alt="image-20230112154530101"></p><p>è€Œä¸­é—´è¿è¡Œçš„åŸå§‹ä¸šåŠ¡æ–¹æ³•ï¼Œå¯èƒ½æ˜¯å…¶ä¸­çš„ä¸€ä¸ªä¸šåŠ¡æ–¹æ³•ï¼Œæ¯”å¦‚ï¼šæˆ‘ä»¬åªæƒ³é€šè¿‡ éƒ¨é—¨ç®¡ç†çš„ list æ–¹æ³•çš„æ‰§è¡Œè€—æ—¶ï¼Œé‚£å°±åªæœ‰è¿™ä¸€ä¸ªæ–¹æ³•æ˜¯åŸå§‹ä¸šåŠ¡æ–¹æ³•ã€‚ è€Œå¦‚æœï¼Œæˆ‘ä»¬æ˜¯å…ˆæƒ³ç»Ÿè®¡æ‰€æœ‰éƒ¨é—¨ç®¡ç†çš„ä¸šåŠ¡æ–¹æ³•æ‰§è¡Œè€—æ—¶ï¼Œé‚£æ­¤æ—¶ï¼Œæ‰€æœ‰çš„éƒ¨é—¨ç®¡ç†çš„ä¸šåŠ¡æ–¹æ³•éƒ½æ˜¯ åŸå§‹ä¸šåŠ¡æ–¹æ³•ã€‚ <strong>é‚£é¢å‘è¿™æ ·çš„æŒ‡å®šçš„ä¸€ä¸ªæˆ–å¤šä¸ªæ–¹æ³•è¿›è¡Œç¼–ç¨‹ï¼Œæˆ‘ä»¬å°±ç§°ä¹‹ä¸º é¢å‘åˆ‡é¢ç¼–ç¨‹ã€‚</strong></p><p>é‚£æ­¤æ—¶ï¼Œå½“æˆ‘ä»¬å†è°ƒç”¨éƒ¨é—¨ç®¡ç†çš„ list ä¸šåŠ¡æ–¹æ³•æ—¶å•Šï¼Œå¹¶ä¸ä¼šç›´æ¥æ‰§è¡Œ list æ–¹æ³•çš„é€»è¾‘ï¼Œè€Œæ˜¯ä¼šæ‰§è¡Œæˆ‘ä»¬æ‰€å®šä¹‰çš„ æ¨¡æ¿æ–¹æ³• ï¼Œ ç„¶åå†æ¨¡æ¿æ–¹æ³•ä¸­ï¼š</p><ul><li>è®°å½•æ–¹æ³•è¿è¡Œå¼€å§‹æ—¶é—´</li><li>è¿è¡ŒåŸå§‹çš„ä¸šåŠ¡æ–¹æ³•ï¼ˆé‚£æ­¤æ—¶åŸå§‹çš„ä¸šåŠ¡æ–¹æ³•ï¼Œå°±æ˜¯ list æ–¹æ³•ï¼‰</li><li>è®°å½•æ–¹æ³•è¿è¡Œç»“æŸæ—¶é—´ï¼Œè®¡ç®—æ–¹æ³•æ‰§è¡Œè€—æ—¶</li></ul><p><img src="http://www.yangeit.cn:21010/assets/image-20230112155813944-02527c13.png" alt="image-20230112155813944"></p><p>ä¸è®ºï¼Œæˆ‘ä»¬è¿è¡Œçš„æ˜¯é‚£ä¸ªä¸šåŠ¡æ–¹æ³•ï¼Œæœ€åå…¶å®è¿è¡Œçš„å°±æ˜¯æˆ‘ä»¬å®šä¹‰çš„æ¨¡æ¿æ–¹æ³•ï¼Œè€Œåœ¨æ¨¡æ¿æ–¹æ³•ä¸­ï¼Œå°±å®Œæˆäº†åŸå§‹æ–¹æ³•æ‰§è¡Œè€—æ—¶çš„ç»Ÿè®¡æ“ä½œ ã€‚(é‚£è¿™æ ·å‘¢ï¼Œæˆ‘ä»¬å°±é€šè¿‡ä¸€ä¸ªæ¨¡æ¿æ–¹æ³•å°±å®Œæˆäº†æŒ‡å®šçš„ä¸€ä¸ªæˆ–å¤šä¸ªä¸šåŠ¡æ–¹æ³•æ‰§è¡Œè€—æ—¶çš„ç»Ÿè®¡)</p><p>è€Œå¤§å®¶ä¼šå‘ç°ï¼Œè¿™ä¸ªæµç¨‹ï¼Œæˆ‘ä»¬æ˜¯ä¸æ˜¯ä¼¼æ›¾ç›¸è¯†å•Šï¼Ÿ</p><p>å¯¹äº†ï¼Œå°±æ˜¯å’Œæˆ‘ä»¬ä¹‹å‰æ‰€å­¦ä¹ çš„åŠ¨æ€ä»£ç†æŠ€æœ¯æ˜¯éå¸¸ç±»ä¼¼çš„ã€‚ æˆ‘ä»¬æ‰€è¯´çš„æ¨¡æ¿æ–¹æ³•ï¼Œå…¶å®å°±æ˜¯ä»£ç†å¯¹è±¡ä¸­æ‰€å®šä¹‰çš„æ–¹æ³•ï¼Œé‚£ä»£ç†å¯¹è±¡ä¸­çš„æ–¹æ³•ä»¥åŠæ ¹æ®å¯¹åº”çš„ä¸šåŠ¡éœ€è¦ï¼Œ å®Œæˆäº†å¯¹åº”çš„ä¸šåŠ¡åŠŸèƒ½ï¼Œå½“è¿è¡ŒåŸå§‹ä¸šåŠ¡æ–¹æ³•æ—¶ï¼Œå°±ä¼šè¿è¡Œä»£ç†å¯¹è±¡ä¸­çš„æ–¹æ³•ï¼Œä»è€Œå®ç°ç»Ÿè®¡ä¸šåŠ¡æ–¹æ³•æ‰§è¡Œè€—æ—¶çš„æ“ä½œã€‚</p><p>å…¶å®ï¼ŒAOPé¢å‘åˆ‡é¢ç¼–ç¨‹å’ŒOOPé¢å‘å¯¹è±¡ç¼–ç¨‹ä¸€æ ·ï¼Œå®ƒä»¬éƒ½ä»…ä»…æ˜¯ä¸€ç§ç¼–ç¨‹æ€æƒ³ï¼Œè€ŒåŠ¨æ€ä»£ç†æŠ€æœ¯æ˜¯è¿™ç§æ€æƒ³æœ€ä¸»æµçš„å®ç°æ–¹å¼ã€‚è€ŒSpringçš„AOPæ˜¯Springæ¡†æ¶çš„é«˜çº§æŠ€æœ¯ï¼Œæ—¨åœ¨ç®¡ç†beanå¯¹è±¡çš„è¿‡ç¨‹ä¸­åº•å±‚ä½¿ç”¨åŠ¨æ€ä»£ç†æœºåˆ¶ï¼Œå¯¹ç‰¹å®šçš„æ–¹æ³•è¿›è¡Œç¼–ç¨‹(åŠŸèƒ½å¢å¼º)ã€‚</p><p>AOPçš„ä½œç”¨å’Œä¼˜åŠ¿</p><p><strong>AOPçš„ä½œç”¨</strong>ï¼šåœ¨ç¨‹åºè¿è¡ŒæœŸé—´åœ¨<strong>ä¸ä¿®æ”¹æºä»£ç </strong>çš„åŸºç¡€ä¸Šå¯¹å·²æœ‰æ–¹æ³•è¿›è¡Œ<strong>å¢å¼º</strong>ï¼ˆæ— ä¾µå…¥æ€§</p><p><strong>AOPçš„ä¼˜åŠ¿ï¼š</strong></p><ol><li>å‡å°‘é‡å¤ä»£ç </li><li>æé«˜å¼€å‘æ•ˆç‡</li><li>ç»´æŠ¤æ–¹ä¾¿</li></ol><p><strong>AOPå¿«é€Ÿå…¥é—¨</strong></p><p>éœ€æ±‚å’Œæ­¥éª¤</p><p><strong>éœ€æ±‚</strong>ï¼š ç»Ÿè®¡å„ä¸ªä¸šåŠ¡å±‚æ–¹æ³•æ‰§è¡Œè€—æ—¶ï¼ˆç»“æŸæ—¶é—´-å¼€å§‹æ—¶é—´ï¼‰ã€‚</p><p><strong>å®ç°æ­¥éª¤ï¼š</strong></p><ol><li>å¯¼å…¥ä¾èµ–ï¼šåœ¨pom.xmlä¸­å¯¼å…¥AOPçš„ä¾èµ–</li><li>ç¼–å†™AOPç¨‹åºï¼šåˆ›å»ºåˆ‡é¢ç±»ï¼Œé’ˆå¯¹äºç‰¹å®šæ–¹æ³•æ ¹æ®ä¸šåŠ¡éœ€è¦è¿›è¡Œç¼–ç¨‹</li></ol><blockquote><p>ä¸ºæ¼”ç¤ºæ–¹ä¾¿ï¼Œå¯ä»¥è‡ªå»ºæ–°é¡¹ç›®æˆ–å¯¼å…¥æä¾›çš„<code>springboot-aop-quickstart</code>é¡¹ç›®å·¥ç¨‹</p></blockquote><p><strong>pom.xml</strong></p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F6F6F4;">&lt;</span><span style="color:#F286C4;">dependency</span><span style="color:#F6F6F4;">&gt;</span></span>
<span class="line"><span style="color:#F6F6F4;">    &lt;</span><span style="color:#F286C4;">groupId</span><span style="color:#F6F6F4;">&gt;org.springframework.boot&lt;/</span><span style="color:#F286C4;">groupId</span><span style="color:#F6F6F4;">&gt;</span></span>
<span class="line"><span style="color:#F6F6F4;">    &lt;</span><span style="color:#F286C4;">artifactId</span><span style="color:#F6F6F4;">&gt;spring-boot-starter-aop&lt;/</span><span style="color:#F286C4;">artifactId</span><span style="color:#F6F6F4;">&gt;</span></span>
<span class="line"><span style="color:#F6F6F4;">&lt;/</span><span style="color:#F286C4;">dependency</span><span style="color:#F6F6F4;">&gt;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#22863A;">dependency</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">    &lt;</span><span style="color:#22863A;">groupId</span><span style="color:#24292E;">&gt;org.springframework.boot&lt;/</span><span style="color:#22863A;">groupId</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">    &lt;</span><span style="color:#22863A;">artifactId</span><span style="color:#24292E;">&gt;spring-boot-starter-aop&lt;/</span><span style="color:#22863A;">artifactId</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">&lt;/</span><span style="color:#22863A;">dependency</span><span style="color:#24292E;">&gt;</span></span></code></pre></div><p><strong>AOPç¨‹åºï¼šTimeAspect</strong></p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Component</span></span>
<span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Aspect</span><span style="color:#F6F6F4;"> </span><span style="color:#7B7F8B;">//å½“å‰ç±»ä¸ºåˆ‡é¢ç±»</span></span>
<span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Slf4j</span></span>
<span class="line"><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">class</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;">TimeAspect</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Around</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">execution(* com.itheima.service.*.*(..))</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">) </span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">Object</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">recordTime</span><span style="color:#F6F6F4;">(</span><span style="color:#97E1F1;font-style:italic;">ProceedingJoinPoint</span><span style="color:#F6F6F4;"> </span><span style="color:#FFB86C;font-style:italic;">pjp</span><span style="color:#F6F6F4;">) </span><span style="color:#F286C4;">throws</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">Throwable</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#7B7F8B;">//è®°å½•æ–¹æ³•æ‰§è¡Œå¼€å§‹æ—¶é—´</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#97E1F1;font-style:italic;">long</span><span style="color:#F6F6F4;"> begin </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> System.</span><span style="color:#62E884;">currentTimeMillis</span><span style="color:#F6F6F4;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#7B7F8B;">//æ‰§è¡ŒåŸå§‹æ–¹æ³•</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#97E1F1;font-style:italic;">Object</span><span style="color:#F6F6F4;"> result </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> pjp.</span><span style="color:#62E884;">proceed</span><span style="color:#F6F6F4;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#7B7F8B;">//è®°å½•æ–¹æ³•æ‰§è¡Œç»“æŸæ—¶é—´</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#97E1F1;font-style:italic;">long</span><span style="color:#F6F6F4;"> end </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> System.</span><span style="color:#62E884;">currentTimeMillis</span><span style="color:#F6F6F4;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#7B7F8B;">//è®¡ç®—æ–¹æ³•æ‰§è¡Œè€—æ—¶</span></span>
<span class="line"><span style="color:#F6F6F4;">        log.</span><span style="color:#62E884;">info</span><span style="color:#F6F6F4;">(pjp.</span><span style="color:#62E884;">getSignature</span><span style="color:#F6F6F4;">()</span><span style="color:#F286C4;">+</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">æ‰§è¡Œè€—æ—¶: {}æ¯«ç§’</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">,end</span><span style="color:#F286C4;">-</span><span style="color:#F6F6F4;">begin);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#F286C4;">return</span><span style="color:#F6F6F4;"> result;</span></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Component</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Aspect</span><span style="color:#24292E;"> </span><span style="color:#6A737D;">//å½“å‰ç±»ä¸ºåˆ‡é¢ç±»</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Slf4j</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">TimeAspect</span><span style="color:#24292E;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Around</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;execution(* com.itheima.service.*.*(..))&quot;</span><span style="color:#24292E;">) </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> Object </span><span style="color:#6F42C1;">recordTime</span><span style="color:#24292E;">(ProceedingJoinPoint </span><span style="color:#E36209;">pjp</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">throws</span><span style="color:#24292E;"> Throwable {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">//è®°å½•æ–¹æ³•æ‰§è¡Œå¼€å§‹æ—¶é—´</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">long</span><span style="color:#24292E;"> begin </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> System.</span><span style="color:#6F42C1;">currentTimeMillis</span><span style="color:#24292E;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">//æ‰§è¡ŒåŸå§‹æ–¹æ³•</span></span>
<span class="line"><span style="color:#24292E;">        Object result </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> pjp.</span><span style="color:#6F42C1;">proceed</span><span style="color:#24292E;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">//è®°å½•æ–¹æ³•æ‰§è¡Œç»“æŸæ—¶é—´</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">long</span><span style="color:#24292E;"> end </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> System.</span><span style="color:#6F42C1;">currentTimeMillis</span><span style="color:#24292E;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">//è®¡ç®—æ–¹æ³•æ‰§è¡Œè€—æ—¶</span></span>
<span class="line"><span style="color:#24292E;">        log.</span><span style="color:#6F42C1;">info</span><span style="color:#24292E;">(pjp.</span><span style="color:#6F42C1;">getSignature</span><span style="color:#24292E;">()</span><span style="color:#D73A49;">+</span><span style="color:#032F62;">&quot;æ‰§è¡Œè€—æ—¶: {}æ¯«ç§’&quot;</span><span style="color:#24292E;">,end</span><span style="color:#D73A49;">-</span><span style="color:#24292E;">begin);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> result;</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><p>é‡æ–°å¯åŠ¨SpringBootæœåŠ¡æµ‹è¯•ç¨‹åºï¼š</p><ul><li>æŸ¥è¯¢3å·éƒ¨é—¨ä¿¡æ¯</li></ul><p><img src="http://www.yangeit.cn:21010/assets/image-20230110143404792-44f1f9ea.png" alt="image-20230110143404792"></p><p>image-20230110143404792</p><p><img src="http://www.yangeit.cn:21010/assets/image-20230110143611669-3568677d.png" alt="image-20230110143611669"></p><p>image-20230110143611669</p><blockquote><p>æˆ‘ä»¬å¯ä»¥å†æµ‹è¯•ä¸‹ï¼šæŸ¥è¯¢æ‰€æœ‰éƒ¨é—¨ä¿¡æ¯ï¼ˆåŒæ ·æ‰§è¡ŒAOPç¨‹åºï¼‰</p><p><img src="http://www.yangeit.cn:21010/assets/image-20230110143815479-994108ca.png" alt="image-20230110143815479"></p><p>image-20230110143815479</p></blockquote><p>ç»“åˆä¸Šè¿°æ¡ˆä¾‹ï¼ŒAOPå¸¸è§çš„åº”ç”¨åœºæ™¯å¦‚ä¸‹ï¼š</p><ul><li>ä¸šåŠ¡æ–¹æ³•æ‰§è¡Œè€—æ—¶çš„ç»Ÿè®¡(å·²å®Œæˆ)</li><li>è®°å½•ç³»ç»Ÿçš„æ“ä½œæ—¥å¿—</li><li>æƒé™æ§åˆ¶</li><li><strong>äº‹åŠ¡ç®¡ç†</strong>ï¼šæˆ‘ä»¬å‰é¢æ‰€è®²è§£çš„Springäº‹åŠ¡ç®¡ç†ï¼Œåº•å±‚å…¶å®ä¹Ÿæ˜¯é€šè¿‡AOPæ¥å®ç°çš„ï¼Œåªè¦æ·»åŠ <code>@Transactional</code>æ³¨è§£ä¹‹åï¼ŒAOPç¨‹åºè‡ªåŠ¨ä¼šåœ¨åŸå§‹æ–¹æ³•è¿è¡Œå‰å…ˆæ¥å¼€å¯äº‹åŠ¡ï¼Œ<strong>åœ¨åŸå§‹æ–¹æ³•è¿è¡Œå®Œæ¯•ä¹‹åæäº¤æˆ–å›æ»šäº‹åŠ¡</strong></li></ul><h3 id="_2-2-aopæ ¸å¿ƒæ¦‚å¿µ-ğŸ" tabindex="-1">2.2 AOPæ ¸å¿ƒæ¦‚å¿µ ğŸ <a class="header-anchor" href="#_2-2-aopæ ¸å¿ƒæ¦‚å¿µ-ğŸ" aria-label="Permalink to &quot;2.2 AOPæ ¸å¿ƒæ¦‚å¿µ ğŸ&quot;">â€‹</a></h3><p>AOP æ ¸å¿ƒæ¦‚å¿µ</p><p><strong>1. è¿æ¥ç‚¹ï¼šJoinPoint</strong>ï¼Œå¯ä»¥è¢«AOPæ§åˆ¶çš„æ–¹æ³•ï¼ˆæš—å«æ–¹æ³•æ‰§è¡Œæ—¶çš„ç›¸å…³ä¿¡æ¯ï¼‰</p><p>è¿æ¥ç‚¹æŒ‡çš„æ˜¯å¯ä»¥è¢«aopæ§åˆ¶çš„æ–¹æ³•ã€‚ä¾‹å¦‚ï¼šå…¥é—¨ç¨‹åºå½“ä¸­æ‰€æœ‰çš„ä¸šåŠ¡æ–¹æ³•éƒ½æ˜¯å¯ä»¥è¢«aopæ§åˆ¶çš„æ–¹æ³•ã€‚</p><p><img src="http://www.yangeit.cn:21010/assets/image-20230112160708474-d56d9977.png" alt="image-20230112160708474"></p><p>åœ¨SpringAOPæä¾›çš„JoinPointå½“ä¸­ï¼Œå°è£…äº†è¿æ¥ç‚¹æ–¹æ³•åœ¨æ‰§è¡Œæ—¶çš„ç›¸å…³ä¿¡æ¯ã€‚ï¼ˆåé¢ä¼šæœ‰å…·ä½“çš„è®²è§£ï¼‰</p><p><strong>2. é€šçŸ¥ï¼šAdvice</strong>ï¼ŒæŒ‡å“ªäº›é‡å¤çš„é€»è¾‘ï¼Œä¹Ÿå°±æ˜¯å…±æ€§åŠŸèƒ½ï¼ˆæœ€ç»ˆä½“ç°ä¸ºä¸€ä¸ªæ–¹æ³•ï¼‰</p><p>åœ¨å…¥é—¨ç¨‹åºä¸­æ˜¯éœ€è¦ç»Ÿè®¡å„ä¸ªä¸šåŠ¡æ–¹æ³•çš„æ‰§è¡Œè€—æ—¶çš„ï¼Œæ­¤æ—¶æˆ‘ä»¬å°±éœ€è¦åœ¨è¿™äº›ä¸šåŠ¡æ–¹æ³•è¿è¡Œå¼€å§‹ä¹‹å‰ï¼Œå…ˆè®°å½•è¿™ä¸ªæ–¹æ³•è¿è¡Œçš„å¼€å§‹æ—¶é—´ï¼Œåœ¨æ¯ä¸€ä¸ªä¸šåŠ¡æ–¹æ³•è¿è¡Œç»“æŸçš„æ—¶å€™ï¼Œå†æ¥è®°å½•è¿™ä¸ªæ–¹æ³•è¿è¡Œçš„ç»“æŸæ—¶é—´ã€‚</p><p>ä½†æ˜¯åœ¨AOPé¢å‘åˆ‡é¢ç¼–ç¨‹å½“ä¸­ï¼Œæˆ‘ä»¬åªéœ€è¦å°†è¿™éƒ¨åˆ†é‡å¤çš„ä»£ç é€»è¾‘æŠ½å–å‡ºæ¥å•ç‹¬å®šä¹‰ã€‚æŠ½å–å‡ºæ¥çš„è¿™ä¸€éƒ¨åˆ†é‡å¤çš„é€»è¾‘ï¼Œä¹Ÿå°±æ˜¯å…±æ€§çš„åŠŸèƒ½ã€‚</p><p><img src="http://www.yangeit.cn:21010/assets/image-20230112160852883-89a74a0e.png" alt="image-20230112160852883"></p><p><strong>3. åˆ‡å…¥ç‚¹ï¼šPointCut</strong>ï¼ŒåŒ¹é…è¿æ¥ç‚¹çš„æ¡ä»¶ï¼Œé€šçŸ¥ä»…ä¼šåœ¨åˆ‡å…¥ç‚¹æ–¹æ³•æ‰§è¡Œæ—¶è¢«åº”ç”¨</p><p>åœ¨é€šçŸ¥å½“ä¸­ï¼Œæˆ‘ä»¬æ‰€å®šä¹‰çš„å…±æ€§åŠŸèƒ½åˆ°åº•è¦åº”ç”¨åœ¨å“ªäº›æ–¹æ³•ä¸Šï¼Ÿæ­¤æ—¶å°±æ¶‰åŠåˆ°äº†åˆ‡å…¥ç‚¹pointcutæ¦‚å¿µã€‚åˆ‡å…¥ç‚¹æŒ‡çš„æ˜¯åŒ¹é…è¿æ¥ç‚¹çš„æ¡ä»¶ã€‚é€šçŸ¥ä»…ä¼šåœ¨åˆ‡å…¥ç‚¹æ–¹æ³•è¿è¡Œæ—¶æ‰ä¼šè¢«åº”ç”¨ã€‚</p><p>åœ¨aopçš„å¼€å‘å½“ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šé€šè¿‡ä¸€ä¸ªåˆ‡å…¥ç‚¹è¡¨è¾¾å¼æ¥æè¿°åˆ‡å…¥ç‚¹(åé¢ä¼šæœ‰è¯¦è§£)ã€‚</p><p><img src="http://www.yangeit.cn:21010/assets/image-20230112161131937-8ab68e46.png" alt="image-20230112161131937"></p><p>å‡å¦‚ï¼šåˆ‡å…¥ç‚¹è¡¨è¾¾å¼æ”¹ä¸ºDeptServiceImpl.list()ï¼Œæ­¤æ—¶å°±ä»£è¡¨ä»…ä»…åªæœ‰listè¿™ä¸€ä¸ªæ–¹æ³•æ˜¯åˆ‡å…¥ç‚¹ã€‚åªæœ‰list()æ–¹æ³•åœ¨è¿è¡Œçš„æ—¶å€™æ‰ä¼šåº”ç”¨é€šçŸ¥ã€‚</p><p><strong>4. åˆ‡é¢ï¼šAspect</strong>ï¼Œæè¿°é€šçŸ¥ä¸åˆ‡å…¥ç‚¹çš„å¯¹åº”å…³ç³»ï¼ˆé€šçŸ¥+åˆ‡å…¥ç‚¹ï¼‰</p><p>å½“é€šçŸ¥å’Œåˆ‡å…¥ç‚¹ç»“åˆåœ¨ä¸€èµ·ï¼Œå°±å½¢æˆäº†ä¸€ä¸ªåˆ‡é¢ã€‚é€šè¿‡åˆ‡é¢å°±èƒ½å¤Ÿæè¿°å½“å‰aopç¨‹åºéœ€è¦é’ˆå¯¹äºå“ªä¸ªåŸå§‹æ–¹æ³•ï¼Œåœ¨ä»€ä¹ˆæ—¶å€™æ‰§è¡Œä»€ä¹ˆæ ·çš„æ“ä½œã€‚</p><p><img src="http://www.yangeit.cn:21010/assets/image-20230112161335186-b5c70ace.png" alt="image-20230112161335186"></p><p>åˆ‡é¢æ‰€åœ¨çš„ç±»ï¼Œæˆ‘ä»¬ä¸€èˆ¬ç§°ä¸º<strong>åˆ‡é¢ç±»</strong>ï¼ˆè¢«@Aspectæ³¨è§£æ ‡è¯†çš„ç±»ï¼‰</p><p><strong>5. ç›®æ ‡å¯¹è±¡ï¼šTarget</strong>ï¼Œé€šçŸ¥æ‰€åº”ç”¨çš„å¯¹è±¡</p><p>ç›®æ ‡å¯¹è±¡æŒ‡çš„å°±æ˜¯é€šçŸ¥æ‰€åº”ç”¨çš„å¯¹è±¡ï¼Œæˆ‘ä»¬å°±ç§°ä¹‹ä¸ºç›®æ ‡å¯¹è±¡ã€‚</p><p><img src="http://www.yangeit.cn:21010/assets/image-20230112161657667-5f4d221c.png" alt="image-20230112161657667"></p><p><strong>å®šä¹‰çš„é€šçŸ¥å¯¹ç›®æ ‡æ–¹æ³•å¢å¼ºæµç¨‹å¦‚ä¸‹ï¼š</strong></p><p><img src="http://www.yangeit.cn:21010/assets/image-20230112161821401-e67b4c92.png" alt="image-20230112161821401"></p><blockquote><p>Springçš„AOPåº•å±‚æ˜¯åŸºäºåŠ¨æ€ä»£ç†æŠ€æœ¯æ¥å®ç°çš„ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨ç¨‹åºè¿è¡Œçš„æ—¶å€™ï¼Œä¼šè‡ªåŠ¨çš„åŸºäºåŠ¨æ€ä»£ç†æŠ€æœ¯ä¸ºç›®æ ‡å¯¹è±¡ç”Ÿæˆä¸€ä¸ªå¯¹åº”çš„ä»£ç†å¯¹è±¡ã€‚åœ¨ä»£ç†å¯¹è±¡å½“ä¸­å°±ä¼šå¯¹ç›®æ ‡å¯¹è±¡å½“ä¸­çš„åŸå§‹æ–¹æ³•è¿›è¡ŒåŠŸèƒ½çš„å¢å¼ºã€‚</p></blockquote><p>æŸ¥çœ‹ä¸‹åˆ—å›¾ç‰‡ï¼Œå›ç­”é—®é¢˜ çœ‹å›¾ç†è§£æ ¸å¿ƒæ¦‚å¿µ</p><ul><li><p>ä¸‹åˆ—å“ªä¸ªæ˜¯ç›®æ ‡å¯¹è±¡ï¼Œå“ªä¸ªæ˜¯ä»£ç†å¯¹è±¡ï¼Ÿ</p><p><img src="http://www.yangeit.cn:21010/assets/image-20220513203556476-3922456c.png" alt="image-20220513203556476"></p><p>image-20220513203556476</p></li></ul><p>è¯¾å ‚ä½œä¸š</p><p>ğŸ» 1.å®ŒæˆAopå…¥é—¨æ¡ˆä¾‹ï¼ˆç»Ÿè®¡DeptServiceä¸­æ–¹æ³•ä¸­çš„æ‰§è¡Œæ•ˆç‡ï¼‰</p><h2 id="_3-aopè¿›é˜¶" tabindex="-1">3. AOPè¿›é˜¶ <a class="header-anchor" href="#_3-aopè¿›é˜¶" aria-label="Permalink to &quot;3\\. AOPè¿›é˜¶&quot;">â€‹</a></h2><p>ç›®æ ‡ğŸ¯ ï¼š<strong>å­¦ä¹ AOPä¸­å„ä¸ªç»†èŠ‚ï¼Œå¦‚ï¼šé€šçŸ¥ç±»å‹ã€é€šçŸ¥é¡ºåºã€åˆ‡å…¥ç‚¹è¡¨è¾¾å¼ã€è¿æ¥ç‚¹</strong></p><h3 id="_3-1-é€šçŸ¥ç±»å‹ğŸ" tabindex="-1">3.1 é€šçŸ¥ç±»å‹ğŸ <a class="header-anchor" href="#_3-1-é€šçŸ¥ç±»å‹ğŸ" aria-label="Permalink to &quot;3.1 é€šçŸ¥ç±»å‹ğŸ&quot;">â€‹</a></h3><p>Springä¸­AOPçš„é€šçŸ¥ç±»å‹ï¼š</p><ul><li><strong>@Around</strong>å¸¸ç”¨ï¼šç¯ç»•é€šçŸ¥ï¼Œæ­¤æ³¨è§£æ ‡æ³¨çš„é€šçŸ¥æ–¹æ³•åœ¨ç›®æ ‡æ–¹æ³•å‰ã€åéƒ½è¢«æ‰§è¡Œ</li><li><strong>@Before</strong>ï¼šå‰ç½®é€šçŸ¥ï¼Œæ­¤æ³¨è§£æ ‡æ³¨çš„é€šçŸ¥æ–¹æ³•åœ¨ç›®æ ‡æ–¹æ³•å‰è¢«æ‰§è¡Œ</li><li><strong>@After</strong>ï¼šåç½®é€šçŸ¥ï¼Œæ­¤æ³¨è§£æ ‡æ³¨çš„é€šçŸ¥æ–¹æ³•åœ¨ç›®æ ‡æ–¹æ³•åè¢«æ‰§è¡Œï¼Œæ— è®ºæ˜¯å¦æœ‰å¼‚å¸¸éƒ½ä¼šæ‰§è¡Œ</li><li><strong>@AfterReturning</strong> ï¼š è¿”å›åé€šçŸ¥ï¼Œæ­¤æ³¨è§£æ ‡æ³¨çš„é€šçŸ¥æ–¹æ³•åœ¨ç›®æ ‡æ–¹æ³•åè¢«æ‰§è¡Œï¼Œæœ‰å¼‚å¸¸ä¸ä¼šæ‰§è¡Œ</li><li><strong>@AfterThrowing</strong> ï¼š å¼‚å¸¸åé€šçŸ¥ï¼Œæ­¤æ³¨è§£æ ‡æ³¨çš„é€šçŸ¥æ–¹æ³•å‘ç”Ÿå¼‚å¸¸åæ‰§è¡Œ</li></ul><p>ä¸‹é¢æˆ‘ä»¬é€šè¿‡ä»£ç æ¼”ç¤ºï¼Œæ¥åŠ æ·±å¯¹äºä¸åŒé€šçŸ¥ç±»å‹çš„ç†è§£ï¼š</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Slf4j</span></span>
<span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Component</span></span>
<span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Aspect</span></span>
<span class="line"><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">class</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;">MyAspect1</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#7B7F8B;">//å‰ç½®é€šçŸ¥</span></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Before</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">execution(* com.itheima.service.*.*(..))</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">)</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">before</span><span style="color:#F6F6F4;">(</span><span style="color:#97E1F1;font-style:italic;">JoinPoint</span><span style="color:#F6F6F4;"> </span><span style="color:#FFB86C;font-style:italic;">joinPoint</span><span style="color:#F6F6F4;">){</span></span>
<span class="line"><span style="color:#F6F6F4;">        log.</span><span style="color:#62E884;">info</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">before ...</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#7B7F8B;">//ç¯ç»•é€šçŸ¥</span></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Around</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">execution(* com.itheima.service.*.*(..))</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">)</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">Object</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">around</span><span style="color:#F6F6F4;">(</span><span style="color:#97E1F1;font-style:italic;">ProceedingJoinPoint</span><span style="color:#F6F6F4;"> </span><span style="color:#FFB86C;font-style:italic;">proceedingJoinPoint</span><span style="color:#F6F6F4;">) </span><span style="color:#F286C4;">throws</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">Throwable</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">        log.</span><span style="color:#62E884;">info</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">around before ...</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#7B7F8B;">//è°ƒç”¨ç›®æ ‡å¯¹è±¡çš„åŸå§‹æ–¹æ³•æ‰§è¡Œ</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#97E1F1;font-style:italic;">Object</span><span style="color:#F6F6F4;"> result </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> proceedingJoinPoint.</span><span style="color:#62E884;">proceed</span><span style="color:#F6F6F4;">();</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#7B7F8B;">//åŸå§‹æ–¹æ³•å¦‚æœæ‰§è¡Œæ—¶æœ‰å¼‚å¸¸ï¼Œç¯ç»•é€šçŸ¥ä¸­çš„åç½®ä»£ç ä¸ä¼šåœ¨æ‰§è¡Œäº†</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span></span>
<span class="line"><span style="color:#F6F6F4;">        log.</span><span style="color:#62E884;">info</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">around after ...</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">);</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#F286C4;">return</span><span style="color:#F6F6F4;"> result;</span></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#7B7F8B;">//åç½®é€šçŸ¥</span></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">After</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">execution(* com.itheima.service.*.*(..))</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">)</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">after</span><span style="color:#F6F6F4;">(</span><span style="color:#97E1F1;font-style:italic;">JoinPoint</span><span style="color:#F6F6F4;"> </span><span style="color:#FFB86C;font-style:italic;">joinPoint</span><span style="color:#F6F6F4;">){</span></span>
<span class="line"><span style="color:#F6F6F4;">        log.</span><span style="color:#62E884;">info</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">after ...</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">);</span></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#7B7F8B;">//è¿”å›åé€šçŸ¥ï¼ˆç¨‹åºåœ¨æ­£å¸¸æ‰§è¡Œçš„æƒ…å†µä¸‹ï¼Œä¼šæ‰§è¡Œçš„åç½®é€šçŸ¥ï¼‰</span></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">AfterReturning</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">execution(* com.itheima.service.*.*(..))</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">)</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">afterReturning</span><span style="color:#F6F6F4;">(</span><span style="color:#97E1F1;font-style:italic;">JoinPoint</span><span style="color:#F6F6F4;"> </span><span style="color:#FFB86C;font-style:italic;">joinPoint</span><span style="color:#F6F6F4;">){</span></span>
<span class="line"><span style="color:#F6F6F4;">        log.</span><span style="color:#62E884;">info</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">afterReturning ...</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">);</span></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#7B7F8B;">//å¼‚å¸¸é€šçŸ¥ï¼ˆç¨‹åºåœ¨å‡ºç°å¼‚å¸¸çš„æƒ…å†µä¸‹ï¼Œæ‰§è¡Œçš„åç½®é€šçŸ¥ï¼‰</span></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">AfterThrowing</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">execution(* com.itheima.service.*.*(..))</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">)</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">afterThrowing</span><span style="color:#F6F6F4;">(</span><span style="color:#97E1F1;font-style:italic;">JoinPoint</span><span style="color:#F6F6F4;"> </span><span style="color:#FFB86C;font-style:italic;">joinPoint</span><span style="color:#F6F6F4;">){</span></span>
<span class="line"><span style="color:#F6F6F4;">        log.</span><span style="color:#62E884;">info</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">afterThrowing ...</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">);</span></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Slf4j</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Component</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Aspect</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">MyAspect1</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//å‰ç½®é€šçŸ¥</span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Before</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;execution(* com.itheima.service.*.*(..))&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">before</span><span style="color:#24292E;">(JoinPoint </span><span style="color:#E36209;">joinPoint</span><span style="color:#24292E;">){</span></span>
<span class="line"><span style="color:#24292E;">        log.</span><span style="color:#6F42C1;">info</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;before ...&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//ç¯ç»•é€šçŸ¥</span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Around</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;execution(* com.itheima.service.*.*(..))&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> Object </span><span style="color:#6F42C1;">around</span><span style="color:#24292E;">(ProceedingJoinPoint </span><span style="color:#E36209;">proceedingJoinPoint</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">throws</span><span style="color:#24292E;"> Throwable {</span></span>
<span class="line"><span style="color:#24292E;">        log.</span><span style="color:#6F42C1;">info</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;around before ...&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">//è°ƒç”¨ç›®æ ‡å¯¹è±¡çš„åŸå§‹æ–¹æ³•æ‰§è¡Œ</span></span>
<span class="line"><span style="color:#24292E;">        Object result </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> proceedingJoinPoint.</span><span style="color:#6F42C1;">proceed</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">        </span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">//åŸå§‹æ–¹æ³•å¦‚æœæ‰§è¡Œæ—¶æœ‰å¼‚å¸¸ï¼Œç¯ç»•é€šçŸ¥ä¸­çš„åç½®ä»£ç ä¸ä¼šåœ¨æ‰§è¡Œäº†</span></span>
<span class="line"><span style="color:#24292E;">        </span></span>
<span class="line"><span style="color:#24292E;">        log.</span><span style="color:#6F42C1;">info</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;around after ...&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> result;</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//åç½®é€šçŸ¥</span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">After</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;execution(* com.itheima.service.*.*(..))&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">after</span><span style="color:#24292E;">(JoinPoint </span><span style="color:#E36209;">joinPoint</span><span style="color:#24292E;">){</span></span>
<span class="line"><span style="color:#24292E;">        log.</span><span style="color:#6F42C1;">info</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;after ...&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//è¿”å›åé€šçŸ¥ï¼ˆç¨‹åºåœ¨æ­£å¸¸æ‰§è¡Œçš„æƒ…å†µä¸‹ï¼Œä¼šæ‰§è¡Œçš„åç½®é€šçŸ¥ï¼‰</span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">AfterReturning</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;execution(* com.itheima.service.*.*(..))&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">afterReturning</span><span style="color:#24292E;">(JoinPoint </span><span style="color:#E36209;">joinPoint</span><span style="color:#24292E;">){</span></span>
<span class="line"><span style="color:#24292E;">        log.</span><span style="color:#6F42C1;">info</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;afterReturning ...&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//å¼‚å¸¸é€šçŸ¥ï¼ˆç¨‹åºåœ¨å‡ºç°å¼‚å¸¸çš„æƒ…å†µä¸‹ï¼Œæ‰§è¡Œçš„åç½®é€šçŸ¥ï¼‰</span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">AfterThrowing</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;execution(* com.itheima.service.*.*(..))&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">afterThrowing</span><span style="color:#24292E;">(JoinPoint </span><span style="color:#E36209;">joinPoint</span><span style="color:#24292E;">){</span></span>
<span class="line"><span style="color:#24292E;">        log.</span><span style="color:#6F42C1;">info</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;afterThrowing ...&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><p>é‡æ–°å¯åŠ¨SpringBootæœåŠ¡ï¼Œè¿›è¡Œæµ‹è¯•ï¼š</p><p><strong>1. æ²¡æœ‰å¼‚å¸¸æƒ…å†µä¸‹ï¼š</strong></p><ul><li>ä½¿ç”¨postmanæµ‹è¯•æŸ¥è¯¢æ‰€æœ‰éƒ¨é—¨æ•°æ®</li></ul><p><img src="http://www.yangeit.cn:21010/assets/image-20230110165514461-93ca142e.png" alt="image-20230110165514461"></p><p>image-20230110165514461</p><ul><li>æŸ¥çœ‹ideaä¸­æ§åˆ¶å°æ—¥å¿—è¾“å‡º</li></ul><p><img src="http://www.yangeit.cn:21010/assets/image-20230110165806934-6ffedb07.png" alt="image-20230110165806934"></p><p>image-20230110165806934</p><blockquote><p>ç¨‹åºæ²¡æœ‰å‘ç”Ÿå¼‚å¸¸çš„æƒ…å†µä¸‹ï¼Œ@AfterThrowingæ ‡è¯†çš„é€šçŸ¥æ–¹æ³•ä¸ä¼šæ‰§è¡Œã€‚</p></blockquote><p><strong>2. å‡ºç°å¼‚å¸¸æƒ…å†µä¸‹ï¼š</strong></p><p>ä¿®æ”¹DeptServiceImplä¸šåŠ¡å®ç°ç±»ä¸­çš„ä»£ç ï¼š æ·»åŠ å¼‚å¸¸</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Slf4j</span></span>
<span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Service</span></span>
<span class="line"><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">class</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;">DeptServiceImpl</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">implements</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">DeptService</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Autowired</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">private</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">DeptMapper</span><span style="color:#F6F6F4;"> deptMapper;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Override</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">List</span><span style="color:#F6F6F4;">&lt;Dept&gt; </span><span style="color:#62E884;">list</span><span style="color:#F6F6F4;">() {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#97E1F1;font-style:italic;">List</span><span style="color:#F6F6F4;">&lt;Dept&gt; deptList </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> deptMapper.</span><span style="color:#62E884;">list</span><span style="color:#F6F6F4;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#7B7F8B;">//æ¨¡æ‹Ÿå¼‚å¸¸</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#97E1F1;font-style:italic;">int</span><span style="color:#F6F6F4;"> num </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">10</span><span style="color:#F286C4;">/</span><span style="color:#BF9EEE;">0</span><span style="color:#F6F6F4;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#F286C4;">return</span><span style="color:#F6F6F4;"> deptList;</span></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#7B7F8B;">//çœç•¥å…¶ä»–ä»£ç ...</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Slf4j</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Service</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">DeptServiceImpl</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">implements</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">DeptService</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Autowired</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> DeptMapper deptMapper;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Override</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> List&lt;</span><span style="color:#D73A49;">Dept</span><span style="color:#24292E;">&gt; </span><span style="color:#6F42C1;">list</span><span style="color:#24292E;">() {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        List&lt;</span><span style="color:#D73A49;">Dept</span><span style="color:#24292E;">&gt; deptList </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> deptMapper.</span><span style="color:#6F42C1;">list</span><span style="color:#24292E;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">//æ¨¡æ‹Ÿå¼‚å¸¸</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">int</span><span style="color:#24292E;"> num </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">10</span><span style="color:#D73A49;">/</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> deptList;</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//çœç•¥å…¶ä»–ä»£ç ...</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><p>é‡æ–°å¯åŠ¨SpringBootæœåŠ¡ï¼Œæµ‹è¯•å‘ç”Ÿå¼‚å¸¸æƒ…å†µä¸‹é€šçŸ¥çš„æ‰§è¡Œï¼š</p><ul><li>æŸ¥çœ‹ideaä¸­æ§åˆ¶å°æ—¥å¿—è¾“å‡º</li></ul><p><img src="http://www.yangeit.cn:21010/assets/image-20230110171006874-93b8d7d5.png" alt="image-20230110171006874"></p><p>image-20230110171006874</p><p>ç¨‹åºå‘ç”Ÿå¼‚å¸¸çš„æƒ…å†µä¸‹ï¼š</p><ul><li><p>@AfterReturningæ ‡è¯†çš„é€šçŸ¥æ–¹æ³•ä¸ä¼šæ‰§è¡Œï¼Œ@AfterThrowing æ ‡è¯†çš„é€šçŸ¥æ–¹æ³•æ‰§è¡Œäº†</p></li><li><p>@Aroundç¯ç»•é€šçŸ¥ä¸­åŸå§‹æ–¹æ³•è°ƒç”¨æ—¶æœ‰å¼‚å¸¸ï¼Œé€šçŸ¥ä¸­çš„<strong>ç¯ç»•å</strong>çš„ä»£ç é€»è¾‘ä¹Ÿä¸ä¼šåœ¨æ‰§è¡Œäº† ï¼ˆå› ä¸ºåŸå§‹æ–¹æ³•è°ƒç”¨å·²ç»å‡ºå¼‚å¸¸äº†ï¼‰</p></li></ul><p>åœ¨ä½¿ç”¨é€šçŸ¥æ—¶çš„æ³¨æ„äº‹é¡¹ï¼š</p><ul><li>@Aroundç¯ç»•é€šçŸ¥éœ€è¦è‡ªå·±è°ƒç”¨ **ProceedingJoinPoint.proceed()**æ¥è®©åŸå§‹æ–¹æ³•æ‰§è¡Œï¼Œå…¶ä»–é€šçŸ¥ä¸éœ€è¦è€ƒè™‘ç›®æ ‡æ–¹æ³•æ‰§è¡Œ</li><li>@Aroundç¯ç»•é€šçŸ¥æ–¹æ³•çš„<strong>è¿”å›å€¼ï¼Œå¿…é¡»æŒ‡å®šä¸ºObject</strong>ï¼Œæ¥æ¥æ”¶åŸå§‹æ–¹æ³•çš„è¿”å›å€¼ï¼Œå¦åˆ™åŸå§‹æ–¹æ³•æ‰§è¡Œå®Œæ¯•ï¼Œæ˜¯è·å–ä¸åˆ°è¿”å›å€¼çš„ã€‚</li></ul><p>ç‚¹å‡»æŸ¥çœ‹ä»£ç ä¼˜åŒ–è¡¨è¾¾å¼æŠ½å–</p><p>äº”ç§å¸¸è§çš„é€šçŸ¥ç±»å‹ï¼Œæˆ‘ä»¬å·²ç»æµ‹è¯•å®Œæ¯•äº†ï¼Œæ­¤æ—¶æˆ‘ä»¬å†æ¥çœ‹ä¸€ä¸‹åˆšæ‰æ‰€ç¼–å†™çš„ä»£ç ï¼Œæœ‰ä»€ä¹ˆé—®é¢˜å—ï¼Ÿ</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#7B7F8B;">//å‰ç½®é€šçŸ¥</span></span>
<span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Before</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">execution(* com.itheima.service.*.*(..))</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7B7F8B;">//ç¯ç»•é€šçŸ¥</span></span>
<span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Around</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">execution(* com.itheima.service.*.*(..))</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">)</span></span>
<span class="line"><span style="color:#F6F6F4;">  </span></span>
<span class="line"><span style="color:#7B7F8B;">//åç½®é€šçŸ¥</span></span>
<span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">After</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">execution(* com.itheima.service.*.*(..))</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7B7F8B;">//è¿”å›åé€šçŸ¥ï¼ˆç¨‹åºåœ¨æ­£å¸¸æ‰§è¡Œçš„æƒ…å†µä¸‹ï¼Œä¼šæ‰§è¡Œçš„åç½®é€šçŸ¥ï¼‰</span></span>
<span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">AfterReturning</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">execution(* com.itheima.service.*.*(..))</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7B7F8B;">//å¼‚å¸¸é€šçŸ¥ï¼ˆç¨‹åºåœ¨å‡ºç°å¼‚å¸¸çš„æƒ…å†µä¸‹ï¼Œæ‰§è¡Œçš„åç½®é€šçŸ¥ï¼‰</span></span>
<span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">AfterThrowing</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">execution(* com.itheima.service.*.*(..))</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">)</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">//å‰ç½®é€šçŸ¥</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Before</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;execution(* com.itheima.service.*.*(..))&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">//ç¯ç»•é€šçŸ¥</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Around</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;execution(* com.itheima.service.*.*(..))&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">  </span></span>
<span class="line"><span style="color:#6A737D;">//åç½®é€šçŸ¥</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">After</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;execution(* com.itheima.service.*.*(..))&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">//è¿”å›åé€šçŸ¥ï¼ˆç¨‹åºåœ¨æ­£å¸¸æ‰§è¡Œçš„æƒ…å†µä¸‹ï¼Œä¼šæ‰§è¡Œçš„åç½®é€šçŸ¥ï¼‰</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">AfterReturning</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;execution(* com.itheima.service.*.*(..))&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">//å¼‚å¸¸é€šçŸ¥ï¼ˆç¨‹åºåœ¨å‡ºç°å¼‚å¸¸çš„æƒ…å†µä¸‹ï¼Œæ‰§è¡Œçš„åç½®é€šçŸ¥ï¼‰</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">AfterThrowing</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;execution(* com.itheima.service.*.*(..))&quot;</span><span style="color:#24292E;">)</span></span></code></pre></div><p>æˆ‘ä»¬å‘ç°å•Šï¼Œæ¯ä¸€ä¸ªæ³¨è§£é‡Œé¢éƒ½æŒ‡å®šäº†åˆ‡å…¥ç‚¹è¡¨è¾¾å¼ï¼Œè€Œä¸”è¿™äº›åˆ‡å…¥ç‚¹è¡¨è¾¾å¼éƒ½ä¸€æ¨¡ä¸€æ ·ã€‚æ­¤æ—¶æˆ‘ä»¬çš„ä»£ç å½“ä¸­å°±å­˜åœ¨äº†å¤§é‡çš„é‡å¤æ€§çš„åˆ‡å…¥ç‚¹è¡¨è¾¾å¼ï¼Œå‡å¦‚æ­¤æ—¶åˆ‡å…¥ç‚¹è¡¨è¾¾å¼éœ€è¦å˜åŠ¨ï¼Œå°±éœ€è¦å°†æ‰€æœ‰çš„åˆ‡å…¥ç‚¹è¡¨è¾¾å¼ä¸€ä¸ªä¸€ä¸ªçš„æ¥æ”¹åŠ¨ï¼Œå°±å˜å¾—éå¸¸ç¹çäº†ã€‚</p><p>æ€ä¹ˆæ¥è§£å†³è¿™ä¸ªåˆ‡å…¥ç‚¹è¡¨è¾¾å¼é‡å¤çš„é—®é¢˜ï¼Ÿ ç­”æ¡ˆå°±æ˜¯ï¼š<strong>æŠ½å–</strong></p><p>Springæä¾›äº†@PointCutæ³¨è§£ï¼Œè¯¥æ³¨è§£çš„ä½œç”¨æ˜¯å°†å…¬å…±çš„åˆ‡å…¥ç‚¹è¡¨è¾¾å¼æŠ½å–å‡ºæ¥ï¼Œéœ€è¦ç”¨åˆ°æ—¶å¼•ç”¨è¯¥åˆ‡å…¥ç‚¹è¡¨è¾¾å¼å³å¯ã€‚</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Slf4j</span></span>
<span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Component</span></span>
<span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Aspect</span></span>
<span class="line"><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">class</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;">MyAspect1</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#7B7F8B;">//åˆ‡å…¥ç‚¹æ–¹æ³•ï¼ˆå…¬å…±çš„åˆ‡å…¥ç‚¹è¡¨è¾¾å¼ï¼‰</span></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Pointcut</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">execution(* com.itheima.service.*.*(..))</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">)</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">private</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">pt</span><span style="color:#F6F6F4;">(){</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#7B7F8B;">//å‰ç½®é€šçŸ¥ï¼ˆå¼•ç”¨åˆ‡å…¥ç‚¹ï¼‰</span></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Before</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">pt()</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">)</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">before</span><span style="color:#F6F6F4;">(</span><span style="color:#97E1F1;font-style:italic;">JoinPoint</span><span style="color:#F6F6F4;"> </span><span style="color:#FFB86C;font-style:italic;">joinPoint</span><span style="color:#F6F6F4;">){</span></span>
<span class="line"><span style="color:#F6F6F4;">        log.</span><span style="color:#62E884;">info</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">before ...</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#7B7F8B;">//ç¯ç»•é€šçŸ¥</span></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Around</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">pt()</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">)</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">Object</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">around</span><span style="color:#F6F6F4;">(</span><span style="color:#97E1F1;font-style:italic;">ProceedingJoinPoint</span><span style="color:#F6F6F4;"> </span><span style="color:#FFB86C;font-style:italic;">proceedingJoinPoint</span><span style="color:#F6F6F4;">) </span><span style="color:#F286C4;">throws</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">Throwable</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">        log.</span><span style="color:#62E884;">info</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">around before ...</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#7B7F8B;">//è°ƒç”¨ç›®æ ‡å¯¹è±¡çš„åŸå§‹æ–¹æ³•æ‰§è¡Œ</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#97E1F1;font-style:italic;">Object</span><span style="color:#F6F6F4;"> result </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> proceedingJoinPoint.</span><span style="color:#62E884;">proceed</span><span style="color:#F6F6F4;">();</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#7B7F8B;">//åŸå§‹æ–¹æ³•åœ¨æ‰§è¡Œæ—¶ï¼šå‘ç”Ÿå¼‚å¸¸</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#7B7F8B;">//åç»­ä»£ç ä¸åœ¨æ‰§è¡Œ</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">        log.</span><span style="color:#62E884;">info</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">around after ...</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">);</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#F286C4;">return</span><span style="color:#F6F6F4;"> result;</span></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#7B7F8B;">//åç½®é€šçŸ¥</span></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">After</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">pt()</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">)</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">after</span><span style="color:#F6F6F4;">(</span><span style="color:#97E1F1;font-style:italic;">JoinPoint</span><span style="color:#F6F6F4;"> </span><span style="color:#FFB86C;font-style:italic;">joinPoint</span><span style="color:#F6F6F4;">){</span></span>
<span class="line"><span style="color:#F6F6F4;">        log.</span><span style="color:#62E884;">info</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">after ...</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">);</span></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#7B7F8B;">//è¿”å›åé€šçŸ¥ï¼ˆç¨‹åºåœ¨æ­£å¸¸æ‰§è¡Œçš„æƒ…å†µä¸‹ï¼Œä¼šæ‰§è¡Œçš„åç½®é€šçŸ¥ï¼‰</span></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">AfterReturning</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">pt()</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">)</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">afterReturning</span><span style="color:#F6F6F4;">(</span><span style="color:#97E1F1;font-style:italic;">JoinPoint</span><span style="color:#F6F6F4;"> </span><span style="color:#FFB86C;font-style:italic;">joinPoint</span><span style="color:#F6F6F4;">){</span></span>
<span class="line"><span style="color:#F6F6F4;">        log.</span><span style="color:#62E884;">info</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">afterReturning ...</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">);</span></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#7B7F8B;">//å¼‚å¸¸é€šçŸ¥ï¼ˆç¨‹åºåœ¨å‡ºç°å¼‚å¸¸çš„æƒ…å†µä¸‹ï¼Œæ‰§è¡Œçš„åç½®é€šçŸ¥ï¼‰</span></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">AfterThrowing</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">pt()</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">)</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">afterThrowing</span><span style="color:#F6F6F4;">(</span><span style="color:#97E1F1;font-style:italic;">JoinPoint</span><span style="color:#F6F6F4;"> </span><span style="color:#FFB86C;font-style:italic;">joinPoint</span><span style="color:#F6F6F4;">){</span></span>
<span class="line"><span style="color:#F6F6F4;">        log.</span><span style="color:#62E884;">info</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">afterThrowing ...</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">);</span></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Slf4j</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Component</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Aspect</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">MyAspect1</span><span style="color:#24292E;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//åˆ‡å…¥ç‚¹æ–¹æ³•ï¼ˆå…¬å…±çš„åˆ‡å…¥ç‚¹è¡¨è¾¾å¼ï¼‰</span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Pointcut</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;execution(* com.itheima.service.*.*(..))&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">pt</span><span style="color:#24292E;">(){</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//å‰ç½®é€šçŸ¥ï¼ˆå¼•ç”¨åˆ‡å…¥ç‚¹ï¼‰</span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Before</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;pt()&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">before</span><span style="color:#24292E;">(JoinPoint </span><span style="color:#E36209;">joinPoint</span><span style="color:#24292E;">){</span></span>
<span class="line"><span style="color:#24292E;">        log.</span><span style="color:#6F42C1;">info</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;before ...&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//ç¯ç»•é€šçŸ¥</span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Around</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;pt()&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> Object </span><span style="color:#6F42C1;">around</span><span style="color:#24292E;">(ProceedingJoinPoint </span><span style="color:#E36209;">proceedingJoinPoint</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">throws</span><span style="color:#24292E;"> Throwable {</span></span>
<span class="line"><span style="color:#24292E;">        log.</span><span style="color:#6F42C1;">info</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;around before ...&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">//è°ƒç”¨ç›®æ ‡å¯¹è±¡çš„åŸå§‹æ–¹æ³•æ‰§è¡Œ</span></span>
<span class="line"><span style="color:#24292E;">        Object result </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> proceedingJoinPoint.</span><span style="color:#6F42C1;">proceed</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">//åŸå§‹æ–¹æ³•åœ¨æ‰§è¡Œæ—¶ï¼šå‘ç”Ÿå¼‚å¸¸</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">//åç»­ä»£ç ä¸åœ¨æ‰§è¡Œ</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        log.</span><span style="color:#6F42C1;">info</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;around after ...&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> result;</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//åç½®é€šçŸ¥</span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">After</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;pt()&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">after</span><span style="color:#24292E;">(JoinPoint </span><span style="color:#E36209;">joinPoint</span><span style="color:#24292E;">){</span></span>
<span class="line"><span style="color:#24292E;">        log.</span><span style="color:#6F42C1;">info</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;after ...&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//è¿”å›åé€šçŸ¥ï¼ˆç¨‹åºåœ¨æ­£å¸¸æ‰§è¡Œçš„æƒ…å†µä¸‹ï¼Œä¼šæ‰§è¡Œçš„åç½®é€šçŸ¥ï¼‰</span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">AfterReturning</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;pt()&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">afterReturning</span><span style="color:#24292E;">(JoinPoint </span><span style="color:#E36209;">joinPoint</span><span style="color:#24292E;">){</span></span>
<span class="line"><span style="color:#24292E;">        log.</span><span style="color:#6F42C1;">info</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;afterReturning ...&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//å¼‚å¸¸é€šçŸ¥ï¼ˆç¨‹åºåœ¨å‡ºç°å¼‚å¸¸çš„æƒ…å†µä¸‹ï¼Œæ‰§è¡Œçš„åç½®é€šçŸ¥ï¼‰</span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">AfterThrowing</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;pt()&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">afterThrowing</span><span style="color:#24292E;">(JoinPoint </span><span style="color:#E36209;">joinPoint</span><span style="color:#24292E;">){</span></span>
<span class="line"><span style="color:#24292E;">        log.</span><span style="color:#6F42C1;">info</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;afterThrowing ...&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼šå½“åˆ‡å…¥ç‚¹æ–¹æ³•ä½¿ç”¨privateä¿®é¥°æ—¶ï¼Œä»…èƒ½åœ¨å½“å‰åˆ‡é¢ç±»ä¸­å¼•ç”¨è¯¥è¡¨è¾¾å¼ï¼Œ å½“å¤–éƒ¨å…¶ä»–åˆ‡é¢ç±»ä¸­ä¹Ÿè¦å¼•ç”¨å½“å‰ç±»ä¸­çš„åˆ‡å…¥ç‚¹è¡¨è¾¾å¼ï¼Œå°±éœ€è¦æŠŠprivateæ”¹ä¸ºpublicï¼Œè€Œåœ¨å¼•ç”¨çš„æ—¶å€™ï¼Œå…·ä½“çš„è¯­æ³•ä¸ºï¼š</p><p>å…¨ç±»å.æ–¹æ³•å()ï¼Œå…·ä½“å½¢å¼å¦‚ä¸‹ï¼š</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Slf4j</span></span>
<span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Component</span></span>
<span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Aspect</span></span>
<span class="line"><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">class</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;">MyAspect2</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#7B7F8B;">//å¼•ç”¨MyAspect1åˆ‡é¢ç±»ä¸­çš„åˆ‡å…¥ç‚¹è¡¨è¾¾å¼</span></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Before</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">com.itheima.aspect.MyAspect1.pt()</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">)</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">before</span><span style="color:#F6F6F4;">(){</span></span>
<span class="line"><span style="color:#F6F6F4;">        log.</span><span style="color:#62E884;">info</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">MyAspect2 -&gt; before ...</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">);</span></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Slf4j</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Component</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Aspect</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">MyAspect2</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//å¼•ç”¨MyAspect1åˆ‡é¢ç±»ä¸­çš„åˆ‡å…¥ç‚¹è¡¨è¾¾å¼</span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Before</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;com.itheima.aspect.MyAspect1.pt()&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">before</span><span style="color:#24292E;">(){</span></span>
<span class="line"><span style="color:#24292E;">        log.</span><span style="color:#6F42C1;">info</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;MyAspect2 -&gt; before ...&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h3 id="_3-2-é€šçŸ¥é¡ºåº-ğŸš€-ğŸ" tabindex="-1">3.2 é€šçŸ¥é¡ºåº ğŸš€ ğŸ <a class="header-anchor" href="#_3-2-é€šçŸ¥é¡ºåº-ğŸš€-ğŸ" aria-label="Permalink to &quot;3.2 é€šçŸ¥é¡ºåº ğŸš€ ğŸ&quot;">â€‹</a></h3><p>ç›®æ ‡ğŸ¯ ï¼š<strong>äº†è§£é€šçŸ¥çš„æ‰§è¡Œé¡ºåº</strong></p><p>é€šçŸ¥çš„æ‰§è¡Œé¡ºåºå¤§å®¶ä¸»è¦çŸ¥é“ä¸¤ç‚¹å³å¯ï¼š</p><ol><li><p>ä¸åŒçš„åˆ‡é¢ç±»å½“ä¸­ï¼Œ<strong>é»˜è®¤æƒ…å†µä¸‹é€šçŸ¥çš„æ‰§è¡Œé¡ºåºæ˜¯ä¸åˆ‡é¢ç±»çš„ç±»åå­—æ¯æ’åºæ˜¯æœ‰å…³ç³»çš„</strong></p><ul><li>ç›®æ ‡æ–¹æ³•å‰çš„é€šçŸ¥æ–¹æ³•ï¼šå­—æ¯æ’åé å‰çš„å…ˆæ‰§è¡Œ</li><li>ç›®æ ‡æ–¹æ³•åçš„é€šçŸ¥æ–¹æ³•ï¼šå­—æ¯æ’åé å‰çš„åæ‰§è¡Œ</li></ul></li><li><p>å¯ä»¥åœ¨åˆ‡é¢ç±»ä¸Šé¢åŠ ä¸Š<code>@Order</code>æ³¨è§£ï¼Œæ¥æ§åˆ¶ä¸åŒçš„åˆ‡é¢ç±»é€šçŸ¥çš„<code>æ‰§è¡Œé¡ºåº</code></p><ul><li><code>@Order(x)</code> //åˆ‡é¢ç±»çš„æ‰§è¡Œé¡ºåºï¼ˆå‰ç½®é€šçŸ¥ï¼šæ•°å­—xè¶Šå°å…ˆæ‰§è¡Œ; åç½®é€šçŸ¥ï¼šæ•°å­—xè¶Šå°è¶Šåæ‰§è¡Œï¼‰</li></ul></li></ol><p>ç‚¹å‡»æŸ¥çœ‹é€šçŸ¥æ‰§è¡Œé¡ºåºçš„éªŒè¯ä»£ç </p><p><strong>å®šä¹‰å¤šä¸ªåˆ‡é¢ç±»ï¼š</strong> ğŸ‘‡ ğŸ‘‡</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Slf4j</span></span>
<span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Component</span></span>
<span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Aspect</span></span>
<span class="line"><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">class</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;">MyAspect2</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#7B7F8B;">//å‰ç½®é€šçŸ¥</span></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Before</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">execution(* com.itheima.service.*.*(..))</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">)</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">before</span><span style="color:#F6F6F4;">(){</span></span>
<span class="line"><span style="color:#F6F6F4;">        log.</span><span style="color:#62E884;">info</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">MyAspect2 -&gt; before ...</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">);</span></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#7B7F8B;">//åç½®é€šçŸ¥</span></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">After</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">execution(* com.itheima.service.*.*(..))</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">)</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">after</span><span style="color:#F6F6F4;">(){</span></span>
<span class="line"><span style="color:#F6F6F4;">        log.</span><span style="color:#62E884;">info</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">MyAspect2 -&gt; after ...</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">);</span></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Slf4j</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Component</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Aspect</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">MyAspect2</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//å‰ç½®é€šçŸ¥</span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Before</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;execution(* com.itheima.service.*.*(..))&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">before</span><span style="color:#24292E;">(){</span></span>
<span class="line"><span style="color:#24292E;">        log.</span><span style="color:#6F42C1;">info</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;MyAspect2 -&gt; before ...&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//åç½®é€šçŸ¥</span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">After</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;execution(* com.itheima.service.*.*(..))&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">after</span><span style="color:#24292E;">(){</span></span>
<span class="line"><span style="color:#24292E;">        log.</span><span style="color:#6F42C1;">info</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;MyAspect2 -&gt; after ...&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Slf4j</span></span>
<span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Component</span></span>
<span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Aspect</span></span>
<span class="line"><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">class</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;">MyAspect3</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#7B7F8B;">//å‰ç½®é€šçŸ¥</span></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Before</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">execution(* com.itheima.service.*.*(..))</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">)</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">before</span><span style="color:#F6F6F4;">(){</span></span>
<span class="line"><span style="color:#F6F6F4;">        log.</span><span style="color:#62E884;">info</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">MyAspect3 -&gt; before ...</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">);</span></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#7B7F8B;">//åç½®é€šçŸ¥</span></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">After</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">execution(* com.itheima.service.*.*(..))</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">)</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">after</span><span style="color:#F6F6F4;">(){</span></span>
<span class="line"><span style="color:#F6F6F4;">        log.</span><span style="color:#62E884;">info</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">MyAspect3 -&gt;  after ...</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">);</span></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Slf4j</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Component</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Aspect</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">MyAspect3</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//å‰ç½®é€šçŸ¥</span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Before</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;execution(* com.itheima.service.*.*(..))&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">before</span><span style="color:#24292E;">(){</span></span>
<span class="line"><span style="color:#24292E;">        log.</span><span style="color:#6F42C1;">info</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;MyAspect3 -&gt; before ...&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//åç½®é€šçŸ¥</span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">After</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;execution(* com.itheima.service.*.*(..))&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">after</span><span style="color:#24292E;">(){</span></span>
<span class="line"><span style="color:#24292E;">        log.</span><span style="color:#6F42C1;">info</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;MyAspect3 -&gt;  after ...&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Slf4j</span></span>
<span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Component</span></span>
<span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Aspect</span></span>
<span class="line"><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">class</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;">MyAspect4</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#7B7F8B;">//å‰ç½®é€šçŸ¥</span></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Before</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">execution(* com.itheima.service.*.*(..))</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">)</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">before</span><span style="color:#F6F6F4;">(){</span></span>
<span class="line"><span style="color:#F6F6F4;">        log.</span><span style="color:#62E884;">info</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">MyAspect4 -&gt; before ...</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">);</span></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#7B7F8B;">//åç½®é€šçŸ¥</span></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">After</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">execution(* com.itheima.service.*.*(..))</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">)</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">after</span><span style="color:#F6F6F4;">(){</span></span>
<span class="line"><span style="color:#F6F6F4;">        log.</span><span style="color:#62E884;">info</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">MyAspect4 -&gt; after ...</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">);</span></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Slf4j</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Component</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Aspect</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">MyAspect4</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//å‰ç½®é€šçŸ¥</span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Before</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;execution(* com.itheima.service.*.*(..))&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">before</span><span style="color:#24292E;">(){</span></span>
<span class="line"><span style="color:#24292E;">        log.</span><span style="color:#6F42C1;">info</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;MyAspect4 -&gt; before ...&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//åç½®é€šçŸ¥</span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">After</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;execution(* com.itheima.service.*.*(..))&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">after</span><span style="color:#24292E;">(){</span></span>
<span class="line"><span style="color:#24292E;">        log.</span><span style="color:#6F42C1;">info</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;MyAspect4 -&gt; after ...&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><p>é‡æ–°å¯åŠ¨SpringBootæœåŠ¡ï¼Œæµ‹è¯•é€šçŸ¥çš„æ‰§è¡Œé¡ºåºï¼š</p><blockquote><p>å¤‡æ³¨ï¼š</p><ol><li><p>æŠŠDeptServiceImplå®ç°ç±»ä¸­æ¨¡æ‹Ÿå¼‚å¸¸çš„ä»£ç åˆ é™¤æˆ–æ³¨é‡Šæ‰ã€‚</p></li><li><p>æ³¨é‡Šæ‰å…¶ä»–åˆ‡é¢ç±»(æŠŠ@Aspectæ³¨é‡Šå³å¯)ï¼Œä»…ä¿ç•™MyAspect2ã€MyAspect3ã€MyAspect4 ï¼Œè¿™æ ·å°±å¯ä»¥æ¸…æ™°çœ‹åˆ°æ‰§è¡Œçš„ç»“æœï¼Œè€Œä¸è¢«å…¶ä»–åˆ‡é¢ç±»å¹²æ‰°ã€‚</p></li></ol></blockquote><ul><li>ä½¿ç”¨postmanæµ‹è¯•æŸ¥è¯¢æ‰€æœ‰éƒ¨é—¨æ•°æ®</li></ul><p><img src="http://www.yangeit.cn:21010/assets/image-20230110165514461-93ca142e.png" alt="image-20230110165514461"></p><p>image-20230110165514461</p><ul><li>æŸ¥çœ‹ideaä¸­æ§åˆ¶å°æ—¥å¿—è¾“å‡º</li></ul><p><img src="http://www.yangeit.cn:21010/assets/image-20230110211208549-1b7b467b.png" alt="image-20230110211208549"></p><p>image-20230110211208549</p><p>å¦‚æœæˆ‘ä»¬æƒ³æ§åˆ¶é€šçŸ¥çš„æ‰§è¡Œé¡ºåºæœ‰ä¸¤ç§æ–¹å¼ï¼š ğŸ‘‡</p><ol><li>ä¿®æ”¹åˆ‡é¢ç±»çš„ç±»åï¼ˆè¿™ç§æ–¹å¼éå¸¸ç¹çã€è€Œä¸”ä¸ä¾¿ç®¡ç†ï¼‰</li><li>ä½¿ç”¨Springæä¾›çš„<code>@Order</code>æ³¨è§£æ¨è</li></ol><p>ä½¿ç”¨@Orderæ³¨è§£ï¼Œæ§åˆ¶é€šçŸ¥çš„æ‰§è¡Œé¡ºåºï¼š</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Slf4j</span></span>
<span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Component</span></span>
<span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Aspect</span></span>
<span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Order</span><span style="color:#F6F6F4;">(</span><span style="color:#BF9EEE;">2</span><span style="color:#F6F6F4;">)  </span><span style="color:#7B7F8B;">//åˆ‡é¢ç±»çš„æ‰§è¡Œé¡ºåºï¼ˆå‰ç½®é€šçŸ¥ï¼šæ•°å­—è¶Šå°å…ˆæ‰§è¡Œ; åç½®é€šçŸ¥ï¼šæ•°å­—è¶Šå°è¶Šåæ‰§è¡Œï¼‰</span></span>
<span class="line"><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">class</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;">MyAspect2</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#7B7F8B;">//å‰ç½®é€šçŸ¥</span></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Before</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">execution(* com.itheima.service.*.*(..))</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">)</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">before</span><span style="color:#F6F6F4;">(){</span></span>
<span class="line"><span style="color:#F6F6F4;">        log.</span><span style="color:#62E884;">info</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">MyAspect2 -&gt; before ...</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">);</span></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#7B7F8B;">//åç½®é€šçŸ¥ </span></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">After</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">execution(* com.itheima.service.*.*(..))</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">)</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">after</span><span style="color:#F6F6F4;">(){</span></span>
<span class="line"><span style="color:#F6F6F4;">        log.</span><span style="color:#62E884;">info</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">MyAspect2 -&gt; after ...</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">);</span></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Slf4j</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Component</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Aspect</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Order</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">2</span><span style="color:#24292E;">)  </span><span style="color:#6A737D;">//åˆ‡é¢ç±»çš„æ‰§è¡Œé¡ºåºï¼ˆå‰ç½®é€šçŸ¥ï¼šæ•°å­—è¶Šå°å…ˆæ‰§è¡Œ; åç½®é€šçŸ¥ï¼šæ•°å­—è¶Šå°è¶Šåæ‰§è¡Œï¼‰</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">MyAspect2</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//å‰ç½®é€šçŸ¥</span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Before</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;execution(* com.itheima.service.*.*(..))&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">before</span><span style="color:#24292E;">(){</span></span>
<span class="line"><span style="color:#24292E;">        log.</span><span style="color:#6F42C1;">info</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;MyAspect2 -&gt; before ...&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//åç½®é€šçŸ¥ </span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">After</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;execution(* com.itheima.service.*.*(..))&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">after</span><span style="color:#24292E;">(){</span></span>
<span class="line"><span style="color:#24292E;">        log.</span><span style="color:#6F42C1;">info</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;MyAspect2 -&gt; after ...&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Slf4j</span></span>
<span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Component</span></span>
<span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Aspect</span></span>
<span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Order</span><span style="color:#F6F6F4;">(</span><span style="color:#BF9EEE;">3</span><span style="color:#F6F6F4;">)  </span><span style="color:#7B7F8B;">//åˆ‡é¢ç±»çš„æ‰§è¡Œé¡ºåºï¼ˆå‰ç½®é€šçŸ¥ï¼šæ•°å­—è¶Šå°å…ˆæ‰§è¡Œ; åç½®é€šçŸ¥ï¼šæ•°å­—è¶Šå°è¶Šåæ‰§è¡Œï¼‰</span></span>
<span class="line"><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">class</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;">MyAspect3</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#7B7F8B;">//å‰ç½®é€šçŸ¥</span></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Before</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">execution(* com.itheima.service.*.*(..))</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">)</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">before</span><span style="color:#F6F6F4;">(){</span></span>
<span class="line"><span style="color:#F6F6F4;">        log.</span><span style="color:#62E884;">info</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">MyAspect3 -&gt; before ...</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">);</span></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#7B7F8B;">//åç½®é€šçŸ¥</span></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">After</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">execution(* com.itheima.service.*.*(..))</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">)</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">after</span><span style="color:#F6F6F4;">(){</span></span>
<span class="line"><span style="color:#F6F6F4;">        log.</span><span style="color:#62E884;">info</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">MyAspect3 -&gt;  after ...</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">);</span></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Slf4j</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Component</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Aspect</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Order</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">3</span><span style="color:#24292E;">)  </span><span style="color:#6A737D;">//åˆ‡é¢ç±»çš„æ‰§è¡Œé¡ºåºï¼ˆå‰ç½®é€šçŸ¥ï¼šæ•°å­—è¶Šå°å…ˆæ‰§è¡Œ; åç½®é€šçŸ¥ï¼šæ•°å­—è¶Šå°è¶Šåæ‰§è¡Œï¼‰</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">MyAspect3</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//å‰ç½®é€šçŸ¥</span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Before</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;execution(* com.itheima.service.*.*(..))&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">before</span><span style="color:#24292E;">(){</span></span>
<span class="line"><span style="color:#24292E;">        log.</span><span style="color:#6F42C1;">info</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;MyAspect3 -&gt; before ...&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//åç½®é€šçŸ¥</span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">After</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;execution(* com.itheima.service.*.*(..))&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">after</span><span style="color:#24292E;">(){</span></span>
<span class="line"><span style="color:#24292E;">        log.</span><span style="color:#6F42C1;">info</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;MyAspect3 -&gt;  after ...&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Slf4j</span></span>
<span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Component</span></span>
<span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Aspect</span></span>
<span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Order</span><span style="color:#F6F6F4;">(</span><span style="color:#BF9EEE;">1</span><span style="color:#F6F6F4;">) </span><span style="color:#7B7F8B;">//åˆ‡é¢ç±»çš„æ‰§è¡Œé¡ºåºï¼ˆå‰ç½®é€šçŸ¥ï¼šæ•°å­—è¶Šå°å…ˆæ‰§è¡Œ; åç½®é€šçŸ¥ï¼šæ•°å­—è¶Šå°è¶Šåæ‰§è¡Œï¼‰</span></span>
<span class="line"><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">class</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;">MyAspect4</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#7B7F8B;">//å‰ç½®é€šçŸ¥</span></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Before</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">execution(* com.itheima.service.*.*(..))</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">)</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">before</span><span style="color:#F6F6F4;">(){</span></span>
<span class="line"><span style="color:#F6F6F4;">        log.</span><span style="color:#62E884;">info</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">MyAspect4 -&gt; before ...</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">);</span></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#7B7F8B;">//åç½®é€šçŸ¥</span></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">After</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">execution(* com.itheima.service.*.*(..))</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">)</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">after</span><span style="color:#F6F6F4;">(){</span></span>
<span class="line"><span style="color:#F6F6F4;">        log.</span><span style="color:#62E884;">info</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">MyAspect4 -&gt; after ...</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">);</span></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Slf4j</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Component</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Aspect</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Order</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">) </span><span style="color:#6A737D;">//åˆ‡é¢ç±»çš„æ‰§è¡Œé¡ºåºï¼ˆå‰ç½®é€šçŸ¥ï¼šæ•°å­—è¶Šå°å…ˆæ‰§è¡Œ; åç½®é€šçŸ¥ï¼šæ•°å­—è¶Šå°è¶Šåæ‰§è¡Œï¼‰</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">MyAspect4</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//å‰ç½®é€šçŸ¥</span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Before</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;execution(* com.itheima.service.*.*(..))&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">before</span><span style="color:#24292E;">(){</span></span>
<span class="line"><span style="color:#24292E;">        log.</span><span style="color:#6F42C1;">info</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;MyAspect4 -&gt; before ...&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//åç½®é€šçŸ¥</span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">After</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;execution(* com.itheima.service.*.*(..))&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">after</span><span style="color:#24292E;">(){</span></span>
<span class="line"><span style="color:#24292E;">        log.</span><span style="color:#6F42C1;">info</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;MyAspect4 -&gt; after ...&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><p>é‡æ–°å¯åŠ¨SpringBootæœåŠ¡ï¼Œæµ‹è¯•é€šçŸ¥æ‰§è¡Œé¡ºåºï¼š</p><p><img src="http://www.yangeit.cn:21010/assets/image-20230110212523787-bc137011.png" alt="image-20230110212523787"></p><p>image-20230110212523787</p><h3 id="_3-3-è¿æ¥ç‚¹ä¿¡æ¯è·å–" tabindex="-1">3.3 è¿æ¥ç‚¹ä¿¡æ¯è·å– <a class="header-anchor" href="#_3-3-è¿æ¥ç‚¹ä¿¡æ¯è·å–" aria-label="Permalink to &quot;3.3 è¿æ¥ç‚¹ä¿¡æ¯è·å–&quot;">â€‹</a></h3><p>@Aroundé€šçŸ¥ï¼Œè·å–è¿æ¥ç‚¹ä¿¡æ¯æ˜¯ä»€ä¹ˆç±»ï¼Ÿ</p><ul><li><p>å¯¹äº<code>@Around</code>ç¯ç»•é€šçŸ¥ï¼Œè·å–è¿æ¥ç‚¹ä¿¡æ¯åªèƒ½ä½¿ç”¨<strong>ProceedingJoinPoint</strong>ç±»å‹</p></li><li><p>å¯¹äº<strong>å…¶ä»–å››ç§é€šçŸ¥</strong>ï¼Œè·å–è¿æ¥ç‚¹ä¿¡æ¯åªèƒ½ä½¿ç”¨<strong>JoinPoint</strong>ï¼Œå®ƒ<strong>æ˜¯ProceedingJoinPointçš„çˆ¶ç±»å‹</strong></p></li></ul><p>ç”¨<strong>ProceedingJoinPoint</strong>å’Œ<strong>JoinPoint</strong> å¯ä»¥è·å¾—æ–¹æ³•æ‰§è¡Œæ—¶çš„ç›¸å…³ä¿¡æ¯ï¼Œå¦‚ç›®æ ‡ç±»åã€æ–¹æ³•åã€æ–¹æ³•å‚æ•°ç­‰ã€‚</p><p>ç‚¹å‡»æŸ¥çœ‹ç¤ºä¾‹ä»£ç </p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Slf4j</span></span>
<span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Component</span></span>
<span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Aspect</span></span>
<span class="line"><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">class</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;">MyAspect7</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Pointcut</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">execution(* com.itheima.service.*.*(..))</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">)</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">private</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">pt</span><span style="color:#F6F6F4;">(){}</span></span>
<span class="line"><span style="color:#F6F6F4;">   </span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#7B7F8B;">//å‰ç½®é€šçŸ¥</span></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Before</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">pt()</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">)</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">before</span><span style="color:#F6F6F4;">(</span><span style="color:#97E1F1;font-style:italic;">JoinPoint</span><span style="color:#F6F6F4;"> </span><span style="color:#FFB86C;font-style:italic;">joinPoint</span><span style="color:#F6F6F4;">){</span></span>
<span class="line"><span style="color:#F6F6F4;">        log.</span><span style="color:#62E884;">info</span><span style="color:#F6F6F4;">(joinPoint.</span><span style="color:#62E884;">getSignature</span><span style="color:#F6F6F4;">().</span><span style="color:#62E884;">getName</span><span style="color:#F6F6F4;">() </span><span style="color:#F286C4;">+</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;"> MyAspect7 -&gt; before ...</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">);</span></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#7B7F8B;">//åç½®é€šçŸ¥</span></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Before</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">pt()</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">)</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">after</span><span style="color:#F6F6F4;">(</span><span style="color:#97E1F1;font-style:italic;">JoinPoint</span><span style="color:#F6F6F4;"> </span><span style="color:#FFB86C;font-style:italic;">joinPoint</span><span style="color:#F6F6F4;">){</span></span>
<span class="line"><span style="color:#F6F6F4;">        log.</span><span style="color:#62E884;">info</span><span style="color:#F6F6F4;">(joinPoint.</span><span style="color:#62E884;">getSignature</span><span style="color:#F6F6F4;">().</span><span style="color:#62E884;">getName</span><span style="color:#F6F6F4;">() </span><span style="color:#F286C4;">+</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;"> MyAspect7 -&gt; after ...</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">);</span></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#7B7F8B;">//ç¯ç»•é€šçŸ¥</span></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Around</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">pt()</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">)</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">Object</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">around</span><span style="color:#F6F6F4;">(</span><span style="color:#97E1F1;font-style:italic;">ProceedingJoinPoint</span><span style="color:#F6F6F4;"> </span><span style="color:#FFB86C;font-style:italic;">pjp</span><span style="color:#F6F6F4;">) </span><span style="color:#F286C4;">throws</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">Throwable</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#7B7F8B;">//è·å–ç›®æ ‡ç±»å</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#97E1F1;font-style:italic;">String</span><span style="color:#F6F6F4;"> name </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> pjp.</span><span style="color:#62E884;">getTarget</span><span style="color:#F6F6F4;">().</span><span style="color:#62E884;">getClass</span><span style="color:#F6F6F4;">().</span><span style="color:#62E884;">getName</span><span style="color:#F6F6F4;">();</span></span>
<span class="line"><span style="color:#F6F6F4;">        log.</span><span style="color:#62E884;">info</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">ç›®æ ‡ç±»åï¼š{}</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">,name);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#7B7F8B;">//ç›®æ ‡æ–¹æ³•å</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#97E1F1;font-style:italic;">String</span><span style="color:#F6F6F4;"> methodName </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> pjp.</span><span style="color:#62E884;">getSignature</span><span style="color:#F6F6F4;">().</span><span style="color:#62E884;">getName</span><span style="color:#F6F6F4;">();</span></span>
<span class="line"><span style="color:#F6F6F4;">        log.</span><span style="color:#62E884;">info</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">ç›®æ ‡æ–¹æ³•åï¼š{}</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">,methodName);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#7B7F8B;">//è·å–æ–¹æ³•æ‰§è¡Œæ—¶éœ€è¦çš„å‚æ•°</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#97E1F1;font-style:italic;">Object</span><span style="color:#F6F6F4;">[] args </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> pjp.</span><span style="color:#62E884;">getArgs</span><span style="color:#F6F6F4;">();</span></span>
<span class="line"><span style="color:#F6F6F4;">        log.</span><span style="color:#62E884;">info</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">ç›®æ ‡æ–¹æ³•å‚æ•°ï¼š{}</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">, Arrays.</span><span style="color:#62E884;">toString</span><span style="color:#F6F6F4;">(args));</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#7B7F8B;">//æ‰§è¡ŒåŸå§‹æ–¹æ³•</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#97E1F1;font-style:italic;">Object</span><span style="color:#F6F6F4;"> returnValue </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> pjp.</span><span style="color:#62E884;">proceed</span><span style="color:#F6F6F4;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#F286C4;">return</span><span style="color:#F6F6F4;"> returnValue;</span></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Slf4j</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Component</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Aspect</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">MyAspect7</span><span style="color:#24292E;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Pointcut</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;execution(* com.itheima.service.*.*(..))&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">pt</span><span style="color:#24292E;">(){}</span></span>
<span class="line"><span style="color:#24292E;">   </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//å‰ç½®é€šçŸ¥</span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Before</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;pt()&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">before</span><span style="color:#24292E;">(JoinPoint </span><span style="color:#E36209;">joinPoint</span><span style="color:#24292E;">){</span></span>
<span class="line"><span style="color:#24292E;">        log.</span><span style="color:#6F42C1;">info</span><span style="color:#24292E;">(joinPoint.</span><span style="color:#6F42C1;">getSignature</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">getName</span><span style="color:#24292E;">() </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot; MyAspect7 -&gt; before ...&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//åç½®é€šçŸ¥</span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Before</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;pt()&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">after</span><span style="color:#24292E;">(JoinPoint </span><span style="color:#E36209;">joinPoint</span><span style="color:#24292E;">){</span></span>
<span class="line"><span style="color:#24292E;">        log.</span><span style="color:#6F42C1;">info</span><span style="color:#24292E;">(joinPoint.</span><span style="color:#6F42C1;">getSignature</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">getName</span><span style="color:#24292E;">() </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot; MyAspect7 -&gt; after ...&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//ç¯ç»•é€šçŸ¥</span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Around</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;pt()&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> Object </span><span style="color:#6F42C1;">around</span><span style="color:#24292E;">(ProceedingJoinPoint </span><span style="color:#E36209;">pjp</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">throws</span><span style="color:#24292E;"> Throwable {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">//è·å–ç›®æ ‡ç±»å</span></span>
<span class="line"><span style="color:#24292E;">        String name </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> pjp.</span><span style="color:#6F42C1;">getTarget</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">getClass</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">getName</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">        log.</span><span style="color:#6F42C1;">info</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;ç›®æ ‡ç±»åï¼š{}&quot;</span><span style="color:#24292E;">,name);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">//ç›®æ ‡æ–¹æ³•å</span></span>
<span class="line"><span style="color:#24292E;">        String methodName </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> pjp.</span><span style="color:#6F42C1;">getSignature</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">getName</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">        log.</span><span style="color:#6F42C1;">info</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;ç›®æ ‡æ–¹æ³•åï¼š{}&quot;</span><span style="color:#24292E;">,methodName);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">//è·å–æ–¹æ³•æ‰§è¡Œæ—¶éœ€è¦çš„å‚æ•°</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">Object</span><span style="color:#24292E;">[] args </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> pjp.</span><span style="color:#6F42C1;">getArgs</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">        log.</span><span style="color:#6F42C1;">info</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;ç›®æ ‡æ–¹æ³•å‚æ•°ï¼š{}&quot;</span><span style="color:#24292E;">, Arrays.</span><span style="color:#6F42C1;">toString</span><span style="color:#24292E;">(args));</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">//æ‰§è¡ŒåŸå§‹æ–¹æ³•</span></span>
<span class="line"><span style="color:#24292E;">        Object returnValue </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> pjp.</span><span style="color:#6F42C1;">proceed</span><span style="color:#24292E;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> returnValue;</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><p>é‡æ–°å¯åŠ¨SpringBootæœåŠ¡ï¼Œæ‰§è¡ŒæŸ¥è¯¢éƒ¨é—¨æ•°æ®çš„åŠŸèƒ½ï¼š</p><p><img src="http://www.yangeit.cn:21010/assets/image-20230110231629140-0f0ce560.png" alt="image-20230110231629140"></p><p>image-20230110231629140</p><h3 id="_3-4-åˆ‡å…¥ç‚¹è¡¨è¾¾å¼-ğŸ-ğŸš€" tabindex="-1">3.4 åˆ‡å…¥ç‚¹è¡¨è¾¾å¼ ğŸ ğŸš€ <a class="header-anchor" href="#_3-4-åˆ‡å…¥ç‚¹è¡¨è¾¾å¼-ğŸ-ğŸš€" aria-label="Permalink to &quot;3.4 åˆ‡å…¥ç‚¹è¡¨è¾¾å¼ ğŸ ğŸš€&quot;">â€‹</a></h3><p>@annotationæ³¨è§£åŒ¹é…å®ç°æ­¥éª¤ï¼š</p><ol><li><p>ç¼–å†™è‡ªå®šä¹‰æ³¨è§£</p></li><li><p>åœ¨ä¸šåŠ¡ç±»è¦åšä¸ºè¿æ¥ç‚¹çš„æ–¹æ³•ä¸Šæ·»åŠ è‡ªå®šä¹‰æ³¨è§£</p></li></ol><p><strong>è‡ªå®šä¹‰æ³¨è§£</strong>ï¼šMyLog</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Target</span><span style="color:#F6F6F4;">(ElementType.METHOD)</span></span>
<span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Retention</span><span style="color:#F6F6F4;">(RetentionPolicy.RUNTIME)</span></span>
<span class="line"><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> @</span><span style="color:#F286C4;">interface</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">MyLog</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Target</span><span style="color:#24292E;">(ElementType.METHOD)</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Retention</span><span style="color:#24292E;">(RetentionPolicy.RUNTIME)</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> @</span><span style="color:#D73A49;">interface</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">MyLog</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><p><strong>ä¸šåŠ¡ç±»</strong>ï¼šDeptServiceImpl</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Slf4j</span></span>
<span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Service</span></span>
<span class="line"><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">class</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;">DeptServiceImpl</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">implements</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">DeptService</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Autowired</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">private</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">DeptMapper</span><span style="color:#F6F6F4;"> deptMapper;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Override</span></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">MyLog</span><span style="color:#F6F6F4;"> </span><span style="color:#7B7F8B;">//è‡ªå®šä¹‰æ³¨è§£ï¼ˆè¡¨ç¤ºï¼šå½“å‰æ–¹æ³•å±äºç›®æ ‡æ–¹æ³•ï¼‰</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">List</span><span style="color:#F6F6F4;">&lt;Dept&gt; </span><span style="color:#62E884;">list</span><span style="color:#F6F6F4;">() {</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#97E1F1;font-style:italic;">List</span><span style="color:#F6F6F4;">&lt;Dept&gt; deptList </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> deptMapper.</span><span style="color:#62E884;">list</span><span style="color:#F6F6F4;">();</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#7B7F8B;">//æ¨¡æ‹Ÿå¼‚å¸¸</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#7B7F8B;">//int num = 10/0;</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#F286C4;">return</span><span style="color:#F6F6F4;"> deptList;</span></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Override</span></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">MyLog</span><span style="color:#F6F6F4;">  </span><span style="color:#7B7F8B;">//è‡ªå®šä¹‰æ³¨è§£ï¼ˆè¡¨ç¤ºï¼šå½“å‰æ–¹æ³•å±äºç›®æ ‡æ–¹æ³•ï¼‰</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">delete</span><span style="color:#F6F6F4;">(</span><span style="color:#97E1F1;font-style:italic;">Integer</span><span style="color:#F6F6F4;"> </span><span style="color:#FFB86C;font-style:italic;">id</span><span style="color:#F6F6F4;">) {</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#7B7F8B;">//1. åˆ é™¤éƒ¨é—¨</span></span>
<span class="line"><span style="color:#F6F6F4;">        deptMapper.</span><span style="color:#62E884;">delete</span><span style="color:#F6F6F4;">(id);</span></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Override</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">save</span><span style="color:#F6F6F4;">(</span><span style="color:#97E1F1;font-style:italic;">Dept</span><span style="color:#F6F6F4;"> </span><span style="color:#FFB86C;font-style:italic;">dept</span><span style="color:#F6F6F4;">) {</span></span>
<span class="line"><span style="color:#F6F6F4;">        dept.</span><span style="color:#62E884;">setCreateTime</span><span style="color:#F6F6F4;">(LocalDateTime.</span><span style="color:#62E884;">now</span><span style="color:#F6F6F4;">());</span></span>
<span class="line"><span style="color:#F6F6F4;">        dept.</span><span style="color:#62E884;">setUpdateTime</span><span style="color:#F6F6F4;">(LocalDateTime.</span><span style="color:#62E884;">now</span><span style="color:#F6F6F4;">());</span></span>
<span class="line"><span style="color:#F6F6F4;">        deptMapper.</span><span style="color:#62E884;">save</span><span style="color:#F6F6F4;">(dept);</span></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Override</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">Dept</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">getById</span><span style="color:#F6F6F4;">(</span><span style="color:#97E1F1;font-style:italic;">Integer</span><span style="color:#F6F6F4;"> </span><span style="color:#FFB86C;font-style:italic;">id</span><span style="color:#F6F6F4;">) {</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#F286C4;">return</span><span style="color:#F6F6F4;"> deptMapper.</span><span style="color:#62E884;">getById</span><span style="color:#F6F6F4;">(id);</span></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Override</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">update</span><span style="color:#F6F6F4;">(</span><span style="color:#97E1F1;font-style:italic;">Dept</span><span style="color:#F6F6F4;"> </span><span style="color:#FFB86C;font-style:italic;">dept</span><span style="color:#F6F6F4;">) {</span></span>
<span class="line"><span style="color:#F6F6F4;">        dept.</span><span style="color:#62E884;">setUpdateTime</span><span style="color:#F6F6F4;">(LocalDateTime.</span><span style="color:#62E884;">now</span><span style="color:#F6F6F4;">());</span></span>
<span class="line"><span style="color:#F6F6F4;">        deptMapper.</span><span style="color:#62E884;">update</span><span style="color:#F6F6F4;">(dept);</span></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Slf4j</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Service</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">DeptServiceImpl</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">implements</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">DeptService</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Autowired</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> DeptMapper deptMapper;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Override</span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">MyLog</span><span style="color:#24292E;"> </span><span style="color:#6A737D;">//è‡ªå®šä¹‰æ³¨è§£ï¼ˆè¡¨ç¤ºï¼šå½“å‰æ–¹æ³•å±äºç›®æ ‡æ–¹æ³•ï¼‰</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> List&lt;</span><span style="color:#D73A49;">Dept</span><span style="color:#24292E;">&gt; </span><span style="color:#6F42C1;">list</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">        List&lt;</span><span style="color:#D73A49;">Dept</span><span style="color:#24292E;">&gt; deptList </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> deptMapper.</span><span style="color:#6F42C1;">list</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">//æ¨¡æ‹Ÿå¼‚å¸¸</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">//int num = 10/0;</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> deptList;</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Override</span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">MyLog</span><span style="color:#24292E;">  </span><span style="color:#6A737D;">//è‡ªå®šä¹‰æ³¨è§£ï¼ˆè¡¨ç¤ºï¼šå½“å‰æ–¹æ³•å±äºç›®æ ‡æ–¹æ³•ï¼‰</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">delete</span><span style="color:#24292E;">(Integer </span><span style="color:#E36209;">id</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">//1. åˆ é™¤éƒ¨é—¨</span></span>
<span class="line"><span style="color:#24292E;">        deptMapper.</span><span style="color:#6F42C1;">delete</span><span style="color:#24292E;">(id);</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Override</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">save</span><span style="color:#24292E;">(Dept </span><span style="color:#E36209;">dept</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">        dept.</span><span style="color:#6F42C1;">setCreateTime</span><span style="color:#24292E;">(LocalDateTime.</span><span style="color:#6F42C1;">now</span><span style="color:#24292E;">());</span></span>
<span class="line"><span style="color:#24292E;">        dept.</span><span style="color:#6F42C1;">setUpdateTime</span><span style="color:#24292E;">(LocalDateTime.</span><span style="color:#6F42C1;">now</span><span style="color:#24292E;">());</span></span>
<span class="line"><span style="color:#24292E;">        deptMapper.</span><span style="color:#6F42C1;">save</span><span style="color:#24292E;">(dept);</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Override</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> Dept </span><span style="color:#6F42C1;">getById</span><span style="color:#24292E;">(Integer </span><span style="color:#E36209;">id</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> deptMapper.</span><span style="color:#6F42C1;">getById</span><span style="color:#24292E;">(id);</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Override</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">update</span><span style="color:#24292E;">(Dept </span><span style="color:#E36209;">dept</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">        dept.</span><span style="color:#6F42C1;">setUpdateTime</span><span style="color:#24292E;">(LocalDateTime.</span><span style="color:#6F42C1;">now</span><span style="color:#24292E;">());</span></span>
<span class="line"><span style="color:#24292E;">        deptMapper.</span><span style="color:#6F42C1;">update</span><span style="color:#24292E;">(dept);</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><p><strong>åˆ‡é¢ç±»</strong></p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Slf4j</span></span>
<span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Component</span></span>
<span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Aspect</span></span>
<span class="line"><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">class</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;">MyAspect6</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#7B7F8B;">//é’ˆå¯¹listæ–¹æ³•ã€deleteæ–¹æ³•è¿›è¡Œå‰ç½®é€šçŸ¥å’Œåç½®é€šçŸ¥</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#7B7F8B;">//å‰ç½®é€šçŸ¥</span></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Before</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">@annotation(com.itheima.anno.MyLog)</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">)</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">before</span><span style="color:#F6F6F4;">(){</span></span>
<span class="line"><span style="color:#F6F6F4;">        log.</span><span style="color:#62E884;">info</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">MyAspect6 -&gt; before ...</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">);</span></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#7B7F8B;">//åç½®é€šçŸ¥</span></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">After</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">@annotation(com.itheima.anno.MyLog)</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">)</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">after</span><span style="color:#F6F6F4;">(){</span></span>
<span class="line"><span style="color:#F6F6F4;">        log.</span><span style="color:#62E884;">info</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">MyAspect6 -&gt; after ...</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">);</span></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Slf4j</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Component</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Aspect</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">MyAspect6</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//é’ˆå¯¹listæ–¹æ³•ã€deleteæ–¹æ³•è¿›è¡Œå‰ç½®é€šçŸ¥å’Œåç½®é€šçŸ¥</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//å‰ç½®é€šçŸ¥</span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Before</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;@annotation(com.itheima.anno.MyLog)&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">before</span><span style="color:#24292E;">(){</span></span>
<span class="line"><span style="color:#24292E;">        log.</span><span style="color:#6F42C1;">info</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;MyAspect6 -&gt; before ...&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//åç½®é€šçŸ¥</span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">After</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;@annotation(com.itheima.anno.MyLog)&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">after</span><span style="color:#24292E;">(){</span></span>
<span class="line"><span style="color:#24292E;">        log.</span><span style="color:#6F42C1;">info</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;MyAspect6 -&gt; after ...&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><p>é‡å¯SpringBootæœåŠ¡ï¼Œæµ‹è¯•æŸ¥è¯¢æ‰€æœ‰éƒ¨é—¨æ•°æ®ï¼ŒæŸ¥çœ‹æ§åˆ¶å°æ—¥å¿—ï¼š</p><p><img src="http://www.yangeit.cn:21010/assets/image-20230110224447047-509244df.png" alt="image-20230110224447047"></p><p>image-20230110224447047</p><p>executioné€šé…ç¬¦åŒ¹é…</p><p>executionä¸»è¦æ ¹æ®æ–¹æ³•çš„è¿”å›å€¼ã€åŒ…åã€ç±»åã€æ–¹æ³•åã€æ–¹æ³•å‚æ•°ç­‰ä¿¡æ¯æ¥åŒ¹é…ï¼Œè¯­æ³•ä¸ºï¼š</p><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#f6f6f4;">execution(è®¿é—®ä¿®é¥°ç¬¦?  è¿”å›å€¼  åŒ…å.ç±»å.?æ–¹æ³•å(æ–¹æ³•å‚æ•°) throws å¼‚å¸¸?)</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">execution(è®¿é—®ä¿®é¥°ç¬¦?  è¿”å›å€¼  åŒ…å.ç±»å.?æ–¹æ³•å(æ–¹æ³•å‚æ•°) throws å¼‚å¸¸?)</span></span></code></pre></div><p>å…¶ä¸­å¸¦<code>?</code>çš„è¡¨ç¤ºå¯ä»¥çœç•¥çš„éƒ¨åˆ†</p><ul><li>è®¿é—®ä¿®é¥°ç¬¦ï¼šå¯çœç•¥ï¼ˆæ¯”å¦‚: publicã€protectedï¼‰</li><li>åŒ…å.ç±»åï¼š å¯çœç•¥</li><li>throws å¼‚å¸¸ï¼šå¯çœç•¥ï¼ˆæ³¨æ„æ˜¯æ–¹æ³•ä¸Šå£°æ˜æŠ›å‡ºçš„å¼‚å¸¸ï¼Œä¸æ˜¯å®é™…æŠ›å‡ºçš„å¼‚å¸¸ï¼‰</li></ul><p>ç¤ºä¾‹ï¼š</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Before</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">execution(void com.itheima.service.impl.DeptServiceImpl.delete(java.lang.Integer))</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">)</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Before</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;execution(void com.itheima.service.impl.DeptServiceImpl.delete(java.lang.Integer))&quot;</span><span style="color:#24292E;">)</span></span></code></pre></div><p>ä½¿ç”¨é€šé…ç¬¦æè¿°åˆ‡å…¥ç‚¹</p><ul><li><p><code>*</code> ï¼šå•ä¸ªç‹¬ç«‹çš„ä»»æ„ç¬¦å·ï¼Œå¯ä»¥é€šé…ä»»æ„è¿”å›å€¼ã€åŒ…åã€ç±»åã€æ–¹æ³•åã€ä»»æ„ç±»å‹çš„ä¸€ä¸ªå‚æ•°ï¼Œä¹Ÿå¯ä»¥é€šé…åŒ…ã€ç±»ã€æ–¹æ³•åçš„ä¸€éƒ¨åˆ†</p></li><li><p><code>..</code> ï¼šå¤šä¸ªè¿ç»­çš„ä»»æ„ç¬¦å·ï¼Œå¯ä»¥é€šé…ä»»æ„å±‚çº§çš„åŒ…ï¼Œæˆ–ä»»æ„ç±»å‹ã€ä»»æ„ä¸ªæ•°çš„å‚æ•°</p></li></ul><p>åˆ‡å…¥ç‚¹è¡¨è¾¾å¼çš„è¯­æ³•è§„åˆ™ä¸è¦æ­»èƒŒï¼Œç†è§£å³å¯ï¼š</p><ol><li>æ–¹æ³•çš„è®¿é—®ä¿®é¥°ç¬¦å¯ä»¥çœç•¥</li><li>è¿”å›å€¼å¯ä»¥ä½¿ç”¨<code>*</code>å·ä»£æ›¿ï¼ˆä»»æ„è¿”å›å€¼ç±»å‹ï¼‰</li><li>åŒ…åå¯ä»¥ä½¿ç”¨<code>*</code>å·ä»£æ›¿ï¼Œä»£è¡¨ä»»æ„åŒ…ï¼ˆä¸€å±‚åŒ…ä½¿ç”¨ä¸€ä¸ª<code>*</code>ï¼‰</li><li>ä½¿ç”¨<code>..</code>é…ç½®åŒ…åï¼Œæ ‡è¯†æ­¤åŒ…ä»¥åŠæ­¤åŒ…ä¸‹çš„æ‰€æœ‰å­åŒ…</li><li>ç±»åå¯ä»¥ä½¿ç”¨<code>*</code>å·ä»£æ›¿ï¼Œæ ‡è¯†ä»»æ„ç±»</li><li>æ–¹æ³•åå¯ä»¥ä½¿ç”¨<code>*</code>å·ä»£æ›¿ï¼Œè¡¨ç¤ºä»»æ„æ–¹æ³•</li><li>å¯ä»¥ä½¿ç”¨ <code>*</code> é…ç½®å‚æ•°ï¼Œä¸€ä¸ªä»»æ„ç±»å‹çš„å‚æ•°</li><li>å¯ä»¥ä½¿ç”¨<code>..</code> é…ç½®å‚æ•°ï¼Œä»»æ„ä¸ªä»»æ„ç±»å‹çš„å‚æ•°</li></ol><p>ç‚¹å‡»æŸ¥çœ‹åˆ‡å…¥ç‚¹è¡¨è¾¾å¼ç¤ºä¾‹</p><ul><li><p>çœç•¥æ–¹æ³•çš„ä¿®é¥°ç¬¦å·</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#62E884;">execution</span><span style="color:#F6F6F4;">(</span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> com.itheima.service.impl.DeptServiceImpl.</span><span style="color:#62E884;">delete</span><span style="color:#F6F6F4;">(java.lang.Integer))</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">execution</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> com.itheima.service.impl.DeptServiceImpl.</span><span style="color:#6F42C1;">delete</span><span style="color:#24292E;">(java.lang.Integer))</span></span></code></pre></div></li><li><p>ä½¿ç”¨<code>*</code>ä»£æ›¿è¿”å›å€¼ç±»å‹</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#62E884;">execution</span><span style="color:#F6F6F4;">(</span><span style="color:#F286C4;">*</span><span style="color:#F6F6F4;"> com.itheima.service.impl.DeptServiceImpl.</span><span style="color:#62E884;">delete</span><span style="color:#F6F6F4;">(java.lang.Integer))</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">execution</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">*</span><span style="color:#24292E;"> com.itheima.service.impl.DeptServiceImpl.</span><span style="color:#6F42C1;">delete</span><span style="color:#24292E;">(java.lang.Integer))</span></span></code></pre></div></li><li><p>ä½¿ç”¨<code>*</code>ä»£æ›¿åŒ…åï¼ˆä¸€å±‚åŒ…ä½¿ç”¨ä¸€ä¸ª<code>*</code>ï¼‰</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#62E884;">execution</span><span style="color:#F6F6F4;">(</span><span style="color:#F286C4;">*</span><span style="color:#F6F6F4;"> com.itheima.</span><span style="color:#F286C4;">*</span><span style="color:#F6F6F4;">.</span><span style="color:#F286C4;">*</span><span style="color:#F6F6F4;">.DeptServiceImpl.</span><span style="color:#62E884;">delete</span><span style="color:#F6F6F4;">(java.lang.Integer))</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">execution</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">*</span><span style="color:#24292E;"> com.itheima.</span><span style="color:#D73A49;">*</span><span style="color:#24292E;">.</span><span style="color:#D73A49;">*</span><span style="color:#24292E;">.DeptServiceImpl.</span><span style="color:#6F42C1;">delete</span><span style="color:#24292E;">(java.lang.Integer))</span></span></code></pre></div></li><li><p>ä½¿ç”¨<code>..</code>çœç•¥åŒ…å</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#62E884;">execution</span><span style="color:#F6F6F4;">(</span><span style="color:#F286C4;">*</span><span style="color:#F6F6F4;"> com..DeptServiceImpl.</span><span style="color:#62E884;">delete</span><span style="color:#F6F6F4;">(java.lang.Integer))</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">execution</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">*</span><span style="color:#24292E;"> com..DeptServiceImpl.</span><span style="color:#6F42C1;">delete</span><span style="color:#24292E;">(java.lang.Integer))</span></span></code></pre></div></li><li><p>ä½¿ç”¨<code>*</code>ä»£æ›¿ç±»å</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#62E884;">execution</span><span style="color:#F6F6F4;">(</span><span style="color:#F286C4;">*</span><span style="color:#F6F6F4;"> com..</span><span style="color:#F286C4;">*</span><span style="color:#F6F6F4;">.</span><span style="color:#62E884;">delete</span><span style="color:#F6F6F4;">(java.lang.Integer))</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">execution</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">*</span><span style="color:#24292E;"> com..</span><span style="color:#D73A49;">*</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">delete</span><span style="color:#24292E;">(java.lang.Integer))</span></span></code></pre></div></li><li><p>ä½¿ç”¨<code>*</code>ä»£æ›¿æ–¹æ³•å</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#62E884;">execution</span><span style="color:#F6F6F4;">(</span><span style="color:#F286C4;">*</span><span style="color:#F6F6F4;"> com..</span><span style="color:#F286C4;">*</span><span style="color:#F6F6F4;">.</span><span style="color:#F286C4;">*</span><span style="color:#F6F6F4;">(java.lang.Integer))</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">execution</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">*</span><span style="color:#24292E;"> com..</span><span style="color:#D73A49;">*</span><span style="color:#24292E;">.</span><span style="color:#D73A49;">*</span><span style="color:#24292E;">(java.lang.Integer))</span></span></code></pre></div></li><li><p>ä½¿ç”¨ <code>*</code> ä»£æ›¿å‚æ•°</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#62E884;">execution</span><span style="color:#F6F6F4;">(</span><span style="color:#F286C4;">*</span><span style="color:#F6F6F4;"> com.itheima.service.impl.DeptServiceImpl.</span><span style="color:#62E884;">delete</span><span style="color:#F6F6F4;">(</span><span style="color:#F286C4;">*</span><span style="color:#F6F6F4;">))</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">execution</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">*</span><span style="color:#24292E;"> com.itheima.service.impl.DeptServiceImpl.</span><span style="color:#6F42C1;">delete</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">*</span><span style="color:#24292E;">))</span></span></code></pre></div></li><li><p>ä½¿ç”¨<code>..</code>çœç•¥å‚æ•°</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#62E884;">execution</span><span style="color:#F6F6F4;">(</span><span style="color:#F286C4;">*</span><span style="color:#F6F6F4;"> com..</span><span style="color:#F286C4;">*</span><span style="color:#F6F6F4;">.</span><span style="color:#F286C4;">*</span><span style="color:#F6F6F4;">(..))</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">execution</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">*</span><span style="color:#24292E;"> com..</span><span style="color:#D73A49;">*</span><span style="color:#24292E;">.</span><span style="color:#D73A49;">*</span><span style="color:#24292E;">(..))</span></span></code></pre></div></li></ul><p>æ³¨æ„äº‹é¡¹ï¼š</p><ul><li><p>æ ¹æ®ä¸šåŠ¡éœ€è¦ï¼Œå¯ä»¥ä½¿ç”¨ ä¸”ï¼ˆ&amp;&amp;ï¼‰ã€æˆ–ï¼ˆ||ï¼‰ã€éï¼ˆ!ï¼‰ æ¥ç»„åˆæ¯”è¾ƒå¤æ‚çš„åˆ‡å…¥ç‚¹è¡¨è¾¾å¼ã€‚</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#62E884;">execution</span><span style="color:#F6F6F4;">(</span><span style="color:#F286C4;">*</span><span style="color:#F6F6F4;"> com.itheima.service.DeptService.</span><span style="color:#62E884;">list</span><span style="color:#F6F6F4;">(..)) </span><span style="color:#F286C4;">||</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">execution</span><span style="color:#F6F6F4;">(</span><span style="color:#F286C4;">*</span><span style="color:#F6F6F4;"> com.itheima.service.DeptService.</span><span style="color:#62E884;">delete</span><span style="color:#F6F6F4;">(..))</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">execution</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">*</span><span style="color:#24292E;"> com.itheima.service.DeptService.</span><span style="color:#6F42C1;">list</span><span style="color:#24292E;">(..)) </span><span style="color:#D73A49;">||</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">execution</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">*</span><span style="color:#24292E;"> com.itheima.service.DeptService.</span><span style="color:#6F42C1;">delete</span><span style="color:#24292E;">(..))</span></span></code></pre></div></li></ul><p><strong>åˆ‡å…¥ç‚¹è¡¨è¾¾å¼çš„ä¹¦å†™å»ºè®®</strong>ğŸâ¤ï¸ï¼šä¼ä¸šå®ç”¨</p><ul><li><p>æ‰€æœ‰ä¸šåŠ¡æ–¹æ³•ååœ¨å‘½åæ—¶å°½é‡è§„èŒƒï¼Œæ–¹ä¾¿åˆ‡å…¥ç‚¹è¡¨è¾¾å¼å¿«é€ŸåŒ¹é…ã€‚å¦‚ï¼šæŸ¥è¯¢ç±»æ–¹æ³•éƒ½æ˜¯ find å¼€å¤´ï¼Œæ›´æ–°ç±»æ–¹æ³•éƒ½æ˜¯updateå¼€å¤´ ğŸ‘</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#7B7F8B;">//ä¸šåŠ¡ç±»</span></span>
<span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Service</span></span>
<span class="line"><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">class</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;">DeptServiceImpl</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">implements</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">DeptService</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">List</span><span style="color:#F6F6F4;">&lt;Dept&gt; </span><span style="color:#62E884;">findAllDept</span><span style="color:#F6F6F4;">() {</span></span>
<span class="line"><span style="color:#F6F6F4;">       </span><span style="color:#7B7F8B;">//çœç•¥ä»£ç ...</span></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">Dept</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">findDeptById</span><span style="color:#F6F6F4;">(</span><span style="color:#97E1F1;font-style:italic;">Integer</span><span style="color:#F6F6F4;"> </span><span style="color:#FFB86C;font-style:italic;">id</span><span style="color:#F6F6F4;">) {</span></span>
<span class="line"><span style="color:#F6F6F4;">       </span><span style="color:#7B7F8B;">//çœç•¥ä»£ç ...</span></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">updateDeptById</span><span style="color:#F6F6F4;">(</span><span style="color:#97E1F1;font-style:italic;">Integer</span><span style="color:#F6F6F4;"> </span><span style="color:#FFB86C;font-style:italic;">id</span><span style="color:#F6F6F4;">) {</span></span>
<span class="line"><span style="color:#F6F6F4;">       </span><span style="color:#7B7F8B;">//çœç•¥ä»£ç ...</span></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">updateDeptByMoreCondition</span><span style="color:#F6F6F4;">(</span><span style="color:#97E1F1;font-style:italic;">Dept</span><span style="color:#F6F6F4;"> </span><span style="color:#FFB86C;font-style:italic;">dept</span><span style="color:#F6F6F4;">) {</span></span>
<span class="line"><span style="color:#F6F6F4;">       </span><span style="color:#7B7F8B;">//çœç•¥ä»£ç ...</span></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#7B7F8B;">//å…¶ä»–ä»£ç ...</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">//ä¸šåŠ¡ç±»</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Service</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">DeptServiceImpl</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">implements</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">DeptService</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> List&lt;</span><span style="color:#D73A49;">Dept</span><span style="color:#24292E;">&gt; </span><span style="color:#6F42C1;">findAllDept</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">       </span><span style="color:#6A737D;">//çœç•¥ä»£ç ...</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> Dept </span><span style="color:#6F42C1;">findDeptById</span><span style="color:#24292E;">(Integer </span><span style="color:#E36209;">id</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">       </span><span style="color:#6A737D;">//çœç•¥ä»£ç ...</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">updateDeptById</span><span style="color:#24292E;">(Integer </span><span style="color:#E36209;">id</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">       </span><span style="color:#6A737D;">//çœç•¥ä»£ç ...</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">updateDeptByMoreCondition</span><span style="color:#24292E;">(Dept </span><span style="color:#E36209;">dept</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">       </span><span style="color:#6A737D;">//çœç•¥ä»£ç ...</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//å…¶ä»–ä»£ç ...</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#7B7F8B;">//åŒ¹é…DeptServiceImplç±»ä¸­ä»¥findå¼€å¤´çš„æ–¹æ³•</span></span>
<span class="line"><span style="color:#62E884;">execution</span><span style="color:#F6F6F4;">(</span><span style="color:#F286C4;">*</span><span style="color:#F6F6F4;"> com.itheima.service.impl.DeptServiceImpl.find</span><span style="color:#F286C4;">*</span><span style="color:#F6F6F4;">(..))</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">//åŒ¹é…DeptServiceImplç±»ä¸­ä»¥findå¼€å¤´çš„æ–¹æ³•</span></span>
<span class="line"><span style="color:#6F42C1;">execution</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">*</span><span style="color:#24292E;"> com.itheima.service.impl.DeptServiceImpl.find</span><span style="color:#D73A49;">*</span><span style="color:#24292E;">(..))</span></span></code></pre></div></li><li><p>æè¿°åˆ‡å…¥ç‚¹æ–¹æ³•é€šå¸¸åŸºäºæ¥å£æè¿°ï¼Œè€Œä¸æ˜¯ç›´æ¥æè¿°å®ç°ç±»ï¼Œå¢å¼ºæ‹“å±•æ€§ ğŸ‘</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#62E884;">execution</span><span style="color:#F6F6F4;">(</span><span style="color:#F286C4;">*</span><span style="color:#F6F6F4;"> com.itheima.service.DeptService.</span><span style="color:#F286C4;">*</span><span style="color:#F6F6F4;">(..))</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">execution</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">*</span><span style="color:#24292E;"> com.itheima.service.DeptService.</span><span style="color:#D73A49;">*</span><span style="color:#24292E;">(..))</span></span></code></pre></div></li><li><p>åœ¨æ»¡è¶³ä¸šåŠ¡éœ€è¦çš„å‰æä¸‹ï¼Œå°½é‡ç¼©å°åˆ‡å…¥ç‚¹çš„åŒ¹é…èŒƒå›´ã€‚å¦‚ï¼šåŒ…ååŒ¹é…å°½é‡ä¸ä½¿ç”¨ ..ï¼Œä½¿ç”¨ * åŒ¹é…å•ä¸ªåŒ… ğŸ‘</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#62E884;">execution</span><span style="color:#F6F6F4;">(</span><span style="color:#F286C4;">*</span><span style="color:#F6F6F4;"> com.itheima.</span><span style="color:#F286C4;">*</span><span style="color:#F6F6F4;">.</span><span style="color:#F286C4;">*</span><span style="color:#F6F6F4;">.DeptServiceImpl.find</span><span style="color:#F286C4;">*</span><span style="color:#F6F6F4;">(..))</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">execution</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">*</span><span style="color:#24292E;"> com.itheima.</span><span style="color:#D73A49;">*</span><span style="color:#24292E;">.</span><span style="color:#D73A49;">*</span><span style="color:#24292E;">.DeptServiceImpl.find</span><span style="color:#D73A49;">*</span><span style="color:#24292E;">(..))</span></span></code></pre></div></li></ul><p>æŠ€å·§</p><ul><li>executionåˆ‡å…¥ç‚¹è¡¨è¾¾å¼ <ul><li>æ ¹æ®æˆ‘ä»¬æ‰€æŒ‡å®šçš„æ–¹æ³•çš„æè¿°ä¿¡æ¯æ¥åŒ¹é…åˆ‡å…¥ç‚¹æ–¹æ³•ï¼Œè¿™ç§æ–¹å¼ä¹Ÿæ˜¯æœ€ä¸ºå¸¸ç”¨çš„ä¸€ç§æ–¹å¼</li><li>å¦‚æœæˆ‘ä»¬è¦åŒ¹é…çš„åˆ‡å…¥ç‚¹æ–¹æ³•çš„æ–¹æ³•åä¸è§„åˆ™ï¼Œæˆ–è€…æœ‰ä¸€äº›æ¯”è¾ƒç‰¹æ®Šçš„éœ€æ±‚ï¼Œé€šè¿‡executionåˆ‡å…¥ç‚¹è¡¨è¾¾å¼æè¿°æ¯”è¾ƒç¹ç</li></ul></li><li>annotation åˆ‡å…¥ç‚¹è¡¨è¾¾å¼ä¼ä¸šå®ç”¨ <ul><li>åŸºäºæ³¨è§£çš„æ–¹å¼æ¥åŒ¹é…åˆ‡å…¥ç‚¹æ–¹æ³•ã€‚è¿™ç§æ–¹å¼è™½ç„¶å¤šä¸€æ­¥æ“ä½œï¼Œæˆ‘ä»¬éœ€è¦è‡ªå®šä¹‰ä¸€ä¸ªæ³¨è§£ï¼Œä½†æ˜¯ç›¸å¯¹æ¥æ¯”è¾ƒçµæ´»ã€‚æˆ‘ä»¬éœ€è¦åŒ¹é…å“ªä¸ªæ–¹æ³•ï¼Œå°±åœ¨æ–¹æ³•ä¸ŠåŠ ä¸Šå¯¹åº”çš„æ³¨è§£å°±å¯ä»¥äº†</li></ul></li></ul><p>æ³¨æ„</p><p>å› ä¸ºAOPé¢å‘åˆ‡é¢ç¼–ç¨‹çš„ç‰¹æ€§ï¼Œå› æ­¤ä¹¦å†™AOPä»£ç éœ€è¦æ…é‡ï¼Œä»¥é˜²å¢å¼ºä¸éœ€è¦å¢å¼ºçš„ä»£ç </p><h2 id="_4-aopæ¡ˆä¾‹" tabindex="-1">4. AOPæ¡ˆä¾‹ <a class="header-anchor" href="#_4-aopæ¡ˆä¾‹" aria-label="Permalink to &quot;4\\. AOPæ¡ˆä¾‹&quot;">â€‹</a></h2><p>ç›®æ ‡ğŸ¯ ï¼š<strong>é€šè¿‡æ¡ˆä¾‹ç†è§£AOPé€šçŸ¥ç±»å‹çš„ä½¿ç”¨</strong></p><h3 id="_4-1-éœ€æ±‚" tabindex="-1">4.1 éœ€æ±‚ <a class="header-anchor" href="#_4-1-éœ€æ±‚" aria-label="Permalink to &quot;4.1 éœ€æ±‚&quot;">â€‹</a></h3><p>éœ€æ±‚ï¼šå°†æ¡ˆä¾‹ä¸­å¢ã€åˆ ã€æ”¹ç›¸å…³æ¥å£çš„æ“ä½œæ—¥å¿—è®°å½•åˆ°æ•°æ®åº“è¡¨ä¸­</p><ul><li>å°±æ˜¯å½“<strong>è®¿é—®</strong>éƒ¨é—¨ç®¡ç†å’Œå‘˜å·¥ç®¡ç†å½“ä¸­çš„<strong>å¢ã€åˆ ã€æ”¹</strong>ç›¸å…³åŠŸèƒ½æ¥å£æ—¶ï¼Œ<strong>éœ€è¦</strong>è¯¦ç»†çš„<strong>æ“ä½œæ—¥å¿—</strong>ï¼Œå¹¶<strong>ä¿å­˜</strong>åœ¨æ•°æ®è¡¨ä¸­ï¼Œä¾¿äºåæœŸ<strong>æ•°æ®è¿½è¸ª</strong>ã€‚ä¼ä¸šå®ç”¨</li></ul><p>æ“ä½œæ—¥å¿—ä¿¡æ¯åŒ…å«ï¼š</p><ul><li><strong>æ“ä½œäºº</strong>(æ‰€è®°å½•çš„æ—¥å¿—ä¿¡æ¯åŒ…æ‹¬å½“å‰æ¥å£çš„æ“ä½œäººæ˜¯è°æ“ä½œçš„)</li><li><strong>æ“ä½œæ—¶é—´</strong>(ä»€ä¹ˆæ—¶é—´ç‚¹æ“ä½œ)</li><li><strong>æ‰§è¡Œæ–¹æ³•çš„å…¨ç±»å</strong>(è®¿é—®çš„æ˜¯å“ªä¸ªç±»)</li><li><strong>æ‰§è¡Œæ–¹æ³•å</strong>(ç±»å½“ä¸­çš„å“ªä¸ªæ–¹æ³•)</li><li><strong>æ–¹æ³•è¿è¡Œæ—¶å‚æ•°</strong>(è®¿é—®è¿™ä¸ªæ–¹æ³•çš„æ—¶å€™ä¼ å…¥è¿›æ¥çš„å‚æ•°æ˜¯ä»€ä¹ˆ)</li><li><strong>è¿”å›å€¼</strong>(è®¿é—®è¿™ä¸ªæ–¹æ³•æœ€ç»ˆæ‹¿åˆ°çš„è¿”å›å€¼æ˜¯ä»€ä¹ˆ)</li><li><strong>æ–¹æ³•æ‰§è¡Œæ—¶é•¿</strong>(æ•´ä¸ªæ¥å£æ–¹æ³•çš„è¿è¡Œæ—¶é•¿æ˜¯å¤šé•¿æ—¶é—´)</li></ul><hr><p><strong>éœ€æ±‚åˆ†æï¼š</strong> ğŸ‘‡ ğŸ‘‡</p><p>é—®é¢˜1ï¼š é¡¹ç›®å½“ä¸­å¢åˆ æ”¹ç›¸å…³çš„æ–¹æ³• æ˜¯ä¸æ˜¯æœ‰å¾ˆå¤šï¼Ÿ</p><ul><li>å¾ˆå¤š</li></ul><p>é—®é¢˜2ï¼š æˆ‘ä»¬éœ€è¦é’ˆå¯¹æ¯ä¸€ä¸ªåŠŸèƒ½æ¥å£æ–¹æ³•è¿›è¡Œä¿®æ”¹ï¼Œåœ¨æ¯ä¸€ä¸ªåŠŸèƒ½æ¥å£ å½“ä¸­éƒ½æ¥è®°å½•è¿™äº›æ“ä½œæ—¥å¿—å—ï¼Ÿ</p><ul><li>è¿™ç§åšæ³•æ¯”è¾ƒç¹ç</li></ul><p>ä»¥ä¸Šä¸¤ä¸ªé—®é¢˜çš„è§£å†³æ–¹æ¡ˆï¼šå¯ä»¥ä½¿ç”¨AOPè§£å†³(æ¯ä¸€ä¸ªå¢åˆ æ”¹åŠŸèƒ½æ¥å£ä¸­è¦å®ç°çš„è®°å½•æ“ä½œæ—¥å¿—çš„é€»è¾‘ä»£ç æ˜¯ç›¸åŒ)ã€‚</p><blockquote><p>å¯ä»¥æŠŠè¿™éƒ¨åˆ†è®°å½•æ“ä½œæ—¥å¿—çš„é€šç”¨çš„ã€é‡å¤æ€§çš„é€»è¾‘ä»£ç æŠ½å–å‡ºæ¥å®šä¹‰åœ¨ä¸€ä¸ªé€šçŸ¥æ–¹æ³•å½“ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡AOPé¢å‘åˆ‡é¢ç¼–ç¨‹çš„æ–¹å¼ï¼Œåœ¨ä¸æ”¹åŠ¨åŸå§‹åŠŸèƒ½çš„åŸºç¡€ä¸Šæ¥å¯¹åŸå§‹çš„åŠŸèƒ½è¿›è¡Œå¢å¼ºã€‚ç›®å‰æˆ‘ä»¬æ‰€å¢å¼ºçš„åŠŸèƒ½å°±æ˜¯æ¥è®°å½•æ“ä½œæ—¥å¿—ï¼Œæ‰€ä»¥ä¹Ÿå¯ä»¥ä½¿ç”¨AOPçš„æŠ€æœ¯æ¥å®ç°ã€‚ä½¿ç”¨AOPçš„æŠ€æœ¯æ¥å®ç°ä¹Ÿæ˜¯æœ€ä¸ºç®€å•ï¼Œæœ€ä¸ºæ–¹ä¾¿çš„ã€‚</p></blockquote><p>é—®é¢˜3ï¼š æ—¢ç„¶è¦åŸºäºAOPé¢å‘åˆ‡é¢ç¼–ç¨‹çš„æ–¹å¼æ¥å®Œæˆçš„åŠŸèƒ½ï¼Œé‚£ä¹ˆæˆ‘ä»¬è¦ä½¿ç”¨ AOPäº”ç§é€šçŸ¥ç±»å‹å½“ä¸­çš„å“ªç§é€šçŸ¥ç±»å‹ï¼Ÿ</p><ul><li>ç­”æ¡ˆï¼šç¯ç»•é€šçŸ¥</li></ul><blockquote><p>æ‰€è®°å½•çš„æ“ä½œæ—¥å¿—å½“ä¸­åŒ…æ‹¬ï¼šæ“ä½œäººã€æ“ä½œæ—¶é—´ï¼Œè®¿é—®çš„æ˜¯å“ªä¸ªç±»ã€å“ªä¸ªæ–¹æ³•ã€æ–¹æ³•è¿è¡Œæ—¶å‚æ•°ã€æ–¹æ³•çš„è¿”å›å€¼ã€æ–¹æ³•çš„è¿è¡Œæ—¶é•¿ã€‚</p><p>æ–¹æ³•è¿”å›å€¼ï¼Œæ˜¯åœ¨åŸå§‹æ–¹æ³•æ‰§è¡Œåæ‰èƒ½è·å–åˆ°çš„ã€‚</p><p>æ–¹æ³•çš„è¿è¡Œæ—¶é•¿ï¼Œéœ€è¦åŸå§‹æ–¹æ³•è¿è¡Œä¹‹å‰è®°å½•å¼€å§‹æ—¶é—´ï¼ŒåŸå§‹æ–¹æ³•è¿è¡Œä¹‹åè®°å½•ç»“æŸæ—¶é—´ã€‚é€šè¿‡è®¡ç®—è·å¾—æ–¹æ³•çš„æ‰§è¡Œè€—æ—¶ã€‚</p><p>åŸºäºä»¥ä¸Šçš„åˆ†ææˆ‘ä»¬ç¡®å®šè¦ä½¿ç”¨Aroundç¯ç»•é€šçŸ¥ã€‚</p></blockquote><p>é—®é¢˜4ï¼š æœ€åä¸€ä¸ªé—®é¢˜ï¼Œåˆ‡å…¥ç‚¹è¡¨è¾¾å¼ æˆ‘ä»¬è¯¥æ€ä¹ˆå†™ï¼Ÿ</p><ul><li>ç­”æ¡ˆï¼šä½¿ç”¨annotationæ¥æè¿°è¡¨è¾¾å¼ <ul><li>è¦åŒ¹é…ä¸šåŠ¡æ¥å£å½“ä¸­æ‰€æœ‰çš„å¢åˆ æ”¹çš„æ–¹æ³•ï¼Œè€Œå¢åˆ æ”¹æ–¹æ³•åœ¨å‘½åä¸Šæ²¡æœ‰å…±åŒçš„å‰ç¼€æˆ–åç¼€ã€‚</li><li>æ­¤æ—¶å¦‚æœä½¿ç”¨executionåˆ‡å…¥ç‚¹è¡¨è¾¾å¼ä¹Ÿå¯ä»¥ï¼Œä½†æ˜¯ä¼šæ¯”è¾ƒç¹çã€‚</li><li>å½“é‡åˆ°å¢åˆ æ”¹çš„æ–¹æ³•åæ²¡æœ‰è§„å¾‹æ—¶ ï¼Œå°±<strong>å¯ä»¥ä½¿ç”¨ annotationåˆ‡å…¥ç‚¹è¡¨è¾¾å¼</strong></li></ul></li></ul><p>æ¡ˆä¾‹çš„å®ç°æ­¥éª¤å…¶å®å°±ä¸¤æ­¥ï¼š</p><ul><li>å‡†å¤‡å·¥ä½œ <ol><li>å¼•å…¥AOPçš„èµ·æ­¥ä¾èµ–</li><li>å¯¼å…¥èµ„æ–™ä¸­å‡†å¤‡å¥½çš„æ•°æ®åº“è¡¨ç»“æ„ï¼Œå¹¶å¼•å…¥å¯¹åº”çš„å®ä½“ç±»</li></ol></li><li>ç¼–ç å®ç° <ol><li>è‡ªå®šä¹‰æ³¨è§£@Log</li><li>å®šä¹‰åˆ‡é¢ç±»ï¼Œå®Œæˆè®°å½•æ“ä½œæ—¥å¿—çš„é€»è¾‘</li></ol></li></ul><h4 id="_4-4-1-å‡†å¤‡å·¥ä½œ" tabindex="-1">4.4.1 å‡†å¤‡å·¥ä½œ <a class="header-anchor" href="#_4-4-1-å‡†å¤‡å·¥ä½œ" aria-label="Permalink to &quot;4.4.1 å‡†å¤‡å·¥ä½œ&quot;">â€‹</a></h4><ol><li>AOPèµ·æ­¥ä¾èµ–</li></ol><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#7B7F8B;">&lt;!--AOPèµ·æ­¥ä¾èµ–--&gt;</span></span>
<span class="line"><span style="color:#F6F6F4;">&lt;</span><span style="color:#F286C4;">dependency</span><span style="color:#F6F6F4;">&gt;</span></span>
<span class="line"><span style="color:#F6F6F4;">    &lt;</span><span style="color:#F286C4;">groupId</span><span style="color:#F6F6F4;">&gt;org.springframework.boot&lt;/</span><span style="color:#F286C4;">groupId</span><span style="color:#F6F6F4;">&gt;</span></span>
<span class="line"><span style="color:#F6F6F4;">    &lt;</span><span style="color:#F286C4;">artifactId</span><span style="color:#F6F6F4;">&gt;spring-boot-starter-aop&lt;/</span><span style="color:#F286C4;">artifactId</span><span style="color:#F6F6F4;">&gt;</span></span>
<span class="line"><span style="color:#F6F6F4;">&lt;/</span><span style="color:#F286C4;">dependency</span><span style="color:#F6F6F4;">&gt;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">&lt;!--AOPèµ·æ­¥ä¾èµ–--&gt;</span></span>
<span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#22863A;">dependency</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">    &lt;</span><span style="color:#22863A;">groupId</span><span style="color:#24292E;">&gt;org.springframework.boot&lt;/</span><span style="color:#22863A;">groupId</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">    &lt;</span><span style="color:#22863A;">artifactId</span><span style="color:#24292E;">&gt;spring-boot-starter-aop&lt;/</span><span style="color:#22863A;">artifactId</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">&lt;/</span><span style="color:#22863A;">dependency</span><span style="color:#24292E;">&gt;</span></span></code></pre></div><ol start="2"><li>å¯¼å…¥èµ„æ–™ä¸­å‡†å¤‡å¥½çš„æ•°æ®åº“è¡¨ç»“æ„ï¼Œå¹¶å¼•å…¥å¯¹åº”çš„å®ä½“ç±»</li></ol><p>æ•°æ®è¡¨</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#7B7F8B;">-- æ“ä½œæ—¥å¿—è¡¨</span></span>
<span class="line"><span style="color:#F286C4;">create</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">table</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">operate_log</span><span style="color:#F6F6F4;">(</span></span>
<span class="line"><span style="color:#F6F6F4;">    id </span><span style="color:#F286C4;">int</span><span style="color:#F6F6F4;"> unsigned </span><span style="color:#F286C4;">primary key</span><span style="color:#F6F6F4;"> auto_increment comment </span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">ID</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">    operate_user </span><span style="color:#F286C4;">int</span><span style="color:#F6F6F4;"> unsigned comment </span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">æ“ä½œäºº</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">    operate_time </span><span style="color:#F286C4;">datetime</span><span style="color:#F6F6F4;"> comment </span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">æ“ä½œæ—¶é—´</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">    class_name </span><span style="color:#F286C4;">varchar</span><span style="color:#F6F6F4;">(</span><span style="color:#BF9EEE;">100</span><span style="color:#F6F6F4;">) comment </span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">æ“ä½œçš„ç±»å</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">    method_name </span><span style="color:#F286C4;">varchar</span><span style="color:#F6F6F4;">(</span><span style="color:#BF9EEE;">100</span><span style="color:#F6F6F4;">) comment </span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">æ“ä½œçš„æ–¹æ³•å</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">    method_params </span><span style="color:#F286C4;">varchar</span><span style="color:#F6F6F4;">(</span><span style="color:#BF9EEE;">1000</span><span style="color:#F6F6F4;">) comment </span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">æ–¹æ³•å‚æ•°</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">    return_value </span><span style="color:#F286C4;">varchar</span><span style="color:#F6F6F4;">(</span><span style="color:#BF9EEE;">2000</span><span style="color:#F6F6F4;">) comment </span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">è¿”å›å€¼</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">    cost_time </span><span style="color:#F286C4;">bigint</span><span style="color:#F6F6F4;"> comment </span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">æ–¹æ³•æ‰§è¡Œè€—æ—¶, å•ä½:ms</span><span style="color:#DEE492;">&#39;</span></span>
<span class="line"><span style="color:#F6F6F4;">) comment </span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">æ“ä½œæ—¥å¿—è¡¨</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">-- æ“ä½œæ—¥å¿—è¡¨</span></span>
<span class="line"><span style="color:#D73A49;">create</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">table</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">operate_log</span><span style="color:#24292E;">(</span></span>
<span class="line"><span style="color:#24292E;">    id </span><span style="color:#D73A49;">int</span><span style="color:#24292E;"> unsigned </span><span style="color:#D73A49;">primary key</span><span style="color:#24292E;"> auto_increment comment </span><span style="color:#032F62;">&#39;ID&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    operate_user </span><span style="color:#D73A49;">int</span><span style="color:#24292E;"> unsigned comment </span><span style="color:#032F62;">&#39;æ“ä½œäºº&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    operate_time </span><span style="color:#D73A49;">datetime</span><span style="color:#24292E;"> comment </span><span style="color:#032F62;">&#39;æ“ä½œæ—¶é—´&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    class_name </span><span style="color:#D73A49;">varchar</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">100</span><span style="color:#24292E;">) comment </span><span style="color:#032F62;">&#39;æ“ä½œçš„ç±»å&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    method_name </span><span style="color:#D73A49;">varchar</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">100</span><span style="color:#24292E;">) comment </span><span style="color:#032F62;">&#39;æ“ä½œçš„æ–¹æ³•å&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    method_params </span><span style="color:#D73A49;">varchar</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">1000</span><span style="color:#24292E;">) comment </span><span style="color:#032F62;">&#39;æ–¹æ³•å‚æ•°&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    return_value </span><span style="color:#D73A49;">varchar</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">2000</span><span style="color:#24292E;">) comment </span><span style="color:#032F62;">&#39;è¿”å›å€¼&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    cost_time </span><span style="color:#D73A49;">bigint</span><span style="color:#24292E;"> comment </span><span style="color:#032F62;">&#39;æ–¹æ³•æ‰§è¡Œè€—æ—¶, å•ä½:ms&#39;</span></span>
<span class="line"><span style="color:#24292E;">) comment </span><span style="color:#032F62;">&#39;æ“ä½œæ—¥å¿—è¡¨&#39;</span><span style="color:#24292E;">;</span></span></code></pre></div><p>å®ä½“ç±»</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#7B7F8B;">//æ“ä½œæ—¥å¿—å®ä½“ç±»</span></span>
<span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Data</span></span>
<span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">NoArgsConstructor</span></span>
<span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">AllArgsConstructor</span></span>
<span class="line"><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">class</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;">OperateLog</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">private</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">Integer</span><span style="color:#F6F6F4;"> id; </span><span style="color:#7B7F8B;">//ä¸»é”®ID</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">private</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">Integer</span><span style="color:#F6F6F4;"> operateUser; </span><span style="color:#7B7F8B;">//æ“ä½œäººID</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">private</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">LocalDateTime</span><span style="color:#F6F6F4;"> operateTime; </span><span style="color:#7B7F8B;">//æ“ä½œæ—¶é—´</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">private</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">String</span><span style="color:#F6F6F4;"> className; </span><span style="color:#7B7F8B;">//æ“ä½œç±»å</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">private</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">String</span><span style="color:#F6F6F4;"> methodName; </span><span style="color:#7B7F8B;">//æ“ä½œæ–¹æ³•å</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">private</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">String</span><span style="color:#F6F6F4;"> methodParams; </span><span style="color:#7B7F8B;">//æ“ä½œæ–¹æ³•å‚æ•°</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">private</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">String</span><span style="color:#F6F6F4;"> returnValue; </span><span style="color:#7B7F8B;">//æ“ä½œæ–¹æ³•è¿”å›å€¼</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">private</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">Long</span><span style="color:#F6F6F4;"> costTime; </span><span style="color:#7B7F8B;">//æ“ä½œè€—æ—¶</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">//æ“ä½œæ—¥å¿—å®ä½“ç±»</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Data</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">NoArgsConstructor</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">AllArgsConstructor</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">OperateLog</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> Integer id; </span><span style="color:#6A737D;">//ä¸»é”®ID</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> Integer operateUser; </span><span style="color:#6A737D;">//æ“ä½œäººID</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> LocalDateTime operateTime; </span><span style="color:#6A737D;">//æ“ä½œæ—¶é—´</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> String className; </span><span style="color:#6A737D;">//æ“ä½œç±»å</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> String methodName; </span><span style="color:#6A737D;">//æ“ä½œæ–¹æ³•å</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> String methodParams; </span><span style="color:#6A737D;">//æ“ä½œæ–¹æ³•å‚æ•°</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> String returnValue; </span><span style="color:#6A737D;">//æ“ä½œæ–¹æ³•è¿”å›å€¼</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> Long costTime; </span><span style="color:#6A737D;">//æ“ä½œè€—æ—¶</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><p>Mapperæ¥å£</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Mapper</span></span>
<span class="line"><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">interface</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;">OperateLogMapper</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#7B7F8B;">//æ’å…¥æ—¥å¿—æ•°æ®</span></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Insert</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">insert into operate_log (operate_user, operate_time, class_name, method_name, method_params, return_value, cost_time) </span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">+</span></span>
<span class="line"><span style="color:#F6F6F4;">            </span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">values (#{operateUser}, #{operateTime}, #{className}, #{methodName}, #{methodParams}, #{returnValue}, #{costTime});</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">)</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">insert</span><span style="color:#F6F6F4;">(</span><span style="color:#97E1F1;font-style:italic;">OperateLog</span><span style="color:#F6F6F4;"> </span><span style="color:#FFB86C;font-style:italic;">log</span><span style="color:#F6F6F4;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Mapper</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">interface</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">OperateLogMapper</span><span style="color:#24292E;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//æ’å…¥æ—¥å¿—æ•°æ®</span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Insert</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;insert into operate_log (operate_user, operate_time, class_name, method_name, method_params, return_value, cost_time) &quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#032F62;">&quot;values (#{operateUser}, #{operateTime}, #{className}, #{methodName}, #{methodParams}, #{returnValue}, #{costTime});&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">insert</span><span style="color:#24292E;">(OperateLog </span><span style="color:#E36209;">log</span><span style="color:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><ul><li>è‡ªå®šä¹‰æ³¨è§£@Log</li></ul><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#7B7F8B;">/**</span></span>
<span class="line"><span style="color:#7B7F8B;"> * è‡ªå®šä¹‰Logæ³¨è§£</span></span>
<span class="line"><span style="color:#7B7F8B;"> */</span></span>
<span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Target</span><span style="color:#F6F6F4;">({ElementType.METHOD}) </span><span style="color:#7B7F8B;">//è¡¨æ˜æ³¨è§£æ˜¯å†™åœ¨æ–¹æ³•ä¸Šçš„</span></span>
<span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Documented</span><span style="color:#F6F6F4;"> </span><span style="color:#7B7F8B;">//è¡¨æ˜å¯ä»¥ç”Ÿæˆæ–‡æ¡£  äº†è§£ä¸€ä¸‹</span></span>
<span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Retention</span><span style="color:#F6F6F4;">(RetentionPolicy.RUNTIME) </span><span style="color:#7B7F8B;">//è¡¨æ˜è¯¥æ³¨è§£è¿è¡Œæ—¶æœ‰æ•ˆ</span></span>
<span class="line"><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> @</span><span style="color:#F286C4;">interface</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">Log</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">/**</span></span>
<span class="line"><span style="color:#6A737D;"> * è‡ªå®šä¹‰Logæ³¨è§£</span></span>
<span class="line"><span style="color:#6A737D;"> */</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Target</span><span style="color:#24292E;">({ElementType.METHOD}) </span><span style="color:#6A737D;">//è¡¨æ˜æ³¨è§£æ˜¯å†™åœ¨æ–¹æ³•ä¸Šçš„</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Documented</span><span style="color:#24292E;"> </span><span style="color:#6A737D;">//è¡¨æ˜å¯ä»¥ç”Ÿæˆæ–‡æ¡£  äº†è§£ä¸€ä¸‹</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Retention</span><span style="color:#24292E;">(RetentionPolicy.RUNTIME) </span><span style="color:#6A737D;">//è¡¨æ˜è¯¥æ³¨è§£è¿è¡Œæ—¶æœ‰æ•ˆ</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> @</span><span style="color:#D73A49;">interface</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">Log</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><ul><li><strong>ä¿®æ”¹ä¸šåŠ¡å®ç°ç±»</strong>ï¼Œåœ¨å¢åˆ æ”¹ä¸šåŠ¡æ–¹æ³•ä¸Šæ·»åŠ <code>@Log</code>æ³¨è§£</li></ul><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Slf4j</span></span>
<span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Service</span></span>
<span class="line"><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">class</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;">EmpServiceImpl</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">implements</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">EmpService</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Autowired</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">private</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">EmpMapper</span><span style="color:#F6F6F4;"> empMapper;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Override</span></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Log</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">update</span><span style="color:#F6F6F4;">(</span><span style="color:#97E1F1;font-style:italic;">Emp</span><span style="color:#F6F6F4;"> </span><span style="color:#FFB86C;font-style:italic;">emp</span><span style="color:#F6F6F4;">) {</span></span>
<span class="line"><span style="color:#F6F6F4;">        emp.</span><span style="color:#62E884;">setUpdateTime</span><span style="color:#F6F6F4;">(LocalDateTime.</span><span style="color:#62E884;">now</span><span style="color:#F6F6F4;">()); </span><span style="color:#7B7F8B;">//æ›´æ–°ä¿®æ”¹æ—¶é—´ä¸ºå½“å‰æ—¶é—´</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">        empMapper.</span><span style="color:#62E884;">update</span><span style="color:#F6F6F4;">(emp);</span></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Override</span></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Log</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">save</span><span style="color:#F6F6F4;">(</span><span style="color:#97E1F1;font-style:italic;">Emp</span><span style="color:#F6F6F4;"> </span><span style="color:#FFB86C;font-style:italic;">emp</span><span style="color:#F6F6F4;">) {</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#7B7F8B;">//è¡¥å…¨æ•°æ®</span></span>
<span class="line"><span style="color:#F6F6F4;">        emp.</span><span style="color:#62E884;">setCreateTime</span><span style="color:#F6F6F4;">(LocalDateTime.</span><span style="color:#62E884;">now</span><span style="color:#F6F6F4;">());</span></span>
<span class="line"><span style="color:#F6F6F4;">        emp.</span><span style="color:#62E884;">setUpdateTime</span><span style="color:#F6F6F4;">(LocalDateTime.</span><span style="color:#62E884;">now</span><span style="color:#F6F6F4;">());</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#7B7F8B;">//è°ƒç”¨æ·»åŠ æ–¹æ³•</span></span>
<span class="line"><span style="color:#F6F6F4;">        empMapper.</span><span style="color:#62E884;">insert</span><span style="color:#F6F6F4;">(emp);</span></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Override</span></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Log</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">delete</span><span style="color:#F6F6F4;">(</span><span style="color:#97E1F1;font-style:italic;">List</span><span style="color:#F6F6F4;">&lt;Integer&gt; </span><span style="color:#FFB86C;font-style:italic;">ids</span><span style="color:#F6F6F4;">) {</span></span>
<span class="line"><span style="color:#F6F6F4;">        empMapper.</span><span style="color:#62E884;">delete</span><span style="color:#F6F6F4;">(ids);</span></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#7B7F8B;">//çœç•¥å…¶ä»–ä»£ç ...</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Slf4j</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Service</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">EmpServiceImpl</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">implements</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">EmpService</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Autowired</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> EmpMapper empMapper;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Override</span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Log</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">update</span><span style="color:#24292E;">(Emp </span><span style="color:#E36209;">emp</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">        emp.</span><span style="color:#6F42C1;">setUpdateTime</span><span style="color:#24292E;">(LocalDateTime.</span><span style="color:#6F42C1;">now</span><span style="color:#24292E;">()); </span><span style="color:#6A737D;">//æ›´æ–°ä¿®æ”¹æ—¶é—´ä¸ºå½“å‰æ—¶é—´</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        empMapper.</span><span style="color:#6F42C1;">update</span><span style="color:#24292E;">(emp);</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Override</span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Log</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">save</span><span style="color:#24292E;">(Emp </span><span style="color:#E36209;">emp</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">//è¡¥å…¨æ•°æ®</span></span>
<span class="line"><span style="color:#24292E;">        emp.</span><span style="color:#6F42C1;">setCreateTime</span><span style="color:#24292E;">(LocalDateTime.</span><span style="color:#6F42C1;">now</span><span style="color:#24292E;">());</span></span>
<span class="line"><span style="color:#24292E;">        emp.</span><span style="color:#6F42C1;">setUpdateTime</span><span style="color:#24292E;">(LocalDateTime.</span><span style="color:#6F42C1;">now</span><span style="color:#24292E;">());</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">//è°ƒç”¨æ·»åŠ æ–¹æ³•</span></span>
<span class="line"><span style="color:#24292E;">        empMapper.</span><span style="color:#6F42C1;">insert</span><span style="color:#24292E;">(emp);</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Override</span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Log</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">delete</span><span style="color:#24292E;">(List&lt;</span><span style="color:#D73A49;">Integer</span><span style="color:#24292E;">&gt; </span><span style="color:#E36209;">ids</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">        empMapper.</span><span style="color:#6F42C1;">delete</span><span style="color:#24292E;">(ids);</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//çœç•¥å…¶ä»–ä»£ç ...</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><p>ä»¥åŒæ ·çš„æ–¹å¼ï¼Œä¿®æ”¹DeptServiceImplä¸šåŠ¡ç±»</p><ul><li>å®šä¹‰åˆ‡é¢ç±»ï¼Œå®Œæˆè®°å½•æ“ä½œæ—¥å¿—çš„é€»è¾‘ æ ¸å¿ƒæ“ä½œ</li></ul><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Slf4j</span><span style="color:#F6F6F4;"> </span><span style="color:#7B7F8B;">//æ—¥å¿—</span></span>
<span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Component</span><span style="color:#7B7F8B;">//å®ä¾‹åŒ–è¯¥ç±»ï¼Œäº¤ç»™iocç®¡ç†</span></span>
<span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Aspect</span><span style="color:#F6F6F4;"> </span><span style="color:#7B7F8B;">//åˆ‡é¢ç±»</span></span>
<span class="line"><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">class</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;">LogAspect</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#7B7F8B;">//æ³¨å…¥è¯·æ±‚å¯¹è±¡ï¼Œæ–¹ä¾¿è·å–tokenä¸­çš„ç”¨æˆ·id</span></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Autowired</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">private</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">HttpServletRequest</span><span style="color:#F6F6F4;"> request;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#7B7F8B;">// æ—¥å¿—æ“ä½œç±»Mapperï¼Œæ–¹ä¾¿æ’å…¥æ—¥å¿—</span></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Autowired</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">private</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">OperateLogMapper</span><span style="color:#F6F6F4;"> operateLogMapper;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#7B7F8B;">//ç¯ç»•é€šçŸ¥ï¼Œå¹¶é…ä¸Šæ³¨è§£åŒ¹é…å¼</span></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Around</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">@annotation(com.itheima.anno.Log)</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">)</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">Object</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">recordLog</span><span style="color:#F6F6F4;">(</span><span style="color:#97E1F1;font-style:italic;">ProceedingJoinPoint</span><span style="color:#F6F6F4;"> </span><span style="color:#FFB86C;font-style:italic;">joinPoint</span><span style="color:#F6F6F4;">) </span><span style="color:#F286C4;">throws</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">Throwable</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#7B7F8B;">//æ“ä½œäººID - å½“å‰ç™»å½•å‘˜å·¥ID</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#7B7F8B;">//è·å–è¯·æ±‚å¤´ä¸­çš„jwtä»¤ç‰Œ, è§£æä»¤ç‰Œ</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#97E1F1;font-style:italic;">String</span><span style="color:#F6F6F4;"> jwt </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> request.</span><span style="color:#62E884;">getHeader</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">token</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">);</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#97E1F1;font-style:italic;">Claims</span><span style="color:#F6F6F4;"> claims </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> JwtUtils.</span><span style="color:#62E884;">parseJWT</span><span style="color:#F6F6F4;">(jwt);</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#97E1F1;font-style:italic;">Integer</span><span style="color:#F6F6F4;"> operateUser </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> (Integer) claims.</span><span style="color:#62E884;">get</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">id</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#7B7F8B;">//æ“ä½œæ—¶é—´</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#97E1F1;font-style:italic;">LocalDateTime</span><span style="color:#F6F6F4;"> operateTime </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> LocalDateTime.</span><span style="color:#62E884;">now</span><span style="color:#F6F6F4;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#7B7F8B;">//æ“ä½œç±»å</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#97E1F1;font-style:italic;">String</span><span style="color:#F6F6F4;"> className </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> joinPoint.</span><span style="color:#62E884;">getTarget</span><span style="color:#F6F6F4;">().</span><span style="color:#62E884;">getClass</span><span style="color:#F6F6F4;">().</span><span style="color:#62E884;">getName</span><span style="color:#F6F6F4;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#7B7F8B;">//æ“ä½œæ–¹æ³•å</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#97E1F1;font-style:italic;">String</span><span style="color:#F6F6F4;"> methodName </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> joinPoint.</span><span style="color:#62E884;">getSignature</span><span style="color:#F6F6F4;">().</span><span style="color:#62E884;">getName</span><span style="color:#F6F6F4;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#7B7F8B;">//æ“ä½œæ–¹æ³•å‚æ•°</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#97E1F1;font-style:italic;">Object</span><span style="color:#F6F6F4;">[] args </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> joinPoint.</span><span style="color:#62E884;">getArgs</span><span style="color:#F6F6F4;">();</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#97E1F1;font-style:italic;">String</span><span style="color:#F6F6F4;"> methodParams </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> Arrays.</span><span style="color:#62E884;">toString</span><span style="color:#F6F6F4;">(args);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#97E1F1;font-style:italic;">long</span><span style="color:#F6F6F4;"> begin </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> System.</span><span style="color:#62E884;">currentTimeMillis</span><span style="color:#F6F6F4;">();</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#7B7F8B;">//è°ƒç”¨åŸå§‹ç›®æ ‡æ–¹æ³•è¿è¡Œ</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#97E1F1;font-style:italic;">Object</span><span style="color:#F6F6F4;"> result </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> joinPoint.</span><span style="color:#62E884;">proceed</span><span style="color:#F6F6F4;">();</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#97E1F1;font-style:italic;">long</span><span style="color:#F6F6F4;"> end </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> System.</span><span style="color:#62E884;">currentTimeMillis</span><span style="color:#F6F6F4;">();</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#7B7F8B;">//æ–¹æ³•è¿”å›å€¼ï¼ˆä½¿ç”¨è½¬æˆJSONå­—ç¬¦ä¸²ï¼‰</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#97E1F1;font-style:italic;">String</span><span style="color:#F6F6F4;"> returnValue </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> JSONObject.</span><span style="color:#62E884;">toJSONString</span><span style="color:#F6F6F4;">(result);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#7B7F8B;">//æ“ä½œè€—æ—¶</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#97E1F1;font-style:italic;">Long</span><span style="color:#F6F6F4;"> costTime </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> end </span><span style="color:#F286C4;">-</span><span style="color:#F6F6F4;"> begin;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#7B7F8B;">//è®°å½•æ“ä½œæ—¥å¿—</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#97E1F1;font-style:italic;">OperateLog</span><span style="color:#F6F6F4;"> operateLog </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;font-weight:bold;">new</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">OperateLog</span><span style="color:#F6F6F4;">(</span><span style="color:#BF9EEE;">null</span><span style="color:#F6F6F4;">,operateUser,operateTime,className,methodName,methodParams,returnValue,costTime);</span></span>
<span class="line"><span style="color:#F6F6F4;">        operateLogMapper.</span><span style="color:#62E884;">insert</span><span style="color:#F6F6F4;">(operateLog);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">        log.</span><span style="color:#62E884;">info</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">AOPè®°å½•æ“ä½œæ—¥å¿—: {}</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;"> , operateLog);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#F286C4;">return</span><span style="color:#F6F6F4;"> result;</span></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Slf4j</span><span style="color:#24292E;"> </span><span style="color:#6A737D;">//æ—¥å¿—</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Component</span><span style="color:#6A737D;">//å®ä¾‹åŒ–è¯¥ç±»ï¼Œäº¤ç»™iocç®¡ç†</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Aspect</span><span style="color:#24292E;"> </span><span style="color:#6A737D;">//åˆ‡é¢ç±»</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">LogAspect</span><span style="color:#24292E;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//æ³¨å…¥è¯·æ±‚å¯¹è±¡ï¼Œæ–¹ä¾¿è·å–tokenä¸­çš„ç”¨æˆ·id</span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Autowired</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> HttpServletRequest request;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// æ—¥å¿—æ“ä½œç±»Mapperï¼Œæ–¹ä¾¿æ’å…¥æ—¥å¿—</span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Autowired</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> OperateLogMapper operateLogMapper;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//ç¯ç»•é€šçŸ¥ï¼Œå¹¶é…ä¸Šæ³¨è§£åŒ¹é…å¼</span></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Around</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;@annotation(com.itheima.anno.Log)&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> Object </span><span style="color:#6F42C1;">recordLog</span><span style="color:#24292E;">(ProceedingJoinPoint </span><span style="color:#E36209;">joinPoint</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">throws</span><span style="color:#24292E;"> Throwable {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">//æ“ä½œäººID - å½“å‰ç™»å½•å‘˜å·¥ID</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">//è·å–è¯·æ±‚å¤´ä¸­çš„jwtä»¤ç‰Œ, è§£æä»¤ç‰Œ</span></span>
<span class="line"><span style="color:#24292E;">        String jwt </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> request.</span><span style="color:#6F42C1;">getHeader</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;token&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">        Claims claims </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> JwtUtils.</span><span style="color:#6F42C1;">parseJWT</span><span style="color:#24292E;">(jwt);</span></span>
<span class="line"><span style="color:#24292E;">        Integer operateUser </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> (Integer) claims.</span><span style="color:#6F42C1;">get</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;id&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">//æ“ä½œæ—¶é—´</span></span>
<span class="line"><span style="color:#24292E;">        LocalDateTime operateTime </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> LocalDateTime.</span><span style="color:#6F42C1;">now</span><span style="color:#24292E;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">//æ“ä½œç±»å</span></span>
<span class="line"><span style="color:#24292E;">        String className </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> joinPoint.</span><span style="color:#6F42C1;">getTarget</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">getClass</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">getName</span><span style="color:#24292E;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">//æ“ä½œæ–¹æ³•å</span></span>
<span class="line"><span style="color:#24292E;">        String methodName </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> joinPoint.</span><span style="color:#6F42C1;">getSignature</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">getName</span><span style="color:#24292E;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">//æ“ä½œæ–¹æ³•å‚æ•°</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">Object</span><span style="color:#24292E;">[] args </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> joinPoint.</span><span style="color:#6F42C1;">getArgs</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">        String methodParams </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> Arrays.</span><span style="color:#6F42C1;">toString</span><span style="color:#24292E;">(args);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">long</span><span style="color:#24292E;"> begin </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> System.</span><span style="color:#6F42C1;">currentTimeMillis</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">//è°ƒç”¨åŸå§‹ç›®æ ‡æ–¹æ³•è¿è¡Œ</span></span>
<span class="line"><span style="color:#24292E;">        Object result </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> joinPoint.</span><span style="color:#6F42C1;">proceed</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">long</span><span style="color:#24292E;"> end </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> System.</span><span style="color:#6F42C1;">currentTimeMillis</span><span style="color:#24292E;">();</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">//æ–¹æ³•è¿”å›å€¼ï¼ˆä½¿ç”¨è½¬æˆJSONå­—ç¬¦ä¸²ï¼‰</span></span>
<span class="line"><span style="color:#24292E;">        String returnValue </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> JSONObject.</span><span style="color:#6F42C1;">toJSONString</span><span style="color:#24292E;">(result);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">//æ“ä½œè€—æ—¶</span></span>
<span class="line"><span style="color:#24292E;">        Long costTime </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> end </span><span style="color:#D73A49;">-</span><span style="color:#24292E;"> begin;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">//è®°å½•æ“ä½œæ—¥å¿—</span></span>
<span class="line"><span style="color:#24292E;">        OperateLog operateLog </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">OperateLog</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">null</span><span style="color:#24292E;">,operateUser,operateTime,className,methodName,methodParams,returnValue,costTime);</span></span>
<span class="line"><span style="color:#24292E;">        operateLogMapper.</span><span style="color:#6F42C1;">insert</span><span style="color:#24292E;">(operateLog);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        log.</span><span style="color:#6F42C1;">info</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;AOPè®°å½•æ“ä½œæ—¥å¿—: {}&quot;</span><span style="color:#24292E;"> , operateLog);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> result;</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><blockquote><p>ä»£ç å®ç°ç»†èŠ‚ï¼š è·å–requestå¯¹è±¡ï¼Œä»è¯·æ±‚å¤´ä¸­è·å–åˆ°jwtä»¤ç‰Œï¼Œè§£æä»¤ç‰Œè·å–å‡ºå½“å‰ç”¨æˆ·çš„idã€‚</p></blockquote><p>é‡å¯SpringBootæœåŠ¡ï¼Œæµ‹è¯•æ“ä½œæ—¥å¿—è®°å½•åŠŸèƒ½ï¼š</p><ul><li>æ·»åŠ ä¸€ä¸ªæ–°çš„éƒ¨é—¨</li></ul><p><img src="http://www.yangeit.cn:21010/assets/image-20230111001114301-ddb49a89.png" alt="image-20230111001114301"></p><p>image-20230111001114301</p><ul><li>æ•°æ®è¡¨</li></ul><p><img src="http://www.yangeit.cn:21010/assets/image-20230111001230731-6900a84f.png" alt="image-20230111001230731"></p><p>image-20230111001230731</p><h2 id="_5-æ‹“å±•" tabindex="-1">5.æ‹“å±• <a class="header-anchor" href="#_5-æ‹“å±•" aria-label="Permalink to &quot;5.æ‹“å±•&quot;">â€‹</a></h2><h3 id="_5-1-aopåº•å±‚å®ç°åŸç†" tabindex="-1">5.1 AOPåº•å±‚å®ç°åŸç† <a class="header-anchor" href="#_5-1-aopåº•å±‚å®ç°åŸç†" aria-label="Permalink to &quot;5.1 AOPåº•å±‚å®ç°åŸç†&quot;">â€‹</a></h3><p><a href="http://www.yangeit.cn:21010/expand/spring/aop/spring-y-aop-impl.html" target="_blank" rel="noreferrer">æƒ³çŸ¥é“AOPåº•å±‚å®ç°åŸç†å—ï¼Œç‚¹å‡»è¿™é‡Œå­¦ä¹ </a> ğŸ‘ˆ ğŸ‘ˆ</p><h3 id="_5-2-springbootåŸç†" tabindex="-1">5.2 SpringBootåŸç† <a class="header-anchor" href="#_5-2-springbootåŸç†" aria-label="Permalink to &quot;5.2 SpringBootåŸç†&quot;">â€‹</a></h3><p><a href="http://www.yangeit.cn:21010/javaweb2023/day14.html#_3-springboot%E5%8E%9F%E7%90%86" target="_blank" rel="noreferrer">SpringBootè¿™ä¹ˆå¥½ç”¨ï¼Œæƒ³çŸ¥é“ä»–çš„åŸç†å—ï¼Ÿç‚¹å‡»è¿™é‡Œå­¦ä¹ </a></p>`,416),e=[o];function t(c,r,y,F,i,E){return n(),a("div",null,e)}const u=s(p,[["render",t]]);export{g as __pageData,u as default};
