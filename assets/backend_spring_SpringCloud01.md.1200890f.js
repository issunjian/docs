import{_ as s,o as a,c as n,V as p}from"./chunks/framework.c6d8cbec.js";const u=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[],"relativePath":"backend/spring/SpringCloud01.md","filePath":"backend/spring/SpringCloud01.md"}'),l={name:"backend/spring/SpringCloud01.md"},e=p(`<h2 id="springcloud01" tabindex="-1">SpringCloud01 <a class="header-anchor" href="#springcloud01" aria-label="Permalink to &quot;SpringCloud01&quot;">â€‹</a></h2><p>éšç€äº’è”ç½‘è¡Œä¸šçš„å‘å±•ï¼Œå¯¹æœåŠ¡çš„è¦æ±‚ä¹Ÿè¶Šæ¥è¶Šé«˜ï¼ŒæœåŠ¡æ¶æ„ä¹Ÿä»å•ä½“æ¶æ„é€æ¸æ¼”å˜ä¸ºç°åœ¨æµè¡Œçš„å¾®æœåŠ¡æ¶æ„ã€‚è¿™äº›æ¶æ„ä¹‹é—´æœ‰æ€æ ·çš„å·®åˆ«å‘¢ï¼Ÿ</p><p><strong>å­¦ä¹ ç›®æ ‡</strong>:äº†è§£å¾®æœåŠ¡æ¶æ„çš„ä¼˜ç¼ºç‚¹ ğŸ¯</p><h2 id="_1-è®¤è¯†å¾®æœåŠ¡" tabindex="-1">1.è®¤è¯†å¾®æœåŠ¡ <a class="header-anchor" href="#_1-è®¤è¯†å¾®æœåŠ¡" aria-label="Permalink to &quot;1.è®¤è¯†å¾®æœåŠ¡&quot;">â€‹</a></h2><p>è®¤è¯†å¾®æœåŠ¡</p><h2 id="_1-1-å•ä½“æ¶æ„" tabindex="-1">1.1.å•ä½“æ¶æ„ <a class="header-anchor" href="#_1-1-å•ä½“æ¶æ„" aria-label="Permalink to &quot;1.1.å•ä½“æ¶æ„&quot;">â€‹</a></h2><p><strong>å•ä½“æ¶æ„</strong>ï¼šå°†ä¸šåŠ¡çš„æ‰€æœ‰åŠŸèƒ½é›†ä¸­åœ¨ä¸€ä¸ªé¡¹ç›®ä¸­å¼€å‘ï¼Œæ‰“æˆä¸€ä¸ªåŒ…éƒ¨ç½²ã€‚</p><p><img src="http://image.yangeit.cn/i/2023/05/11/image-20210713202807818.png" alt="image-20210713202807818"></p><p>image-20210713202807818</p><p>å•ä½“æ¶æ„çš„ä¼˜ç¼ºç‚¹å¦‚ä¸‹ï¼š</p><p><strong>ä¼˜ç‚¹ï¼š</strong></p><ul><li>æ¶æ„ç®€å•</li><li>éƒ¨ç½²æˆæœ¬ä½</li></ul><p><strong>ç¼ºç‚¹ï¼š</strong></p><ul><li>è€¦åˆåº¦é«˜ï¼ˆç»´æŠ¤å›°éš¾ã€å‡çº§å›°éš¾ï¼‰</li></ul><h2 id="_1-2-åˆ†å¸ƒå¼æ¶æ„" tabindex="-1">1.2.åˆ†å¸ƒå¼æ¶æ„ <a class="header-anchor" href="#_1-2-åˆ†å¸ƒå¼æ¶æ„" aria-label="Permalink to &quot;1.2.åˆ†å¸ƒå¼æ¶æ„&quot;">â€‹</a></h2><p><strong>åˆ†å¸ƒå¼æ¶æ„</strong>ï¼šæ ¹æ®ä¸šåŠ¡åŠŸèƒ½å¯¹ç³»ç»Ÿåšæ‹†åˆ†ï¼Œæ¯ä¸ªä¸šåŠ¡åŠŸèƒ½æ¨¡å—ä½œä¸ºç‹¬ç«‹é¡¹ç›®å¼€å‘ï¼Œç§°ä¸ºä¸€ä¸ªæœåŠ¡ã€‚</p><p><img src="http://image.yangeit.cn/i/2023/05/11/image-20210713203124797.png" alt="image-20210713203124797"></p><p>image-20210713203124797</p><p>åˆ†å¸ƒå¼æ¶æ„çš„ä¼˜ç¼ºç‚¹ï¼š</p><p><strong>ä¼˜ç‚¹ï¼š</strong></p><ul><li>é™ä½æœåŠ¡è€¦åˆ</li><li>æœ‰åˆ©äºæœåŠ¡å‡çº§å’Œæ‹“å±•</li></ul><p><strong>ç¼ºç‚¹ï¼š</strong></p><ul><li>æœåŠ¡è°ƒç”¨å…³ç³»é”™ç»¼å¤æ‚</li></ul><p>åˆ†å¸ƒå¼æ¶æ„è™½ç„¶é™ä½äº†æœåŠ¡è€¦åˆï¼Œä½†æ˜¯æœåŠ¡æ‹†åˆ†æ—¶ä¹Ÿæœ‰å¾ˆå¤šé—®é¢˜éœ€è¦æ€è€ƒï¼š</p><ul><li>æœåŠ¡æ‹†åˆ†çš„ç²’åº¦å¦‚ä½•ç•Œå®šï¼Ÿ</li><li>æœåŠ¡ä¹‹é—´å¦‚ä½•è°ƒç”¨ï¼Ÿ</li><li>æœåŠ¡çš„è°ƒç”¨å…³ç³»å¦‚ä½•ç®¡ç†ï¼Ÿ</li></ul><p>äººä»¬éœ€è¦åˆ¶å®šä¸€å¥—è¡Œä¹‹æœ‰æ•ˆçš„æ ‡å‡†æ¥çº¦æŸåˆ†å¸ƒå¼æ¶æ„ã€‚</p><h2 id="_1-3-å¾®æœåŠ¡" tabindex="-1">1.3.å¾®æœåŠ¡ <a class="header-anchor" href="#_1-3-å¾®æœåŠ¡" aria-label="Permalink to &quot;1.3.å¾®æœåŠ¡&quot;">â€‹</a></h2><p>å¾®æœåŠ¡çš„æ¶æ„ç‰¹å¾ï¼š</p><ul><li>å•ä¸€èŒè´£ï¼šå¾®æœåŠ¡æ‹†åˆ†ç²’åº¦æ›´å°ï¼Œæ¯ä¸€ä¸ªæœåŠ¡éƒ½å¯¹åº”å”¯ä¸€çš„ä¸šåŠ¡èƒ½åŠ›ï¼Œåšåˆ°å•ä¸€èŒè´£</li><li>è‡ªæ²»ï¼šå›¢é˜Ÿç‹¬ç«‹ã€æŠ€æœ¯ç‹¬ç«‹ã€æ•°æ®ç‹¬ç«‹ï¼Œç‹¬ç«‹éƒ¨ç½²å’Œäº¤ä»˜</li><li>é¢å‘æœåŠ¡ï¼šæœåŠ¡æä¾›ç»Ÿä¸€æ ‡å‡†çš„æ¥å£ï¼Œä¸è¯­è¨€å’ŒæŠ€æœ¯æ— å…³</li><li>éš”ç¦»æ€§å¼ºï¼šæœåŠ¡è°ƒç”¨åšå¥½éš”ç¦»ã€å®¹é”™ã€é™çº§ï¼Œé¿å…å‡ºç°çº§è”é—®é¢˜</li></ul><p><img src="http://image.yangeit.cn/i/2023/05/11/image-20210713203753373.png" alt="image-20210713203753373"></p><p>image-20210713203753373</p><p>å¾®æœåŠ¡çš„ä¸Šè¿°ç‰¹æ€§å…¶å®æ˜¯åœ¨ç»™åˆ†å¸ƒå¼æ¶æ„åˆ¶å®šä¸€ä¸ªæ ‡å‡†ï¼Œè¿›ä¸€æ­¥é™ä½æœåŠ¡ä¹‹é—´çš„è€¦åˆåº¦ï¼Œæä¾›æœåŠ¡çš„ç‹¬ç«‹æ€§å’Œçµæ´»æ€§ã€‚åšåˆ°é«˜å†…èšï¼Œä½è€¦åˆã€‚</p><p>å› æ­¤ï¼Œå¯ä»¥è®¤ä¸º<strong>å¾®æœåŠ¡</strong>æ˜¯ä¸€ç§ç»è¿‡è‰¯å¥½æ¶æ„è®¾è®¡çš„<strong>åˆ†å¸ƒå¼æ¶æ„æ–¹æ¡ˆ</strong> ã€‚</p><p>ä½†æ–¹æ¡ˆè¯¥æ€ä¹ˆè½åœ°ï¼Ÿé€‰ç”¨ä»€ä¹ˆæ ·çš„æŠ€æœ¯æ ˆï¼Ÿå…¨çƒçš„äº’è”ç½‘å…¬å¸éƒ½åœ¨ç§¯æå°è¯•è‡ªå·±çš„å¾®æœåŠ¡è½åœ°æ–¹æ¡ˆã€‚</p><p>å…¶ä¸­åœ¨Javaé¢†åŸŸæœ€å¼•äººæ³¨ç›®çš„å°±æ˜¯SpringCloudæä¾›çš„æ–¹æ¡ˆäº†ã€‚</p><h2 id="_1-4-springcloud" tabindex="-1">1.4.SpringCloud <a class="header-anchor" href="#_1-4-springcloud" aria-label="Permalink to &quot;1.4.SpringCloud&quot;">â€‹</a></h2><p>SpringCloudæ˜¯ç›®å‰å›½å†…ä½¿ç”¨æœ€å¹¿æ³›çš„å¾®æœåŠ¡æ¡†æ¶ã€‚å®˜ç½‘åœ°å€ï¼š<a href="https://spring.io/projects/spring-cloud%E3%80%82" target="_blank" rel="noreferrer">https://spring.io/projects/spring-cloudã€‚open in new window</a></p><p>SpringCloudé›†æˆäº†å„ç§å¾®æœåŠ¡åŠŸèƒ½ç»„ä»¶ï¼Œå¹¶åŸºäºSpringBootå®ç°äº†è¿™äº›ç»„ä»¶çš„è‡ªåŠ¨è£…é…ï¼Œä»è€Œæä¾›äº†è‰¯å¥½çš„å¼€ç®±å³ç”¨ä½“éªŒã€‚</p><p>å…¶ä¸­å¸¸è§çš„ç»„ä»¶åŒ…æ‹¬ï¼š</p><p><img src="http://image.yangeit.cn/i/2023/05/11/image-20210713204155887.png" alt="image-20210713204155887"></p><p>image-20210713204155887</p><p>å¦å¤–ï¼ŒSpringCloudåº•å±‚æ˜¯ä¾èµ–äºSpringBootçš„ï¼Œå¹¶ä¸”æœ‰ç‰ˆæœ¬çš„å…¼å®¹å…³ç³»ï¼Œå¦‚ä¸‹ï¼š</p><p><img src="http://image.yangeit.cn/i/2023/05/11/image-20210713205003790.png" alt="image-20210713205003790"></p><p>image-20210713205003790</p><p>æˆ‘ä»¬è¯¾å ‚å­¦ä¹ çš„ç‰ˆæœ¬æ˜¯ Hoxton.SR10ï¼Œå› æ­¤å¯¹åº”çš„SpringBootç‰ˆæœ¬æ˜¯2.3.xç‰ˆæœ¬ã€‚</p><h2 id="_1-5-æ€»ç»“" tabindex="-1">1.5.æ€»ç»“ <a class="header-anchor" href="#_1-5-æ€»ç»“" aria-label="Permalink to &quot;1.5.æ€»ç»“&quot;">â€‹</a></h2><ul><li><p>å•ä½“æ¶æ„ï¼šç®€å•æ–¹ä¾¿ï¼Œé«˜åº¦è€¦åˆï¼Œæ‰©å±•æ€§å·®ï¼Œé€‚åˆå°å‹é¡¹ç›®ã€‚ä¾‹å¦‚ï¼šå­¦ç”Ÿç®¡ç†ç³»ç»Ÿ</p></li><li><p>åˆ†å¸ƒå¼æ¶æ„ï¼šæ¾è€¦åˆï¼Œæ‰©å±•æ€§å¥½ï¼Œä½†æ¶æ„å¤æ‚ï¼Œéš¾åº¦å¤§ã€‚é€‚åˆå¤§å‹äº’è”ç½‘é¡¹ç›®ï¼Œä¾‹å¦‚ï¼šäº¬ä¸œã€æ·˜å®</p></li><li><p>å¾®æœåŠ¡ï¼šä¸€ç§è‰¯å¥½çš„åˆ†å¸ƒå¼æ¶æ„æ–¹æ¡ˆ</p><p>â‘ ä¼˜ç‚¹ï¼šæ‹†åˆ†ç²’åº¦æ›´å°ã€æœåŠ¡æ›´ç‹¬ç«‹ã€è€¦åˆåº¦æ›´ä½</p><p>â‘¡ç¼ºç‚¹ï¼šæ¶æ„éå¸¸å¤æ‚ï¼Œè¿ç»´ã€ç›‘æ§ã€éƒ¨ç½²éš¾åº¦æé«˜</p></li><li><p>SpringCloudæ˜¯å¾®æœåŠ¡æ¶æ„çš„ä¸€ç«™å¼è§£å†³æ–¹æ¡ˆï¼Œé›†æˆäº†å„ç§ä¼˜ç§€å¾®æœåŠ¡åŠŸèƒ½ç»„ä»¶</p></li></ul><h2 id="_2-æœåŠ¡æ‹†åˆ†å’Œè¿œç¨‹è°ƒç”¨" tabindex="-1">2.æœåŠ¡æ‹†åˆ†å’Œè¿œç¨‹è°ƒç”¨ <a class="header-anchor" href="#_2-æœåŠ¡æ‹†åˆ†å’Œè¿œç¨‹è°ƒç”¨" aria-label="Permalink to &quot;2.æœåŠ¡æ‹†åˆ†å’Œè¿œç¨‹è°ƒç”¨&quot;">â€‹</a></h2><p>ä»»ä½•åˆ†å¸ƒå¼æ¶æ„éƒ½ç¦»ä¸å¼€æœåŠ¡çš„æ‹†åˆ†ï¼Œå¾®æœåŠ¡ä¹Ÿæ˜¯ä¸€æ ·ã€‚</p><h3 id="_2-1-æœåŠ¡æ‹†åˆ†-ç›®æ ‡1" tabindex="-1">2.1 æœåŠ¡æ‹†åˆ† ç›®æ ‡1 <a class="header-anchor" href="#_2-1-æœåŠ¡æ‹†åˆ†-ç›®æ ‡1" aria-label="Permalink to &quot;2.1 æœåŠ¡æ‹†åˆ† ç›®æ ‡1&quot;">â€‹</a></h3><p>æœåŠ¡æ‹†åˆ†</p><p><strong>æœåŠ¡æ‹†åˆ†åŸåˆ™</strong></p><p>è¿™é‡Œæˆ‘æ€»ç»“äº†å¾®æœåŠ¡æ‹†åˆ†æ—¶çš„å‡ ä¸ªåŸåˆ™ï¼š</p><ul><li>ä¸åŒå¾®æœåŠ¡ï¼Œä¸è¦é‡å¤å¼€å‘ç›¸åŒä¸šåŠ¡</li><li>å¾®æœåŠ¡æ•°æ®ç‹¬ç«‹ï¼Œä¸è¦è®¿é—®å…¶å®ƒå¾®æœåŠ¡çš„æ•°æ®åº“</li><li>å¾®æœåŠ¡å¯ä»¥å°†è‡ªå·±çš„ä¸šåŠ¡æš´éœ²ä¸ºæ¥å£ï¼Œä¾›å…¶å®ƒå¾®æœåŠ¡è°ƒç”¨</li></ul><p><img src="http://image.yangeit.cn/i/2023/05/11/image-20210713210800950.png" alt="image-20210713210800950"></p><p>image-20210713210800950</p><h3 id="_2-2-æœåŠ¡æ‹†åˆ†ç¤ºä¾‹" tabindex="-1">2.2.æœåŠ¡æ‹†åˆ†ç¤ºä¾‹ <a class="header-anchor" href="#_2-2-æœåŠ¡æ‹†åˆ†ç¤ºä¾‹" aria-label="Permalink to &quot;2.2.æœåŠ¡æ‹†åˆ†ç¤ºä¾‹&quot;">â€‹</a></h3><p>ä»¥è¯¾å‰èµ„æ–™ä¸­çš„å¾®æœåŠ¡cloud-demoä¸ºä¾‹ï¼Œå…¶ç»“æ„å¦‚ä¸‹ï¼š</p><p><img src="http://image.yangeit.cn/i/2023/05/11/image-20210713211009593.png" alt="image-20210713211009593"></p><p>image-20210713211009593</p><p>cloud-demoï¼šçˆ¶å·¥ç¨‹ï¼Œç®¡ç†ä¾èµ–</p><ul><li>order-serviceï¼šè®¢å•å¾®æœåŠ¡ï¼Œè´Ÿè´£è®¢å•ç›¸å…³ä¸šåŠ¡</li><li>user-serviceï¼šç”¨æˆ·å¾®æœåŠ¡ï¼Œè´Ÿè´£ç”¨æˆ·ç›¸å…³ä¸šåŠ¡</li></ul><p>è¦æ±‚ï¼š</p><ul><li>è®¢å•å¾®æœåŠ¡å’Œç”¨æˆ·å¾®æœåŠ¡éƒ½å¿…é¡»æœ‰å„è‡ªçš„æ•°æ®åº“ï¼Œç›¸äº’ç‹¬ç«‹</li><li>è®¢å•æœåŠ¡å’Œç”¨æˆ·æœåŠ¡éƒ½å¯¹å¤–æš´éœ²Restfulçš„æ¥å£</li><li>è®¢å•æœåŠ¡å¦‚æœéœ€è¦æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯ï¼Œåªèƒ½è°ƒç”¨ç”¨æˆ·æœåŠ¡çš„Restfulæ¥å£ï¼Œä¸èƒ½æŸ¥è¯¢ç”¨æˆ·æ•°æ®åº“</li></ul><p><strong>æœåŠ¡æ‹†åˆ†ç¤ºä¾‹ä»£ç æ“ä½œ</strong></p><h5 id="_1ï¸âƒ£-å¯¼å…¥sqlè¯­å¥" tabindex="-1">1ï¸âƒ£ å¯¼å…¥Sqlè¯­å¥ <a class="header-anchor" href="#_1ï¸âƒ£-å¯¼å…¥sqlè¯­å¥" aria-label="Permalink to &quot;1ï¸âƒ£ å¯¼å…¥Sqlè¯­å¥&quot;">â€‹</a></h5><p>é¦–å…ˆï¼Œå°†è¯¾å‰èµ„æ–™æä¾›çš„<code>cloud-order.sql</code>å’Œ<code>cloud-user.sql</code>å¯¼å…¥åˆ°mysqlä¸­ï¼š</p><p><img src="http://image.yangeit.cn/i/2023/05/11/image-20210713211417049.png" alt="image-20210713211417049"></p><p>image-20210713211417049</p><p>cloud-userè¡¨ä¸­åˆå§‹æ•°æ®å¦‚ä¸‹ï¼š</p><p><img src="http://image.yangeit.cn/i/2023/05/11/image-20210713211550169.png" alt="image-20210713211550169"></p><p>image-20210713211550169</p><p>cloud-orderè¡¨ä¸­åˆå§‹æ•°æ®å¦‚ä¸‹ï¼š</p><p><img src="http://image.yangeit.cn/i/2023/05/11/image-20210713211657319.png" alt="image-20210713211657319"></p><p>image-20210713211657319</p><p>cloud-orderè¡¨ä¸­æŒæœ‰cloud-userè¡¨ä¸­çš„idå­—æ®µã€‚</p><h5 id="_2ï¸âƒ£-å¯¼å…¥demoå·¥ç¨‹" tabindex="-1">2ï¸âƒ£ å¯¼å…¥demoå·¥ç¨‹ <a class="header-anchor" href="#_2ï¸âƒ£-å¯¼å…¥demoå·¥ç¨‹" aria-label="Permalink to &quot;2ï¸âƒ£ å¯¼å…¥demoå·¥ç¨‹&quot;">â€‹</a></h5><p>ç”¨IDEAå¯¼å…¥è¯¾å‰èµ„æ–™æä¾›çš„Demoï¼š</p><p><img src="http://image.yangeit.cn/i/2023/05/11/image-20210713211814094.png" alt="image-20210713211814094"></p><p>image-20210713211814094</p><p>é¡¹ç›®ç»“æ„å¦‚ä¸‹ï¼š</p><p><img src="http://image.yangeit.cn/i/2023/05/11/image-20210713212656887.png" alt="image-20210713212656887"></p><p>image-20210713212656887</p><p>å¯¼å…¥åï¼Œä¼šåœ¨IDEAå³ä¸‹è§’å‡ºç°å¼¹çª—ï¼š</p><p><img src="http://image.yangeit.cn/i/2023/05/11/image-20210713212349272.png" alt="image-20210713212349272"></p><p>image-20210713212349272</p><p>ç‚¹å‡»å¼¹çª—ï¼Œç„¶åæŒ‰ä¸‹å›¾é€‰æ‹©ï¼š</p><p><img src="http://image.yangeit.cn/i/2023/05/11/image-20210713212336185.png" alt="image-20210713212336185"></p><p>image-20210713212336185</p><p>ä¼šå‡ºç°è¿™æ ·çš„èœå•ï¼š</p><p><img src="http://image.yangeit.cn/i/2023/05/11/image-20210713212513324.png" alt="image-20210713212513324"></p><p>image-20210713212513324</p><p>é…ç½®ä¸‹é¡¹ç›®ä½¿ç”¨çš„JDKï¼š</p><p><img src="http://image.yangeit.cn/i/2023/05/11/image-20210713220736408.png" alt="image-20210713220736408"></p><p>image-20210713220736408</p><h3 id="_2-2-è¿œç¨‹è°ƒç”¨-ç›®æ ‡2" tabindex="-1">2.2 è¿œç¨‹è°ƒç”¨ ç›®æ ‡2 <a class="header-anchor" href="#_2-2-è¿œç¨‹è°ƒç”¨-ç›®æ ‡2" aria-label="Permalink to &quot;2.2 è¿œç¨‹è°ƒç”¨ ç›®æ ‡2&quot;">â€‹</a></h3><p>è¿œç¨‹è°ƒç”¨</p><p>æ¡ˆä¾‹éœ€æ±‚</p><p>ä¿®æ”¹order-serviceä¸­çš„æ ¹æ®idæŸ¥è¯¢è®¢å•ä¸šåŠ¡ï¼Œè¦æ±‚åœ¨æŸ¥è¯¢è®¢å•çš„åŒæ—¶ï¼Œæ ¹æ®è®¢å•ä¸­åŒ…å«çš„userIdæŸ¥è¯¢å‡ºç”¨æˆ·ä¿¡æ¯ï¼Œä¸€èµ·è¿”å›ã€‚</p><p><img src="http://image.yangeit.cn/i/2023/05/11/image-20210713213312278.png" alt="image-20210713213312278"></p><p>image-20210713213312278</p><p>å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦åœ¨order-serviceä¸­ å‘user-serviceå‘èµ·ä¸€ä¸ªhttpçš„è¯·æ±‚ï¼Œè°ƒç”¨<a href="http://localhost:8081/user/%7BuserId%7D%E8%BF%99%E4%B8%AA%E6%8E%A5%E5%8F%A3%E3%80%82" target="_blank" rel="noreferrer">http://localhost:8081/user/{userId}è¿™ä¸ªæ¥å£ã€‚open in new window</a></p><p>å¤§æ¦‚çš„æ­¥éª¤æ˜¯è¿™æ ·çš„ï¼š</p><ul><li>æ³¨å†Œä¸€ä¸ªRestTemplateçš„å®ä¾‹åˆ°Springå®¹å™¨</li><li>ä¿®æ”¹order-serviceæœåŠ¡ä¸­çš„OrderServiceç±»ä¸­çš„queryOrderByIdæ–¹æ³•ï¼Œæ ¹æ®Orderå¯¹è±¡ä¸­çš„userIdæŸ¥è¯¢User</li><li>å°†æŸ¥è¯¢çš„Userå¡«å……åˆ°Orderå¯¹è±¡ï¼Œä¸€èµ·è¿”å›</li></ul><blockquote><p>RestTemplateå°è£…äº†Httpè¯·æ±‚</p></blockquote><p>åœ¨order-serviceæœåŠ¡ä¸­ï¼Œæœ‰ä¸€ä¸ªæ ¹æ®idæŸ¥è¯¢è®¢å•çš„æ¥å£ï¼š</p><p><img src="http://image.yangeit.cn/i/2023/05/11/image-20210713212749575.png" alt="image-20210713212749575"></p><p>image-20210713212749575</p><p>æ ¹æ®idæŸ¥è¯¢è®¢å•ï¼Œè¿”å›å€¼æ˜¯Orderå¯¹è±¡ï¼Œå¦‚å›¾ï¼š</p><p><img src="http://image.yangeit.cn/i/2023/05/11/image-20210713212901725.png" alt="image-20210713212901725"></p><p>image-20210713212901725</p><p>å…¶ä¸­çš„userä¸ºnull</p><p>åœ¨user-serviceä¸­æœ‰ä¸€ä¸ªæ ¹æ®idæŸ¥è¯¢ç”¨æˆ·çš„æ¥å£ï¼š</p><p><img src="http://image.yangeit.cn/i/2023/05/11/image-20210713213146089.png" alt="image-20210713213146089"></p><p>image-20210713213146089</p><p>æŸ¥è¯¢çš„ç»“æœå¦‚å›¾ï¼š</p><p><img src="http://image.yangeit.cn/i/2023/05/11/image-20210713213213075.png" alt="image-20210713213213075"></p><p>image-20210713213213075</p><h3 id="_2-3-2-æ³¨å†Œresttemplate" tabindex="-1">2.3.2.æ³¨å†ŒRestTemplate <a class="header-anchor" href="#_2-3-2-æ³¨å†Œresttemplate" aria-label="Permalink to &quot;2.3.2.æ³¨å†ŒRestTemplate&quot;">â€‹</a></h3><p>é¦–å…ˆï¼Œæˆ‘ä»¬åœ¨order-serviceæœåŠ¡ä¸­çš„OrderApplicationå¯åŠ¨ç±»ä¸­ï¼Œæ³¨å†ŒRestTemplateå®ä¾‹ï¼š</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F286C4;">package</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">cn.itcast.order</span><span style="color:#F6F6F4;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F286C4;">import</span><span style="color:#F6F6F4;"> org.mybatis.spring.annotation.MapperScan;</span></span>
<span class="line"><span style="color:#F286C4;">import</span><span style="color:#F6F6F4;"> org.springframework.boot.SpringApplication;</span></span>
<span class="line"><span style="color:#F286C4;">import</span><span style="color:#F6F6F4;"> org.springframework.boot.autoconfigure.SpringBootApplication;</span></span>
<span class="line"><span style="color:#F286C4;">import</span><span style="color:#F6F6F4;"> org.springframework.context.annotation.Bean;</span></span>
<span class="line"><span style="color:#F286C4;">import</span><span style="color:#F6F6F4;"> org.springframework.web.client.RestTemplate;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">MapperScan</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">cn.itcast.order.mapper</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">)</span></span>
<span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">SpringBootApplication</span></span>
<span class="line"><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">class</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;">OrderApplication</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">static</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">main</span><span style="color:#F6F6F4;">(</span><span style="color:#97E1F1;font-style:italic;">String</span><span style="color:#F6F6F4;">[] </span><span style="color:#FFB86C;font-style:italic;">args</span><span style="color:#F6F6F4;">) {</span></span>
<span class="line"><span style="color:#F6F6F4;">        SpringApplication.</span><span style="color:#62E884;">run</span><span style="color:#F6F6F4;">(OrderApplication.class, args);</span></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">    @</span><span style="color:#97E1F1;font-style:italic;">Bean</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">RestTemplate</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">restTemplate</span><span style="color:#F6F6F4;">() {</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#F286C4;">return</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;font-weight:bold;">new</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">RestTemplate</span><span style="color:#F6F6F4;">();</span></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">package</span><span style="color:#24292E;"> cn.itcast.order;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> org.mybatis.spring.annotation.MapperScan;</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> org.springframework.boot.SpringApplication;</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> org.springframework.boot.autoconfigure.SpringBootApplication;</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> org.springframework.context.annotation.Bean;</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> org.springframework.web.client.RestTemplate;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">MapperScan</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;cn.itcast.order.mapper&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">SpringBootApplication</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">OrderApplication</span><span style="color:#24292E;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">static</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">main</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">String</span><span style="color:#24292E;">[] </span><span style="color:#E36209;">args</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">        SpringApplication.</span><span style="color:#6F42C1;">run</span><span style="color:#24292E;">(OrderApplication.class, args);</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    @</span><span style="color:#D73A49;">Bean</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> RestTemplate </span><span style="color:#6F42C1;">restTemplate</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">RestTemplate</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h3 id="_2-3-3-å®ç°è¿œç¨‹è°ƒç”¨" tabindex="-1">2.3.3.å®ç°è¿œç¨‹è°ƒç”¨ <a class="header-anchor" href="#_2-3-3-å®ç°è¿œç¨‹è°ƒç”¨" aria-label="Permalink to &quot;2.3.3.å®ç°è¿œç¨‹è°ƒç”¨&quot;">â€‹</a></h3><p>ä¿®æ”¹order-serviceæœåŠ¡ä¸­çš„cn.itcast.order.serviceåŒ…ä¸‹çš„OrderServiceç±»ä¸­çš„queryOrderByIdæ–¹æ³•ï¼š</p><p><img src="http://image.yangeit.cn/i/2023/05/11/image-20210713213959569.png" alt="image-20210713213959569"></p><p>image-20210713213959569</p><p>è¯¾å ‚ä½œä¸š</p><p>ğŸš© 1. å¯¼å…¥è¯¾ç¨‹å®ä¾‹ï¼Œåœ¨æµè§ˆå™¨å‘èµ·è¯·æ±‚ï¼Œæ­£å¸¸è¾“å‡ºjsonæ•°æ®</p><h3 id="_2-3-æä¾›è€…ä¸æ¶ˆè´¹è€…" tabindex="-1">2.3 æä¾›è€…ä¸æ¶ˆè´¹è€… <a class="header-anchor" href="#_2-3-æä¾›è€…ä¸æ¶ˆè´¹è€…" aria-label="Permalink to &quot;2.3 æä¾›è€…ä¸æ¶ˆè´¹è€…&quot;">â€‹</a></h3><p>æä¾›è€…ä¸æ¶ˆè´¹è€…</p><p>ç»“åˆä¸‹å›¾ï¼Œæ€è€ƒä¸Šè¿°ä»£ç ä¸­ï¼Œåœ¨æœåŠ¡è°ƒç”¨å…³ç³»ä¸­ï¼Œå„ä¸ªæ¨¡å—æ‰®æ¼”çš„è§’è‰² <img src="http://image.yangeit.cn/i/2023/05/11/image-20210713210800950.png" alt=""></p><p><strong>åœ¨æœåŠ¡è°ƒç”¨å…³ç³»ä¸­ï¼Œä¼šæœ‰ä¸¤ä¸ªä¸åŒçš„è§’è‰²ï¼š</strong></p><p><strong>æœåŠ¡æä¾›è€…</strong>ï¼šä¸€æ¬¡ä¸šåŠ¡ä¸­ï¼Œè¢«å…¶å®ƒå¾®æœåŠ¡è°ƒç”¨çš„æœåŠ¡ã€‚ï¼ˆæä¾›æ¥å£ç»™å…¶å®ƒå¾®æœåŠ¡ï¼‰</p><p><strong>æœåŠ¡æ¶ˆè´¹è€…</strong>ï¼šä¸€æ¬¡ä¸šåŠ¡ä¸­ï¼Œè°ƒç”¨å…¶å®ƒå¾®æœåŠ¡çš„æœåŠ¡ã€‚ï¼ˆè°ƒç”¨å…¶å®ƒå¾®æœåŠ¡æä¾›çš„æ¥å£ï¼‰</p><p><img src="http://image.yangeit.cn/i/2023/05/11/image-20210713214404481.png" alt="image-20210713214404481"></p><p>image-20210713214404481</p><p>ä½†æ˜¯ï¼ŒæœåŠ¡æä¾›è€…ä¸æœåŠ¡æ¶ˆè´¹è€…çš„è§’è‰²å¹¶ä¸æ˜¯ç»å¯¹çš„ï¼Œè€Œæ˜¯ç›¸å¯¹äºä¸šåŠ¡è€Œè¨€ã€‚</p><p>å¦‚æœæœåŠ¡Aè°ƒç”¨äº†æœåŠ¡Bï¼Œè€ŒæœåŠ¡Båˆè°ƒç”¨äº†æœåŠ¡Cï¼ŒæœåŠ¡Bçš„è§’è‰²æ˜¯ä»€ä¹ˆï¼Ÿ</p><ul><li>å¯¹äºAè°ƒç”¨Bçš„ä¸šåŠ¡è€Œè¨€ï¼šAæ˜¯æœåŠ¡æ¶ˆè´¹è€…ï¼ŒBæ˜¯æœåŠ¡æä¾›è€…</li><li>å¯¹äºBè°ƒç”¨Cçš„ä¸šåŠ¡è€Œè¨€ï¼šBæ˜¯æœåŠ¡æ¶ˆè´¹è€…ï¼ŒCæ˜¯æœåŠ¡æä¾›è€…</li></ul><p>å› æ­¤ï¼ŒæœåŠ¡Bæ—¢å¯ä»¥æ˜¯æœåŠ¡æä¾›è€…ï¼Œä¹Ÿå¯ä»¥æ˜¯æœåŠ¡æ¶ˆè´¹è€…ã€‚</p><p>è¯¾å ‚ä½œä¸š</p><p>ğŸš© 1. è¯´å‡ºæ¶ˆè´¹è€…å’Œæä¾›è€…çš„ç‰¹ç‚¹ï¼Ÿå¹¶æ ¹æ®å…¶ç‰¹æ€§ï¼Œä¸¾å‡ºç”Ÿæ´»ä¸­çš„åˆ—å­</p><h2 id="_3-eurekaæ³¨å†Œä¸­å¿ƒ" tabindex="-1">3.Eurekaæ³¨å†Œä¸­å¿ƒ <a class="header-anchor" href="#_3-eurekaæ³¨å†Œä¸­å¿ƒ" aria-label="Permalink to &quot;3.Eurekaæ³¨å†Œä¸­å¿ƒ&quot;">â€‹</a></h2><h3 id="_3-1-eurekaçš„ç»“æ„å’Œä½œç”¨" tabindex="-1">3.1.Eurekaçš„ç»“æ„å’Œä½œç”¨ <a class="header-anchor" href="#_3-1-eurekaçš„ç»“æ„å’Œä½œç”¨" aria-label="Permalink to &quot;3.1.Eurekaçš„ç»“æ„å’Œä½œç”¨&quot;">â€‹</a></h3><p>å‰è¨€</p><p>å‡å¦‚æˆ‘ä»¬çš„æœåŠ¡æä¾›è€…user-serviceéƒ¨ç½²äº†å¤šä¸ªå®ä¾‹ï¼Œå¦‚å›¾ï¼š</p><p><img src="http://image.yangeit.cn/i/2023/05/11/image-20210713214925388.png" alt="image-20210713214925388"></p><p>image-20210713214925388</p><p>å¤§å®¶æ€è€ƒå‡ ä¸ªé—®é¢˜ï¼š</p><ul><li>order-serviceåœ¨å‘èµ·è¿œç¨‹è°ƒç”¨çš„æ—¶å€™ï¼Œè¯¥å¦‚ä½•å¾—çŸ¥<strong>user-serviceå®ä¾‹çš„ipåœ°å€å’Œç«¯å£</strong>ï¼Ÿ</li><li>æœ‰å¤šä¸ªuser-serviceå®ä¾‹åœ°å€ï¼Œorder-serviceè°ƒç”¨æ—¶è¯¥<strong>å¦‚ä½•é€‰æ‹©</strong>ï¼Ÿ</li><li>order-serviceå¦‚ä½•å¾—çŸ¥æŸä¸ªuser-service<strong>å®ä¾‹æ˜¯å¦ä¾ç„¶å¥åº·ï¼Œæ˜¯ä¸æ˜¯å·²ç»å®•æœº</strong>ï¼Ÿ</li></ul><p>è¿™äº›é—®é¢˜éƒ½éœ€è¦åˆ©ç”¨<strong>SpringCloudä¸­çš„æ³¨å†Œä¸­å¿ƒ</strong>æ¥è§£å†³ï¼Œå…¶ä¸­æœ€å¹¿ä¸ºäººçŸ¥çš„æ³¨å†Œä¸­å¿ƒå°±æ˜¯Eurekaï¼Œå…¶ç»“æ„å¦‚ä¸‹ï¼š</p><p><img src="http://image.yangeit.cn/i/2023/05/11/image-20210713220104956.png" alt="image-20210713220104956"></p><p>image-20210713220104956</p><blockquote><p>Eureak æ˜¯<strong>Netflix å¼€æºå¾®æœåŠ¡æ¡†æ¶</strong>ä¸­ä¸€ç³»åˆ—é¡¹ç›®ä¸­çš„ä¸€ä¸ªã€‚Spring Cloudå¯¹å…¶è¿›è¡Œäº†<strong>äºŒæ¬¡å°è£…</strong>,å½¢æˆäº†Spring Cloud Netflix å­é¡¹ç›®,<strong>ä½†æœªå¯¹Netflixå¾®æœåŠ¡å®ç°åŸç†è¿›è¡Œæ›´æ”¹,åªæ˜¯è¿›è¡Œäº†Spring BootåŒ–</strong>,ä½¿å¼€å‘è€…æ›´å®¹æ˜“ä½¿ç”¨å’Œæ•´åˆã€‚</p></blockquote><p>å­¦ä¹ Eurekaä¹‹å‰ï¼Œå…ˆæ€è€ƒä¸‹è¿°é—®é¢˜ ğŸ‘‡ğŸ‘‡</p><p><strong>é—®é¢˜1ï¼šorder-serviceå¦‚ä½•å¾—çŸ¥user-serviceå®ä¾‹åœ°å€ï¼Ÿ</strong></p><p>è·å–åœ°å€ä¿¡æ¯çš„æµç¨‹å¦‚ä¸‹ï¼ˆå‚è€ƒä¸Šå›¾â˜ï¸ï¼‰ï¼š</p><ul><li>user-service æœåŠ¡å®ä¾‹å¯åŠ¨åï¼Œå°†è‡ªå·±çš„ä¿¡æ¯æ³¨å†Œåˆ°eureka-serverï¼ˆEurekaæœåŠ¡ç«¯ï¼‰ã€‚è¿™ä¸ªå«æœåŠ¡æ³¨å†Œ</li><li>eureka-server ä¿å­˜æœåŠ¡åç§°åˆ°æœåŠ¡å®ä¾‹åœ°å€åˆ—è¡¨çš„æ˜ å°„å…³ç³»</li><li>order-service æ ¹æ®æœåŠ¡åç§°ï¼Œæ‹‰å–å®ä¾‹åœ°å€åˆ—è¡¨ã€‚è¿™ä¸ªå«æœåŠ¡å‘ç°æˆ–æœåŠ¡æ‹‰å–</li></ul><p><strong>é—®é¢˜2ï¼šorder-serviceå¦‚ä½•ä»å¤šä¸ªuser-serviceå®ä¾‹ä¸­é€‰æ‹©å…·ä½“çš„å®ä¾‹ï¼Ÿ</strong></p><ul><li>order-service ä» <strong>å®ä¾‹åˆ—è¡¨</strong> ä¸­åˆ©ç”¨è´Ÿè½½å‡è¡¡ç®—æ³• é€‰ä¸­ä¸€ä¸ªå®ä¾‹åœ°å€ğŸ“ƒ</li><li>å‘<strong>è¯¥å®ä¾‹åœ°å€</strong>å‘èµ·è¿œç¨‹è°ƒç”¨</li></ul><p><strong>é—®é¢˜3ï¼šorder-serviceå¦‚ä½•å¾—çŸ¥æŸä¸ªuser-serviceå®ä¾‹æ˜¯å¦ä¾ç„¶å¥åº·ï¼Œæ˜¯ä¸æ˜¯å·²ç»å®•æœºï¼Ÿ</strong></p><blockquote><p>å¯¹åº”ä¸Šå›¾çš„æ©™è‰²ç®­å¤´</p></blockquote><ul><li>user-service ä¼šæ¯éš”ä¸€æ®µæ—¶é—´ï¼ˆé»˜è®¤30ç§’ ï¼‰å‘eureka-serverå‘èµ·è¯·æ±‚ï¼ŒæŠ¥å‘Šè‡ªå·±çŠ¶æ€ï¼Œç§°ä¸ºå¿ƒè·³ ğŸ’“</li><li>å½“<strong>è¶…è¿‡ä¸€å®šæ—¶é—´æ²¡æœ‰å‘é€å¿ƒè·³æ—¶</strong>ğŸ’”ï¼Œeureka-serverä¼šè®¤ä¸ºå¾®æœåŠ¡å®ä¾‹æ•…éšœğŸ’¥ï¼Œå°†è¯¥å®ä¾‹ä»æœåŠ¡åˆ—è¡¨ä¸­<strong>å‰”é™¤</strong></li><li><strong>order-serviceæ‹‰å–æœåŠ¡æ—¶</strong>ï¼Œå°±èƒ½å°†æ•…éšœå®ä¾‹æ’é™¤äº†</li></ul><blockquote><p>æ³¨æ„ï¼šä¸€ä¸ªå¾®æœåŠ¡ï¼Œæ—¢å¯ä»¥æ˜¯æœåŠ¡æä¾›è€… ğŸ¨ï¼Œåˆå¯ä»¥æ˜¯æœåŠ¡æ¶ˆè´¹è€…ğŸ’‚â€â™‚ï¸ï¼Œå› æ­¤eurekaå°†æœåŠ¡æ³¨å†Œã€æœåŠ¡å‘ç°ç­‰åŠŸèƒ½ç»Ÿä¸€å°è£…åˆ°äº†<strong>eureka-clientç«¯</strong></p></blockquote><p>å› æ­¤ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬åŠ¨æ‰‹å®è·µçš„æ­¥éª¤åŒ…æ‹¬ï¼š</p><p><img src="http://image.yangeit.cn/i/2023/05/11/image-20210713220509769.png" alt="image-20210713220509769"></p><p>image-20210713220509769</p><h3 id="_3-2-æ­å»ºæ³¨å†Œä¸­å¿ƒ-ğŸ”§" tabindex="-1">3.2.æ­å»ºæ³¨å†Œä¸­å¿ƒ ğŸ”§ <a class="header-anchor" href="#_3-2-æ­å»ºæ³¨å†Œä¸­å¿ƒ-ğŸ”§" aria-label="Permalink to &quot;3.2.æ­å»ºæ³¨å†Œä¸­å¿ƒ ğŸ”§&quot;">â€‹</a></h3><p>é¦–å…ˆå¤§å®¶æ³¨å†Œä¸­å¿ƒæœåŠ¡ç«¯ï¼šeureka-serverï¼Œè¿™å¿…é¡»æ˜¯ä¸€ä¸ªç‹¬ç«‹ çš„å¾®æœåŠ¡</p><p>æ­å»ºeureka-serveræ³¨å†Œä¸­å¿ƒ</p><p>æ­¥éª¤</p><ol><li>åˆ›å»ºeureka-serveræœåŠ¡</li><li>å¼•å…¥eurekaä¾èµ–</li><li>ç¼–å†™å¯åŠ¨ç±»</li><li>ç¼–å†™é…ç½®æ–‡ä»¶</li><li>å¯åŠ¨æœåŠ¡</li></ol><p><strong>ä»£ç æ“ä½œ</strong></p><h4 id="_3-2-1-åˆ›å»ºeureka-serveræœåŠ¡" tabindex="-1">3.2.1.åˆ›å»ºeureka-serveræœåŠ¡ <a class="header-anchor" href="#_3-2-1-åˆ›å»ºeureka-serveræœåŠ¡" aria-label="Permalink to &quot;3.2.1.åˆ›å»ºeureka-serveræœåŠ¡&quot;">â€‹</a></h4><p>åœ¨<code>cloud-demoçˆ¶å·¥ç¨‹</code>ä¸‹ï¼Œåˆ›å»ºä¸€ä¸ª<code>å­æ¨¡å—</code>ï¼š</p><p><img src="http://image.yangeit.cn/i/2023/05/11/image-20210713220605881.png" alt="image-20210713220605881"></p><p>image-20210713220605881</p><p>å¡«å†™æ¨¡å—ä¿¡æ¯ï¼š</p><p><img src="http://image.yangeit.cn/i/2023/05/11/image-20210713220857396.png" alt="image-20210713220857396"></p><p>image-20210713220857396</p><p>ç„¶åå¡«å†™æœåŠ¡ä¿¡æ¯(æ³¨æ„ï¼šåœ¨çˆ¶å·¥ç¨‹cloud-demoä¸‹ )ï¼š</p><p><img src="http://image.yangeit.cn/i/2023/05/11/image-20210713221339022.png" alt="image-20210713221339022"></p><p>image-20210713221339022</p><h4 id="_3-2-2-å¼•å…¥eurekaä¾èµ–" tabindex="-1">3.2.2.å¼•å…¥eurekaä¾èµ– <a class="header-anchor" href="#_3-2-2-å¼•å…¥eurekaä¾èµ–" aria-label="Permalink to &quot;3.2.2.å¼•å…¥eurekaä¾èµ–&quot;">â€‹</a></h4><p>å¼•å…¥SpringCloudä¸ºeurekaæä¾›çš„starterä¾èµ–ï¼š</p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F6F6F4;">&lt;</span><span style="color:#F286C4;">dependency</span><span style="color:#F6F6F4;">&gt;</span></span>
<span class="line"><span style="color:#F6F6F4;">    &lt;</span><span style="color:#F286C4;">groupId</span><span style="color:#F6F6F4;">&gt;org.springframework.cloud&lt;/</span><span style="color:#F286C4;">groupId</span><span style="color:#F6F6F4;">&gt;</span></span>
<span class="line"><span style="color:#F6F6F4;">    &lt;</span><span style="color:#F286C4;">artifactId</span><span style="color:#F6F6F4;">&gt;spring-cloud-starter-netflix-eureka-server&lt;/</span><span style="color:#F286C4;">artifactId</span><span style="color:#F6F6F4;">&gt;</span></span>
<span class="line"><span style="color:#F6F6F4;">&lt;/</span><span style="color:#F286C4;">dependency</span><span style="color:#F6F6F4;">&gt;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#22863A;">dependency</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">    &lt;</span><span style="color:#22863A;">groupId</span><span style="color:#24292E;">&gt;org.springframework.cloud&lt;/</span><span style="color:#22863A;">groupId</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">    &lt;</span><span style="color:#22863A;">artifactId</span><span style="color:#24292E;">&gt;spring-cloud-starter-netflix-eureka-server&lt;/</span><span style="color:#22863A;">artifactId</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">&lt;/</span><span style="color:#22863A;">dependency</span><span style="color:#24292E;">&gt;</span></span></code></pre></div><blockquote><p>å¯¼å…¥åï¼Œæ£€æŸ¥ideaçš„å³ä¾§mavenä¸­çš„denpendiesä¸­æ˜¯å¦å­˜åœ¨ä¾èµ–</p></blockquote><h4 id="_3-2-3-ç¼–å†™å¯åŠ¨ç±»" tabindex="-1">3.2.3.ç¼–å†™å¯åŠ¨ç±» <a class="header-anchor" href="#_3-2-3-ç¼–å†™å¯åŠ¨ç±»" aria-label="Permalink to &quot;3.2.3.ç¼–å†™å¯åŠ¨ç±»&quot;">â€‹</a></h4><p>ç»™eureka-serveræœåŠ¡<strong>ç¼–å†™ä¸€ä¸ªå¯åŠ¨ç±»</strong>ï¼Œä¸€å®šè¦æ·»åŠ ä¸€ä¸ª<code>@EnableEurekaServer</code>æ³¨è§£ï¼Œå¼€å¯eurekaçš„æ³¨å†Œä¸­å¿ƒåŠŸèƒ½ï¼š</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F286C4;">package</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">cn.itcast.eureka</span><span style="color:#F6F6F4;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">SpringBootApplication</span></span>
<span class="line"><span style="color:#7B7F8B;">// å¼€å¯eurekaçš„æ³¨å†Œä¸­å¿ƒåŠŸèƒ½</span></span>
<span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">EnableEurekaServer</span></span>
<span class="line"><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">class</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;">EurekaApplication</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">static</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">main</span><span style="color:#F6F6F4;">(</span><span style="color:#97E1F1;font-style:italic;">String</span><span style="color:#F6F6F4;">[] </span><span style="color:#FFB86C;font-style:italic;">args</span><span style="color:#F6F6F4;">) {</span></span>
<span class="line"><span style="color:#F6F6F4;">        SpringApplication.</span><span style="color:#62E884;">run</span><span style="color:#F6F6F4;">(EurekaApplication.class, args);</span></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">package</span><span style="color:#24292E;"> cn.itcast.eureka;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">SpringBootApplication</span></span>
<span class="line"><span style="color:#6A737D;">// å¼€å¯eurekaçš„æ³¨å†Œä¸­å¿ƒåŠŸèƒ½</span></span>
<span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">EnableEurekaServer</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">EurekaApplication</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">static</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">main</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">String</span><span style="color:#24292E;">[] </span><span style="color:#E36209;">args</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">        SpringApplication.</span><span style="color:#6F42C1;">run</span><span style="color:#24292E;">(EurekaApplication.class, args);</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h4 id="_3-2-4-ç¼–å†™é…ç½®æ–‡ä»¶" tabindex="-1">3.2.4.ç¼–å†™é…ç½®æ–‡ä»¶ <a class="header-anchor" href="#_3-2-4-ç¼–å†™é…ç½®æ–‡ä»¶" aria-label="Permalink to &quot;3.2.4.ç¼–å†™é…ç½®æ–‡ä»¶&quot;">â€‹</a></h4><p>ç¼–å†™ä¸€ä¸ªapplication.ymlæ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#97E1F1;">server</span><span style="color:#F286C4;">:</span></span>
<span class="line"><span style="color:#F6F6F4;">  </span><span style="color:#97E1F1;">port</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">10086</span></span>
<span class="line"><span style="color:#97E1F1;">spring</span><span style="color:#F286C4;">:</span></span>
<span class="line"><span style="color:#F6F6F4;">  </span><span style="color:#97E1F1;">application</span><span style="color:#F286C4;">:</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#97E1F1;">name</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#E7EE98;">eureka-server</span></span>
<span class="line"><span style="color:#97E1F1;">eureka</span><span style="color:#F286C4;">:</span></span>
<span class="line"><span style="color:#F6F6F4;">  </span><span style="color:#97E1F1;">client</span><span style="color:#F286C4;">:</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#97E1F1;">service-url</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span></span>
<span class="line"><span style="color:#F6F6F4;">      </span><span style="color:#97E1F1;">defaultZone</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#E7EE98;">http://127.0.0.1:10086/eureka</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#22863A;">server</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">port</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">10086</span></span>
<span class="line"><span style="color:#22863A;">spring</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">application</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">eureka-server</span></span>
<span class="line"><span style="color:#22863A;">eureka</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">client</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">service-url</span><span style="color:#24292E;">: </span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">defaultZone</span><span style="color:#24292E;">: </span><span style="color:#032F62;">http://127.0.0.1:10086/eureka</span></span></code></pre></div><blockquote><p>æ³¨æ„ï¼šå†™æˆdefault-zoneä¸å¯ä»¥ï¼Œeurekaå¹¶ä¸è®¤è¯†è¿™ä¸ª</p><p>defaultZone ä»£è¡¨çš„å°±æ˜¯ eureka server ( æœåŠ¡å‘ç°å’Œæ³¨å†Œä¸­å¿ƒ)çš„åœ°å€</p><p>ä½œä¸ºæ³¨å†Œä¸­å¿ƒä¸ºä»€ä¹ˆè¦æ³¨å†Œï¼Ÿå› ä¸ºæœªæ¥ä¼šæœ‰å¤šä¸ªeurekaç»„æˆé›†ç¾¤ï¼Œéœ€è¦äº’ç›¸æ³¨å†Œ</p></blockquote><h3 id="_3-3-æœåŠ¡æ³¨å†Œ-ğŸ”–" tabindex="-1">3.3.æœåŠ¡æ³¨å†Œ ğŸ”– <a class="header-anchor" href="#_3-3-æœåŠ¡æ³¨å†Œ-ğŸ”–" aria-label="Permalink to &quot;3.3.æœåŠ¡æ³¨å†Œ ğŸ”–&quot;">â€‹</a></h3><p>æœåŠ¡æ³¨å†Œ</p><p><strong>ä¸‹é¢ï¼Œæˆ‘ä»¬å°†user-serviceæ³¨å†Œåˆ°eureka-serverä¸­å»ã€‚</strong> ğŸ¯</p><p><img src="http://image.yangeit.cn/i/2023/05/11/sureka-client-register.jpg" alt="æœåŠ¡æ³¨å†Œ"></p><p>æœåŠ¡æ³¨å†Œ</p><p><strong>ä»£ç æ“ä½œ</strong></p><h4 id="_1-å¼•å…¥ä¾èµ–" tabindex="-1">1ï¼‰å¼•å…¥ä¾èµ– <a class="header-anchor" href="#_1-å¼•å…¥ä¾èµ–" aria-label="Permalink to &quot;1ï¼‰å¼•å…¥ä¾èµ–&quot;">â€‹</a></h4><p>åœ¨<code>user-serviceçš„pomæ–‡ä»¶ä¸­</code>ï¼Œå¼•å…¥ä¸‹é¢çš„<code>eureka-clientä¾èµ–</code>ï¼š</p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F6F6F4;">&lt;</span><span style="color:#F286C4;">dependency</span><span style="color:#F6F6F4;">&gt;</span></span>
<span class="line"><span style="color:#F6F6F4;">    &lt;</span><span style="color:#F286C4;">groupId</span><span style="color:#F6F6F4;">&gt;org.springframework.cloud&lt;/</span><span style="color:#F286C4;">groupId</span><span style="color:#F6F6F4;">&gt;</span></span>
<span class="line"><span style="color:#F6F6F4;">    &lt;</span><span style="color:#F286C4;">artifactId</span><span style="color:#F6F6F4;">&gt;spring-cloud-starter-netflix-eureka-client&lt;/</span><span style="color:#F286C4;">artifactId</span><span style="color:#F6F6F4;">&gt;</span></span>
<span class="line"><span style="color:#F6F6F4;">&lt;/</span><span style="color:#F286C4;">dependency</span><span style="color:#F6F6F4;">&gt;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#22863A;">dependency</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">    &lt;</span><span style="color:#22863A;">groupId</span><span style="color:#24292E;">&gt;org.springframework.cloud&lt;/</span><span style="color:#22863A;">groupId</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">    &lt;</span><span style="color:#22863A;">artifactId</span><span style="color:#24292E;">&gt;spring-cloud-starter-netflix-eureka-client&lt;/</span><span style="color:#22863A;">artifactId</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">&lt;/</span><span style="color:#22863A;">dependency</span><span style="color:#24292E;">&gt;</span></span></code></pre></div><h4 id="_2-é…ç½®æ–‡ä»¶" tabindex="-1">2ï¼‰é…ç½®æ–‡ä»¶ <a class="header-anchor" href="#_2-é…ç½®æ–‡ä»¶" aria-label="Permalink to &quot;2ï¼‰é…ç½®æ–‡ä»¶&quot;">â€‹</a></h4><p>åœ¨<code>user-service</code>ä¸­ï¼Œä¿®æ”¹<code>application.yml</code>æ–‡ä»¶ï¼Œæ·»åŠ æœåŠ¡åç§°ã€eurekaåœ°å€ï¼š</p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#97E1F1;">spring</span><span style="color:#F286C4;">:</span></span>
<span class="line"><span style="color:#F6F6F4;">  </span><span style="color:#97E1F1;">application</span><span style="color:#F286C4;">:</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#97E1F1;">name</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#E7EE98;">userservice</span></span>
<span class="line"><span style="color:#97E1F1;">eureka</span><span style="color:#F286C4;">:</span></span>
<span class="line"><span style="color:#F6F6F4;">  </span><span style="color:#97E1F1;">client</span><span style="color:#F286C4;">:</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#97E1F1;">service-url</span><span style="color:#F286C4;">:</span></span>
<span class="line"><span style="color:#F6F6F4;">      </span><span style="color:#97E1F1;">defaultZone</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#E7EE98;">http://127.0.0.1:10086/eureka</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#22863A;">spring</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">application</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">userservice</span></span>
<span class="line"><span style="color:#22863A;">eureka</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">client</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">service-url</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">defaultZone</span><span style="color:#24292E;">: </span><span style="color:#032F62;">http://127.0.0.1:10086/eureka</span></span></code></pre></div><h4 id="_3-å¯åŠ¨å¤šä¸ªuser-serviceå®ä¾‹" tabindex="-1">3ï¼‰å¯åŠ¨å¤šä¸ªuser-serviceå®ä¾‹ <a class="header-anchor" href="#_3-å¯åŠ¨å¤šä¸ªuser-serviceå®ä¾‹" aria-label="Permalink to &quot;3ï¼‰å¯åŠ¨å¤šä¸ªuser-serviceå®ä¾‹&quot;">â€‹</a></h4><p>ä¸ºäº†æ¼”ç¤ºä¸€ä¸ªæœåŠ¡æœ‰å¤šä¸ªå®ä¾‹çš„åœºæ™¯ å¤šä¾‹ï¼Œæˆ‘ä»¬æ·»åŠ ä¸€ä¸ªSpringBootçš„å¯åŠ¨é…ç½®ï¼Œå†å¯åŠ¨ä¸€ä¸ªuser-serviceã€‚</p><p>é¦–å…ˆï¼Œå¤åˆ¶åŸæ¥çš„user-serviceå¯åŠ¨é…ç½®ï¼š</p><p><img src="http://image.yangeit.cn/i/2023/05/11/image-20210713222656562.png" alt="image-20210713222656562"></p><p>image-20210713222656562</p><p>ç„¶åï¼Œåœ¨å¼¹å‡ºçš„çª—å£ä¸­ï¼Œå¡«å†™ä¿¡æ¯ï¼ˆæ–°çš„åº”ç”¨åå­—ã€æ–°çš„ç«¯å£ ï¼‰ï¼š</p><p><img src="http://image.yangeit.cn/i/2023/05/11/image-20210713222757702.png" alt="image-20210713222757702"></p><p>image-20210713222757702</p><p>ç°åœ¨ï¼ŒSpringBootçª—å£ä¼šå‡ºç°ä¸¤ä¸ªuser-serviceå¯åŠ¨é…ç½®ï¼š</p><p><img src="http://image.yangeit.cn/i/2023/05/11/image-20210713222841951.png" alt="image-20210713222841951"></p><p>image-20210713222841951</p><p><strong>ä¸è¿‡ï¼Œç¬¬ä¸€ä¸ªæ˜¯8081ç«¯å£ï¼Œç¬¬äºŒä¸ªæ˜¯8082ç«¯å£ã€‚</strong></p><p>å¯åŠ¨ä¸¤ä¸ªuser-serviceå®ä¾‹ï¼š</p><p><img src="http://image.yangeit.cn/i/2023/05/11/image-20210713223041491.png" alt="image-20210713223041491"></p><p>image-20210713223041491</p><p>æŸ¥çœ‹eureka-serverç®¡ç†é¡µé¢ï¼š</p><p><img src="http://image.yangeit.cn/i/2023/05/11/image-20210713223150650.png" alt="image-20210713223150650"></p><p>image-20210713223150650</p><blockquote><p>å› ä¸ºymlä¸­é…ç½®çš„åº”ç”¨åå­—ä¸€æ ·ï¼Œå› æ­¤åŒä¸€ä¸ªæœåŠ¡åå­—ä¸‹ï¼Œæœ‰å¤šä¸ªå®ä¾‹</p></blockquote><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#97E1F1;">spring</span><span style="color:#F286C4;">:</span></span>
<span class="line"><span style="color:#F6F6F4;">  </span><span style="color:#97E1F1;">application</span><span style="color:#F286C4;">:</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#97E1F1;">name</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#E7EE98;">userservice</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#22863A;">spring</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">application</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">userservice</span></span></code></pre></div><h3 id="_3-4-æœåŠ¡å‘ç°ğŸ”" tabindex="-1">3.4.æœåŠ¡å‘ç°ğŸ” <a class="header-anchor" href="#_3-4-æœåŠ¡å‘ç°ğŸ”" aria-label="Permalink to &quot;3.4.æœåŠ¡å‘ç°ğŸ”&quot;">â€‹</a></h3><p>æœåŠ¡å‘ç°</p><p>ç›¸å…³ä¿¡æ¯</p><p>ä¸‹é¢ï¼Œæˆ‘ä»¬å°†<code>order-service</code>çš„é€»è¾‘ä¿®æ”¹ï¼šå‘eureka-serveræ‹‰å–<code>user-serviceçš„ä¿¡æ¯</code>ï¼Œå®ç°æœåŠ¡å‘ç°ğŸ”ã€‚</p><p><img src="http://image.yangeit.cn/i/2023/05/11/sureka-client-register.jpg" alt=""></p><p><strong>ä»£ç æ“ä½œ</strong></p><h4 id="_1-å¼•å…¥ä¾èµ–-1" tabindex="-1">1ï¼‰å¼•å…¥ä¾èµ– <a class="header-anchor" href="#_1-å¼•å…¥ä¾èµ–-1" aria-label="Permalink to &quot;1ï¼‰å¼•å…¥ä¾èµ–&quot;">â€‹</a></h4><p><strong>æœåŠ¡å‘ç°ã€æœåŠ¡æ³¨å†Œç»Ÿä¸€éƒ½å°è£…åœ¨eureka-clientä¾èµ–ï¼Œå› æ­¤è¿™ä¸€æ­¥ä¸æœåŠ¡æ³¨å†Œæ—¶ä¸€è‡´ã€‚</strong></p><p>åœ¨<strong>order-serviceçš„pomæ–‡ä»¶ä¸­</strong>ï¼Œå¼•å…¥ä¸‹é¢çš„<strong>eureka-clientä¾èµ–</strong>ï¼š</p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F6F6F4;">&lt;</span><span style="color:#F286C4;">dependency</span><span style="color:#F6F6F4;">&gt;</span></span>
<span class="line"><span style="color:#F6F6F4;">    &lt;</span><span style="color:#F286C4;">groupId</span><span style="color:#F6F6F4;">&gt;org.springframework.cloud&lt;/</span><span style="color:#F286C4;">groupId</span><span style="color:#F6F6F4;">&gt;</span></span>
<span class="line"><span style="color:#F6F6F4;">    &lt;</span><span style="color:#F286C4;">artifactId</span><span style="color:#F6F6F4;">&gt;spring-cloud-starter-netflix-eureka-client&lt;/</span><span style="color:#F286C4;">artifactId</span><span style="color:#F6F6F4;">&gt;</span></span>
<span class="line"><span style="color:#F6F6F4;">&lt;/</span><span style="color:#F286C4;">dependency</span><span style="color:#F6F6F4;">&gt;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#22863A;">dependency</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">    &lt;</span><span style="color:#22863A;">groupId</span><span style="color:#24292E;">&gt;org.springframework.cloud&lt;/</span><span style="color:#22863A;">groupId</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">    &lt;</span><span style="color:#22863A;">artifactId</span><span style="color:#24292E;">&gt;spring-cloud-starter-netflix-eureka-client&lt;/</span><span style="color:#22863A;">artifactId</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">&lt;/</span><span style="color:#22863A;">dependency</span><span style="color:#24292E;">&gt;</span></span></code></pre></div><h4 id="_2-é…ç½®æ–‡ä»¶-1" tabindex="-1">2ï¼‰é…ç½®æ–‡ä»¶ <a class="header-anchor" href="#_2-é…ç½®æ–‡ä»¶-1" aria-label="Permalink to &quot;2ï¼‰é…ç½®æ–‡ä»¶&quot;">â€‹</a></h4><p>æœåŠ¡å‘ç°ä¹Ÿéœ€è¦çŸ¥é“eurekaåœ°å€ï¼Œå› æ­¤ç¬¬äºŒæ­¥ä¸æœåŠ¡æ³¨å†Œä¸€è‡´ï¼Œéƒ½æ˜¯é…ç½®eurekaä¿¡æ¯ï¼š</p><p>åœ¨order-serviceä¸­ï¼Œä¿®æ”¹application.ymlæ–‡ä»¶ï¼Œæ·»åŠ æœåŠ¡åç§°ã€eurekaåœ°å€ï¼š</p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#97E1F1;">spring</span><span style="color:#F286C4;">:</span></span>
<span class="line"><span style="color:#F6F6F4;">  </span><span style="color:#97E1F1;">application</span><span style="color:#F286C4;">:</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#97E1F1;">name</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#E7EE98;">orderservice</span></span>
<span class="line"><span style="color:#97E1F1;">eureka</span><span style="color:#F286C4;">:</span></span>
<span class="line"><span style="color:#F6F6F4;">  </span><span style="color:#97E1F1;">client</span><span style="color:#F286C4;">:</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#97E1F1;">service-url</span><span style="color:#F286C4;">:</span></span>
<span class="line"><span style="color:#F6F6F4;">      </span><span style="color:#97E1F1;">defaultZone</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#E7EE98;">http://127.0.0.1:10086/eureka</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#22863A;">spring</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">application</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">orderservice</span></span>
<span class="line"><span style="color:#22863A;">eureka</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">client</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">service-url</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">defaultZone</span><span style="color:#24292E;">: </span><span style="color:#032F62;">http://127.0.0.1:10086/eureka</span></span></code></pre></div><h4 id="_3-æœåŠ¡æ‹‰å–å’Œè´Ÿè½½å‡è¡¡" tabindex="-1">3ï¼‰æœåŠ¡æ‹‰å–å’Œè´Ÿè½½å‡è¡¡ <a class="header-anchor" href="#_3-æœåŠ¡æ‹‰å–å’Œè´Ÿè½½å‡è¡¡" aria-label="Permalink to &quot;3ï¼‰æœåŠ¡æ‹‰å–å’Œè´Ÿè½½å‡è¡¡&quot;">â€‹</a></h4><p>æœ€åï¼Œæˆ‘ä»¬è¦å»eureka-serverä¸­æ‹‰å–user-serviceæœåŠ¡çš„å®ä¾‹åˆ—è¡¨ï¼Œå¹¶ä¸”å®ç°<strong>è´Ÿè½½å‡è¡¡</strong>ã€‚</p><p><strong>ä¸è¿‡è¿™äº›åŠ¨ä½œä¸ç”¨æˆ‘ä»¬å»åšï¼Œåªéœ€è¦æ·»åŠ ä¸€äº›æ³¨è§£å³å¯ã€‚</strong></p><p>åœ¨<code>order-service</code>çš„<code>OrderApplication</code>ä¸­ï¼Œç»™<code>RestTemplateè¿™ä¸ªBean</code>æ·»åŠ ä¸€ä¸ª<code>@LoadBalanced</code>æ³¨è§£ï¼š</p><p><img src="http://image.yangeit.cn/i/2023/05/11/image-20210713224049419.png" alt="image-20210713224049419"></p><p>image-20210713224049419</p><p>ä¿®æ”¹ <code>order-service</code>æœåŠ¡ä¸­çš„<code>cn.itcast.order.service</code>åŒ…ä¸‹çš„<code>OrderServiceç±»</code>ä¸­çš„<code>queryOrderById</code>æ–¹æ³•ã€‚ä¿®æ”¹<code>è®¿é—®çš„urlè·¯å¾„ï¼Œç”¨æœåŠ¡åä»£æ›¿ipã€ç«¯å£</code>ï¼š</p><p><img src="http://image.yangeit.cn/i/2023/05/11/image-20210713224245731.png" alt="image-20210713224245731"></p><p>image-20210713224245731</p><p>springä¼šè‡ªåŠ¨å¸®åŠ©æˆ‘ä»¬ä»<strong>eureka-serverç«¯</strong>ï¼Œ<strong>æ ¹æ®userserviceè¿™ä¸ªæœåŠ¡åç§°</strong>ï¼Œè·å–<strong>å®ä¾‹åˆ—è¡¨</strong>ï¼Œè€Œåå®Œæˆè´Ÿè½½å‡è¡¡ã€‚</p><blockquote><p>è´Ÿè½½å‡è¡¡ï¼šå…¶åŸºæœ¬æ¦‚å¿µæ˜¯ä¸ºäº†å‡è½»æŸä¸ªæˆ–æŸäº›å®ä½“çš„è´Ÿè½½ï¼Œå°†ä»»åŠ¡é€šè¿‡æŸç§ç­–ç•¥åˆ†é…åˆ°å¤šä¸ªå®ä½“ä¸Šå»ï¼Œå®ç°è´Ÿè½½åœ¨ä¸åŒå®ä½“é—´çš„å¹³è¡¡ã€‚</p></blockquote><h2 id="_4-ribbonè´Ÿè½½å‡è¡¡" tabindex="-1">4.Ribbonè´Ÿè½½å‡è¡¡ <a class="header-anchor" href="#_4-ribbonè´Ÿè½½å‡è¡¡" aria-label="Permalink to &quot;4.Ribbonè´Ÿè½½å‡è¡¡&quot;">â€‹</a></h2><h3 id="_4-1-è´Ÿè½½å‡è¡¡åŸç†å’Œæºç " tabindex="-1">4.1.è´Ÿè½½å‡è¡¡åŸç†å’Œæºç  <a class="header-anchor" href="#_4-1-è´Ÿè½½å‡è¡¡åŸç†å’Œæºç " aria-label="Permalink to &quot;4.1.è´Ÿè½½å‡è¡¡åŸç†å’Œæºç &quot;">â€‹</a></h3><p>Ribbon[ËˆrÉªbÉ™n]è´Ÿè½½å‡è¡¡</p><p>æ³¨æ„</p><p>ä¸Šä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬æ·»åŠ äº†<code>@LoadBalancedæ³¨è§£</code>ï¼Œå³å¯å®ç°<code>è´Ÿè½½å‡è¡¡åŠŸèƒ½</code>ï¼Œè¿™æ˜¯ä»€ä¹ˆåŸç†å‘¢ï¼Ÿ</p><p>SpringCloudåº•å±‚å…¶å®æ˜¯åˆ©ç”¨äº†ä¸€ä¸ªåä¸º<strong>Ribbonçš„ç»„ä»¶</strong>ï¼Œæ¥å®ç°<strong>è´Ÿè½½å‡è¡¡</strong>åŠŸèƒ½çš„ã€‚</p><p><img src="http://image.yangeit.cn/i/2023/05/11/image-20210713224517686.png" alt="image-20210713224517686"></p><p>image-20210713224517686</p><p>é‚£ä¹ˆæˆ‘ä»¬å‘å‡ºçš„è¯·æ±‚æ˜æ˜æ˜¯<code>http://userservice/user/1</code>ï¼Œæ€ä¹ˆå˜æˆäº†<code>http://localhost:8081çš„å‘¢ï¼Ÿ</code></p><p>æ¬²çŸ¥è¯¦æƒ…å¦‚ä½•ï¼Œè¯·æŸ¥çœ‹<code>æºç è·Ÿè¸ªæ±‚è§£</code> ğŸ‘‰</p><h3 id="_4-2-æºç è·Ÿè¸ª" tabindex="-1">4.2.æºç è·Ÿè¸ª <a class="header-anchor" href="#_4-2-æºç è·Ÿè¸ª" aria-label="Permalink to &quot;4.2.æºç è·Ÿè¸ª&quot;">â€‹</a></h3><p>ä¸ºä»€ä¹ˆæˆ‘ä»¬åªè¾“å…¥äº†serviceåç§°å°±å¯ä»¥è®¿é—®äº†å‘¢ï¼Ÿä¹‹å‰è¿˜è¦è·å–ipå’Œç«¯å£ã€‚</p><p>æ˜¾ç„¶æœ‰äººå¸®æˆ‘ä»¬æ ¹æ®serviceåç§°ï¼Œè·å–åˆ°äº†æœåŠ¡å®ä¾‹çš„ipå’Œç«¯å£ã€‚å®ƒå°±æ˜¯<code>LoadBalancerInterceptor</code>ï¼Œè¿™ä¸ªç±»ä¼šåœ¨å¯¹RestTemplateçš„è¯·æ±‚è¿›è¡Œæ‹¦æˆªï¼Œç„¶åä»Eurekaæ ¹æ®æœåŠ¡idè·å–æœåŠ¡åˆ—è¡¨ï¼Œéšååˆ©ç”¨è´Ÿè½½å‡è¡¡ç®—æ³•å¾—åˆ°çœŸå®çš„æœåŠ¡åœ°å€ä¿¡æ¯ï¼Œæ›¿æ¢æœåŠ¡idã€‚</p><p>æˆ‘ä»¬è¿›è¡Œæºç è·Ÿè¸ªï¼š</p><h4 id="_1-loadbalancerinterceptor" tabindex="-1">1ï¼‰LoadBalancerInterceptor <a class="header-anchor" href="#_1-loadbalancerinterceptor" aria-label="Permalink to &quot;1ï¼‰LoadBalancerInterceptor&quot;">â€‹</a></h4><p><img src="http://image.yangeit.cn/i/2023/05/11/1525620483637.png" alt="1525620483637"></p><p>1525620483637</p><p>å¯ä»¥çœ‹åˆ°è¿™é‡Œçš„interceptæ–¹æ³•ï¼Œæ‹¦æˆªäº†ç”¨æˆ·çš„HttpRequestè¯·æ±‚ï¼Œç„¶ååšäº†å‡ ä»¶äº‹ï¼š</p><ul><li><code>request.getURI()</code>ï¼šè·å–è¯·æ±‚uriï¼Œæœ¬ä¾‹ä¸­å°±æ˜¯ <a href="http://user-service/user/8" target="_blank" rel="noreferrer">http://user-service/user/8open in new window</a></li><li><code>originalUri.getHost()</code>ï¼šè·å–uriè·¯å¾„çš„ä¸»æœºåï¼Œå…¶å®å°±æ˜¯æœåŠ¡idï¼Œ<code>user-service</code></li><li><code>this.loadBalancer.execute()</code>ï¼šå¤„ç†æœåŠ¡idï¼Œå’Œç”¨æˆ·è¯·æ±‚ã€‚</li></ul><p>è¿™é‡Œçš„<code>this.loadBalancer</code>æ˜¯<code>LoadBalancerClient</code>ç±»å‹ï¼Œæˆ‘ä»¬ç»§ç»­è·Ÿå…¥ã€‚</p><h4 id="_2-loadbalancerclient" tabindex="-1">2ï¼‰LoadBalancerClient <a class="header-anchor" href="#_2-loadbalancerclient" aria-label="Permalink to &quot;2ï¼‰LoadBalancerClient&quot;">â€‹</a></h4><p>ç»§ç»­è·Ÿå…¥executeæ–¹æ³•ï¼š</p><p><img src="http://image.yangeit.cn/i/2023/05/11/1525620787090.png" alt="1525620787090"></p><p>1525620787090</p><p>ä»£ç æ˜¯è¿™æ ·çš„ï¼š</p><ul><li>getLoadBalancer(serviceId)ï¼šæ ¹æ®æœåŠ¡idè·å–ILoadBalancerï¼Œè€ŒILoadBalancerä¼šæ‹¿ç€æœåŠ¡idå»eurekaä¸­è·å–æœåŠ¡åˆ—è¡¨å¹¶ä¿å­˜èµ·æ¥ã€‚</li><li>getServer(loadBalancer)ï¼šåˆ©ç”¨å†…ç½®çš„è´Ÿè½½å‡è¡¡ç®—æ³•ï¼Œä»æœåŠ¡åˆ—è¡¨ä¸­é€‰æ‹©ä¸€ä¸ªã€‚æœ¬ä¾‹ä¸­ï¼Œå¯ä»¥çœ‹åˆ°è·å–äº†8082ç«¯å£çš„æœåŠ¡</li></ul><p>æ”¾è¡Œåï¼Œå†æ¬¡è®¿é—®å¹¶è·Ÿè¸ªï¼Œå‘ç°è·å–çš„æ˜¯8081ï¼š</p><p><img src="http://image.yangeit.cn/i/2023/05/11/1525620835911.png" alt="1525620835911"></p><p>1525620835911</p><p>æœç„¶å®ç°äº†è´Ÿè½½å‡è¡¡ã€‚</p><h4 id="_3-è´Ÿè½½å‡è¡¡ç­–ç•¥irule" tabindex="-1">3ï¼‰è´Ÿè½½å‡è¡¡ç­–ç•¥IRule <a class="header-anchor" href="#_3-è´Ÿè½½å‡è¡¡ç­–ç•¥irule" aria-label="Permalink to &quot;3ï¼‰è´Ÿè½½å‡è¡¡ç­–ç•¥IRule&quot;">â€‹</a></h4><p>åœ¨åˆšæ‰çš„ä»£ç ä¸­ï¼Œå¯ä»¥çœ‹åˆ°è·å–æœåŠ¡ä½¿é€šè¿‡ä¸€ä¸ª<code>getServer</code>æ–¹æ³•æ¥åšè´Ÿè½½å‡è¡¡:</p><p><img src="http://image.yangeit.cn/i/2023/05/11/1525620835911.png" alt="1525620835911"></p><p>1525620835911</p><p>æˆ‘ä»¬ç»§ç»­è·Ÿå…¥ï¼š</p><p><img src="http://image.yangeit.cn/i/2023/05/11/1544361421671.png" alt="1544361421671"></p><p>1544361421671</p><p>ç»§ç»­è·Ÿè¸ªæºç chooseServeræ–¹æ³•ï¼Œå‘ç°è¿™ä¹ˆä¸€æ®µä»£ç ï¼š</p><p><img src="http://image.yangeit.cn/i/2023/05/11/1525622652849.png" alt="1525622652849"></p><p>1525622652849</p><p>æˆ‘ä»¬çœ‹çœ‹è¿™ä¸ªruleæ˜¯è°ï¼šï¼ˆctrl+Hå¿«æ·é”®ï¼‰</p><p><img src="http://image.yangeit.cn/i/2023/05/11/1525622699666.png" alt="1525622699666"></p><p>1525622699666</p><p>è¿™é‡Œçš„ruleé»˜è®¤å€¼æ˜¯ä¸€ä¸ª<code>RoundRobinRule</code>ï¼Œçœ‹ç±»çš„ä»‹ç»ï¼š</p><p><img src="http://image.yangeit.cn/i/2023/05/11/1525622754316.png" alt="1525622754316"></p><p>1525622754316</p><p>è¿™ä¸å°±æ˜¯è½®è¯¢çš„æ„æ€å˜›ã€‚</p><p>åˆ°è¿™é‡Œï¼Œæ•´ä¸ªè´Ÿè½½å‡è¡¡çš„æµç¨‹æˆ‘ä»¬å°±æ¸…æ¥šäº†ã€‚</p><p>æ€»ç»“</p><p><code>SpringCloudRibbon</code>[ËˆrÉªbÉ™n]çš„åº•å±‚é‡‡ç”¨äº†ä¸€ä¸ª<strong>æ‹¦æˆªå™¨</strong>ï¼Œæ‹¦æˆªäº†<strong>RestTemplate</strong>å‘å‡ºçš„è¯·æ±‚ï¼Œå¯¹åœ°å€åšäº†ä¿®æ”¹ã€‚ç”¨ä¸€å¹…å›¾æ¥æ€»ç»“ä¸€ä¸‹ï¼š</p><p><img src="http://image.yangeit.cn/i/2023/05/11/image-20210713224724673.png" alt="image-20210713224724673"></p><p>image-20210713224724673</p><p>åŸºæœ¬æµç¨‹å¦‚ä¸‹ï¼š</p><ul><li>æ‹¦æˆªæˆ‘ä»¬çš„RestTemplateè¯·æ±‚<code>http://userservice/user/1</code></li><li>RibbonLoadBalancerClientä¼šä»è¯·æ±‚urlä¸­è·å–æœåŠ¡åç§°ï¼Œä¹Ÿå°±æ˜¯user-service</li><li>DynamicServerListLoadBalanceræ ¹æ®user-serviceåˆ°eurekaæ‹‰å–æœåŠ¡åˆ—è¡¨</li><li>eurekaè¿”å›åˆ—è¡¨ï¼Œlocalhost:8081ã€localhost:8082</li><li>IRuleåˆ©ç”¨å†…ç½®è´Ÿè½½å‡è¡¡è§„åˆ™ï¼Œä»åˆ—è¡¨ä¸­é€‰æ‹©ä¸€ä¸ªï¼Œä¾‹å¦‚localhost:8081</li><li>RibbonLoadBalancerClientä¿®æ”¹è¯·æ±‚åœ°å€ï¼Œç”¨localhost:8081æ›¿ä»£userserviceï¼Œå¾—åˆ°<code>http://localhost:8081/user/1</code>ï¼Œå‘èµ·çœŸå®è¯·æ±‚</li></ul><h3 id="_4-2-è´Ÿè½½å‡è¡¡ç­–ç•¥å’ŒåŠ è½½æ–¹å¼" tabindex="-1">4.2.è´Ÿè½½å‡è¡¡ç­–ç•¥å’ŒåŠ è½½æ–¹å¼ <a class="header-anchor" href="#_4-2-è´Ÿè½½å‡è¡¡ç­–ç•¥å’ŒåŠ è½½æ–¹å¼" aria-label="Permalink to &quot;4.2.è´Ÿè½½å‡è¡¡ç­–ç•¥å’ŒåŠ è½½æ–¹å¼&quot;">â€‹</a></h3><p>è´Ÿè½½å‡è¡¡ç­–ç•¥</p><h4 id="_4-3-1-è´Ÿè½½å‡è¡¡ç­–ç•¥" tabindex="-1">4.3.1.è´Ÿè½½å‡è¡¡ç­–ç•¥ <a class="header-anchor" href="#_4-3-1-è´Ÿè½½å‡è¡¡ç­–ç•¥" aria-label="Permalink to &quot;4.3.1.è´Ÿè½½å‡è¡¡ç­–ç•¥&quot;">â€‹</a></h4><p><strong>è´Ÿè½½å‡è¡¡çš„è§„åˆ™éƒ½å®šä¹‰åœ¨IRuleæ¥å£</strong>ä¸­ï¼Œè€ŒIRuleæœ‰å¾ˆå¤šä¸åŒçš„å®ç°ç±»ï¼š</p><p><img src="http://image.yangeit.cn/i/2023/05/11/image-20210713225653000.png" alt="image-20210713225653000"></p><p>image-20210713225653000</p><p>ä¸åŒè§„åˆ™çš„å«ä¹‰å¦‚ä¸‹ï¼š</p><table><thead><tr><th><strong>å†…ç½®è´Ÿè½½å‡è¡¡è§„åˆ™ç±»</strong></th><th><strong>è§„åˆ™æè¿°</strong></th></tr></thead><tbody><tr><td>RoundRobinRule</td><td>ç®€å•è½®è¯¢æœåŠ¡åˆ—è¡¨æ¥é€‰æ‹©æœåŠ¡å™¨ã€‚å®ƒæ˜¯Ribboné»˜è®¤çš„è´Ÿè½½å‡è¡¡è§„åˆ™ã€‚</td></tr><tr><td>AvailabilityFilteringRule</td><td>å¯¹ä»¥ä¸‹ä¸¤ç§æœåŠ¡å™¨è¿›è¡Œå¿½ç•¥ï¼š ï¼ˆ1ï¼‰åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œè¿™å°æœåŠ¡å™¨å¦‚æœ3æ¬¡è¿æ¥å¤±è´¥ï¼Œè¿™å°æœåŠ¡å™¨å°±ä¼šè¢«è®¾ç½®ä¸ºâ€œçŸ­è·¯â€çŠ¶æ€ã€‚çŸ­è·¯çŠ¶æ€å°†æŒç»­30ç§’ï¼Œå¦‚æœå†æ¬¡è¿æ¥å¤±è´¥ï¼ŒçŸ­è·¯çš„æŒç»­æ—¶é—´å°±ä¼šå‡ ä½•çº§åœ°å¢åŠ ã€‚ ï¼ˆ2ï¼‰å¹¶å‘æ•°è¿‡é«˜çš„æœåŠ¡å™¨ã€‚å¦‚æœä¸€ä¸ªæœåŠ¡å™¨çš„å¹¶å‘è¿æ¥æ•°è¿‡é«˜ï¼Œé…ç½®äº†AvailabilityFilteringRuleè§„åˆ™çš„å®¢æˆ·ç«¯ä¹Ÿä¼šå°†å…¶å¿½ç•¥ã€‚å¹¶å‘è¿æ¥æ•°çš„ä¸Šé™ï¼Œå¯ä»¥ç”±å®¢æˆ·ç«¯çš„<code>&lt;clientName&gt;.&lt;clientConfigNameSpace&gt;</code>.ActiveConnectionsLimitå±æ€§è¿›è¡Œé…ç½®ã€‚</td></tr><tr><td>WeightedResponseTimeRule</td><td>ä¸ºæ¯ä¸€ä¸ªæœåŠ¡å™¨èµ‹äºˆä¸€ä¸ªæƒé‡å€¼ã€‚æœåŠ¡å™¨å“åº”æ—¶é—´è¶Šé•¿ï¼Œè¿™ä¸ªæœåŠ¡å™¨çš„æƒé‡å°±è¶Šå°ã€‚è¿™ä¸ªè§„åˆ™ä¼šéšæœºé€‰æ‹©æœåŠ¡å™¨ï¼Œè¿™ä¸ªæƒé‡å€¼ä¼šå½±å“æœåŠ¡å™¨çš„é€‰æ‹©ã€‚</td></tr><tr><td><strong>ZoneAvoidanceRule</strong>ğŸ‘ˆ</td><td>ä»¥<strong>åŒºåŸŸå¯ç”¨çš„æœåŠ¡å™¨</strong>ä¸ºåŸºç¡€è¿›è¡ŒæœåŠ¡å™¨çš„é€‰æ‹©ã€‚ä½¿ç”¨<strong>Zoneå¯¹æœåŠ¡å™¨è¿›è¡Œåˆ†ç±»</strong>ï¼Œè¿™ä¸ªZoneå¯ä»¥ç†è§£ä¸ºä¸€ä¸ªæœºæˆ¿ã€ä¸€ä¸ªæœºæ¶ç­‰ã€‚è€Œåå†å¯¹<strong>Zoneå†…</strong>çš„å¤šä¸ªæœåŠ¡åšè½®è¯¢ã€‚</td></tr><tr><td>BestAvailableRule</td><td>å¿½ç•¥é‚£äº›çŸ­è·¯çš„æœåŠ¡å™¨ï¼Œå¹¶é€‰æ‹©å¹¶å‘æ•°è¾ƒä½çš„æœåŠ¡å™¨ã€‚</td></tr><tr><td>RandomRule</td><td>éšæœºé€‰æ‹©ä¸€ä¸ªå¯ç”¨çš„æœåŠ¡å™¨ã€‚</td></tr><tr><td>RetryRule</td><td>é‡è¯•æœºåˆ¶çš„é€‰æ‹©é€»è¾‘</td></tr></tbody></table><p>é»˜è®¤çš„å®ç°å°±æ˜¯ZoneAvoidanceRuleï¼Œæ˜¯ä¸€ç§è½®è¯¢æ–¹æ¡ˆ</p><h4 id="è‡ªå®šä¹‰è´Ÿè½½å‡è¡¡ç­–ç•¥" tabindex="-1">è‡ªå®šä¹‰è´Ÿè½½å‡è¡¡ç­–ç•¥ <a class="header-anchor" href="#è‡ªå®šä¹‰è´Ÿè½½å‡è¡¡ç­–ç•¥" aria-label="Permalink to &quot;è‡ªå®šä¹‰è´Ÿè½½å‡è¡¡ç­–ç•¥&quot;">â€‹</a></h4><p><strong>é€šè¿‡å®šä¹‰IRuleå®ç°å¯ä»¥ä¿®æ”¹è´Ÿè½½å‡è¡¡è§„åˆ™</strong>ï¼Œæœ‰ä¸¤ç§æ–¹å¼ï¼š</p><ol><li>ä»£ç æ–¹å¼ï¼šåœ¨order-serviceä¸­çš„OrderApplicationç±»ä¸­ï¼Œå®šä¹‰ä¸€ä¸ªæ–°çš„IRuleï¼š</li></ol><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#97E1F1;font-style:italic;">Bean</span></span>
<span class="line"><span style="color:#F286C4;">public</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">IRule</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">randomRule</span><span style="color:#F6F6F4;">(){</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">return</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;font-weight:bold;">new</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">RandomRule</span><span style="color:#F6F6F4;">();</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">@</span><span style="color:#D73A49;">Bean</span></span>
<span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> IRule </span><span style="color:#6F42C1;">randomRule</span><span style="color:#24292E;">(){</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">RandomRule</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><blockquote><p>è¿™ç§é…ç½®æ–¹å¼ï¼Œä½œç”¨äºå…¨å±€</p></blockquote><ol start="2"><li>é…ç½®æ–‡ä»¶æ–¹å¼ï¼šåœ¨<strong>order-serviceçš„application.ymlæ–‡ä»¶ä¸­</strong>ï¼Œæ·»åŠ æ–°çš„é…ç½®ä¹Ÿå¯ä»¥ä¿®æ”¹è§„åˆ™ï¼š</li></ol><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#97E1F1;">userservice</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#7B7F8B;"># ç»™æŸä¸ªå¾®æœåŠ¡é…ç½®è´Ÿè½½å‡è¡¡è§„åˆ™ï¼Œè¿™é‡Œæ˜¯userserviceæœåŠ¡</span></span>
<span class="line"><span style="color:#F6F6F4;">  </span><span style="color:#97E1F1;">ribbon</span><span style="color:#F286C4;">:</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#97E1F1;">NFLoadBalancerRuleClassName</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#E7EE98;">com.netflix.loadbalancer.RandomRule</span><span style="color:#F6F6F4;"> </span><span style="color:#7B7F8B;"># è´Ÿè½½å‡è¡¡è§„åˆ™</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#22863A;">userservice</span><span style="color:#24292E;">: </span><span style="color:#6A737D;"># ç»™æŸä¸ªå¾®æœåŠ¡é…ç½®è´Ÿè½½å‡è¡¡è§„åˆ™ï¼Œè¿™é‡Œæ˜¯userserviceæœåŠ¡</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">ribbon</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">NFLoadBalancerRuleClassName</span><span style="color:#24292E;">: </span><span style="color:#032F62;">com.netflix.loadbalancer.RandomRule</span><span style="color:#24292E;"> </span><span style="color:#6A737D;"># è´Ÿè½½å‡è¡¡è§„åˆ™</span></span></code></pre></div><blockquote><p>è¿™ç§é…ç½®æ–¹å¼ä½œç”¨ä¸æŸä¸€ä¸ªæœåŠ¡ï¼Œï¼ˆè®°å¾—æ³¨é‡Šå…¨å±€çš„é…ç½®ï¼‰</p></blockquote><blockquote><p><strong>æ³¨æ„</strong>ï¼Œä¸€èˆ¬ç”¨é»˜è®¤çš„è´Ÿè½½å‡è¡¡è§„åˆ™ï¼Œä¸åšä¿®æ”¹ã€‚</p></blockquote><h4 id="é¥¥é¥¿åŠ è½½-ğŸ‘‡" tabindex="-1">é¥¥é¥¿åŠ è½½ ğŸ‘‡ <a class="header-anchor" href="#é¥¥é¥¿åŠ è½½-ğŸ‘‡" aria-label="Permalink to &quot;é¥¥é¥¿åŠ è½½ ğŸ‘‡&quot;">â€‹</a></h4><p><strong>Ribboné»˜è®¤æ˜¯é‡‡ç”¨æ‡’åŠ è½½</strong>ï¼Œå³<strong>ç¬¬ä¸€æ¬¡è®¿é—®æ—¶æ‰ä¼šå»åˆ›å»ºLoadBalanceClient</strong>ï¼Œè¯·æ±‚æ—¶é—´ä¼šå¾ˆé•¿ã€‚</p><p>è€Œé¥¥é¥¿åŠ è½½åˆ™ä¼šåœ¨é¡¹ç›®å¯åŠ¨æ—¶åˆ›å»ºï¼Œé™ä½ç¬¬ä¸€æ¬¡è®¿é—®çš„è€—æ—¶ï¼Œé€šè¿‡ä¸‹é¢é…ç½®å¼€å¯é¥¥é¥¿åŠ è½½ç©ºé—´æ¢æ—¶é—´ï¼š</p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#7B7F8B;"># å®šæ ¼å†™</span></span>
<span class="line"><span style="color:#97E1F1;">ribbon</span><span style="color:#F286C4;">:</span></span>
<span class="line"><span style="color:#F6F6F4;">  </span><span style="color:#97E1F1;">eager-load</span><span style="color:#F286C4;">:</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#97E1F1;">enabled</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">true</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#97E1F1;">clients</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#E7EE98;">userservice</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#7B7F8B;"># è¦æŒ‡å®šå¯¹è°è¿›è¡Œé¥¥é¥¿åŠ è½½</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;"># å®šæ ¼å†™</span></span>
<span class="line"><span style="color:#22863A;">ribbon</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">eager-load</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">enabled</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">true</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">clients</span><span style="color:#24292E;">: </span><span style="color:#032F62;">userservice</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;"># è¦æŒ‡å®šå¯¹è°è¿›è¡Œé¥¥é¥¿åŠ è½½</span></span></code></pre></div><p>è¯¾å ‚ä½œä¸š</p><p>ğŸš©</p><ol><li>è´Ÿè½½å‡è¡¡çš„ç­–ç•¥é»˜è®¤æ˜¯ä»€ä¹ˆæ¨¡å¼ï¼Ÿæœ‰ä½•ç‰¹ç‚¹ï¼Ÿ</li><li>å¦‚ä½•è‡ªå®šä¹‰è´Ÿè½½å‡è¡¡ç­–ç•¥ï¼Ÿ</li><li>Ribbonè´Ÿè½½å‡è¡¡ç­–ç•¥åŠ è½½é»˜è®¤æ˜¯ä»€ä¹ˆæ–¹å¼ï¼Ÿæœ‰å’Œç¼ºç‚¹ï¼Ÿå¦‚ä½•æ”¹å–„ï¼Ÿ</li></ol><h2 id="_5-nacosæ³¨å†Œä¸­å¿ƒ-ğŸâ¤ï¸" tabindex="-1">5.Nacosæ³¨å†Œä¸­å¿ƒ ğŸâ¤ï¸ <a class="header-anchor" href="#_5-nacosæ³¨å†Œä¸­å¿ƒ-ğŸâ¤ï¸" aria-label="Permalink to &quot;5.Nacosæ³¨å†Œä¸­å¿ƒ ğŸâ¤ï¸&quot;">â€‹</a></h2><p>å›½å†…å…¬å¸ä¸€èˆ¬éƒ½æ¨å´‡é˜¿é‡Œå·´å·´çš„æŠ€æœ¯ï¼Œæ¯”å¦‚æ³¨å†Œä¸­å¿ƒï¼ŒSpringCloudAlibabaä¹Ÿæ¨å‡ºäº†ä¸€ä¸ªåä¸ºNacosçš„æ³¨å†Œä¸­å¿ƒã€‚</p><h3 id="_5-1-è®¤è¯†å’Œå®‰è£…nacos" tabindex="-1">5.1.è®¤è¯†å’Œå®‰è£…Nacos <a class="header-anchor" href="#_5-1-è®¤è¯†å’Œå®‰è£…nacos" aria-label="Permalink to &quot;5.1.è®¤è¯†å’Œå®‰è£…Nacos&quot;">â€‹</a></h3><h3 id="_5-2-æœåŠ¡æ³¨å†Œåˆ°nacos" tabindex="-1">5.2.æœåŠ¡æ³¨å†Œåˆ°nacos <a class="header-anchor" href="#_5-2-æœåŠ¡æ³¨å†Œåˆ°nacos" aria-label="Permalink to &quot;5.2.æœåŠ¡æ³¨å†Œåˆ°nacos&quot;">â€‹</a></h3><p>æœåŠ¡æ³¨å†Œåˆ°nacos</p><p>Nacosæ˜¯SpringCloudAlibabaçš„ç»„ä»¶ï¼Œè€ŒSpringCloudAlibabaä¹Ÿéµå¾ªSpringCloudä¸­å®šä¹‰çš„æœåŠ¡æ³¨å†Œã€æœåŠ¡å‘ç°è§„èŒƒã€‚å› æ­¤ä½¿ç”¨Nacoså’Œä½¿ç”¨Eurekaå¯¹äºå¾®æœåŠ¡æ¥è¯´ï¼Œå¹¶æ²¡æœ‰å¤ªå¤§åŒºåˆ«ã€‚</p><p>ä¸»è¦å·®å¼‚åœ¨äºï¼š</p><ul><li>ä¾èµ–ä¸åŒ</li><li>æœåŠ¡åœ°å€ä¸åŒ</li></ul><p><strong>ä»£ç æ“ä½œ</strong></p><h4 id="_1-å¼•å…¥ä¾èµ–-2" tabindex="-1">1ï¼‰å¼•å…¥ä¾èµ– <a class="header-anchor" href="#_1-å¼•å…¥ä¾èµ–-2" aria-label="Permalink to &quot;1ï¼‰å¼•å…¥ä¾èµ–&quot;">â€‹</a></h4><p>åœ¨cloud-demoçˆ¶å·¥ç¨‹çš„pomæ–‡ä»¶ä¸­çš„<code>&lt;dependencyManagement&gt;</code>ä¸­å¼•å…¥SpringCloudAlibabaçš„ä¾èµ–ï¼š</p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F6F6F4;">&lt;</span><span style="color:#F286C4;">dependency</span><span style="color:#F6F6F4;">&gt;</span></span>
<span class="line"><span style="color:#F6F6F4;">    &lt;</span><span style="color:#F286C4;">groupId</span><span style="color:#F6F6F4;">&gt;com.alibaba.cloud&lt;/</span><span style="color:#F286C4;">groupId</span><span style="color:#F6F6F4;">&gt;</span></span>
<span class="line"><span style="color:#F6F6F4;">    &lt;</span><span style="color:#F286C4;">artifactId</span><span style="color:#F6F6F4;">&gt;spring-cloud-alibaba-dependencies&lt;/</span><span style="color:#F286C4;">artifactId</span><span style="color:#F6F6F4;">&gt;</span></span>
<span class="line"><span style="color:#F6F6F4;">    &lt;</span><span style="color:#F286C4;">version</span><span style="color:#F6F6F4;">&gt;2.2.6.RELEASE&lt;/</span><span style="color:#F286C4;">version</span><span style="color:#F6F6F4;">&gt;</span></span>
<span class="line"><span style="color:#F6F6F4;">    &lt;</span><span style="color:#F286C4;">type</span><span style="color:#F6F6F4;">&gt;pom&lt;/</span><span style="color:#F286C4;">type</span><span style="color:#F6F6F4;">&gt;</span></span>
<span class="line"><span style="color:#F6F6F4;">    &lt;</span><span style="color:#F286C4;">scope</span><span style="color:#F6F6F4;">&gt;import&lt;/</span><span style="color:#F286C4;">scope</span><span style="color:#F6F6F4;">&gt;</span></span>
<span class="line"><span style="color:#F6F6F4;">&lt;/</span><span style="color:#F286C4;">dependency</span><span style="color:#F6F6F4;">&gt;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#22863A;">dependency</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">    &lt;</span><span style="color:#22863A;">groupId</span><span style="color:#24292E;">&gt;com.alibaba.cloud&lt;/</span><span style="color:#22863A;">groupId</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">    &lt;</span><span style="color:#22863A;">artifactId</span><span style="color:#24292E;">&gt;spring-cloud-alibaba-dependencies&lt;/</span><span style="color:#22863A;">artifactId</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">    &lt;</span><span style="color:#22863A;">version</span><span style="color:#24292E;">&gt;2.2.6.RELEASE&lt;/</span><span style="color:#22863A;">version</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">    &lt;</span><span style="color:#22863A;">type</span><span style="color:#24292E;">&gt;pom&lt;/</span><span style="color:#22863A;">type</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">    &lt;</span><span style="color:#22863A;">scope</span><span style="color:#24292E;">&gt;import&lt;/</span><span style="color:#22863A;">scope</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">&lt;/</span><span style="color:#22863A;">dependency</span><span style="color:#24292E;">&gt;</span></span></code></pre></div><p>ç„¶ååœ¨user-serviceå’Œorder-serviceä¸­çš„pomæ–‡ä»¶ä¸­å¼•å…¥nacos-discoveryä¾èµ–ï¼š</p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F6F6F4;">&lt;</span><span style="color:#F286C4;">dependency</span><span style="color:#F6F6F4;">&gt;</span></span>
<span class="line"><span style="color:#F6F6F4;">    &lt;</span><span style="color:#F286C4;">groupId</span><span style="color:#F6F6F4;">&gt;com.alibaba.cloud&lt;/</span><span style="color:#F286C4;">groupId</span><span style="color:#F6F6F4;">&gt;</span></span>
<span class="line"><span style="color:#F6F6F4;">    &lt;</span><span style="color:#F286C4;">artifactId</span><span style="color:#F6F6F4;">&gt;spring-cloud-starter-alibaba-nacos-discovery&lt;/</span><span style="color:#F286C4;">artifactId</span><span style="color:#F6F6F4;">&gt;</span></span>
<span class="line"><span style="color:#F6F6F4;">&lt;/</span><span style="color:#F286C4;">dependency</span><span style="color:#F6F6F4;">&gt;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#22863A;">dependency</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">    &lt;</span><span style="color:#22863A;">groupId</span><span style="color:#24292E;">&gt;com.alibaba.cloud&lt;/</span><span style="color:#22863A;">groupId</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">    &lt;</span><span style="color:#22863A;">artifactId</span><span style="color:#24292E;">&gt;spring-cloud-starter-alibaba-nacos-discovery&lt;/</span><span style="color:#22863A;">artifactId</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">&lt;/</span><span style="color:#22863A;">dependency</span><span style="color:#24292E;">&gt;</span></span></code></pre></div><blockquote><p><strong>æ³¨æ„</strong>ï¼šä¸è¦å¿˜äº†æ³¨é‡Šæ‰eurekaçš„ä¾èµ–ã€‚</p></blockquote><h4 id="_2-é…ç½®nacosåœ°å€" tabindex="-1">2ï¼‰é…ç½®nacosåœ°å€ <a class="header-anchor" href="#_2-é…ç½®nacosåœ°å€" aria-label="Permalink to &quot;2ï¼‰é…ç½®nacosåœ°å€&quot;">â€‹</a></h4><p>åœ¨user-serviceå’Œorder-serviceçš„application.ymlä¸­æ·»åŠ nacosåœ°å€ï¼š</p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#97E1F1;">spring</span><span style="color:#F286C4;">:</span></span>
<span class="line"><span style="color:#F6F6F4;">  </span><span style="color:#97E1F1;">cloud</span><span style="color:#F286C4;">:</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#97E1F1;">nacos</span><span style="color:#F286C4;">:</span></span>
<span class="line"><span style="color:#F6F6F4;">      </span><span style="color:#97E1F1;">server-addr</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#E7EE98;">localhost:8848</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#22863A;">spring</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">cloud</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">nacos</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">server-addr</span><span style="color:#24292E;">: </span><span style="color:#032F62;">localhost:8848</span></span></code></pre></div><blockquote><p><strong>æ³¨æ„</strong>ï¼šä¸è¦å¿˜äº†æ³¨é‡Šæ‰eurekaçš„åœ°å€</p></blockquote><h4 id="_3-é‡å¯" tabindex="-1">3ï¼‰é‡å¯ <a class="header-anchor" href="#_3-é‡å¯" aria-label="Permalink to &quot;3ï¼‰é‡å¯&quot;">â€‹</a></h4><p>é‡å¯å¾®æœåŠ¡åï¼Œç™»å½•nacosç®¡ç†é¡µé¢ï¼Œå¯ä»¥çœ‹åˆ°å¾®æœåŠ¡ä¿¡æ¯ï¼š</p><p><img src="http://image.yangeit.cn/i/2023/05/11/image-20210713231439607.png" alt="image-20210713231439607"></p><p>image-20210713231439607</p><h3 id="_5-3-æœåŠ¡åˆ†çº§å­˜å‚¨æ¨¡å‹" tabindex="-1">5.3.æœåŠ¡åˆ†çº§å­˜å‚¨æ¨¡å‹ <a class="header-anchor" href="#_5-3-æœåŠ¡åˆ†çº§å­˜å‚¨æ¨¡å‹" aria-label="Permalink to &quot;5.3.æœåŠ¡åˆ†çº§å­˜å‚¨æ¨¡å‹&quot;">â€‹</a></h3><p>æœåŠ¡åˆ†çº§å­˜å‚¨æ¨¡å‹</p><p>ä¸€ä¸ª<strong>æœåŠ¡</strong>å¯ä»¥æœ‰å¤šä¸ª<strong>å®ä¾‹</strong>ï¼Œä¾‹å¦‚æˆ‘ä»¬çš„user-serviceï¼Œå¯ä»¥æœ‰:</p><ul><li>127.0.0.1:8081</li><li>127.0.0.1:8082</li><li>127.0.0.1:8083</li></ul><p>å‡å¦‚è¿™äº›å®ä¾‹åˆ†å¸ƒäºå…¨å›½å„åœ°çš„ä¸åŒæœºæˆ¿ï¼Œä¾‹å¦‚ï¼š</p><ul><li>127.0.0.1:8081ï¼Œåœ¨ä¸Šæµ·æœºæˆ¿</li><li>127.0.0.1:8082ï¼Œåœ¨ä¸Šæµ·æœºæˆ¿</li><li>127.0.0.1:8083ï¼Œåœ¨æ­å·æœºæˆ¿</li></ul><p>Nacoså°±å°†åŒä¸€æœºæˆ¿å†…çš„å®ä¾‹ åˆ’åˆ†ä¸ºä¸€ä¸ª<strong>é›†ç¾¤</strong>ã€‚</p><blockquote><p>å®¹ç¾ç³»ç»Ÿæ˜¯æŒ‡åœ¨ç›¸éš”è¾ƒè¿œçš„å¼‚åœ°ï¼Œå»ºç«‹ä¸¤å¥—æˆ–å¤šå¥—åŠŸèƒ½ç›¸åŒçš„ITç³»ç»Ÿï¼Œäº’ç›¸ä¹‹é—´å¯ä»¥è¿›è¡Œå¥åº·çŠ¶æ€ç›‘è§†å’ŒåŠŸèƒ½åˆ‡æ¢ï¼Œå½“ä¸€å¤„ç³»ç»Ÿå› æ„å¤–ï¼ˆå¦‚ç«ç¾ã€åœ°éœ‡ç­‰ï¼‰åœæ­¢å·¥ä½œæ—¶ï¼Œæ•´ä¸ªåº”ç”¨ç³»ç»Ÿå¯ä»¥åˆ‡æ¢åˆ°å¦ä¸€å¤„ï¼Œä½¿å¾—è¯¥ç³»ç»ŸåŠŸèƒ½å¯ä»¥ç»§ç»­æ­£å¸¸å·¥ä½œã€‚å®¹ç¾æŠ€æœ¯æ˜¯ç³»ç»Ÿçš„é«˜å¯ç”¨æ€§æŠ€æœ¯</p></blockquote><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œuser-serviceæ˜¯æœåŠ¡ï¼Œä¸€ä¸ªæœåŠ¡å¯ä»¥åŒ…å«å¤šä¸ªé›†ç¾¤ï¼Œå¦‚æ­å·ã€ä¸Šæµ·ï¼Œæ¯ä¸ªé›†ç¾¤ä¸‹å¯ä»¥æœ‰å¤šä¸ªå®ä¾‹ï¼Œå½¢æˆåˆ†çº§æ¨¡å‹ï¼Œå¦‚å›¾ï¼š</p><p><img src="http://image.yangeit.cn/i/2023/05/11/image-20210713232522531.png" alt="image-20210713232522531"></p><p>image-20210713232522531</p><p><strong>å¾®æœåŠ¡äº’ç›¸è®¿é—®æ—¶ï¼Œåº”è¯¥å°½å¯èƒ½è®¿é—®åŒé›†ç¾¤å®ä¾‹ï¼Œå› ä¸ºæœ¬åœ°è®¿é—®é€Ÿåº¦æ›´å¿«ã€‚å½“æœ¬é›†ç¾¤å†…ä¸å¯ç”¨æ—¶ï¼Œæ‰è®¿é—®å…¶å®ƒé›†ç¾¤</strong>ã€‚ä¾‹å¦‚ï¼š</p><p><img src="http://image.yangeit.cn/i/2023/05/11/image-20210713232658928.png" alt="image-20210713232658928"></p><p>image-20210713232658928</p><p>æ­å·æœºæˆ¿å†…çš„order-serviceåº”è¯¥ä¼˜å…ˆè®¿é—®åŒæœºæˆ¿çš„user-serviceã€‚ ğŸ‘ˆ</p><p>ä¿®æ”¹user-serviceçš„application.ymlæ–‡ä»¶ï¼Œæ·»åŠ é›†ç¾¤é…ç½®ï¼š</p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#97E1F1;">spring</span><span style="color:#F286C4;">:</span></span>
<span class="line"><span style="color:#F6F6F4;">  </span><span style="color:#97E1F1;">cloud</span><span style="color:#F286C4;">:</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#97E1F1;">nacos</span><span style="color:#F286C4;">:</span></span>
<span class="line"><span style="color:#F6F6F4;">      </span><span style="color:#97E1F1;">server-addr</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#E7EE98;">localhost:8848</span></span>
<span class="line"><span style="color:#F6F6F4;">      </span><span style="color:#97E1F1;">discovery</span><span style="color:#F286C4;">:</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#97E1F1;">cluster-name</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#E7EE98;">HZ</span><span style="color:#F6F6F4;"> </span><span style="color:#7B7F8B;"># é›†ç¾¤åç§°</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#22863A;">spring</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">cloud</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">nacos</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">server-addr</span><span style="color:#24292E;">: </span><span style="color:#032F62;">localhost:8848</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">discovery</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">cluster-name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">HZ</span><span style="color:#24292E;"> </span><span style="color:#6A737D;"># é›†ç¾¤åç§°</span></span></code></pre></div><p>é‡å¯ä¸¤ä¸ªuser-serviceå®ä¾‹åï¼Œæˆ‘ä»¬å¯ä»¥åœ¨nacosæ§åˆ¶å°çœ‹åˆ°ä¸‹é¢ç»“æœï¼š</p><p><img src="http://image.yangeit.cn/i/2023/05/11/image-20210713232916215.png" alt="image-20210713232916215"></p><p>image-20210713232916215</p><p>æˆ‘ä»¬å†æ¬¡å¤åˆ¶ä¸€ä¸ªuser-serviceå¯åŠ¨é…ç½®ï¼Œæ·»åŠ å±æ€§ï¼š</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#62E884;">-Dserver.port</span><span style="color:#F6F6F4;">=8083 </span><span style="color:#BF9EEE;">-Dspring.cloud.nacos.discovery.cluster-name=SH</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">-Dserver.port</span><span style="color:#24292E;">=8083 </span><span style="color:#005CC5;">-Dspring.cloud.nacos.discovery.cluster-name=SH</span></span></code></pre></div><p>é…ç½®å¦‚å›¾æ‰€ç¤ºï¼š</p><p><img src="http://image.yangeit.cn/i/2023/05/11/image-20210713233528982.png" alt="image-20210713233528982"></p><p>image-20210713233528982</p><p>å¯åŠ¨UserApplication3åå†æ¬¡æŸ¥çœ‹nacosæ§åˆ¶å°ï¼š</p><p><img src="http://image.yangeit.cn/i/2023/05/11/image-20210713233727923.png" alt="image-20210713233727923"></p><p>image-20210713233727923</p><p>é»˜è®¤çš„<code>ZoneAvoidanceRule</code>å¹¶<strong>ä¸èƒ½å®ç°æ ¹æ®åŒé›†ç¾¤ä¼˜å…ˆæ¥å®ç°è´Ÿè½½å‡è¡¡</strong>ã€‚</p><p>å› æ­¤Nacosä¸­æä¾›äº†ä¸€ä¸ª<code>NacosRule</code>çš„å®ç°ï¼Œå¯ä»¥<strong>ä¼˜å…ˆä»åŒé›†ç¾¤ä¸­æŒ‘é€‰å®ä¾‹ã€‚</strong> ğŸ‘ˆ</p><h5 id="_1ï¸âƒ£-1-ç»™order-serviceé…ç½®é›†ç¾¤ä¿¡æ¯" tabindex="-1">1ï¸âƒ£ 1ï¼‰ç»™order-serviceé…ç½®é›†ç¾¤ä¿¡æ¯ <a class="header-anchor" href="#_1ï¸âƒ£-1-ç»™order-serviceé…ç½®é›†ç¾¤ä¿¡æ¯" aria-label="Permalink to &quot;1ï¸âƒ£ 1ï¼‰ç»™order-serviceé…ç½®é›†ç¾¤ä¿¡æ¯&quot;">â€‹</a></h5><p>ä¿®æ”¹order-serviceçš„application.ymlæ–‡ä»¶ï¼Œæ·»åŠ é›†ç¾¤é…ç½®ï¼š</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#62E884;">spring:</span></span>
<span class="line"><span style="color:#F6F6F4;">  </span><span style="color:#62E884;">cloud:</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#62E884;">nacos:</span></span>
<span class="line"><span style="color:#F6F6F4;">      </span><span style="color:#62E884;">server-addr:</span><span style="color:#F6F6F4;"> </span><span style="color:#E7EE98;">localhost:8848</span></span>
<span class="line"><span style="color:#F6F6F4;">      </span><span style="color:#62E884;">discovery:</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#62E884;">cluster-name:</span><span style="color:#F6F6F4;"> </span><span style="color:#E7EE98;">HZ</span><span style="color:#F6F6F4;"> </span><span style="color:#7B7F8B;"># é›†ç¾¤åç§°</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">spring:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">cloud:</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">nacos:</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#6F42C1;">server-addr:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">localhost:8848</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#6F42C1;">discovery:</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">cluster-name:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">HZ</span><span style="color:#24292E;"> </span><span style="color:#6A737D;"># é›†ç¾¤åç§°</span></span></code></pre></div><h5 id="_2ï¸âƒ£-2-ä¿®æ”¹è´Ÿè½½å‡è¡¡è§„åˆ™" tabindex="-1">2ï¸âƒ£ 2ï¼‰ä¿®æ”¹è´Ÿè½½å‡è¡¡è§„åˆ™ <a class="header-anchor" href="#_2ï¸âƒ£-2-ä¿®æ”¹è´Ÿè½½å‡è¡¡è§„åˆ™" aria-label="Permalink to &quot;2ï¸âƒ£ 2ï¼‰ä¿®æ”¹è´Ÿè½½å‡è¡¡è§„åˆ™&quot;">â€‹</a></h5><p>ä¿®æ”¹order-serviceçš„application.ymlæ–‡ä»¶ï¼Œä¿®æ”¹è´Ÿè½½å‡è¡¡è§„åˆ™ï¼š</p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#97E1F1;">userservice</span><span style="color:#F286C4;">:</span></span>
<span class="line"><span style="color:#F6F6F4;">  </span><span style="color:#97E1F1;">ribbon</span><span style="color:#F286C4;">:</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#97E1F1;">NFLoadBalancerRuleClassName</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#E7EE98;">com.alibaba.cloud.nacos.ribbon.NacosRule</span><span style="color:#F6F6F4;"> </span><span style="color:#7B7F8B;"># è´Ÿè½½å‡è¡¡è§„åˆ™</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#22863A;">userservice</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">ribbon</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">NFLoadBalancerRuleClassName</span><span style="color:#24292E;">: </span><span style="color:#032F62;">com.alibaba.cloud.nacos.ribbon.NacosRule</span><span style="color:#24292E;"> </span><span style="color:#6A737D;"># è´Ÿè½½å‡è¡¡è§„åˆ™</span></span></code></pre></div><p>è¯¾å ‚ä½œä¸š</p><p>ğŸš© 1. ä¸ºä»€ä¹ˆè¦å­¦ä¹ æœåŠ¡åˆ†çº§å­˜å‚¨æ¨¡å‹ï¼Ÿ</p><h3 id="_5-4-æƒé‡é…ç½®å’Œç¯å¢ƒéš”ç¦»" tabindex="-1">5.4.æƒé‡é…ç½®å’Œç¯å¢ƒéš”ç¦» <a class="header-anchor" href="#_5-4-æƒé‡é…ç½®å’Œç¯å¢ƒéš”ç¦»" aria-label="Permalink to &quot;5.4.æƒé‡é…ç½®å’Œç¯å¢ƒéš”ç¦»&quot;">â€‹</a></h3><p>æƒé‡é…ç½®å’Œç¯å¢ƒéš”ç¦»</p><p>æƒé‡é…ç½®</p><p>å®é™…éƒ¨ç½²ä¸­ä¼šå‡ºç°è¿™æ ·çš„åœºæ™¯ï¼š</p><p>æœåŠ¡å™¨è®¾å¤‡æ€§èƒ½æœ‰å·®å¼‚ï¼Œéƒ¨åˆ†å®ä¾‹æ‰€åœ¨æœºå™¨æ€§èƒ½è¾ƒå¥½ï¼Œå¦ä¸€äº›è¾ƒå·®ï¼Œæˆ‘ä»¬å¸Œæœ›æ€§èƒ½å¥½çš„æœºå™¨æ‰¿æ‹…æ›´å¤šçš„ç”¨æˆ·è¯·æ±‚ã€‚</p><p>ä½†é»˜è®¤æƒ…å†µä¸‹NacosRuleæ˜¯åŒé›†ç¾¤å†…éšæœºæŒ‘é€‰ï¼Œä¸ä¼šè€ƒè™‘æœºå™¨çš„æ€§èƒ½é—®é¢˜ã€‚</p><p>å› æ­¤ï¼ŒNacosæä¾›äº†æƒé‡é…ç½®æ¥æ§åˆ¶è®¿é—®é¢‘ç‡ï¼Œæƒé‡è¶Šå¤§åˆ™è®¿é—®é¢‘ç‡è¶Šé«˜ã€‚</p><p>åœ¨nacosæ§åˆ¶å°ï¼Œæ‰¾åˆ°user-serviceçš„å®ä¾‹åˆ—è¡¨ï¼Œç‚¹å‡»ç¼–è¾‘ï¼Œå³å¯ä¿®æ”¹æƒé‡ï¼š</p><p><img src="http://image.yangeit.cn/i/2023/05/11/image-20210713235133225.png" alt="image-20210713235133225"></p><p>image-20210713235133225</p><p>åœ¨å¼¹å‡ºçš„ç¼–è¾‘çª—å£ï¼Œä¿®æ”¹æƒé‡ï¼š</p><p><img src="http://image.yangeit.cn/i/2023/05/11/image-20210713235235219.png" alt="image-20210713235235219"></p><p>image-20210713235235219</p><blockquote><p>å®é™…å¼€å‘ä¸­ï¼Œå¦‚æœè¦å‡çº§ï¼Œä½†æ˜¯å¾€å¸¸è¦åœæœºï¼Œä½†æ˜¯ç°åœ¨å¯ä»¥è®¾ç½®æƒé‡ä¸º0ï¼Œç„¶åå‡çº§</p></blockquote><blockquote><p><strong>æ³¨æ„</strong>ï¼šå¦‚æœæƒé‡ä¿®æ”¹ä¸º0ï¼Œåˆ™è¯¥å®ä¾‹æ°¸è¿œä¸ä¼šè¢«è®¿é—®</p></blockquote><h3 id="_5-5-ç¯å¢ƒéš”ç¦»" tabindex="-1">5.5.ç¯å¢ƒéš”ç¦» <a class="header-anchor" href="#_5-5-ç¯å¢ƒéš”ç¦»" aria-label="Permalink to &quot;5.5.ç¯å¢ƒéš”ç¦»&quot;">â€‹</a></h3><p>ç¯å¢ƒéš”ç¦»</p><p>Nacosæä¾›äº†namespaceæ¥å®ç°ç¯å¢ƒéš”ç¦»åŠŸèƒ½ã€‚</p><ul><li>nacosä¸­å¯ä»¥æœ‰å¤šä¸ªnamespace</li><li>namespaceä¸‹å¯ä»¥æœ‰groupã€serviceç­‰</li><li>ä¸åŒnamespaceä¹‹é—´ç›¸äº’éš”ç¦»ï¼Œä¾‹å¦‚ä¸åŒnamespaceçš„æœåŠ¡äº’ç›¸ä¸å¯è§</li></ul><p><img src="http://image.yangeit.cn/i/2023/05/11/image-20210714000101516.png" alt="image-20210714000101516"></p><p>image-20210714000101516</p><h4 id="_5-5-1-åˆ›å»ºnamespace" tabindex="-1">5.5.1.åˆ›å»ºnamespace <a class="header-anchor" href="#_5-5-1-åˆ›å»ºnamespace" aria-label="Permalink to &quot;5.5.1.åˆ›å»ºnamespace&quot;">â€‹</a></h4><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œæ‰€æœ‰<strong>serviceã€dataã€group</strong>éƒ½åœ¨åŒä¸€ä¸ªnamespaceï¼Œåä¸ºpublicï¼š</p><p><img src="http://image.yangeit.cn/i/2023/05/11/image-20210714000414781.png" alt="image-20210714000414781"></p><p>image-20210714000414781</p><p>æˆ‘ä»¬å¯ä»¥ç‚¹å‡»é¡µé¢æ–°å¢æŒ‰é’®ï¼Œæ·»åŠ ä¸€ä¸ªnamespaceï¼š</p><p><img src="http://image.yangeit.cn/i/2023/05/11/image-20210714000440143.png" alt="image-20210714000440143"></p><p>image-20210714000440143</p><p>ç„¶åï¼Œå¡«å†™è¡¨å•ï¼š</p><p><img src="http://image.yangeit.cn/i/2023/05/11/image-20210714000505928.png" alt="image-20210714000505928"></p><p>image-20210714000505928</p><p>å°±èƒ½åœ¨é¡µé¢çœ‹åˆ°ä¸€ä¸ªæ–°çš„namespaceï¼š</p><p><img src="http://image.yangeit.cn/i/2023/05/11/image-20210714000522913.png" alt="image-20210714000522913"></p><p>image-20210714000522913</p><h4 id="_5-5-2-ç»™å¾®æœåŠ¡é…ç½®namespace" tabindex="-1">5.5.2.ç»™å¾®æœåŠ¡é…ç½®namespace <a class="header-anchor" href="#_5-5-2-ç»™å¾®æœåŠ¡é…ç½®namespace" aria-label="Permalink to &quot;5.5.2.ç»™å¾®æœåŠ¡é…ç½®namespace&quot;">â€‹</a></h4><p><strong>ç»™å¾®æœåŠ¡é…ç½®namespaceåªèƒ½é€šè¿‡ä¿®æ”¹é…ç½®</strong>æ¥å®ç°ã€‚</p><p>ä¾‹å¦‚ï¼Œä¿®æ”¹order-serviceçš„application.ymlæ–‡ä»¶ï¼š</p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#97E1F1;">spring</span><span style="color:#F286C4;">:</span></span>
<span class="line"><span style="color:#F6F6F4;">  </span><span style="color:#97E1F1;">cloud</span><span style="color:#F286C4;">:</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#97E1F1;">nacos</span><span style="color:#F286C4;">:</span></span>
<span class="line"><span style="color:#F6F6F4;">      </span><span style="color:#97E1F1;">server-addr</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#E7EE98;">localhost:8848</span></span>
<span class="line"><span style="color:#F6F6F4;">      </span><span style="color:#97E1F1;">discovery</span><span style="color:#F286C4;">:</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#97E1F1;">cluster-name</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#E7EE98;">HZ</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#97E1F1;">namespace</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#E7EE98;">492a7d5d-237b-46a1-a99a-fa8e98e4b0f9</span><span style="color:#F6F6F4;"> </span><span style="color:#7B7F8B;"># å‘½åç©ºé—´ï¼Œå¡«ID</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#22863A;">spring</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">cloud</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">nacos</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">server-addr</span><span style="color:#24292E;">: </span><span style="color:#032F62;">localhost:8848</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">discovery</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">cluster-name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">HZ</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">namespace</span><span style="color:#24292E;">: </span><span style="color:#032F62;">492a7d5d-237b-46a1-a99a-fa8e98e4b0f9</span><span style="color:#24292E;"> </span><span style="color:#6A737D;"># å‘½åç©ºé—´ï¼Œå¡«ID</span></span></code></pre></div><p>é‡å¯order-serviceåï¼Œè®¿é—®æ§åˆ¶å°ï¼Œå¯ä»¥çœ‹åˆ°ä¸‹é¢çš„ç»“æœï¼š</p><p><img src="http://image.yangeit.cn/i/2023/05/11/image-20210714000830703.png" alt="image-20210714000830703"></p><p>image-20210714000830703</p><p><img src="http://image.yangeit.cn/i/2023/05/11/image-20210714000837140.png" alt="image-20210714000837140"></p><p>image-20210714000837140</p><p>æ­¤æ—¶è®¿é—®order-serviceï¼Œå› ä¸ºnamespaceä¸åŒï¼Œä¼šå¯¼è‡´æ‰¾ä¸åˆ°userserviceï¼Œæ§åˆ¶å°ä¼šæŠ¥é”™ï¼š</p><p><img src="http://image.yangeit.cn/i/2023/05/11/image-20210714000941256.png" alt="image-20210714000941256"></p><p>image-20210714000941256</p><h3 id="_5-5-nacosä¸eurekaçš„åŒºåˆ«-â¤ï¸-ğŸ" tabindex="-1">5.5.Nacosä¸Eurekaçš„åŒºåˆ« â¤ï¸ ğŸ <a class="header-anchor" href="#_5-5-nacosä¸eurekaçš„åŒºåˆ«-â¤ï¸-ğŸ" aria-label="Permalink to &quot;5.5.Nacosä¸Eurekaçš„åŒºåˆ« â¤ï¸ ğŸ&quot;">â€‹</a></h3><p>æç¤º</p><p>Nacosçš„æœåŠ¡å®ä¾‹åˆ†ä¸ºä¸¤ç§lç±»å‹ï¼š</p><ul><li><p>ä¸´æ—¶å®ä¾‹ï¼šå¦‚æœå®ä¾‹å®•æœºè¶…è¿‡ä¸€å®šæ—¶é—´ï¼Œä¼šä»æœåŠ¡åˆ—è¡¨å‰”é™¤ï¼Œé»˜è®¤çš„ç±»å‹ã€‚</p></li><li><p>éä¸´æ—¶å®ä¾‹ï¼šå¦‚æœå®ä¾‹å®•æœºï¼Œä¸ä¼šä»æœåŠ¡åˆ—è¡¨å‰”é™¤ï¼Œä¹Ÿå¯ä»¥å«æ°¸ä¹…å®ä¾‹ã€‚</p></li></ul><p>é…ç½®ä¸€ä¸ªæœåŠ¡å®ä¾‹ä¸ºæ°¸ä¹…å®ä¾‹ï¼š</p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#97E1F1;">spring</span><span style="color:#F286C4;">:</span></span>
<span class="line"><span style="color:#F6F6F4;">  </span><span style="color:#97E1F1;">cloud</span><span style="color:#F286C4;">:</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#97E1F1;">nacos</span><span style="color:#F286C4;">:</span></span>
<span class="line"><span style="color:#F6F6F4;">      </span><span style="color:#97E1F1;">discovery</span><span style="color:#F286C4;">:</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#97E1F1;">ephemeral</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">false</span><span style="color:#F6F6F4;"> </span><span style="color:#7B7F8B;"># è®¾ç½®ä¸ºéä¸´æ—¶å®ä¾‹</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#22863A;">spring</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">cloud</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">nacos</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">discovery</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">ephemeral</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">false</span><span style="color:#24292E;"> </span><span style="color:#6A737D;"># è®¾ç½®ä¸ºéä¸´æ—¶å®ä¾‹</span></span></code></pre></div><p>Nacoså’ŒEurekaæ•´ä½“ç»“æ„ç±»ä¼¼ï¼ŒæœåŠ¡æ³¨å†Œã€æœåŠ¡æ‹‰å–ã€å¿ƒè·³ç­‰å¾…ï¼Œä½†æ˜¯ä¹Ÿå­˜åœ¨ä¸€äº›å·®å¼‚ï¼š</p><p><img src="http://image.yangeit.cn/i/2023/05/11/image-20210714001728017.png" alt="image-20210714001728017"></p><p>image-20210714001728017</p><ul><li><p>Nacosä¸eurekaçš„å…±åŒç‚¹</p><ul><li>éƒ½æ”¯æŒæœåŠ¡æ³¨å†Œå’ŒæœåŠ¡æ‹‰å–</li><li>éƒ½æ”¯æŒæœåŠ¡æä¾›è€…å¿ƒè·³æ–¹å¼åšå¥åº·æ£€æµ‹</li></ul></li><li><p>Nacosä¸Eurekaçš„åŒºåˆ«</p><ul><li>Nacosæ”¯æŒæœåŠ¡ç«¯<code>ä¸»åŠ¨æ£€æµ‹</code>æä¾›è€…çŠ¶æ€ï¼š<code>ä¸´æ—¶å®ä¾‹é‡‡ç”¨å¿ƒè·³æ¨¡å¼</code>ï¼Œ<code>éä¸´æ—¶å®ä¾‹é‡‡ç”¨ä¸»åŠ¨æ£€æµ‹æ¨¡å¼</code></li><li><code>ä¸´æ—¶</code>å®ä¾‹å¿ƒè·³<code>ä¸æ­£å¸¸ä¼šè¢«å‰”é™¤</code>ï¼Œ<code>éä¸´æ—¶</code>å®ä¾‹åˆ™<code>ä¸ä¼šè¢«å‰”é™¤</code></li><li>Nacosæ”¯æŒ<code>æœåŠ¡åˆ—è¡¨å˜æ›´çš„æ¶ˆæ¯æ¨é€</code>æ¨¡å¼ï¼Œ\`æœåŠ¡åˆ—è¡¨æ›´æ–°æ›´åŠæ—¶ï¼Œä½†æ˜¯è€—æ€§èƒ½</li><li>Nacosé›†ç¾¤<code>é»˜è®¤é‡‡ç”¨APæ–¹å¼</code>ï¼Œå½“é›†ç¾¤ä¸­å­˜åœ¨éä¸´æ—¶å®ä¾‹æ—¶ï¼Œ<code>é‡‡ç”¨CPæ¨¡å¼</code>ï¼›Eurekaé‡‡ç”¨APæ–¹å¼</li></ul></li></ul><blockquote><p>CAPåŸåˆ™åˆç§°CAPå®šç†ï¼ŒæŒ‡çš„æ˜¯åœ¨ä¸€ä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œä¸€è‡´æ€§ï¼ˆConsistencyï¼‰ã€å¯ç”¨æ€§ï¼ˆAvailabilityï¼‰ã€åˆ†åŒºå®¹é”™æ€§ï¼ˆPartition toleranceï¼‰ï¼Œä½†æ˜¯CAP åŸåˆ™æŒ‡ç¤º3ä¸ªè¦ç´ æœ€å¤šåªèƒ½åŒæ—¶å®ç°ä¸¤ç‚¹ï¼Œä¸å¯èƒ½ä¸‰è€…å…¼é¡¾ï¼Œ</p></blockquote><blockquote><p>AP</p><p>å½“ç½‘ç»œåˆ†åŒºå‡ºç°åï¼Œä¸ºäº†ä¿è¯å¯ç”¨æ€§ï¼Œç³»ç»ŸBå¯ä»¥è¿”å›æ—§å€¼ï¼Œä¿è¯ç³»ç»Ÿçš„å¯ç”¨æ€§ã€‚</p><p>ç»“è®ºï¼šè¿èƒŒäº†ä¸€è‡´æ€§Cçš„è¦æ±‚ï¼Œåªæ»¡è¶³å¯ç”¨æ€§å’Œåˆ†åŒºå®¹é”™ï¼Œå³AP</p></blockquote><blockquote><p>CP</p><p>å½“ç½‘ç»œåˆ†åŒºå‡ºç°åï¼Œä¸ºäº†ä¿è¯ä¸€è‡´æ€§ï¼Œå°±å¿…é¡»æ‹’ç»è¯·æ±‚ï¼Œå¦åˆ™æ— æ³•ä¿è¯ä¸€è‡´æ€§ã€‚</p><p>ç»“è®ºï¼šè¿èƒŒäº†å¯ç”¨æ€§Açš„è¦æ±‚ï¼Œåªæ»¡è¶³ä¸€è‡´æ€§å’Œåˆ†åŒºå®¹é”™ï¼Œå³CP</p></blockquote>`,449),o=[e];function t(r,c,i,y,g,d){return a(),n("div",null,o)}const m=s(l,[["render",t]]);export{u as __pageData,m as default};
