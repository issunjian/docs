import{_ as s,o as n,c as a,V as l}from"./chunks/framework.c6d8cbec.js";const u=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[],"relativePath":"frontend/graph/VUE3+AntV-X6.md","filePath":"frontend/graph/VUE3+AntV-X6.md"}'),p={name:"frontend/graph/VUE3+AntV-X6.md"},o=l(`<h2 id="实现效果" tabindex="-1">实现效果 <a class="header-anchor" href="#实现效果" aria-label="Permalink to &quot;实现效果&quot;">​</a></h2><h2 id="" tabindex="-1"><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ae47b3717e1d40599eeeffeed5e7785b~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.image" alt="在这里插入图片描述"> <a class="header-anchor" href="#" aria-label="Permalink to &quot;![在这里插入图片描述](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ae47b3717e1d40599eeeffeed5e7785b~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.image)&quot;">​</a></h2><h2 id="实现思路" tabindex="-1">实现思路 <a class="header-anchor" href="#实现思路" aria-label="Permalink to &quot;实现思路&quot;">​</a></h2><ol><li>首先我们要了解系统的业务功能需求，以及业务流程的线路是怎样的； 如图是窗口的拆解，其中①作业树使用的是element UI的el-tree组件，是用于储存画布内容和画布回显更新的，②是选中节点树中的某项流程作业进行对应的任务操作，③和④才是实际应用AntV X6的画布插件实现的可拖拽、增、删、改、配置的流程图编辑器。 <img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c48d27dcdcba4d4d85c111b7d5660c12~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.image?" alt="image.png"> 通过vue的父子组件我们创建一个index.vue的父组件，然后将这四个部分拆分为三个子组件的.vue文件，分别为DataTree.vue、DataButton.vue、FiliationGraph.vue（包含③、④两部分）今天记录的是FiliationGraph.vue内节点配置画布的实现。</li><li>安装AntV X6 通过 npm 或 yarn 命令安装 X6。</li></ol><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F6F6F4;"># npm</span></span>
<span class="line"><span style="color:#F6F6F4;">$ npm install @</span><span style="color:#62E884;font-style:italic;">antv</span><span style="color:#F286C4;">/</span><span style="color:#62E884;font-style:italic;">x6</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">--</span><span style="color:#F6F6F4;">save</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;"># yarn</span></span>
<span class="line"><span style="color:#F6F6F4;">$ yarn add @</span><span style="color:#62E884;font-style:italic;">antv</span><span style="color:#F286C4;">/</span><span style="color:#62E884;font-style:italic;">x6</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;"># npm</span></span>
<span class="line"><span style="color:#24292E;">$ npm install @antv</span><span style="color:#D73A49;">/</span><span style="color:#24292E;">x6 </span><span style="color:#D73A49;">--</span><span style="color:#24292E;">save</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;"># yarn</span></span>
<span class="line"><span style="color:#24292E;">$ yarn add @antv</span><span style="color:#D73A49;">/</span><span style="color:#24292E;">x6</span></span></code></pre></div><ol start="3"><li>初始化画布，在html中建立节点库和画布div容器：</li></ol><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F286C4;">&lt;--</span><span style="color:#F6F6F4;"> 节点库 </span><span style="color:#F286C4;">--&gt;</span></span>
<span class="line"><span style="color:#F6F6F4;">&lt;</span><span style="color:#F286C4;">div</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;font-style:italic;">class</span><span style="color:#F286C4;">=</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">app-stencil</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;font-style:italic;">ref</span><span style="color:#F286C4;">=</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">stencilContainer</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">&gt;&lt;/</span><span style="color:#F286C4;">div</span><span style="color:#F6F6F4;">&gt;</span></span>
<span class="line"><span style="color:#F286C4;">&lt;--</span><span style="color:#F6F6F4;"> 画布 </span><span style="color:#F286C4;">--&gt;</span></span>
<span class="line"><span style="color:#F6F6F4;">&lt;</span><span style="color:#F286C4;">div</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;font-style:italic;">class</span><span style="color:#F286C4;">=</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">app-content</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;font-style:italic;">id</span><span style="color:#F286C4;">=</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">flowContainer</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;font-style:italic;">ref</span><span style="color:#F286C4;">=</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">container</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">&gt;&lt;/</span><span style="color:#F286C4;">div</span><span style="color:#F6F6F4;">&gt;</span></span>
<span class="line"><span style="color:#7B7F8B;">// 引入</span></span>
<span class="line"><span style="color:#F286C4;">import</span><span style="color:#F6F6F4;"> { Graph, Shape, Addon, FunctionExt } </span><span style="color:#F286C4;">from</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">@antv/x6</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F286C4;">const</span><span style="color:#F6F6F4;"> { Stencil } </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> Addon;  </span><span style="color:#7B7F8B;">//节点库</span></span>
<span class="line"><span style="color:#F286C4;">const</span><span style="color:#F6F6F4;"> {graph} </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> Graph;  </span><span style="color:#7B7F8B;">//画布</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F286C4;">const</span><span style="color:#F6F6F4;"> stencil </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;font-weight:bold;">new</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">Stencil</span><span style="color:#F6F6F4;">({  </span><span style="color:#7B7F8B;">//新建节点库</span></span>
<span class="line"><span style="color:#F6F6F4;">  title</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">数据集成</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">  target</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> graph,</span></span>
<span class="line"><span style="color:#F6F6F4;">  search</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">false</span><span style="color:#F6F6F4;">, </span><span style="color:#7B7F8B;">// 搜索</span></span>
<span class="line"><span style="color:#F6F6F4;">  collapsable</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">true</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">  stencilGraphWidth</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">300</span><span style="color:#F6F6F4;">,  </span><span style="color:#7B7F8B;">//容器宽度</span></span>
<span class="line"><span style="color:#F6F6F4;">  stencilGraphHeight</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">600</span><span style="color:#F6F6F4;">,  </span><span style="color:#7B7F8B;">//容器长度</span></span>
<span class="line"><span style="color:#F6F6F4;">  groups</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> [  </span><span style="color:#7B7F8B;">//分组</span></span>
<span class="line"><span style="color:#F6F6F4;">    {</span></span>
<span class="line"><span style="color:#F6F6F4;">      name</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">processLibrary</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">      title</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">dataSource</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">    },</span></span>
<span class="line"><span style="color:#F6F6F4;">  ],</span></span>
<span class="line"><span style="color:#F6F6F4;">  layoutOptions</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">    dx</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">30</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">    dy</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">20</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">    columns</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">1</span><span style="color:#F6F6F4;">,  </span><span style="color:#7B7F8B;">//列数（行内节点数）</span></span>
<span class="line"><span style="color:#F6F6F4;">    columnWidth</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">130</span><span style="color:#F6F6F4;">, </span><span style="color:#7B7F8B;">//列宽</span></span>
<span class="line"><span style="color:#F6F6F4;">    rowHeight</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">100</span><span style="color:#F6F6F4;">,  </span><span style="color:#7B7F8B;">//行高</span></span>
<span class="line"><span style="color:#F6F6F4;">  },</span></span>
<span class="line"><span style="color:#F6F6F4;">});</span></span>
<span class="line"><span style="color:#F6F6F4;">proxy.$refs.stencilContainer.</span><span style="color:#62E884;">appendChild</span><span style="color:#F6F6F4;">(stencil.container) </span><span style="color:#7B7F8B;">//注册到div中</span></span>
<span class="line"><span style="color:#F286C4;">const</span><span style="color:#F6F6F4;"> graph </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;font-weight:bold;">new</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">Graph</span><span style="color:#F6F6F4;">({ </span><span style="color:#7B7F8B;">// 新建画布</span></span>
<span class="line"><span style="color:#F6F6F4;">  container</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> document.</span><span style="color:#62E884;">getElementById</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">flowContainer</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">),</span></span>
<span class="line"><span style="color:#F6F6F4;">  width</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">800</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">  height</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">600</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">  background</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">    color</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">#F2F7FA</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">  },</span></span>
<span class="line"><span style="color:#F6F6F4;">});</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">&lt;--</span><span style="color:#24292E;"> 节点库 </span><span style="color:#D73A49;">--&gt;</span></span>
<span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#22863A;">div</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">class</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;app-stencil&quot;</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">ref</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;stencilContainer&quot;</span><span style="color:#24292E;">&gt;&lt;/</span><span style="color:#22863A;">div</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#D73A49;">&lt;--</span><span style="color:#24292E;"> 画布 </span><span style="color:#D73A49;">--&gt;</span></span>
<span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#22863A;">div</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">class</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;app-content&quot;</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">id</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;flowContainer&quot;</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">ref</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;container&quot;</span><span style="color:#24292E;">&gt;&lt;/</span><span style="color:#22863A;">div</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#6A737D;">// 引入</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> { Graph, Shape, Addon, FunctionExt } </span><span style="color:#D73A49;">from</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;@antv/x6&quot;</span><span style="color:#24292E;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> { </span><span style="color:#005CC5;">Stencil</span><span style="color:#24292E;"> } </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> Addon;  </span><span style="color:#6A737D;">//节点库</span></span>
<span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> {</span><span style="color:#005CC5;">graph</span><span style="color:#24292E;">} </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> Graph;  </span><span style="color:#6A737D;">//画布</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">stencil</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Stencil</span><span style="color:#24292E;">({  </span><span style="color:#6A737D;">//新建节点库</span></span>
<span class="line"><span style="color:#24292E;">  title: </span><span style="color:#032F62;">&quot;数据集成&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">  target: graph,</span></span>
<span class="line"><span style="color:#24292E;">  search: </span><span style="color:#005CC5;">false</span><span style="color:#24292E;">, </span><span style="color:#6A737D;">// 搜索</span></span>
<span class="line"><span style="color:#24292E;">  collapsable: </span><span style="color:#005CC5;">true</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">  stencilGraphWidth: </span><span style="color:#005CC5;">300</span><span style="color:#24292E;">,  </span><span style="color:#6A737D;">//容器宽度</span></span>
<span class="line"><span style="color:#24292E;">  stencilGraphHeight: </span><span style="color:#005CC5;">600</span><span style="color:#24292E;">,  </span><span style="color:#6A737D;">//容器长度</span></span>
<span class="line"><span style="color:#24292E;">  groups: [  </span><span style="color:#6A737D;">//分组</span></span>
<span class="line"><span style="color:#24292E;">    {</span></span>
<span class="line"><span style="color:#24292E;">      name: </span><span style="color:#032F62;">&quot;processLibrary&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">      title: </span><span style="color:#032F62;">&quot;dataSource&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    },</span></span>
<span class="line"><span style="color:#24292E;">  ],</span></span>
<span class="line"><span style="color:#24292E;">  layoutOptions: {</span></span>
<span class="line"><span style="color:#24292E;">    dx: </span><span style="color:#005CC5;">30</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    dy: </span><span style="color:#005CC5;">20</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    columns: </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">,  </span><span style="color:#6A737D;">//列数（行内节点数）</span></span>
<span class="line"><span style="color:#24292E;">    columnWidth: </span><span style="color:#005CC5;">130</span><span style="color:#24292E;">, </span><span style="color:#6A737D;">//列宽</span></span>
<span class="line"><span style="color:#24292E;">    rowHeight: </span><span style="color:#005CC5;">100</span><span style="color:#24292E;">,  </span><span style="color:#6A737D;">//行高</span></span>
<span class="line"><span style="color:#24292E;">  },</span></span>
<span class="line"><span style="color:#24292E;">});</span></span>
<span class="line"><span style="color:#24292E;">proxy.$refs.stencilContainer.</span><span style="color:#6F42C1;">appendChild</span><span style="color:#24292E;">(stencil.container) </span><span style="color:#6A737D;">//注册到div中</span></span>
<span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">graph</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Graph</span><span style="color:#24292E;">({ </span><span style="color:#6A737D;">// 新建画布</span></span>
<span class="line"><span style="color:#24292E;">  container: document.</span><span style="color:#6F42C1;">getElementById</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;flowContainer&#39;</span><span style="color:#24292E;">),</span></span>
<span class="line"><span style="color:#24292E;">  width: </span><span style="color:#005CC5;">800</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">  height: </span><span style="color:#005CC5;">600</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">  background: {</span></span>
<span class="line"><span style="color:#24292E;">    color: </span><span style="color:#032F62;">&quot;#F2F7FA&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">  },</span></span>
<span class="line"><span style="color:#24292E;">});</span></span></code></pre></div><ol start="4"><li>初始化节点、边： 初始化节点、边数据：</li></ol><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F286C4;">const</span><span style="color:#F6F6F4;"> nodeData </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;"> </span><span style="color:#7B7F8B;">// 节点</span></span>
<span class="line"><span style="color:#F6F6F4;">  nodes</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> [</span></span>
<span class="line"><span style="color:#F6F6F4;">  ],</span></span>
<span class="line"><span style="color:#F6F6F4;">  </span><span style="color:#7B7F8B;">// 边</span></span>
<span class="line"><span style="color:#F6F6F4;">  edges</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> [</span></span>
<span class="line"><span style="color:#F6F6F4;">  ],</span></span>
<span class="line"><span style="color:#F6F6F4;">};</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">nodeData</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;"> </span><span style="color:#6A737D;">// 节点</span></span>
<span class="line"><span style="color:#24292E;">  nodes: [</span></span>
<span class="line"><span style="color:#24292E;">  ],</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">// 边</span></span>
<span class="line"><span style="color:#24292E;">  edges: [</span></span>
<span class="line"><span style="color:#24292E;">  ],</span></span>
<span class="line"><span style="color:#24292E;">};</span></span></code></pre></div><p>准备节点样式内容数据，其中节点的左上角图标image是自定义的svg文件，根据产品ui或自己设计来使用哟。 <img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4cb572fbdf8d4f45b9273341d75e69fe~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.image" alt="在这里插入图片描述"></p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F286C4;">const</span><span style="color:#F6F6F4;"> imageShapes </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> [</span></span>
<span class="line"><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">    body</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">      fill</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">rgba(102, 153, 204, 0.05)</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">      stroke</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">rgb(102, 153, 204)</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">    },</span></span>
<span class="line"><span style="color:#F6F6F4;">    label</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">      text</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> state.collectLabel,</span></span>
<span class="line"><span style="color:#F6F6F4;">      fill</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">rgb(102, 153, 204)</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">    },</span></span>
<span class="line"><span style="color:#F6F6F4;">    image</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">require</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">/src/assets/Scheduler/DataCollect.svg</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">),</span></span>
<span class="line"><span style="color:#F6F6F4;">  },</span></span>
<span class="line"><span style="color:#F6F6F4;">  {</span></span>
<span class="line"><span style="color:#F6F6F4;">    body</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">      fill</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">rgba(185, 147, 214, 0.05)</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">      stroke</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">rgb(185, 147, 214)</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">    },</span></span>
<span class="line"><span style="color:#F6F6F4;">    label</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">      text</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> state.flinkLabel,</span></span>
<span class="line"><span style="color:#F6F6F4;">      fill</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">rgb(185, 147, 214)</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">      },</span></span>
<span class="line"><span style="color:#F6F6F4;">    image</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">require</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">/src/assets/Scheduler/DataFlink.svg</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">),</span></span>
<span class="line"><span style="color:#F6F6F4;">  },</span></span>
<span class="line"><span style="color:#F6F6F4;">  {</span></span>
<span class="line"><span style="color:#F6F6F4;">    body</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">      fill</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">rgba(154, 184, 122, 0.05)</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">      stroke</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">rgb(154, 184, 122)</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">    },</span></span>
<span class="line"><span style="color:#F6F6F4;">    label</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">      text</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> state.controlLabel,</span></span>
<span class="line"><span style="color:#F6F6F4;">      fill</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">rgb(154, 184, 122)</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">      },</span></span>
<span class="line"><span style="color:#F6F6F4;">    image</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">require</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">/src/assets/Scheduler/DataQc.svg</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">),</span></span>
<span class="line"><span style="color:#F6F6F4;">  },</span></span>
<span class="line"><span style="color:#F6F6F4;">  {</span></span>
<span class="line"><span style="color:#F6F6F4;">    body</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">      fill</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">rgba(247, 178, 103, 0.05)</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">      stroke</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">rgb(247, 178, 103)</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">    },</span></span>
<span class="line"><span style="color:#F6F6F4;">    label</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">      text</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> state.monitorLabel,</span></span>
<span class="line"><span style="color:#F6F6F4;">      fill</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">rgb(247, 178, 103)</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">      },</span></span>
<span class="line"><span style="color:#F6F6F4;">    image</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">require</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">/src/assets/Scheduler/DataWatch.svg</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">),</span></span>
<span class="line"><span style="color:#F6F6F4;">  },</span></span>
<span class="line"><span style="color:#F6F6F4;">  {</span></span>
<span class="line"><span style="color:#F6F6F4;">    body</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">      fill</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">rgba(219, 127, 142, 0.05)</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">      stroke</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">rgb(219, 127, 142)</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">    },</span></span>
<span class="line"><span style="color:#F6F6F4;">    label</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">      text</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> state.standerLabel,</span></span>
<span class="line"><span style="color:#F6F6F4;">      fill</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">rgb(219, 127, 142)</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">      },</span></span>
<span class="line"><span style="color:#F6F6F4;">    image</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">require</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">/src/assets/Scheduler/DataStandred.svg</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">),</span></span>
<span class="line"><span style="color:#F6F6F4;">  },</span></span>
<span class="line"><span style="color:#F6F6F4;">]</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">imageShapes</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> [</span></span>
<span class="line"><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    body: {</span></span>
<span class="line"><span style="color:#24292E;">      fill: </span><span style="color:#032F62;">&quot;rgba(102, 153, 204, 0.05)&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">      stroke: </span><span style="color:#032F62;">&quot;rgb(102, 153, 204)&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    },</span></span>
<span class="line"><span style="color:#24292E;">    label: {</span></span>
<span class="line"><span style="color:#24292E;">      text: state.collectLabel,</span></span>
<span class="line"><span style="color:#24292E;">      fill: </span><span style="color:#032F62;">&#39;rgb(102, 153, 204)&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    },</span></span>
<span class="line"><span style="color:#24292E;">    image: </span><span style="color:#6F42C1;">require</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;/src/assets/Scheduler/DataCollect.svg&#39;</span><span style="color:#24292E;">),</span></span>
<span class="line"><span style="color:#24292E;">  },</span></span>
<span class="line"><span style="color:#24292E;">  {</span></span>
<span class="line"><span style="color:#24292E;">    body: {</span></span>
<span class="line"><span style="color:#24292E;">      fill: </span><span style="color:#032F62;">&quot;rgba(185, 147, 214, 0.05)&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">      stroke: </span><span style="color:#032F62;">&quot;rgb(185, 147, 214)&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    },</span></span>
<span class="line"><span style="color:#24292E;">    label: {</span></span>
<span class="line"><span style="color:#24292E;">      text: state.flinkLabel,</span></span>
<span class="line"><span style="color:#24292E;">      fill: </span><span style="color:#032F62;">&#39;rgb(185, 147, 214)&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">      },</span></span>
<span class="line"><span style="color:#24292E;">    image: </span><span style="color:#6F42C1;">require</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;/src/assets/Scheduler/DataFlink.svg&#39;</span><span style="color:#24292E;">),</span></span>
<span class="line"><span style="color:#24292E;">  },</span></span>
<span class="line"><span style="color:#24292E;">  {</span></span>
<span class="line"><span style="color:#24292E;">    body: {</span></span>
<span class="line"><span style="color:#24292E;">      fill: </span><span style="color:#032F62;">&quot;rgba(154, 184, 122, 0.05)&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">      stroke: </span><span style="color:#032F62;">&quot;rgb(154, 184, 122)&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    },</span></span>
<span class="line"><span style="color:#24292E;">    label: {</span></span>
<span class="line"><span style="color:#24292E;">      text: state.controlLabel,</span></span>
<span class="line"><span style="color:#24292E;">      fill: </span><span style="color:#032F62;">&#39;rgb(154, 184, 122)&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">      },</span></span>
<span class="line"><span style="color:#24292E;">    image: </span><span style="color:#6F42C1;">require</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;/src/assets/Scheduler/DataQc.svg&#39;</span><span style="color:#24292E;">),</span></span>
<span class="line"><span style="color:#24292E;">  },</span></span>
<span class="line"><span style="color:#24292E;">  {</span></span>
<span class="line"><span style="color:#24292E;">    body: {</span></span>
<span class="line"><span style="color:#24292E;">      fill: </span><span style="color:#032F62;">&quot;rgba(247, 178, 103, 0.05)&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">      stroke: </span><span style="color:#032F62;">&quot;rgb(247, 178, 103)&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    },</span></span>
<span class="line"><span style="color:#24292E;">    label: {</span></span>
<span class="line"><span style="color:#24292E;">      text: state.monitorLabel,</span></span>
<span class="line"><span style="color:#24292E;">      fill: </span><span style="color:#032F62;">&#39;rgb(247, 178, 103)&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">      },</span></span>
<span class="line"><span style="color:#24292E;">    image: </span><span style="color:#6F42C1;">require</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;/src/assets/Scheduler/DataWatch.svg&#39;</span><span style="color:#24292E;">),</span></span>
<span class="line"><span style="color:#24292E;">  },</span></span>
<span class="line"><span style="color:#24292E;">  {</span></span>
<span class="line"><span style="color:#24292E;">    body: {</span></span>
<span class="line"><span style="color:#24292E;">      fill: </span><span style="color:#032F62;">&quot;rgba(219, 127, 142, 0.05)&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">      stroke: </span><span style="color:#032F62;">&quot;rgb(219, 127, 142)&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    },</span></span>
<span class="line"><span style="color:#24292E;">    label: {</span></span>
<span class="line"><span style="color:#24292E;">      text: state.standerLabel,</span></span>
<span class="line"><span style="color:#24292E;">      fill: </span><span style="color:#032F62;">&#39;rgb(219, 127, 142)&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">      },</span></span>
<span class="line"><span style="color:#24292E;">    image: </span><span style="color:#6F42C1;">require</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;/src/assets/Scheduler/DataStandred.svg&#39;</span><span style="color:#24292E;">),</span></span>
<span class="line"><span style="color:#24292E;">  },</span></span>
<span class="line"><span style="color:#24292E;">]</span></span></code></pre></div><ol start="5"><li>左侧模型栏节点样式： 初始化链接桩</li></ol><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F286C4;">const</span><span style="color:#F6F6F4;"> ports </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;"> groups</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">   in</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">     position</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">top</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">     attrs</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">       circle</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">         r</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">4</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">         magnet</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">true</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">         stroke</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">#108ee9</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">         strokeWidth</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">2</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">         fill</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">#fff</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">         style</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">           visibility</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">hidden</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">         },</span></span>
<span class="line"><span style="color:#F6F6F4;">       }</span></span>
<span class="line"><span style="color:#F6F6F4;">     }</span></span>
<span class="line"><span style="color:#F6F6F4;">   },</span></span>
<span class="line"><span style="color:#F6F6F4;">   out</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">     position</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">bottom</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">     attrs</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">       circle</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">         r</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">4</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">         magnet</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">true</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">         stroke</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">#31d0c6</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">         strokeWidth</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">2</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">         fill</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">#fff</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">         style</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">           visibility</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">hidden</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">         },</span></span>
<span class="line"><span style="color:#F6F6F4;">       }</span></span>
<span class="line"><span style="color:#F6F6F4;">     }</span></span>
<span class="line"><span style="color:#F6F6F4;">   }</span></span>
<span class="line"><span style="color:#F6F6F4;"> },</span></span>
<span class="line"><span style="color:#F6F6F4;"> items</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> [</span></span>
<span class="line"><span style="color:#F6F6F4;">   {</span></span>
<span class="line"><span style="color:#F6F6F4;">     id</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> state.currentCode</span><span style="color:#F286C4;">+</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">_in</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">     group</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">in</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">   },</span></span>
<span class="line"><span style="color:#F6F6F4;">   {</span></span>
<span class="line"><span style="color:#F6F6F4;">     id</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> state.currentCode </span><span style="color:#F286C4;">+</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">_out</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">     group</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">out</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">   },</span></span>
<span class="line"><span style="color:#F6F6F4;"> ],</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">ports</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;"> groups: {</span></span>
<span class="line"><span style="color:#24292E;">   in: {</span></span>
<span class="line"><span style="color:#24292E;">     position: </span><span style="color:#032F62;">&#39;top&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">     attrs: {</span></span>
<span class="line"><span style="color:#24292E;">       circle: {</span></span>
<span class="line"><span style="color:#24292E;">         r: </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">         magnet: </span><span style="color:#005CC5;">true</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">         stroke: </span><span style="color:#032F62;">&#39;#108ee9&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">         strokeWidth: </span><span style="color:#005CC5;">2</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">         fill: </span><span style="color:#032F62;">&#39;#fff&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">         style: {</span></span>
<span class="line"><span style="color:#24292E;">           visibility: </span><span style="color:#032F62;">&quot;hidden&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">         },</span></span>
<span class="line"><span style="color:#24292E;">       }</span></span>
<span class="line"><span style="color:#24292E;">     }</span></span>
<span class="line"><span style="color:#24292E;">   },</span></span>
<span class="line"><span style="color:#24292E;">   out: {</span></span>
<span class="line"><span style="color:#24292E;">     position: </span><span style="color:#032F62;">&#39;bottom&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">     attrs: {</span></span>
<span class="line"><span style="color:#24292E;">       circle: {</span></span>
<span class="line"><span style="color:#24292E;">         r: </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">         magnet: </span><span style="color:#005CC5;">true</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">         stroke: </span><span style="color:#032F62;">&#39;#31d0c6&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">         strokeWidth: </span><span style="color:#005CC5;">2</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">         fill: </span><span style="color:#032F62;">&#39;#fff&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">         style: {</span></span>
<span class="line"><span style="color:#24292E;">           visibility: </span><span style="color:#032F62;">&quot;hidden&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">         },</span></span>
<span class="line"><span style="color:#24292E;">       }</span></span>
<span class="line"><span style="color:#24292E;">     }</span></span>
<span class="line"><span style="color:#24292E;">   }</span></span>
<span class="line"><span style="color:#24292E;"> },</span></span>
<span class="line"><span style="color:#24292E;"> items: [</span></span>
<span class="line"><span style="color:#24292E;">   {</span></span>
<span class="line"><span style="color:#24292E;">     id: state.currentCode</span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;_in&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">     group: </span><span style="color:#032F62;">&#39;in&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">   },</span></span>
<span class="line"><span style="color:#24292E;">   {</span></span>
<span class="line"><span style="color:#24292E;">     id: state.currentCode </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;_out&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">     group: </span><span style="color:#032F62;">&#39;out&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">   },</span></span>
<span class="line"><span style="color:#24292E;"> ],</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><p>根据样式数据，设计画布左侧节点样式</p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F6F6F4;">Graph.</span><span style="color:#62E884;">registerNode</span><span style="color:#F6F6F4;">( </span><span style="color:#7B7F8B;">//注册节点</span></span>
<span class="line"><span style="color:#F6F6F4;">  </span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">custom-node</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">  {</span></span>
<span class="line"><span style="color:#F6F6F4;">    inherit</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">rect</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">, </span><span style="color:#7B7F8B;">//基础图形</span></span>
<span class="line"><span style="color:#F6F6F4;">    width</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">140</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">    height</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">76</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">    attrs</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> {  </span><span style="color:#7B7F8B;">//自定义样式</span></span>
<span class="line"><span style="color:#F6F6F4;">      body</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> {  </span><span style="color:#7B7F8B;">//节点主体</span></span>
<span class="line"><span style="color:#F6F6F4;">        strokeWidth</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">1</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">        rx</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">30</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">        ry</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">30</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">      },</span></span>
<span class="line"><span style="color:#F6F6F4;">      image</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> {  </span><span style="color:#7B7F8B;">//图片</span></span>
<span class="line"><span style="color:#F6F6F4;">        width</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">20</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">        height</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">20</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">        x</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">12</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">        y</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">3</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">      },</span></span>
<span class="line"><span style="color:#F6F6F4;">      text</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> {  </span><span style="color:#7B7F8B;">//主题文本</span></span>
<span class="line"><span style="color:#F6F6F4;">        refX</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">40</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">        refY</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">15</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">        fontSize</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">15</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">text-anchor</span><span style="color:#DEE492;">&#39;</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">start</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">      },</span></span>
<span class="line"><span style="color:#F6F6F4;">      label</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> {  </span><span style="color:#7B7F8B;">//标签名</span></span>
<span class="line"><span style="color:#F6F6F4;">        text</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">Please nominate this node</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">        id</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">0</span><span style="color:#F6F6F4;">,  </span><span style="color:#7B7F8B;">//自定义传给接口的数据</span></span>
<span class="line"><span style="color:#F6F6F4;">        data</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> {},  </span><span style="color:#7B7F8B;">//这里是我加入的标签内自定义储存的数据内容</span></span>
<span class="line"><span style="color:#F6F6F4;">        refX</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">10</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">        refY</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">30</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">        fontSize</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">12</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">        fill</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">rgba(0,0,0,0.6)</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">text-anchor</span><span style="color:#DEE492;">&#39;</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">start</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">        textWrap</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> {  </span><span style="color:#7B7F8B;">//如果节点命名标签过长可以使用这个属性来定义文本内容</span></span>
<span class="line"><span style="color:#F6F6F4;">          width</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">-</span><span style="color:#BF9EEE;">10</span><span style="color:#F6F6F4;">,      </span><span style="color:#7B7F8B;">// 宽度减少 10px</span></span>
<span class="line"><span style="color:#F6F6F4;">          height</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">70%</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">,   </span><span style="color:#7B7F8B;">// 高度为参照元素高度的一半</span></span>
<span class="line"><span style="color:#F6F6F4;">          ellipsis</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">true</span><span style="color:#F6F6F4;">,  </span><span style="color:#7B7F8B;">// 文本超出显示范围时，自动添加省略号</span></span>
<span class="line"><span style="color:#F6F6F4;">          breakWord</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">true</span><span style="color:#F6F6F4;">, </span><span style="color:#7B7F8B;">// 是否截断单词</span></span>
<span class="line"><span style="color:#F6F6F4;">        }</span></span>
<span class="line"><span style="color:#F6F6F4;">      },</span></span>
<span class="line"><span style="color:#F6F6F4;">    },</span></span>
<span class="line"><span style="color:#F6F6F4;">    markup</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> [ </span><span style="color:#7B7F8B;">//组合</span></span>
<span class="line"><span style="color:#F6F6F4;">      {</span></span>
<span class="line"><span style="color:#F6F6F4;">        tagName</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">rect</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">        selector</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">body</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">      },</span></span>
<span class="line"><span style="color:#F6F6F4;">      {</span></span>
<span class="line"><span style="color:#F6F6F4;">        tagName</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">image</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">        selector</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">image</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">      },</span></span>
<span class="line"><span style="color:#F6F6F4;">      {</span></span>
<span class="line"><span style="color:#F6F6F4;">        tagName</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">text</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">        selector</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">text</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">      },</span></span>
<span class="line"><span style="color:#F6F6F4;">      {</span></span>
<span class="line"><span style="color:#F6F6F4;">        tagName</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">text</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">        selector</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">label</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">      },</span></span>
<span class="line"><span style="color:#F6F6F4;">    ],</span></span>
<span class="line"><span style="color:#F6F6F4;">    data</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> {},</span></span>
<span class="line"><span style="color:#F6F6F4;">    relation</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> {},</span></span>
<span class="line"><span style="color:#F6F6F4;">    ports</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> { </span><span style="color:#F286C4;">...</span><span style="color:#F6F6F4;">ports }, </span><span style="color:#7B7F8B;">//链接桩定义</span></span>
<span class="line"><span style="color:#F6F6F4;">  },</span></span>
<span class="line"><span style="color:#F6F6F4;">  </span><span style="color:#BF9EEE;">true</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">)</span></span>
<span class="line"><span style="color:#F286C4;">const</span><span style="color:#F6F6F4;"> imageNodes </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> imageShapes.</span><span style="color:#62E884;">map</span><span style="color:#F6F6F4;">((</span><span style="color:#FFB86C;font-style:italic;">item</span><span style="color:#F6F6F4;">) </span><span style="color:#F286C4;">=&gt;</span><span style="color:#F6F6F4;"> </span><span style="color:#7B7F8B;">//呈现画布节点数据的样式</span></span>
<span class="line"><span style="color:#F6F6F4;">  graph.</span><span style="color:#62E884;">createNode</span><span style="color:#F6F6F4;">({</span></span>
<span class="line"><span style="color:#F6F6F4;">    shape</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">custom-node</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">    attrs</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">      image</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">xlink:href</span><span style="color:#DEE492;">&#39;</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> item.image,</span></span>
<span class="line"><span style="color:#F6F6F4;">      },</span></span>
<span class="line"><span style="color:#F6F6F4;">      body</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> item.body,</span></span>
<span class="line"><span style="color:#F6F6F4;">      text</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> item.label,</span></span>
<span class="line"><span style="color:#F6F6F4;">    },</span></span>
<span class="line"><span style="color:#F6F6F4;">  }),</span></span>
<span class="line"><span style="color:#F6F6F4;">)</span></span>
<span class="line"><span style="color:#F6F6F4;">stencil.</span><span style="color:#62E884;">load</span><span style="color:#F6F6F4;">( </span><span style="color:#7B7F8B;">//载入左侧节点模型库</span></span>
<span class="line"><span style="color:#F6F6F4;">  imageNodes,</span></span>
<span class="line"><span style="color:#F6F6F4;">  </span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">processLibrary</span><span style="color:#DEE492;">&quot;</span></span>
<span class="line"><span style="color:#F6F6F4;">);</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">Graph.</span><span style="color:#6F42C1;">registerNode</span><span style="color:#24292E;">( </span><span style="color:#6A737D;">//注册节点</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#032F62;">&#39;custom-node&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">  {</span></span>
<span class="line"><span style="color:#24292E;">    inherit: </span><span style="color:#032F62;">&#39;rect&#39;</span><span style="color:#24292E;">, </span><span style="color:#6A737D;">//基础图形</span></span>
<span class="line"><span style="color:#24292E;">    width: </span><span style="color:#005CC5;">140</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    height: </span><span style="color:#005CC5;">76</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    attrs: {  </span><span style="color:#6A737D;">//自定义样式</span></span>
<span class="line"><span style="color:#24292E;">      body: {  </span><span style="color:#6A737D;">//节点主体</span></span>
<span class="line"><span style="color:#24292E;">        strokeWidth: </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">        rx: </span><span style="color:#005CC5;">30</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">        ry: </span><span style="color:#005CC5;">30</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">      },</span></span>
<span class="line"><span style="color:#24292E;">      image: {  </span><span style="color:#6A737D;">//图片</span></span>
<span class="line"><span style="color:#24292E;">        width: </span><span style="color:#005CC5;">20</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">        height: </span><span style="color:#005CC5;">20</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">        x: </span><span style="color:#005CC5;">12</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">        y: </span><span style="color:#005CC5;">3</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">      },</span></span>
<span class="line"><span style="color:#24292E;">      text: {  </span><span style="color:#6A737D;">//主题文本</span></span>
<span class="line"><span style="color:#24292E;">        refX: </span><span style="color:#005CC5;">40</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">        refY: </span><span style="color:#005CC5;">15</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">        fontSize: </span><span style="color:#005CC5;">15</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#032F62;">&#39;text-anchor&#39;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;start&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">      },</span></span>
<span class="line"><span style="color:#24292E;">      label: {  </span><span style="color:#6A737D;">//标签名</span></span>
<span class="line"><span style="color:#24292E;">        text: </span><span style="color:#032F62;">&#39;Please nominate this node&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">        id: </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">,  </span><span style="color:#6A737D;">//自定义传给接口的数据</span></span>
<span class="line"><span style="color:#24292E;">        data: {},  </span><span style="color:#6A737D;">//这里是我加入的标签内自定义储存的数据内容</span></span>
<span class="line"><span style="color:#24292E;">        refX: </span><span style="color:#005CC5;">10</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">        refY: </span><span style="color:#005CC5;">30</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">        fontSize: </span><span style="color:#005CC5;">12</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">        fill: </span><span style="color:#032F62;">&#39;rgba(0,0,0,0.6)&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#032F62;">&#39;text-anchor&#39;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;start&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">        textWrap: {  </span><span style="color:#6A737D;">//如果节点命名标签过长可以使用这个属性来定义文本内容</span></span>
<span class="line"><span style="color:#24292E;">          width: </span><span style="color:#D73A49;">-</span><span style="color:#005CC5;">10</span><span style="color:#24292E;">,      </span><span style="color:#6A737D;">// 宽度减少 10px</span></span>
<span class="line"><span style="color:#24292E;">          height: </span><span style="color:#032F62;">&#39;70%&#39;</span><span style="color:#24292E;">,   </span><span style="color:#6A737D;">// 高度为参照元素高度的一半</span></span>
<span class="line"><span style="color:#24292E;">          ellipsis: </span><span style="color:#005CC5;">true</span><span style="color:#24292E;">,  </span><span style="color:#6A737D;">// 文本超出显示范围时，自动添加省略号</span></span>
<span class="line"><span style="color:#24292E;">          breakWord: </span><span style="color:#005CC5;">true</span><span style="color:#24292E;">, </span><span style="color:#6A737D;">// 是否截断单词</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"><span style="color:#24292E;">      },</span></span>
<span class="line"><span style="color:#24292E;">    },</span></span>
<span class="line"><span style="color:#24292E;">    markup: [ </span><span style="color:#6A737D;">//组合</span></span>
<span class="line"><span style="color:#24292E;">      {</span></span>
<span class="line"><span style="color:#24292E;">        tagName: </span><span style="color:#032F62;">&#39;rect&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">        selector: </span><span style="color:#032F62;">&#39;body&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">      },</span></span>
<span class="line"><span style="color:#24292E;">      {</span></span>
<span class="line"><span style="color:#24292E;">        tagName: </span><span style="color:#032F62;">&#39;image&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">        selector: </span><span style="color:#032F62;">&#39;image&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">      },</span></span>
<span class="line"><span style="color:#24292E;">      {</span></span>
<span class="line"><span style="color:#24292E;">        tagName: </span><span style="color:#032F62;">&#39;text&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">        selector: </span><span style="color:#032F62;">&#39;text&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">      },</span></span>
<span class="line"><span style="color:#24292E;">      {</span></span>
<span class="line"><span style="color:#24292E;">        tagName: </span><span style="color:#032F62;">&#39;text&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">        selector: </span><span style="color:#032F62;">&#39;label&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">      },</span></span>
<span class="line"><span style="color:#24292E;">    ],</span></span>
<span class="line"><span style="color:#24292E;">    data: {},</span></span>
<span class="line"><span style="color:#24292E;">    relation: {},</span></span>
<span class="line"><span style="color:#24292E;">    ports: { </span><span style="color:#D73A49;">...</span><span style="color:#24292E;">ports }, </span><span style="color:#6A737D;">//链接桩定义</span></span>
<span class="line"><span style="color:#24292E;">  },</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#005CC5;">true</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">imageNodes</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> imageShapes.</span><span style="color:#6F42C1;">map</span><span style="color:#24292E;">((</span><span style="color:#E36209;">item</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> </span><span style="color:#6A737D;">//呈现画布节点数据的样式</span></span>
<span class="line"><span style="color:#24292E;">  graph.</span><span style="color:#6F42C1;">createNode</span><span style="color:#24292E;">({</span></span>
<span class="line"><span style="color:#24292E;">    shape: </span><span style="color:#032F62;">&#39;custom-node&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    attrs: {</span></span>
<span class="line"><span style="color:#24292E;">      image: {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#032F62;">&#39;xlink:href&#39;</span><span style="color:#24292E;">: item.image,</span></span>
<span class="line"><span style="color:#24292E;">      },</span></span>
<span class="line"><span style="color:#24292E;">      body: item.body,</span></span>
<span class="line"><span style="color:#24292E;">      text: item.label,</span></span>
<span class="line"><span style="color:#24292E;">    },</span></span>
<span class="line"><span style="color:#24292E;">  }),</span></span>
<span class="line"><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">stencil.</span><span style="color:#6F42C1;">load</span><span style="color:#24292E;">( </span><span style="color:#6A737D;">//载入左侧节点模型库</span></span>
<span class="line"><span style="color:#24292E;">  imageNodes,</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#032F62;">&quot;processLibrary&quot;</span></span>
<span class="line"><span style="color:#24292E;">);</span></span></code></pre></div><p>6.定义边的样式（节点连线）</p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F6F6F4;">Graph.</span><span style="color:#62E884;">registerConnector</span><span style="color:#F6F6F4;">(</span></span>
<span class="line"><span style="color:#F6F6F4;">  </span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">algo-edge</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">  (</span><span style="color:#FFB86C;font-style:italic;">source</span><span style="color:#F6F6F4;">, </span><span style="color:#FFB86C;font-style:italic;">target</span><span style="color:#F6F6F4;">) </span><span style="color:#F286C4;">=&gt;</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">const</span><span style="color:#F6F6F4;"> offset </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">4</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">const</span><span style="color:#F6F6F4;"> control </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">80</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">const</span><span style="color:#F6F6F4;"> v1 </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> { x</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> source.x, y</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> source.y </span><span style="color:#F286C4;">+</span><span style="color:#F6F6F4;"> offset </span><span style="color:#F286C4;">+</span><span style="color:#F6F6F4;"> control }</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">const</span><span style="color:#F6F6F4;"> v2 </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> { x</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> target.x, y</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> target.y </span><span style="color:#F286C4;">-</span><span style="color:#F6F6F4;"> offset </span><span style="color:#F286C4;">-</span><span style="color:#F6F6F4;"> control }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">return</span><span style="color:#F6F6F4;"> </span><span style="color:#E7EE98;">\`M </span><span style="color:#F286C4;">\${</span><span style="color:#F6F6F4;">source.x</span><span style="color:#F286C4;">}</span><span style="color:#E7EE98;"> </span><span style="color:#F286C4;">\${</span><span style="color:#F6F6F4;">source.y</span><span style="color:#F286C4;">}</span></span>
<span class="line"><span style="color:#E7EE98;">            L </span><span style="color:#F286C4;">\${</span><span style="color:#F6F6F4;">source.x</span><span style="color:#F286C4;">}</span><span style="color:#E7EE98;"> </span><span style="color:#F286C4;">\${</span><span style="color:#F6F6F4;">source.y</span><span style="color:#E7EE98;"> </span><span style="color:#F286C4;">+</span><span style="color:#E7EE98;"> </span><span style="color:#F6F6F4;">offset</span><span style="color:#F286C4;">}</span></span>
<span class="line"><span style="color:#E7EE98;">            C </span><span style="color:#F286C4;">\${</span><span style="color:#F6F6F4;">v1.x</span><span style="color:#F286C4;">}</span><span style="color:#E7EE98;"> </span><span style="color:#F286C4;">\${</span><span style="color:#F6F6F4;">v1.y</span><span style="color:#F286C4;">}</span><span style="color:#E7EE98;"> </span><span style="color:#F286C4;">\${</span><span style="color:#F6F6F4;">v2.x</span><span style="color:#F286C4;">}</span><span style="color:#E7EE98;"> </span><span style="color:#F286C4;">\${</span><span style="color:#F6F6F4;">v2.y</span><span style="color:#F286C4;">}</span><span style="color:#E7EE98;"> </span><span style="color:#F286C4;">\${</span><span style="color:#F6F6F4;">target.x</span><span style="color:#F286C4;">}</span><span style="color:#E7EE98;"> </span><span style="color:#F286C4;">\${</span><span style="color:#F6F6F4;">target.y</span><span style="color:#E7EE98;"> </span><span style="color:#F286C4;">-</span><span style="color:#E7EE98;"> </span><span style="color:#F6F6F4;">offset</span><span style="color:#F286C4;">}</span></span>
<span class="line"><span style="color:#E7EE98;">            L </span><span style="color:#F286C4;">\${</span><span style="color:#F6F6F4;">target.x</span><span style="color:#F286C4;">}</span><span style="color:#E7EE98;"> </span><span style="color:#F286C4;">\${</span><span style="color:#F6F6F4;">target.y</span><span style="color:#F286C4;">}</span><span style="color:#E7EE98;">\`</span></span>
<span class="line"><span style="color:#F6F6F4;">  },</span></span>
<span class="line"><span style="color:#F6F6F4;">  </span><span style="color:#BF9EEE;">true</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">)</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">Graph.</span><span style="color:#6F42C1;">registerConnector</span><span style="color:#24292E;">(</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#032F62;">&#39;algo-edge&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">  (</span><span style="color:#E36209;">source</span><span style="color:#24292E;">, </span><span style="color:#E36209;">target</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">offset</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">4</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">control</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">80</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">v1</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> { x: source.x, y: source.y </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> offset </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> control }</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">v2</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> { x: target.x, y: target.y </span><span style="color:#D73A49;">-</span><span style="color:#24292E;"> offset </span><span style="color:#D73A49;">-</span><span style="color:#24292E;"> control }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> </span><span style="color:#032F62;">\`M \${</span><span style="color:#24292E;">source</span><span style="color:#032F62;">.</span><span style="color:#24292E;">x</span><span style="color:#032F62;">} \${</span><span style="color:#24292E;">source</span><span style="color:#032F62;">.</span><span style="color:#24292E;">y</span><span style="color:#032F62;">}</span></span>
<span class="line"><span style="color:#032F62;">            L \${</span><span style="color:#24292E;">source</span><span style="color:#032F62;">.</span><span style="color:#24292E;">x</span><span style="color:#032F62;">} \${</span><span style="color:#24292E;">source</span><span style="color:#032F62;">.</span><span style="color:#24292E;">y</span><span style="color:#032F62;"> </span><span style="color:#D73A49;">+</span><span style="color:#032F62;"> </span><span style="color:#24292E;">offset</span><span style="color:#032F62;">}</span></span>
<span class="line"><span style="color:#032F62;">            C \${</span><span style="color:#24292E;">v1</span><span style="color:#032F62;">.</span><span style="color:#24292E;">x</span><span style="color:#032F62;">} \${</span><span style="color:#24292E;">v1</span><span style="color:#032F62;">.</span><span style="color:#24292E;">y</span><span style="color:#032F62;">} \${</span><span style="color:#24292E;">v2</span><span style="color:#032F62;">.</span><span style="color:#24292E;">x</span><span style="color:#032F62;">} \${</span><span style="color:#24292E;">v2</span><span style="color:#032F62;">.</span><span style="color:#24292E;">y</span><span style="color:#032F62;">} \${</span><span style="color:#24292E;">target</span><span style="color:#032F62;">.</span><span style="color:#24292E;">x</span><span style="color:#032F62;">} \${</span><span style="color:#24292E;">target</span><span style="color:#032F62;">.</span><span style="color:#24292E;">y</span><span style="color:#032F62;"> </span><span style="color:#D73A49;">-</span><span style="color:#032F62;"> </span><span style="color:#24292E;">offset</span><span style="color:#032F62;">}</span></span>
<span class="line"><span style="color:#032F62;">            L \${</span><span style="color:#24292E;">target</span><span style="color:#032F62;">.</span><span style="color:#24292E;">x</span><span style="color:#032F62;">} \${</span><span style="color:#24292E;">target</span><span style="color:#032F62;">.</span><span style="color:#24292E;">y</span><span style="color:#032F62;">}\`</span></span>
<span class="line"><span style="color:#24292E;">  },</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#005CC5;">true</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">)</span></span></code></pre></div><p>以及可以在初始化画布graph = new graph（{}）方法中，定义连线规则</p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#7B7F8B;">// 连线规则</span></span>
<span class="line"><span style="color:#F6F6F4;">connecting: {</span></span>
<span class="line"><span style="color:#F6F6F4;">  snap: </span><span style="color:#BF9EEE;">true</span><span style="color:#F6F6F4;">,  </span><span style="color:#7B7F8B;">// 当 snap 设置为 true 时连线的过程中距离节点或者连接桩 50px 时会触发自动吸附</span></span>
<span class="line"><span style="color:#F6F6F4;">  allowBlank: </span><span style="color:#BF9EEE;">false</span><span style="color:#F6F6F4;">,  </span><span style="color:#7B7F8B;">// 是否允许连接到画布空白位置的点，默认为 true</span></span>
<span class="line"><span style="color:#F6F6F4;">  allowLoop: </span><span style="color:#BF9EEE;">false</span><span style="color:#F6F6F4;">, </span><span style="color:#7B7F8B;">// 是否允许创建循环连线，即边的起始节点和终止节点为同一节点，默认为 true</span></span>
<span class="line"><span style="color:#F6F6F4;">  allowMulti: </span><span style="color:#BF9EEE;">false</span><span style="color:#F6F6F4;">, </span><span style="color:#7B7F8B;">// 当设置为 false 时，在起始和终止节点之间只允许创建一条边</span></span>
<span class="line"><span style="color:#F6F6F4;">  highlight: </span><span style="color:#BF9EEE;">true</span><span style="color:#F6F6F4;">,  </span><span style="color:#7B7F8B;">// 拖动边时，是否高亮显示所有可用的连接桩或节点，默认值为 false。</span></span>
<span class="line"><span style="color:#F6F6F4;">  sourceAnchor: {  </span><span style="color:#7B7F8B;">// 当连接到节点时，通过 sourceAnchor 来指定源节点的锚点。</span></span>
<span class="line"><span style="color:#F6F6F4;">    name: </span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">bottom</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">    args: {</span></span>
<span class="line"><span style="color:#F6F6F4;">      dx: </span><span style="color:#BF9EEE;">0</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">    },</span></span>
<span class="line"><span style="color:#F6F6F4;">  },</span></span>
<span class="line"><span style="color:#F6F6F4;">  targetAnchor: {  </span><span style="color:#7B7F8B;">// 当连接到节点时，通过 targetAnchor 来指定目标节点的锚点。</span></span>
<span class="line"><span style="color:#F6F6F4;">    name: </span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">top</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">    args: {</span></span>
<span class="line"><span style="color:#F6F6F4;">      dx: </span><span style="color:#BF9EEE;">0</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">    },</span></span>
<span class="line"><span style="color:#F6F6F4;">  },</span></span>
<span class="line"><span style="color:#F6F6F4;">  connectionPoint: </span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">anchor</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">,  </span><span style="color:#7B7F8B;">// 指定连接点，默认值为 boundary。</span></span>
<span class="line"><span style="color:#F6F6F4;">  connector: </span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">algo-edge</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">,  </span><span style="color:#7B7F8B;">// 连接器将起点、路由返回的点、终点加工为 元素的 d 属性，决定了边渲染到画布后的样式，默认值为 normal。</span></span>
<span class="line"><span style="color:#F6F6F4;">  </span><span style="color:#62E884;">createEdge</span><span style="color:#F6F6F4;">() {</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">return</span><span style="color:#F6F6F4;"> graph.</span><span style="color:#62E884;">createEdge</span><span style="color:#F6F6F4;">({</span></span>
<span class="line"><span style="color:#F6F6F4;">      attrs</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">        line</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">          strokeDasharray</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">5 5</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">          stroke</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">#808080</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">          strokeWidth</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">1</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">          targetMarker</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">            name</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">block</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">            args</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">              size</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">6</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">            },</span></span>
<span class="line"><span style="color:#F6F6F4;">          },</span></span>
<span class="line"><span style="color:#F6F6F4;">        },</span></span>
<span class="line"><span style="color:#F6F6F4;">      },</span></span>
<span class="line"><span style="color:#F6F6F4;">    })</span></span>
<span class="line"><span style="color:#F6F6F4;">  },</span></span>
<span class="line"><span style="color:#F6F6F4;">  </span><span style="color:#62E884;">validateMagnet</span><span style="color:#F6F6F4;">({ magnet }) {</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">return</span><span style="color:#F6F6F4;"> magnet.</span><span style="color:#62E884;">getAttribute</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">port-group</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">) </span><span style="color:#F286C4;">!==</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">in</span><span style="color:#DEE492;">&#39;</span></span>
<span class="line"><span style="color:#F6F6F4;">  },</span></span>
<span class="line"><span style="color:#F6F6F4;">  </span><span style="color:#62E884;">validateConnection</span><span style="color:#F6F6F4;">({</span></span>
<span class="line"><span style="color:#F6F6F4;">    sourceView,</span></span>
<span class="line"><span style="color:#F6F6F4;">    targetView,</span></span>
<span class="line"><span style="color:#F6F6F4;">    sourceMagnet,</span></span>
<span class="line"><span style="color:#F6F6F4;">    targetMagnet</span></span>
<span class="line"><span style="color:#F6F6F4;">  }) {</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">if</span><span style="color:#F6F6F4;"> (sourceView </span><span style="color:#F286C4;">===</span><span style="color:#F6F6F4;"> targetView) {</span></span>
<span class="line"><span style="color:#F6F6F4;">      </span><span style="color:#F286C4;">return</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">false</span><span style="color:#F6F6F4;">;</span></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">if</span><span style="color:#F6F6F4;"> (</span><span style="color:#F286C4;">!</span><span style="color:#F6F6F4;">sourceMagnet) {</span></span>
<span class="line"><span style="color:#F6F6F4;">      </span><span style="color:#F286C4;">return</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">false</span><span style="color:#F6F6F4;">;</span></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#7B7F8B;">// 只能连接到输入链接桩</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">if</span><span style="color:#F6F6F4;"> (</span></span>
<span class="line"><span style="color:#F6F6F4;">      </span><span style="color:#F286C4;">!</span><span style="color:#F6F6F4;">targetMagnet </span><span style="color:#F286C4;">||</span></span>
<span class="line"><span style="color:#F6F6F4;">      targetMagnet.</span><span style="color:#62E884;">getAttribute</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">port-group</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">) </span><span style="color:#F286C4;">!==</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">in</span><span style="color:#DEE492;">&quot;</span></span>
<span class="line"><span style="color:#F6F6F4;">    ) {</span></span>
<span class="line"><span style="color:#F6F6F4;">      </span><span style="color:#F286C4;">return</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">false</span><span style="color:#F6F6F4;">;</span></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">return</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">true</span><span style="color:#F6F6F4;">;</span></span>
<span class="line"><span style="color:#F6F6F4;">  },</span></span>
<span class="line"><span style="color:#F6F6F4;">  </span><span style="color:#7B7F8B;">// 当停止拖动边的时候根据 validateEdge 返回值来判断边是否生效，如果返回 false, 该边会被清除。</span></span>
<span class="line"><span style="color:#F6F6F4;">  </span><span style="color:#62E884;">validateEdge</span><span style="color:#F6F6F4;">({ edge }) {</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">const</span><span style="color:#F6F6F4;"> { source, target } </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> edge</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">return</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">true</span></span>
<span class="line"><span style="color:#F6F6F4;">  }</span></span>
<span class="line"><span style="color:#F6F6F4;">},</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">// 连线规则</span></span>
<span class="line"><span style="color:#6F42C1;">connecting</span><span style="color:#24292E;">: {</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">snap</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">true</span><span style="color:#24292E;">,  </span><span style="color:#6A737D;">// 当 snap 设置为 true 时连线的过程中距离节点或者连接桩 50px 时会触发自动吸附</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">allowBlank</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">false</span><span style="color:#24292E;">,  </span><span style="color:#6A737D;">// 是否允许连接到画布空白位置的点，默认为 true</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">allowLoop</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">false</span><span style="color:#24292E;">, </span><span style="color:#6A737D;">// 是否允许创建循环连线，即边的起始节点和终止节点为同一节点，默认为 true</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">allowMulti</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">false</span><span style="color:#24292E;">, </span><span style="color:#6A737D;">// 当设置为 false 时，在起始和终止节点之间只允许创建一条边</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">highlight</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">true</span><span style="color:#24292E;">,  </span><span style="color:#6A737D;">// 拖动边时，是否高亮显示所有可用的连接桩或节点，默认值为 false。</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">sourceAnchor</span><span style="color:#24292E;">: {  </span><span style="color:#6A737D;">// 当连接到节点时，通过 sourceAnchor 来指定源节点的锚点。</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;bottom&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">args</span><span style="color:#24292E;">: {</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#6F42C1;">dx</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    },</span></span>
<span class="line"><span style="color:#24292E;">  },</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">targetAnchor</span><span style="color:#24292E;">: {  </span><span style="color:#6A737D;">// 当连接到节点时，通过 targetAnchor 来指定目标节点的锚点。</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;top&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">args</span><span style="color:#24292E;">: {</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#6F42C1;">dx</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    },</span></span>
<span class="line"><span style="color:#24292E;">  },</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">connectionPoint</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;anchor&#39;</span><span style="color:#24292E;">,  </span><span style="color:#6A737D;">// 指定连接点，默认值为 boundary。</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">connector</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;algo-edge&#39;</span><span style="color:#24292E;">,  </span><span style="color:#6A737D;">// 连接器将起点、路由返回的点、终点加工为 元素的 d 属性，决定了边渲染到画布后的样式，默认值为 normal。</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">createEdge</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> graph.</span><span style="color:#6F42C1;">createEdge</span><span style="color:#24292E;">({</span></span>
<span class="line"><span style="color:#24292E;">      attrs: {</span></span>
<span class="line"><span style="color:#24292E;">        line: {</span></span>
<span class="line"><span style="color:#24292E;">          strokeDasharray: </span><span style="color:#032F62;">&#39;5 5&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">          stroke: </span><span style="color:#032F62;">&#39;#808080&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">          strokeWidth: </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">          targetMarker: {</span></span>
<span class="line"><span style="color:#24292E;">            name: </span><span style="color:#032F62;">&#39;block&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">            args: {</span></span>
<span class="line"><span style="color:#24292E;">              size: </span><span style="color:#032F62;">&#39;6&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">            },</span></span>
<span class="line"><span style="color:#24292E;">          },</span></span>
<span class="line"><span style="color:#24292E;">        },</span></span>
<span class="line"><span style="color:#24292E;">      },</span></span>
<span class="line"><span style="color:#24292E;">    })</span></span>
<span class="line"><span style="color:#24292E;">  },</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">validateMagnet</span><span style="color:#24292E;">({ magnet }) {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> magnet.</span><span style="color:#6F42C1;">getAttribute</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;port-group&#39;</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">!==</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;in&#39;</span></span>
<span class="line"><span style="color:#24292E;">  },</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">validateConnection</span><span style="color:#24292E;">({</span></span>
<span class="line"><span style="color:#24292E;">    sourceView,</span></span>
<span class="line"><span style="color:#24292E;">    targetView,</span></span>
<span class="line"><span style="color:#24292E;">    sourceMagnet,</span></span>
<span class="line"><span style="color:#24292E;">    targetMagnet</span></span>
<span class="line"><span style="color:#24292E;">  }) {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (sourceView </span><span style="color:#D73A49;">===</span><span style="color:#24292E;"> targetView) {</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">false</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (</span><span style="color:#D73A49;">!</span><span style="color:#24292E;">sourceMagnet) {</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">false</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// 只能连接到输入链接桩</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#D73A49;">!</span><span style="color:#24292E;">targetMagnet </span><span style="color:#D73A49;">||</span></span>
<span class="line"><span style="color:#24292E;">      targetMagnet.</span><span style="color:#6F42C1;">getAttribute</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;port-group&quot;</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">!==</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;in&quot;</span></span>
<span class="line"><span style="color:#24292E;">    ) {</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">false</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">true</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">  },</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">// 当停止拖动边的时候根据 validateEdge 返回值来判断边是否生效，如果返回 false, 该边会被清除。</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">validateEdge</span><span style="color:#24292E;">({ edge }) {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> { </span><span style="color:#005CC5;">source</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">target</span><span style="color:#24292E;"> } </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> edge</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">true</span></span>
<span class="line"><span style="color:#24292E;">  }</span></span>
<span class="line"><span style="color:#24292E;">},</span></span></code></pre></div><p>7.方法们</p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F6F6F4;">graph.</span><span style="color:#62E884;">toJSON</span><span style="color:#F6F6F4;">()  </span><span style="color:#7B7F8B;">//  数据导出</span></span>
<span class="line"><span style="color:#F6F6F4;">graph.</span><span style="color:#62E884;">fromJSON</span><span style="color:#F6F6F4;">()  </span><span style="color:#7B7F8B;">//  数据渲染</span></span>
<span class="line"><span style="color:#F6F6F4;">graph.</span><span style="color:#62E884;">isPannable</span><span style="color:#F6F6F4;">()  </span><span style="color:#7B7F8B;">//  画布是否可以平移</span></span>
<span class="line"><span style="color:#F6F6F4;">graph.</span><span style="color:#62E884;">enablePanning</span><span style="color:#F6F6F4;">()  </span><span style="color:#7B7F8B;">//  启用画布平移</span></span>
<span class="line"><span style="color:#F6F6F4;">graph.</span><span style="color:#62E884;">centerContent</span><span style="color:#F6F6F4;">();  </span><span style="color:#7B7F8B;">//  中心对称</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">graph.</span><span style="color:#6F42C1;">toJSON</span><span style="color:#24292E;">()  </span><span style="color:#6A737D;">//  数据导出</span></span>
<span class="line"><span style="color:#24292E;">graph.</span><span style="color:#6F42C1;">fromJSON</span><span style="color:#24292E;">()  </span><span style="color:#6A737D;">//  数据渲染</span></span>
<span class="line"><span style="color:#24292E;">graph.</span><span style="color:#6F42C1;">isPannable</span><span style="color:#24292E;">()  </span><span style="color:#6A737D;">//  画布是否可以平移</span></span>
<span class="line"><span style="color:#24292E;">graph.</span><span style="color:#6F42C1;">enablePanning</span><span style="color:#24292E;">()  </span><span style="color:#6A737D;">//  启用画布平移</span></span>
<span class="line"><span style="color:#24292E;">graph.</span><span style="color:#6F42C1;">centerContent</span><span style="color:#24292E;">();  </span><span style="color:#6A737D;">//  中心对称</span></span></code></pre></div><p>8.绑定事件</p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F6F6F4;">graph.</span><span style="color:#62E884;">on</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">node:added</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">, ({ </span><span style="color:#FFB86C;font-style:italic;">node</span><span style="color:#F6F6F4;">, </span><span style="color:#FFB86C;font-style:italic;">cell</span><span style="color:#F6F6F4;"> }) </span><span style="color:#F286C4;">=&gt;</span><span style="color:#F6F6F4;"> {}) </span><span style="color:#7B7F8B;">// 节点移入画布事件</span></span>
<span class="line"><span style="color:#F6F6F4;">graph.</span><span style="color:#62E884;">on</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">cell:dblclick</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">, ({ </span><span style="color:#FFB86C;font-style:italic;">node</span><span style="color:#F6F6F4;">, </span><span style="color:#FFB86C;font-style:italic;">cell</span><span style="color:#F6F6F4;"> }) </span><span style="color:#F286C4;">=&gt;</span><span style="color:#F6F6F4;"> {});  </span><span style="color:#7B7F8B;">//  节点双击事件</span></span>
<span class="line"><span style="color:#F6F6F4;">graph.</span><span style="color:#62E884;">on</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">node:mouseenter</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">, ({ </span><span style="color:#FFB86C;font-style:italic;">node</span><span style="color:#F6F6F4;"> }) </span><span style="color:#F286C4;">=&gt;</span><span style="color:#F6F6F4;"> {  </span><span style="color:#7B7F8B;">//  节点删除操作</span></span>
<span class="line"><span style="color:#F6F6F4;">  </span><span style="color:#7B7F8B;">// 鼠标 Hover 节点时添加删除按钮</span></span>
<span class="line"><span style="color:#F6F6F4;">  node.</span><span style="color:#62E884;">addTools</span><span style="color:#F6F6F4;">({</span></span>
<span class="line"><span style="color:#F6F6F4;">    name</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">button-remove</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">    args</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">      x</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">0</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">      y</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">0</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">      offset</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> { x</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">10</span><span style="color:#F6F6F4;">, y</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">10</span><span style="color:#F6F6F4;"> },</span></span>
<span class="line"><span style="color:#F6F6F4;">      markup</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> [  </span><span style="color:#7B7F8B;">//自定义的删除按钮样式</span></span>
<span class="line"><span style="color:#F6F6F4;">        {</span></span>
<span class="line"><span style="color:#F6F6F4;">          tagName</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">circle</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">          selector</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">button</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">          attrs</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">            r</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">8</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">            stroke</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">#F25C54</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">            strokeWidth</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">1</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">            fill</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">rgba(214, 40, 40, 0.25)</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">            cursor</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">pointer</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">          },</span></span>
<span class="line"><span style="color:#F6F6F4;">        },</span></span>
<span class="line"><span style="color:#F6F6F4;">        {</span></span>
<span class="line"><span style="color:#F6F6F4;">          tagName</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">text</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">          textContent</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">✕</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">          selector</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">icon</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">          attrs</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">            fill</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">#F25C54</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">            fontSize</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">7</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">            textAnchor</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">middle</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">            pointerEvents</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">none</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">            y</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">0.3em</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">          },</span></span>
<span class="line"><span style="color:#F6F6F4;">        },</span></span>
<span class="line"><span style="color:#F6F6F4;">      ],</span></span>
<span class="line"><span style="color:#F6F6F4;">    },</span></span>
<span class="line"><span style="color:#F6F6F4;">  });</span></span>
<span class="line"><span style="color:#F6F6F4;">});</span></span>
<span class="line"><span style="color:#F6F6F4;">graph.</span><span style="color:#62E884;">on</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">node:removed</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">, ({ </span><span style="color:#FFB86C;font-style:italic;">node</span><span style="color:#F6F6F4;">, </span><span style="color:#FFB86C;font-style:italic;">options</span><span style="color:#F6F6F4;"> }) </span><span style="color:#F286C4;">=&gt;</span><span style="color:#F6F6F4;"> {  </span><span style="color:#7B7F8B;">//  删除节点事件</span></span>
<span class="line"><span style="color:#F6F6F4;">  </span><span style="color:#F286C4;">if</span><span style="color:#F6F6F4;"> (</span><span style="color:#F286C4;">!</span><span style="color:#F6F6F4;">options.ui) {</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">return</span><span style="color:#F6F6F4;">;</span></span>
<span class="line"><span style="color:#F6F6F4;">  }</span></span>
<span class="line"><span style="color:#F6F6F4;">});</span></span>
<span class="line"><span style="color:#F6F6F4;">graph.</span><span style="color:#62E884;">on</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">node:mouseleave</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">, ({ </span><span style="color:#FFB86C;font-style:italic;">node</span><span style="color:#F6F6F4;"> }) </span><span style="color:#F286C4;">=&gt;</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">  </span><span style="color:#7B7F8B;">// 鼠标移开节点时删除删除按钮</span></span>
<span class="line"><span style="color:#F6F6F4;">  node.</span><span style="color:#62E884;">removeTools</span><span style="color:#F6F6F4;">();</span></span>
<span class="line"><span style="color:#F6F6F4;">});</span></span>
<span class="line"><span style="color:#7B7F8B;">// 线删除操作</span></span>
<span class="line"><span style="color:#F6F6F4;">graph.</span><span style="color:#62E884;">on</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">edge:mouseenter</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">, ({ </span><span style="color:#FFB86C;font-style:italic;">edge</span><span style="color:#F6F6F4;"> }) </span><span style="color:#F286C4;">=&gt;</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">  </span><span style="color:#7B7F8B;">// 鼠标 Hover 边时添加删除按钮</span></span>
<span class="line"><span style="color:#F6F6F4;">  edge.</span><span style="color:#62E884;">addTools</span><span style="color:#F6F6F4;">([</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">target-arrowhead</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">    {</span></span>
<span class="line"><span style="color:#F6F6F4;">      name</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">button-remove</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">      args</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">        distance</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">-</span><span style="color:#BF9EEE;">30</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"><span style="color:#F6F6F4;">      },</span></span>
<span class="line"><span style="color:#F6F6F4;">    },</span></span>
<span class="line"><span style="color:#F6F6F4;">  ]);</span></span>
<span class="line"><span style="color:#F6F6F4;">});</span></span>
<span class="line"><span style="color:#F6F6F4;">graph.</span><span style="color:#62E884;">on</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">edge:removed</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">, ({ </span><span style="color:#FFB86C;font-style:italic;">edge</span><span style="color:#F6F6F4;">, </span><span style="color:#FFB86C;font-style:italic;">options</span><span style="color:#F6F6F4;"> }) </span><span style="color:#F286C4;">=&gt;</span><span style="color:#F6F6F4;"> {  </span><span style="color:#7B7F8B;">//  移除连线事件</span></span>
<span class="line"><span style="color:#F6F6F4;">  </span><span style="color:#F286C4;">if</span><span style="color:#F6F6F4;"> (</span><span style="color:#F286C4;">!</span><span style="color:#F6F6F4;">options.ui) {</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">return</span><span style="color:#F6F6F4;">;</span></span>
<span class="line"><span style="color:#F6F6F4;">  }</span></span>
<span class="line"><span style="color:#F6F6F4;">  </span><span style="color:#F286C4;">const</span><span style="color:#F6F6F4;"> cellId </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> edge.</span><span style="color:#62E884;">getTargetCellId</span><span style="color:#F6F6F4;">()</span></span>
<span class="line"><span style="color:#F6F6F4;">  </span><span style="color:#F286C4;">const</span><span style="color:#F6F6F4;"> target </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> graph.</span><span style="color:#62E884;">getCellById</span><span style="color:#F6F6F4;">(cellId)、</span></span>
<span class="line"><span style="color:#F6F6F4;">  </span><span style="color:#F286C4;">if</span><span style="color:#F6F6F4;"> (target) {</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">const</span><span style="color:#F6F6F4;"> id </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> target.ports.items[</span><span style="color:#BF9EEE;">0</span><span style="color:#F6F6F4;">].id</span></span>
<span class="line"><span style="color:#F6F6F4;">    target </span><span style="color:#F286C4;">&amp;&amp;</span><span style="color:#F6F6F4;"> target.</span><span style="color:#62E884;">setPortProp</span><span style="color:#F6F6F4;">(id, </span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">connected</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">, </span><span style="color:#BF9EEE;">false</span><span style="color:#F6F6F4;">)</span></span>
<span class="line"><span style="color:#F6F6F4;">  }</span><span style="color:#F286C4;">else</span><span style="color:#F6F6F4;">{</span></span>
<span class="line"><span style="color:#F6F6F4;">    target </span><span style="color:#F286C4;">&amp;&amp;</span><span style="color:#F6F6F4;"> target.</span><span style="color:#62E884;">setPortProp</span><span style="color:#F6F6F4;">(cellId</span><span style="color:#F286C4;">+</span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">_in</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">, </span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">connected</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">, </span><span style="color:#BF9EEE;">false</span><span style="color:#F6F6F4;">)</span></span>
<span class="line"><span style="color:#F6F6F4;">  }</span></span>
<span class="line"><span style="color:#F6F6F4;">});</span></span>
<span class="line"><span style="color:#F6F6F4;">graph.</span><span style="color:#62E884;">on</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">edge:mouseleave</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">, ({ </span><span style="color:#FFB86C;font-style:italic;">edge</span><span style="color:#F6F6F4;"> }) </span><span style="color:#F286C4;">=&gt;</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">  </span><span style="color:#7B7F8B;">// 鼠标移开边时删除删除按钮</span></span>
<span class="line"><span style="color:#F6F6F4;">  edge.</span><span style="color:#62E884;">removeTools</span><span style="color:#F6F6F4;">();</span></span>
<span class="line"><span style="color:#F6F6F4;">});</span></span>
<span class="line"><span style="color:#F6F6F4;">graph.</span><span style="color:#62E884;">on</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">node:change:data</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">, ({ </span><span style="color:#FFB86C;font-style:italic;">node</span><span style="color:#F6F6F4;"> }) </span><span style="color:#F286C4;">=&gt;</span><span style="color:#F6F6F4;"> {  </span><span style="color:#7B7F8B;">//  修改节点数据的实时响应事件</span></span>
<span class="line"><span style="color:#F6F6F4;">  node.data </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> eachNodeData</span></span>
<span class="line"><span style="color:#F6F6F4;">})</span></span>
<span class="line"><span style="color:#F6F6F4;">graph.</span><span style="color:#62E884;">on</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">node:contextmenu</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">, ({ </span><span style="color:#FFB86C;font-style:italic;">cell</span><span style="color:#F6F6F4;">, </span><span style="color:#FFB86C;font-style:italic;">view</span><span style="color:#F6F6F4;"> }) </span><span style="color:#F286C4;">=&gt;</span><span style="color:#F6F6F4;"> {  </span><span style="color:#7B7F8B;">//  节点文本</span></span>
<span class="line"><span style="color:#F6F6F4;">  </span><span style="color:#F286C4;">const</span><span style="color:#F6F6F4;"> oldText </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> cell.</span><span style="color:#62E884;">attr</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">text/textWrap/text</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">);</span></span>
<span class="line"><span style="color:#F6F6F4;">  </span><span style="color:#F286C4;">const</span><span style="color:#F6F6F4;"> elem </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> view.container.</span><span style="color:#62E884;">querySelector</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">.x6-edit-text</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">);</span></span>
<span class="line"><span style="color:#F6F6F4;">  </span><span style="color:#F286C4;">if</span><span style="color:#F6F6F4;"> (elem </span><span style="color:#F286C4;">==</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">null</span><span style="color:#F6F6F4;">) {</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">return</span><span style="color:#F6F6F4;">;</span></span>
<span class="line"><span style="color:#F6F6F4;">  }</span></span>
<span class="line"><span style="color:#F6F6F4;">  cell.</span><span style="color:#62E884;">attr</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">text/style/display</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">, </span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">none</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">);</span></span>
<span class="line"><span style="color:#F6F6F4;">  </span><span style="color:#F286C4;">if</span><span style="color:#F6F6F4;"> (elem) {</span></span>
<span class="line"><span style="color:#F6F6F4;">    elem.style.display </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&quot;&quot;</span><span style="color:#F6F6F4;">;</span></span>
<span class="line"><span style="color:#F6F6F4;">    elem.contentEditable </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">true</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">;</span></span>
<span class="line"><span style="color:#F6F6F4;">    elem.innerText </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> oldText;</span></span>
<span class="line"><span style="color:#F6F6F4;">    elem.</span><span style="color:#62E884;">focus</span><span style="color:#F6F6F4;">();</span></span>
<span class="line"><span style="color:#F6F6F4;">  }</span></span>
<span class="line"><span style="color:#F6F6F4;">  </span><span style="color:#F286C4;">const</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">onBlur</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> () </span><span style="color:#F286C4;">=&gt;</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">    cell.</span><span style="color:#62E884;">attr</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">text/textWrap/text</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">, elem.innerText);</span></span>
<span class="line"><span style="color:#F6F6F4;">    cell.</span><span style="color:#62E884;">attr</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">text/style/display</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">, </span><span style="color:#DEE492;">&quot;&quot;</span><span style="color:#F6F6F4;">);</span></span>
<span class="line"><span style="color:#F6F6F4;">    elem.style.display </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">none</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">;</span></span>
<span class="line"><span style="color:#F6F6F4;">    elem.contentEditable </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">false</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">;</span></span>
<span class="line"><span style="color:#F6F6F4;">  };</span></span>
<span class="line"><span style="color:#F6F6F4;">  elem.</span><span style="color:#62E884;">addEventListener</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">blur</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">, () </span><span style="color:#F286C4;">=&gt;</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#62E884;">onBlur</span><span style="color:#F6F6F4;">();</span></span>
<span class="line"><span style="color:#F6F6F4;">    elem.</span><span style="color:#62E884;">removeEventListener</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">blur</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">, onBlur);</span></span>
<span class="line"><span style="color:#F6F6F4;">  });</span></span>
<span class="line"><span style="color:#F6F6F4;">});</span></span>
<span class="line"><span style="color:#F286C4;">const</span><span style="color:#F6F6F4;"> container </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> document.</span><span style="color:#62E884;">getElementById</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">flowContainer</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">);</span></span>
<span class="line"><span style="color:#F6F6F4;">graph.</span><span style="color:#62E884;">on</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">node:mouseenter</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">,FunctionExt.</span><span style="color:#62E884;">debounce</span><span style="color:#F6F6F4;">(() </span><span style="color:#F286C4;">=&gt;</span><span style="color:#F6F6F4;"> {  </span><span style="color:#7B7F8B;">//  节点链接桩显隐</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">const</span><span style="color:#F6F6F4;"> ports </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> container.</span><span style="color:#62E884;">querySelectorAll</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">.x6-port-body</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">);</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#62E884;">showPorts</span><span style="color:#F6F6F4;">(ports, </span><span style="color:#BF9EEE;">true</span><span style="color:#F6F6F4;">);</span></span>
<span class="line"><span style="color:#F6F6F4;">  }),</span></span>
<span class="line"><span style="color:#F6F6F4;">  </span><span style="color:#BF9EEE;">500</span></span>
<span class="line"><span style="color:#F6F6F4;">);</span></span>
<span class="line"><span style="color:#F6F6F4;">graph.</span><span style="color:#62E884;">on</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">node:mouseleave</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">, () </span><span style="color:#F286C4;">=&gt;</span><span style="color:#F6F6F4;"> {  </span><span style="color:#7B7F8B;">//  节点链接桩显隐</span></span>
<span class="line"><span style="color:#F6F6F4;">  </span><span style="color:#F286C4;">const</span><span style="color:#F6F6F4;"> ports </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> container.</span><span style="color:#62E884;">querySelectorAll</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">.x6-port-body</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">);</span></span>
<span class="line"><span style="color:#F6F6F4;">  </span><span style="color:#62E884;">showPorts</span><span style="color:#F6F6F4;">(ports, </span><span style="color:#BF9EEE;">false</span><span style="color:#F6F6F4;">);</span></span>
<span class="line"><span style="color:#F6F6F4;">});</span></span>
<span class="line"><span style="color:#F6F6F4;">graph.</span><span style="color:#62E884;">bindKey</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">backspace</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">, () </span><span style="color:#F286C4;">=&gt;</span><span style="color:#F6F6F4;"> {  </span><span style="color:#7B7F8B;">//  点按空格后跳出带有节点的画布区域</span></span>
<span class="line"><span style="color:#F6F6F4;">  </span><span style="color:#F286C4;">const</span><span style="color:#F6F6F4;"> cells </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> graph.</span><span style="color:#62E884;">getSelectedCells</span><span style="color:#F6F6F4;">();</span></span>
<span class="line"><span style="color:#F6F6F4;">  </span><span style="color:#F286C4;">if</span><span style="color:#F6F6F4;"> (cells.length) {</span></span>
<span class="line"><span style="color:#F6F6F4;">    graph.</span><span style="color:#62E884;">removeCells</span><span style="color:#F6F6F4;">(cells);</span></span>
<span class="line"><span style="color:#F6F6F4;">  }</span></span>
<span class="line"><span style="color:#F6F6F4;">});</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">graph.</span><span style="color:#6F42C1;">on</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;node:added&#39;</span><span style="color:#24292E;">, ({ </span><span style="color:#E36209;">node</span><span style="color:#24292E;">, </span><span style="color:#E36209;">cell</span><span style="color:#24292E;"> }) </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> {}) </span><span style="color:#6A737D;">// 节点移入画布事件</span></span>
<span class="line"><span style="color:#24292E;">graph.</span><span style="color:#6F42C1;">on</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;cell:dblclick&quot;</span><span style="color:#24292E;">, ({ </span><span style="color:#E36209;">node</span><span style="color:#24292E;">, </span><span style="color:#E36209;">cell</span><span style="color:#24292E;"> }) </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> {});  </span><span style="color:#6A737D;">//  节点双击事件</span></span>
<span class="line"><span style="color:#24292E;">graph.</span><span style="color:#6F42C1;">on</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;node:mouseenter&quot;</span><span style="color:#24292E;">, ({ </span><span style="color:#E36209;">node</span><span style="color:#24292E;"> }) </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> {  </span><span style="color:#6A737D;">//  节点删除操作</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">// 鼠标 Hover 节点时添加删除按钮</span></span>
<span class="line"><span style="color:#24292E;">  node.</span><span style="color:#6F42C1;">addTools</span><span style="color:#24292E;">({</span></span>
<span class="line"><span style="color:#24292E;">    name: </span><span style="color:#032F62;">&quot;button-remove&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    args: {</span></span>
<span class="line"><span style="color:#24292E;">      x: </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">      y: </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">      offset: { x: </span><span style="color:#005CC5;">10</span><span style="color:#24292E;">, y: </span><span style="color:#005CC5;">10</span><span style="color:#24292E;"> },</span></span>
<span class="line"><span style="color:#24292E;">      markup: [  </span><span style="color:#6A737D;">//自定义的删除按钮样式</span></span>
<span class="line"><span style="color:#24292E;">        {</span></span>
<span class="line"><span style="color:#24292E;">          tagName: </span><span style="color:#032F62;">&#39;circle&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">          selector: </span><span style="color:#032F62;">&#39;button&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">          attrs: {</span></span>
<span class="line"><span style="color:#24292E;">            r: </span><span style="color:#005CC5;">8</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">            stroke: </span><span style="color:#032F62;">&#39;#F25C54&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">            strokeWidth: </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">            fill: </span><span style="color:#032F62;">&#39;rgba(214, 40, 40, 0.25)&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">            cursor: </span><span style="color:#032F62;">&#39;pointer&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">          },</span></span>
<span class="line"><span style="color:#24292E;">        },</span></span>
<span class="line"><span style="color:#24292E;">        {</span></span>
<span class="line"><span style="color:#24292E;">          tagName: </span><span style="color:#032F62;">&#39;text&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">          textContent: </span><span style="color:#032F62;">&#39;✕&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">          selector: </span><span style="color:#032F62;">&#39;icon&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">          attrs: {</span></span>
<span class="line"><span style="color:#24292E;">            fill: </span><span style="color:#032F62;">&#39;#F25C54&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">            fontSize: </span><span style="color:#005CC5;">7</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">            textAnchor: </span><span style="color:#032F62;">&#39;middle&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">            pointerEvents: </span><span style="color:#032F62;">&#39;none&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">            y: </span><span style="color:#032F62;">&#39;0.3em&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">          },</span></span>
<span class="line"><span style="color:#24292E;">        },</span></span>
<span class="line"><span style="color:#24292E;">      ],</span></span>
<span class="line"><span style="color:#24292E;">    },</span></span>
<span class="line"><span style="color:#24292E;">  });</span></span>
<span class="line"><span style="color:#24292E;">});</span></span>
<span class="line"><span style="color:#24292E;">graph.</span><span style="color:#6F42C1;">on</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;node:removed&quot;</span><span style="color:#24292E;">, ({ </span><span style="color:#E36209;">node</span><span style="color:#24292E;">, </span><span style="color:#E36209;">options</span><span style="color:#24292E;"> }) </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> {  </span><span style="color:#6A737D;">//  删除节点事件</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (</span><span style="color:#D73A49;">!</span><span style="color:#24292E;">options.ui) {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">return</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">  }</span></span>
<span class="line"><span style="color:#24292E;">});</span></span>
<span class="line"><span style="color:#24292E;">graph.</span><span style="color:#6F42C1;">on</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;node:mouseleave&quot;</span><span style="color:#24292E;">, ({ </span><span style="color:#E36209;">node</span><span style="color:#24292E;"> }) </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">// 鼠标移开节点时删除删除按钮</span></span>
<span class="line"><span style="color:#24292E;">  node.</span><span style="color:#6F42C1;">removeTools</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">});</span></span>
<span class="line"><span style="color:#6A737D;">// 线删除操作</span></span>
<span class="line"><span style="color:#24292E;">graph.</span><span style="color:#6F42C1;">on</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;edge:mouseenter&quot;</span><span style="color:#24292E;">, ({ </span><span style="color:#E36209;">edge</span><span style="color:#24292E;"> }) </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">// 鼠标 Hover 边时添加删除按钮</span></span>
<span class="line"><span style="color:#24292E;">  edge.</span><span style="color:#6F42C1;">addTools</span><span style="color:#24292E;">([</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#032F62;">&quot;target-arrowhead&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    {</span></span>
<span class="line"><span style="color:#24292E;">      name: </span><span style="color:#032F62;">&quot;button-remove&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">      args: {</span></span>
<span class="line"><span style="color:#24292E;">        distance: </span><span style="color:#D73A49;">-</span><span style="color:#005CC5;">30</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">      },</span></span>
<span class="line"><span style="color:#24292E;">    },</span></span>
<span class="line"><span style="color:#24292E;">  ]);</span></span>
<span class="line"><span style="color:#24292E;">});</span></span>
<span class="line"><span style="color:#24292E;">graph.</span><span style="color:#6F42C1;">on</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;edge:removed&quot;</span><span style="color:#24292E;">, ({ </span><span style="color:#E36209;">edge</span><span style="color:#24292E;">, </span><span style="color:#E36209;">options</span><span style="color:#24292E;"> }) </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> {  </span><span style="color:#6A737D;">//  移除连线事件</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (</span><span style="color:#D73A49;">!</span><span style="color:#24292E;">options.ui) {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">return</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">  }</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">cellId</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> edge.</span><span style="color:#6F42C1;">getTargetCellId</span><span style="color:#24292E;">()</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">target</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> graph.</span><span style="color:#6F42C1;">getCellById</span><span style="color:#24292E;">(cellId)、</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (target) {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">id</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> target.ports.items[</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">].id</span></span>
<span class="line"><span style="color:#24292E;">    target </span><span style="color:#D73A49;">&amp;&amp;</span><span style="color:#24292E;"> target.</span><span style="color:#6F42C1;">setPortProp</span><span style="color:#24292E;">(id, </span><span style="color:#032F62;">&#39;connected&#39;</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">false</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">  }</span><span style="color:#D73A49;">else</span><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">    target </span><span style="color:#D73A49;">&amp;&amp;</span><span style="color:#24292E;"> target.</span><span style="color:#6F42C1;">setPortProp</span><span style="color:#24292E;">(cellId</span><span style="color:#D73A49;">+</span><span style="color:#032F62;">&#39;_in&#39;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&#39;connected&#39;</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">false</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">  }</span></span>
<span class="line"><span style="color:#24292E;">});</span></span>
<span class="line"><span style="color:#24292E;">graph.</span><span style="color:#6F42C1;">on</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;edge:mouseleave&quot;</span><span style="color:#24292E;">, ({ </span><span style="color:#E36209;">edge</span><span style="color:#24292E;"> }) </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">// 鼠标移开边时删除删除按钮</span></span>
<span class="line"><span style="color:#24292E;">  edge.</span><span style="color:#6F42C1;">removeTools</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">});</span></span>
<span class="line"><span style="color:#24292E;">graph.</span><span style="color:#6F42C1;">on</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;node:change:data&#39;</span><span style="color:#24292E;">, ({ </span><span style="color:#E36209;">node</span><span style="color:#24292E;"> }) </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> {  </span><span style="color:#6A737D;">//  修改节点数据的实时响应事件</span></span>
<span class="line"><span style="color:#24292E;">  node.data </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> eachNodeData</span></span>
<span class="line"><span style="color:#24292E;">})</span></span>
<span class="line"><span style="color:#24292E;">graph.</span><span style="color:#6F42C1;">on</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;node:contextmenu&quot;</span><span style="color:#24292E;">, ({ </span><span style="color:#E36209;">cell</span><span style="color:#24292E;">, </span><span style="color:#E36209;">view</span><span style="color:#24292E;"> }) </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> {  </span><span style="color:#6A737D;">//  节点文本</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">oldText</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> cell.</span><span style="color:#6F42C1;">attr</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;text/textWrap/text&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">elem</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> view.container.</span><span style="color:#6F42C1;">querySelector</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;.x6-edit-text&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (elem </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">null</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">return</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">  }</span></span>
<span class="line"><span style="color:#24292E;">  cell.</span><span style="color:#6F42C1;">attr</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;text/style/display&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;none&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (elem) {</span></span>
<span class="line"><span style="color:#24292E;">    elem.style.display </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;&quot;</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">    elem.contentEditable </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;true&quot;</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">    elem.innerText </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> oldText;</span></span>
<span class="line"><span style="color:#24292E;">    elem.</span><span style="color:#6F42C1;">focus</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">  }</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">onBlur</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> () </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    cell.</span><span style="color:#6F42C1;">attr</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;text/textWrap/text&quot;</span><span style="color:#24292E;">, elem.innerText);</span></span>
<span class="line"><span style="color:#24292E;">    cell.</span><span style="color:#6F42C1;">attr</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;text/style/display&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    elem.style.display </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;none&quot;</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">    elem.contentEditable </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;false&quot;</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">  };</span></span>
<span class="line"><span style="color:#24292E;">  elem.</span><span style="color:#6F42C1;">addEventListener</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;blur&quot;</span><span style="color:#24292E;">, () </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">onBlur</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">    elem.</span><span style="color:#6F42C1;">removeEventListener</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;blur&quot;</span><span style="color:#24292E;">, onBlur);</span></span>
<span class="line"><span style="color:#24292E;">  });</span></span>
<span class="line"><span style="color:#24292E;">});</span></span>
<span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">container</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> document.</span><span style="color:#6F42C1;">getElementById</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;flowContainer&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">graph.</span><span style="color:#6F42C1;">on</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;node:mouseenter&quot;</span><span style="color:#24292E;">,FunctionExt.</span><span style="color:#6F42C1;">debounce</span><span style="color:#24292E;">(() </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> {  </span><span style="color:#6A737D;">//  节点链接桩显隐</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">ports</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> container.</span><span style="color:#6F42C1;">querySelectorAll</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;.x6-port-body&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">showPorts</span><span style="color:#24292E;">(ports, </span><span style="color:#005CC5;">true</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">  }),</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#005CC5;">500</span></span>
<span class="line"><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">graph.</span><span style="color:#6F42C1;">on</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;node:mouseleave&quot;</span><span style="color:#24292E;">, () </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> {  </span><span style="color:#6A737D;">//  节点链接桩显隐</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">ports</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> container.</span><span style="color:#6F42C1;">querySelectorAll</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;.x6-port-body&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">showPorts</span><span style="color:#24292E;">(ports, </span><span style="color:#005CC5;">false</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">});</span></span>
<span class="line"><span style="color:#24292E;">graph.</span><span style="color:#6F42C1;">bindKey</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;backspace&quot;</span><span style="color:#24292E;">, () </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> {  </span><span style="color:#6A737D;">//  点按空格后跳出带有节点的画布区域</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">cells</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> graph.</span><span style="color:#6F42C1;">getSelectedCells</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (cells.</span><span style="color:#005CC5;">length</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">    graph.</span><span style="color:#6F42C1;">removeCells</span><span style="color:#24292E;">(cells);</span></span>
<span class="line"><span style="color:#24292E;">  }</span></span>
<span class="line"><span style="color:#24292E;">});</span></span></code></pre></div><p>其他有趣的用法</p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#7B7F8B;">//设置指定路径上的属性值cell.attr(&#39;text/text&#39;, value)  其中label/text为自定义标题</span></span>
<span class="line"><span style="color:#F6F6F4;">cell.</span><span style="color:#62E884;">attr</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">label/text</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">, state.flinkLabel)</span></span>
<span class="line"><span style="color:#F6F6F4;">cell.</span><span style="color:#62E884;">attr</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">label/data</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">, j)</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">//设置指定路径上的属性值cell.attr(&#39;text/text&#39;, value)  其中label/text为自定义标题</span></span>
<span class="line"><span style="color:#24292E;">cell.</span><span style="color:#6F42C1;">attr</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;label/text&#39;</span><span style="color:#24292E;">, state.flinkLabel)</span></span>
<span class="line"><span style="color:#24292E;">cell.</span><span style="color:#6F42C1;">attr</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;label/data&#39;</span><span style="color:#24292E;">, j)</span></span></code></pre></div><p>9.根据接口数据回显画布流程图</p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#7B7F8B;">//就是通过这个方法来实现的</span></span>
<span class="line"><span style="color:#F6F6F4;">graph.</span><span style="color:#62E884;">fromJSON</span><span style="color:#F6F6F4;">(nodeData)  </span><span style="color:#7B7F8B;">//  数据渲染，括号内填入回显的数组数据变量</span></span>
<span class="line"><span style="color:#7B7F8B;">//而nodeData在前面2.提出的数据准备中初始化定义了，我们在接口返回的数据里填充数据和样式就搞定回显了</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">//就是通过这个方法来实现的</span></span>
<span class="line"><span style="color:#24292E;">graph.</span><span style="color:#6F42C1;">fromJSON</span><span style="color:#24292E;">(nodeData)  </span><span style="color:#6A737D;">//  数据渲染，括号内填入回显的数组数据变量</span></span>
<span class="line"><span style="color:#6A737D;">//而nodeData在前面2.提出的数据准备中初始化定义了，我们在接口返回的数据里填充数据和样式就搞定回显了</span></span></code></pre></div><h2 id="总结" tabindex="-1">总结 <a class="header-anchor" href="#总结" aria-label="Permalink to &quot;总结&quot;">​</a></h2><p>在vue项目中，使用AntV X6实现节点和画布、连线的配置，非常灵活，一旦会用后有相当多的方法可以使用，自由度和定制度高。还有许多用法可以实现，如点击执行指令显示流程图的动画运行流： <img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/52926bc4b87e4952a022e91dc14bdf1e~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.image" alt="在这里插入图片描述"></p><h2 id="参考资料" tabindex="-1">参考资料 <a class="header-anchor" href="#参考资料" aria-label="Permalink to &quot;参考资料&quot;">​</a></h2><ol><li><a href="https://x6.antv.antgroup.com/zh/examples/showcase/practices/#flowchart" title="https://x6.antv.antgroup.com/zh/examples/showcase/practices/#flowchart" target="_blank" rel="noreferrer">ANTV-X6 流程图</a></li><li><a href="https://x6.antv.antgroup.com/tutorial/getting-started" title="https://x6.antv.antgroup.com/tutorial/getting-started" target="_blank" rel="noreferrer">ANTV-X6 快速上手</a></li></ol>`,31),e=[o];function t(c,r,F,y,E,i){return n(),a("div",null,e)}const d=s(p,[["render",t]]);export{u as __pageData,d as default};
